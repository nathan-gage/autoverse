(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))n(i);new MutationObserver(i=>{for(const s of i)if(s.type==="childList")for(const a of s.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&n(a)}).observe(document,{childList:!0,subtree:!0});function r(i){const s={};return i.integrity&&(s.integrity=i.integrity),i.referrerPolicy&&(s.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?s.credentials="include":i.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function n(i){if(i.ep)return;i.ep=!0;const s=r(i);fetch(i.href,s)}})();const tr=!1;var Wr=Array.isArray,Un=Array.prototype.indexOf,Yt=Array.from,Hr=Object.defineProperty,it=Object.getOwnPropertyDescriptor,Vr=Object.getOwnPropertyDescriptors,jn=Object.prototype,qn=Array.prototype,gr=Object.getPrototypeOf,Pr=Object.isExtensible;const Ee=()=>{};function Xn(t){return t()}function Ot(t){for(var e=0;e<t.length;e++)t[e]()}function Kr(){var t,e,r=new Promise((n,i)=>{t=n,e=i});return{promise:r,resolve:t,reject:e}}const H=2,_r=4,Ut=8,Wn=1<<24,Ae=16,Te=32,He=64,jt=128,he=512,X=1024,te=2048,ve=4096,ne=8192,Me=16384,mr=32768,je=65536,$r=1<<17,Jr=1<<18,dt=1<<19,Zr=1<<20,xe=1<<25,qe=32768,rr=1<<21,br=1<<22,Le=1<<23,ze=Symbol("$state"),Hn=Symbol("legacy props"),Vn=Symbol(""),rt=new class extends Error{name="StaleReactionError";message="The reaction that called `getAbortSignal()` was re-run or destroyed"};function Qr(t){throw new Error("https://svelte.dev/e/lifecycle_outside_component")}function Kn(){throw new Error("https://svelte.dev/e/async_derived_orphan")}function Jn(t){throw new Error("https://svelte.dev/e/effect_in_teardown")}function Zn(){throw new Error("https://svelte.dev/e/effect_in_unowned_derived")}function Qn(t){throw new Error("https://svelte.dev/e/effect_orphan")}function es(){throw new Error("https://svelte.dev/e/effect_update_depth_exceeded")}function ts(t){throw new Error("https://svelte.dev/e/props_invalid_value")}function rs(){throw new Error("https://svelte.dev/e/state_descriptors_fixed")}function ns(){throw new Error("https://svelte.dev/e/state_prototype_fixed")}function ss(){throw new Error("https://svelte.dev/e/state_unsafe_mutation")}function is(){throw new Error("https://svelte.dev/e/svelte_boundary_reset_onerror")}const as=1,os=2,en=4,ls=8,cs=16,fs=1,us=2,ds=4,hs=8,vs=16,ps=1,gs=2,K=Symbol(),_s="http://www.w3.org/1999/xhtml";function ms(){console.warn("https://svelte.dev/e/svelte_boundary_reset_noop")}function tn(t){return t===this.v}function rn(t,e){return t!=t?e==e:t!==e||t!==null&&typeof t=="object"||typeof t=="function"}function nn(t){return!rn(t,this.v)}let ht=!1,bs=!1;function ws(){ht=!0}let N=null;function ot(t){N=t}function Ve(t,e=!1,r){N={p:N,i:!1,c:null,e:null,s:t,x:null,l:ht&&!e?{s:null,u:null,$:[]}:null}}function Ke(t){var e=N,r=e.e;if(r!==null){e.e=null;for(var n of r)_n(n)}return e.i=!0,N=e.p,{}}function kt(){return!ht||N!==null&&N.l===null}let nt=[];function ys(){var t=nt;nt=[],Ot(t)}function vt(t){if(nt.length===0){var e=nt;queueMicrotask(()=>{e===nt&&ys()})}nt.push(t)}function sn(t){var e=P;if(e===null)return D.f|=Le,t;if((e.f&mr)===0){if((e.f&jt)===0)throw t;e.b.error(t)}else lt(t,e)}function lt(t,e){for(;e!==null;){if((e.f&jt)!==0)try{e.b.error(t);return}catch(r){t=r}e=e.parent}throw t}const It=new Set;let F=null,ce=null,pe=[],wr=null,nr=!1;class _e{committed=!1;current=new Map;previous=new Map;#e=new Set;#t=new Set;#n=0;#r=0;#l=null;#i=new Set;#s=new Set;skipped_effects=new Set;is_fork=!1;is_deferred(){return this.is_fork||this.#r>0}process(e){pe=[],this.apply();var r={parent:null,effect:null,effects:[],render_effects:[]};for(const n of e)this.#a(n,r);this.is_fork||this.#f(),this.is_deferred()?(this.#o(r.effects),this.#o(r.render_effects)):(F=null,Lr(r.render_effects),Lr(r.effects),this.#l?.resolve()),ce=null}#a(e,r){e.f^=X;for(var n=e.first;n!==null;){var i=n.f,s=(i&(Te|He))!==0,a=s&&(i&X)!==0,l=a||(i&ne)!==0||this.skipped_effects.has(n);if((n.f&jt)!==0&&n.b?.is_pending()&&(r={parent:r,effect:n,effects:[],render_effects:[]}),!l&&n.fn!==null){s?n.f^=X:(i&_r)!==0?r.effects.push(n):pt(n)&&((n.f&Ae)!==0&&this.#i.add(n),ft(n));var o=n.first;if(o!==null){n=o;continue}}var c=n.parent;for(n=n.next;n===null&&c!==null;)c===r.effect&&(this.#o(r.effects),this.#o(r.render_effects),r=r.parent),n=c.next,c=c.parent}}#o(e){for(const r of e)(r.f&te)!==0?this.#i.add(r):(r.f&ve)!==0&&this.#s.add(r),this.#c(r.deps),W(r,X)}#c(e){if(e!==null)for(const r of e)(r.f&H)===0||(r.f&qe)===0||(r.f^=qe,this.#c(r.deps))}capture(e,r){this.previous.has(e)||this.previous.set(e,r),(e.f&Le)===0&&(this.current.set(e,e.v),ce?.set(e,e.v))}activate(){F=this,this.apply()}deactivate(){F===this&&(F=null,ce=null)}flush(){if(this.activate(),pe.length>0){if(Ss(),F!==null&&F!==this)return}else this.#n===0&&this.process([]);this.deactivate()}discard(){for(const e of this.#t)e(this);this.#t.clear()}#f(){if(this.#r===0){for(const e of this.#e)e();this.#e.clear()}this.#n===0&&this.#u()}#u(){if(It.size>1){this.previous.clear();var e=ce,r=!0,n={parent:null,effect:null,effects:[],render_effects:[]};for(const s of It){if(s===this){r=!1;continue}const a=[];for(const[o,c]of this.current){if(s.current.has(o))if(r&&c!==s.current.get(o))s.current.set(o,c);else continue;a.push(o)}if(a.length===0)continue;const l=[...s.current.keys()].filter(o=>!this.current.has(o));if(l.length>0){var i=pe;pe=[];const o=new Set,c=new Map;for(const f of a)an(f,l,o,c);if(pe.length>0){F=s,s.apply();for(const f of pe)s.#a(f,n);s.deactivate()}pe=i}}F=null,ce=e}this.committed=!0,It.delete(this)}increment(e){this.#n+=1,e&&(this.#r+=1)}decrement(e){this.#n-=1,e&&(this.#r-=1),this.revive()}revive(){for(const e of this.#i)this.#s.delete(e),W(e,te),Xe(e);for(const e of this.#s)W(e,ve),Xe(e);this.flush()}oncommit(e){this.#e.add(e)}ondiscard(e){this.#t.add(e)}settled(){return(this.#l??=Kr()).promise}static ensure(){if(F===null){const e=F=new _e;It.add(F),_e.enqueue(()=>{F===e&&e.flush()})}return F}static enqueue(e){vt(e)}apply(){}}function Ss(){var t=Ye;nr=!0;var e=null;try{var r=0;for(Ft(!0);pe.length>0;){var n=_e.ensure();if(r++>1e3){var i,s;xs()}n.process(pe),Re.clear()}}finally{nr=!1,Ft(t),wr=null}}function xs(){try{es()}catch(t){lt(t,wr)}}let Se=null;function Lr(t){var e=t.length;if(e!==0){for(var r=0;r<e;){var n=t[r++];if((n.f&(Me|ne))===0&&pt(n)&&(Se=new Set,ft(n),n.deps===null&&n.first===null&&n.nodes===null&&(n.teardown===null&&n.ac===null?yn(n):n.fn=null),Se?.size>0)){Re.clear();for(const i of Se){if((i.f&(Me|ne))!==0)continue;const s=[i];let a=i.parent;for(;a!==null;)Se.has(a)&&(Se.delete(a),s.push(a)),a=a.parent;for(let l=s.length-1;l>=0;l--){const o=s[l];(o.f&(Me|ne))===0&&ft(o)}}Se.clear()}}Se=null}}function an(t,e,r,n){if(!r.has(t)&&(r.add(t),t.reactions!==null))for(const i of t.reactions){const s=i.f;(s&H)!==0?an(i,e,r,n):(s&(br|Ae))!==0&&(s&te)===0&&on(i,e,n)&&(W(i,te),Xe(i))}}function on(t,e,r){const n=r.get(t);if(n!==void 0)return n;if(t.deps!==null)for(const i of t.deps){if(e.includes(i))return!0;if((i.f&H)!==0&&on(i,e,r))return r.set(i,!0),!0}return r.set(t,!1),!1}function Xe(t){for(var e=wr=t;e.parent!==null;){e=e.parent;var r=e.f;if(nr&&e===P&&(r&Ae)!==0&&(r&Jr)===0)return;if((r&(He|Te))!==0){if((r&X)===0)return;e.f^=X}}pe.push(e)}function Es(t){let e=0,r=We(0),n;return()=>{xt()&&(p(r),Xt(()=>(e===0&&(n=L(()=>t(()=>yt(r)))),e+=1,()=>{vt(()=>{e-=1,e===0&&(n?.(),n=void 0,yt(r))})})))}}var Ms=je|dt|jt;function Cs(t,e,r){new ks(t,e,r)}class ks{parent;#e=!1;#t;#n=null;#r;#l;#i;#s=null;#a=null;#o=null;#c=null;#f=null;#u=0;#d=0;#v=!1;#h=null;#b=Es(()=>(this.#h=We(this.#u),()=>{this.#h=null}));constructor(e,r,n){this.#t=e,this.#r=r,this.#l=n,this.parent=P.b,this.#e=!!this.#r.pending,this.#i=Wt(()=>{P.b=this;{var i=this.#_();try{this.#s=le(()=>n(i))}catch(s){this.error(s)}this.#d>0?this.#g():this.#e=!1}return()=>{this.#f?.remove()}},Ms)}#w(){try{this.#s=le(()=>this.#l(this.#t))}catch(e){this.error(e)}this.#e=!1}#y(){const e=this.#r.pending;e&&(this.#a=le(()=>e(this.#t)),_e.enqueue(()=>{var r=this.#_();this.#s=this.#p(()=>(_e.ensure(),le(()=>this.#l(r)))),this.#d>0?this.#g():(Ge(this.#a,()=>{this.#a=null}),this.#e=!1)}))}#_(){var e=this.#t;return this.#e&&(this.#f=Oe(),this.#t.before(this.#f),e=this.#f),e}is_pending(){return this.#e||!!this.parent&&this.parent.is_pending()}has_pending_snippet(){return!!this.#r.pending}#p(e){var r=P,n=D,i=N;be(this.#i),Q(this.#i),ot(this.#i.ctx);try{return e()}catch(s){return sn(s),null}finally{be(r),Q(n),ot(i)}}#g(){const e=this.#r.pending;this.#s!==null&&(this.#c=document.createDocumentFragment(),this.#c.append(this.#f),En(this.#s,this.#c)),this.#a===null&&(this.#a=le(()=>e(this.#t)))}#m(e){if(!this.has_pending_snippet()){this.parent&&this.parent.#m(e);return}this.#d+=e,this.#d===0&&(this.#e=!1,this.#a&&Ge(this.#a,()=>{this.#a=null}),this.#c&&(this.#t.before(this.#c),this.#c=null))}update_pending_count(e){this.#m(e),this.#u+=e,this.#h&&ct(this.#h,this.#u)}get_effect_pending(){return this.#b(),p(this.#h)}error(e){var r=this.#r.onerror;let n=this.#r.failed;if(this.#v||!r&&!n)throw e;this.#s&&(ee(this.#s),this.#s=null),this.#a&&(ee(this.#a),this.#a=null),this.#o&&(ee(this.#o),this.#o=null);var i=!1,s=!1;const a=()=>{if(i){ms();return}i=!0,s&&is(),_e.ensure(),this.#u=0,this.#o!==null&&Ge(this.#o,()=>{this.#o=null}),this.#e=this.has_pending_snippet(),this.#s=this.#p(()=>(this.#v=!1,le(()=>this.#l(this.#t)))),this.#d>0?this.#g():this.#e=!1};var l=D;try{Q(null),s=!0,r?.(e,a),s=!1}catch(o){lt(o,this.#i&&this.#i.parent)}finally{Q(l)}n&&vt(()=>{this.#o=this.#p(()=>{_e.ensure(),this.#v=!0;try{return le(()=>{n(this.#t,()=>e,()=>a)})}catch(o){return lt(o,this.#i.parent),null}finally{this.#v=!1}})})}}function As(t,e,r,n){const i=kt()?qt:yr;if(r.length===0&&t.length===0){n(e.map(i));return}var s=F,a=P,l=Ts();function o(){Promise.all(r.map(c=>Ds(c))).then(c=>{l();try{n([...e.map(i),...c])}catch(f){(a.f&Me)===0&&lt(f,a)}s?.deactivate(),Nt()}).catch(c=>{lt(c,a)})}t.length>0?Promise.all(t).then(()=>{l();try{return o()}finally{s?.deactivate(),Nt()}}):o()}function Ts(){var t=P,e=D,r=N,n=F;return function(s=!0){be(t),Q(e),ot(r),s&&n?.activate()}}function Nt(){be(null),Q(null),ot(null)}function qt(t){var e=H|te,r=D!==null&&(D.f&H)!==0?D:null;return P!==null&&(P.f|=dt),{ctx:N,deps:null,effects:null,equals:tn,f:e,fn:t,reactions:null,rv:0,v:K,wv:0,parent:r??P,ac:null}}function Ds(t,e){let r=P;r===null&&Kn();var n=r.b,i=void 0,s=We(K),a=!D,l=new Map;return Bs(()=>{var o=Kr();i=o.promise;try{Promise.resolve(t()).then(o.resolve,o.reject).then(()=>{c===F&&c.committed&&c.deactivate(),Nt()})}catch(u){o.reject(u),Nt()}var c=F;if(a){var f=!n.is_pending();n.update_pending_count(1),c.increment(f),l.get(c)?.reject(rt),l.delete(c),l.set(c,o)}const h=(u,d=void 0)=>{if(c.activate(),d)d!==rt&&(s.f|=Le,ct(s,d));else{(s.f&Le)!==0&&(s.f^=Le),ct(s,u);for(const[g,w]of l){if(l.delete(g),g===c)break;w.reject(rt)}}a&&(n.update_pending_count(-1),c.decrement(f))};o.promise.then(h,u=>h(null,u||"unknown"))}),Er(()=>{for(const o of l.values())o.reject(rt)}),new Promise(o=>{function c(f){function h(){f===i?o(s):c(i)}f.then(h,h)}c(i)})}function yr(t){const e=qt(t);return e.equals=nn,e}function ln(t){var e=t.effects;if(e!==null){t.effects=null;for(var r=0;r<e.length;r+=1)ee(e[r])}}function Is(t){for(var e=t.parent;e!==null;){if((e.f&H)===0)return(e.f&Me)===0?e:null;e=e.parent}return null}function Sr(t){var e,r=P;be(Is(t));try{t.f&=~qe,ln(t),e=An(t)}finally{be(r)}return e}function cn(t){var e=Sr(t);if(t.equals(e)||(F?.is_fork||(t.v=e),t.wv=Cn()),!Je)if(ce!==null)(xt()||F?.is_fork)&&ce.set(t,e);else{var r=(t.f&he)===0?ve:X;W(t,r)}}let sr=new Set;const Re=new Map;let fn=!1;function We(t,e){var r={f:0,v:t,reactions:null,equals:tn,rv:0,wv:0};return r}function ye(t,e){const r=We(t);return Gs(r),r}function fe(t,e=!1,r=!0){const n=We(t);return e||(n.equals=nn),ht&&r&&N!==null&&N.l!==null&&(N.l.s??=[]).push(n),n}function z(t,e,r=!1){D!==null&&(!me||(D.f&$r)!==0)&&kt()&&(D.f&(H|Ae|br|$r))!==0&&!Ce?.includes(t)&&ss();let n=r?st(e):e;return ct(t,n)}function ct(t,e){if(!t.equals(e)){var r=t.v;Je?Re.set(t,e):Re.set(t,r),t.v=e;var n=_e.ensure();n.capture(t,r),(t.f&H)!==0&&((t.f&te)!==0&&Sr(t),W(t,(t.f&he)!==0?X:ve)),t.wv=Cn(),un(t,te),kt()&&P!==null&&(P.f&X)!==0&&(P.f&(Te|He))===0&&(oe===null?Ys([t]):oe.push(t)),!n.is_fork&&sr.size>0&&!fn&&Ps()}return e}function Ps(){fn=!1;var t=Ye;Ft(!0);const e=Array.from(sr);try{for(const r of e)(r.f&X)!==0&&W(r,ve),pt(r)&&ft(r)}finally{Ft(t)}sr.clear()}function yt(t){z(t,t.v+1)}function un(t,e){var r=t.reactions;if(r!==null)for(var n=kt(),i=r.length,s=0;s<i;s++){var a=r[s],l=a.f;if(!(!n&&a===P)){var o=(l&te)===0;if(o&&W(a,e),(l&H)!==0){var c=a;ce?.delete(c),(l&qe)===0&&(l&he&&(a.f|=qe),un(c,ve))}else o&&((l&Ae)!==0&&Se!==null&&Se.add(a),Xe(a))}}}function st(t){if(typeof t!="object"||t===null||ze in t)return t;const e=gr(t);if(e!==jn&&e!==qn)return t;var r=new Map,n=Wr(t),i=ye(0),s=Ue,a=l=>{if(Ue===s)return l();var o=D,c=Ue;Q(null),Nr(s);var f=l();return Q(o),Nr(c),f};return n&&r.set("length",ye(t.length)),new Proxy(t,{defineProperty(l,o,c){(!("value"in c)||c.configurable===!1||c.enumerable===!1||c.writable===!1)&&rs();var f=r.get(o);return f===void 0?f=a(()=>{var h=ye(c.value);return r.set(o,h),h}):z(f,c.value,!0),!0},deleteProperty(l,o){var c=r.get(o);if(c===void 0){if(o in l){const f=a(()=>ye(K));r.set(o,f),yt(i)}}else z(c,K),yt(i);return!0},get(l,o,c){if(o===ze)return t;var f=r.get(o),h=o in l;if(f===void 0&&(!h||it(l,o)?.writable)&&(f=a(()=>{var d=st(h?l[o]:K),g=ye(d);return g}),r.set(o,f)),f!==void 0){var u=p(f);return u===K?void 0:u}return Reflect.get(l,o,c)},getOwnPropertyDescriptor(l,o){var c=Reflect.getOwnPropertyDescriptor(l,o);if(c&&"value"in c){var f=r.get(o);f&&(c.value=p(f))}else if(c===void 0){var h=r.get(o),u=h?.v;if(h!==void 0&&u!==K)return{enumerable:!0,configurable:!0,value:u,writable:!0}}return c},has(l,o){if(o===ze)return!0;var c=r.get(o),f=c!==void 0&&c.v!==K||Reflect.has(l,o);if(c!==void 0||P!==null&&(!f||it(l,o)?.writable)){c===void 0&&(c=a(()=>{var u=f?st(l[o]):K,d=ye(u);return d}),r.set(o,c));var h=p(c);if(h===K)return!1}return f},set(l,o,c,f){var h=r.get(o),u=o in l;if(n&&o==="length")for(var d=c;d<h.v;d+=1){var g=r.get(d+"");g!==void 0?z(g,K):d in l&&(g=a(()=>ye(K)),r.set(d+"",g))}if(h===void 0)(!u||it(l,o)?.writable)&&(h=a(()=>ye(void 0)),z(h,st(c)),r.set(o,h));else{u=h.v!==K;var w=a(()=>st(c));z(h,w)}var v=Reflect.getOwnPropertyDescriptor(l,o);if(v?.set&&v.set.call(f,c),!u){if(n&&typeof o=="string"){var _=r.get("length"),k=Number(o);Number.isInteger(k)&&k>=_.v&&z(_,k+1)}yt(i)}return!0},ownKeys(l){p(i);var o=Reflect.ownKeys(l).filter(h=>{var u=r.get(h);return u===void 0||u.v!==K});for(var[c,f]of r)f.v!==K&&!(c in l)&&o.push(c);return o},setPrototypeOf(){ns()}})}var Rr,dn,hn,vn;function $s(){if(Rr===void 0){Rr=window,dn=/Firefox/.test(navigator.userAgent);var t=Element.prototype,e=Node.prototype,r=Text.prototype;hn=it(e,"firstChild").get,vn=it(e,"nextSibling").get,Pr(t)&&(t.__click=void 0,t.__className=void 0,t.__attributes=null,t.__style=void 0,t.__e=void 0),Pr(r)&&(r.__t=void 0)}}function Oe(t=""){return document.createTextNode(t)}function $e(t){return hn.call(t)}function At(t){return vn.call(t)}function b(t,e){return $e(t)}function at(t,e=!1){{var r=$e(t);return r instanceof Comment&&r.data===""?At(r):r}}function M(t,e=1,r=!1){let n=t;for(;e--;)n=At(n);return n}function Ls(t){t.textContent=""}function pn(){return!1}function xr(t){var e=D,r=P;Q(null),be(null);try{return t()}finally{Q(e),be(r)}}function gn(t){P===null&&(D===null&&Qn(),Zn()),Je&&Jn()}function Rs(t,e){var r=e.last;r===null?e.last=e.first=t:(r.next=t,t.prev=r,e.last=t)}function we(t,e,r){var n=P;n!==null&&(n.f&ne)!==0&&(t|=ne);var i={ctx:N,deps:null,nodes:null,f:t|te|he,first:null,fn:e,last:null,next:null,parent:n,b:n&&n.b,prev:null,teardown:null,wv:0,ac:null};if(r)try{ft(i),i.f|=mr}catch(l){throw ee(i),l}else e!==null&&Xe(i);var s=i;if(r&&s.deps===null&&s.teardown===null&&s.nodes===null&&s.first===s.last&&(s.f&dt)===0&&(s=s.first,(t&Ae)!==0&&(t&je)!==0&&s!==null&&(s.f|=je)),s!==null&&(s.parent=n,n!==null&&Rs(s,n),D!==null&&(D.f&H)!==0&&(t&He)===0)){var a=D;(a.effects??=[]).push(s)}return i}function xt(){return D!==null&&!me}function Er(t){const e=we(Ut,null,!1);return W(e,X),e.teardown=t,e}function ir(t){gn();var e=P.f,r=!D&&(e&Te)!==0&&(e&mr)===0;if(r){var n=N;(n.e??=[]).push(t)}else return _n(t)}function _n(t){return we(_r|Zr,t,!1)}function Os(t){return gn(),we(Ut|Zr,t,!0)}function Ns(t){_e.ensure();const e=we(He|dt,t,!0);return(r={})=>new Promise(n=>{r.outro?Ge(e,()=>{ee(e),n(void 0)}):(ee(e),n(void 0))})}function Fs(t){return we(_r,t,!1)}function Pe(t,e){var r=N,n={effect:null,ran:!1,deps:t};r.l.$.push(n),n.effect=Xt(()=>{t(),!n.ran&&(n.ran=!0,L(e))})}function Mr(){var t=N;Xt(()=>{for(var e of t.l.$){e.deps();var r=e.effect;(r.f&X)!==0&&W(r,ve),pt(r)&&ft(r),e.ran=!1}})}function Bs(t){return we(br|dt,t,!0)}function Xt(t,e=0){return we(Ut|e,t,!0)}function j(t,e=[],r=[],n=[]){As(n,e,r,i=>{we(Ut,()=>t(...i.map(p)),!0)})}function Wt(t,e=0){var r=we(Ae|e,t,!0);return r}function le(t){return we(Te|dt,t,!0)}function mn(t){var e=t.teardown;if(e!==null){const r=Je,n=D;Or(!0),Q(null);try{e.call(null)}finally{Or(r),Q(n)}}}function bn(t,e=!1){var r=t.first;for(t.first=t.last=null;r!==null;){const i=r.ac;i!==null&&xr(()=>{i.abort(rt)});var n=r.next;(r.f&He)!==0?r.parent=null:ee(r,e),r=n}}function zs(t){for(var e=t.first;e!==null;){var r=e.next;(e.f&Te)===0&&ee(e),e=r}}function ee(t,e=!0){var r=!1;(e||(t.f&Jr)!==0)&&t.nodes!==null&&t.nodes.end!==null&&(wn(t.nodes.start,t.nodes.end),r=!0),bn(t,e&&!r),Bt(t,0),W(t,Me);var n=t.nodes&&t.nodes.t;if(n!==null)for(const s of n)s.stop();mn(t);var i=t.parent;i!==null&&i.first!==null&&yn(t),t.next=t.prev=t.teardown=t.ctx=t.deps=t.fn=t.nodes=t.ac=null}function wn(t,e){for(;t!==null;){var r=t===e?null:At(t);t.remove(),t=r}}function yn(t){var e=t.parent,r=t.prev,n=t.next;r!==null&&(r.next=n),n!==null&&(n.prev=r),e!==null&&(e.first===t&&(e.first=n),e.last===t&&(e.last=r))}function Ge(t,e,r=!0){var n=[];Sn(t,n,!0);var i=()=>{r&&ee(t),e&&e()},s=n.length;if(s>0){var a=()=>--s||i();for(var l of n)l.out(a)}else i()}function Sn(t,e,r){if((t.f&ne)===0){t.f^=ne;var n=t.nodes&&t.nodes.t;if(n!==null)for(const l of n)(l.is_global||r)&&e.push(l);for(var i=t.first;i!==null;){var s=i.next,a=(i.f&je)!==0||(i.f&Te)!==0&&(t.f&Ae)!==0;Sn(i,e,a?r:!1),i=s}}}function Cr(t){xn(t,!0)}function xn(t,e){if((t.f&ne)!==0){t.f^=ne,(t.f&X)===0&&(W(t,te),Xe(t));for(var r=t.first;r!==null;){var n=r.next,i=(r.f&je)!==0||(r.f&Te)!==0;xn(r,i?e:!1),r=n}var s=t.nodes&&t.nodes.t;if(s!==null)for(const a of s)(a.is_global||e)&&a.in()}}function En(t,e){if(t.nodes)for(var r=t.nodes.start,n=t.nodes.end;r!==null;){var i=r===n?null:At(r);e.append(r),r=i}}let Ye=!1;function Ft(t){Ye=t}let Je=!1;function Or(t){Je=t}let D=null,me=!1;function Q(t){D=t}let P=null;function be(t){P=t}let Ce=null;function Gs(t){D!==null&&(Ce===null?Ce=[t]:Ce.push(t))}let Z=null,re=0,oe=null;function Ys(t){oe=t}let Mn=1,Et=0,Ue=Et;function Nr(t){Ue=t}function Cn(){return++Mn}function pt(t){var e=t.f;if((e&te)!==0)return!0;if(e&H&&(t.f&=~qe),(e&ve)!==0){var r=t.deps;if(r!==null)for(var n=r.length,i=0;i<n;i++){var s=r[i];if(pt(s)&&cn(s),s.wv>t.wv)return!0}(e&he)!==0&&ce===null&&W(t,X)}return!1}function kn(t,e,r=!0){var n=t.reactions;if(n!==null&&!Ce?.includes(t))for(var i=0;i<n.length;i++){var s=n[i];(s.f&H)!==0?kn(s,e,!1):e===s&&(r?W(s,te):(s.f&X)!==0&&W(s,ve),Xe(s))}}function An(t){var e=Z,r=re,n=oe,i=D,s=Ce,a=N,l=me,o=Ue,c=t.f;Z=null,re=0,oe=null,D=(c&(Te|He))===0?t:null,Ce=null,ot(t.ctx),me=!1,Ue=++Et,t.ac!==null&&(xr(()=>{t.ac.abort(rt)}),t.ac=null);try{t.f|=rr;var f=t.fn,h=f(),u=t.deps;if(Z!==null){var d;if(Bt(t,re),u!==null&&re>0)for(u.length=re+Z.length,d=0;d<Z.length;d++)u[re+d]=Z[d];else t.deps=u=Z;if(xt()&&(t.f&he)!==0)for(d=re;d<u.length;d++)(u[d].reactions??=[]).push(t)}else u!==null&&re<u.length&&(Bt(t,re),u.length=re);if(kt()&&oe!==null&&!me&&u!==null&&(t.f&(H|ve|te))===0)for(d=0;d<oe.length;d++)kn(oe[d],t);return i!==null&&i!==t&&(Et++,oe!==null&&(n===null?n=oe:n.push(...oe))),(t.f&Le)!==0&&(t.f^=Le),h}catch(g){return sn(g)}finally{t.f^=rr,Z=e,re=r,oe=n,D=i,Ce=s,ot(a),me=l,Ue=o}}function Us(t,e){let r=e.reactions;if(r!==null){var n=Un.call(r,t);if(n!==-1){var i=r.length-1;i===0?r=e.reactions=null:(r[n]=r[i],r.pop())}}r===null&&(e.f&H)!==0&&(Z===null||!Z.includes(e))&&(W(e,ve),(e.f&he)!==0&&(e.f^=he,e.f&=~qe),ln(e),Bt(e,0))}function Bt(t,e){var r=t.deps;if(r!==null)for(var n=e;n<r.length;n++)Us(t,r[n])}function ft(t){var e=t.f;if((e&Me)===0){W(t,X);var r=P,n=Ye;P=t,Ye=!0;try{(e&(Ae|Wn))!==0?zs(t):bn(t),mn(t);var i=An(t);t.teardown=typeof i=="function"?i:null,t.wv=Mn;var s;tr&&bs&&(t.f&te)!==0&&t.deps}finally{Ye=n,P=r}}}function p(t){var e=t.f,r=(e&H)!==0;if(D!==null&&!me){var n=P!==null&&(P.f&Me)!==0;if(!n&&!Ce?.includes(t)){var i=D.deps;if((D.f&rr)!==0)t.rv<Et&&(t.rv=Et,Z===null&&i!==null&&i[re]===t?re++:Z===null?Z=[t]:Z.includes(t)||Z.push(t));else{(D.deps??=[]).push(t);var s=t.reactions;s===null?t.reactions=[D]:s.includes(D)||s.push(D)}}}if(Je){if(Re.has(t))return Re.get(t);if(r){var a=t,l=a.v;return((a.f&X)===0&&a.reactions!==null||Dn(a))&&(l=Sr(a)),Re.set(a,l),l}}else r&&(!ce?.has(t)||F?.is_fork&&!xt())&&(a=t,pt(a)&&cn(a),Ye&&xt()&&(a.f&he)===0&&Tn(a));if(ce?.has(t))return ce.get(t);if((t.f&Le)!==0)throw t.v;return t.v}function Tn(t){if(t.deps!==null){t.f^=he;for(const e of t.deps)(e.reactions??=[]).push(t),(e.f&H)!==0&&(e.f&he)===0&&Tn(e)}}function Dn(t){if(t.v===K)return!0;if(t.deps===null)return!1;for(const e of t.deps)if(Re.has(e)||(e.f&H)!==0&&Dn(e))return!0;return!1}function L(t){var e=me;try{return me=!0,t()}finally{me=e}}const js=-7169;function W(t,e){t.f=t.f&js|e}function qs(t){if(!(typeof t!="object"||!t||t instanceof EventTarget)){if(ze in t)ar(t);else if(!Array.isArray(t))for(let e in t){const r=t[e];typeof r=="object"&&r&&ze in r&&ar(r)}}}function ar(t,e=new Set){if(typeof t=="object"&&t!==null&&!(t instanceof EventTarget)&&!e.has(t)){e.add(t),t instanceof Date&&t.getTime();for(let n in t)try{ar(t[n],e)}catch{}const r=gr(t);if(r!==Object.prototype&&r!==Array.prototype&&r!==Map.prototype&&r!==Set.prototype&&r!==Date.prototype){const n=Vr(r);for(let i in n){const s=n[i].get;if(s)try{s.call(t)}catch{}}}}}const Xs=["touchstart","touchmove"];function Ws(t){return Xs.includes(t)}const In=new Set,or=new Set;function Hs(t,e,r,n={}){function i(s){if(n.capture||bt.call(e,s),!s.cancelBubble)return xr(()=>r?.call(this,s))}return t.startsWith("pointer")||t.startsWith("touch")||t==="wheel"?vt(()=>{e.addEventListener(t,i,n)}):e.addEventListener(t,i,n),i}function Vs(t,e,r,n,i){var s={capture:n,passive:i},a=Hs(t,e,r,s);(e===document.body||e===window||e===document||e instanceof HTMLMediaElement)&&Er(()=>{e.removeEventListener(t,a,s)})}function Ht(t){for(var e=0;e<t.length;e++)In.add(t[e]);for(var r of or)r(t)}let Fr=null;function bt(t){var e=this,r=e.ownerDocument,n=t.type,i=t.composedPath?.()||[],s=i[0]||t.target;Fr=t;var a=0,l=Fr===t&&t.__root;if(l){var o=i.indexOf(l);if(o!==-1&&(e===document||e===window)){t.__root=e;return}var c=i.indexOf(e);if(c===-1)return;o<=c&&(a=o)}if(s=i[a]||t.target,s!==e){Hr(t,"currentTarget",{configurable:!0,get(){return s||r}});var f=D,h=P;Q(null),be(null);try{for(var u,d=[];s!==null;){var g=s.assignedSlot||s.parentNode||s.host||null;try{var w=s["__"+n];w!=null&&(!s.disabled||t.target===s)&&w.call(s,t)}catch(v){u?d.push(v):u=v}if(t.cancelBubble||g===e||g===null)break;s=g}if(u){for(let v of d)queueMicrotask(()=>{throw v});throw u}}finally{t.__root=e,delete t.currentTarget,Q(f),be(h)}}}function Pn(t){var e=document.createElement("template");return e.innerHTML=t.replaceAll("<!>","<!---->"),e.content}function zt(t,e){var r=P;r.nodes===null&&(r.nodes={start:t,end:e,a:null,t:null})}function I(t,e){var r=(e&ps)!==0,n=(e&gs)!==0,i,s=!t.startsWith("<!>");return()=>{i===void 0&&(i=Pn(s?t:"<!>"+t),r||(i=$e(i)));var a=n||dn?document.importNode(i,!0):i.cloneNode(!0);if(r){var l=$e(a),o=a.lastChild;zt(l,o)}else zt(a,a);return a}}function Br(){var t=document.createDocumentFragment(),e=document.createComment(""),r=Oe();return t.append(e,r),zt(e,r),t}function T(t,e){t!==null&&t.before(e)}function G(t,e){var r=e==null?"":typeof e=="object"?e+"":e;r!==(t.__t??=t.nodeValue)&&(t.__t=r,t.nodeValue=r+"")}function Ks(t,e){return Js(t,e)}const et=new Map;function Js(t,{target:e,anchor:r,props:n={},events:i,context:s,intro:a=!0}){$s();var l=new Set,o=h=>{for(var u=0;u<h.length;u++){var d=h[u];if(!l.has(d)){l.add(d);var g=Ws(d);e.addEventListener(d,bt,{passive:g});var w=et.get(d);w===void 0?(document.addEventListener(d,bt,{passive:g}),et.set(d,1)):et.set(d,w+1)}}};o(Yt(In)),or.add(o);var c=void 0,f=Ns(()=>{var h=r??e.appendChild(Oe());return Cs(h,{pending:()=>{}},u=>{if(s){Ve({});var d=N;d.c=s}i&&(n.$$events=i),c=t(u,n)||{},s&&Ke()}),()=>{for(var u of l){e.removeEventListener(u,bt);var d=et.get(u);--d===0?(document.removeEventListener(u,bt),et.delete(u)):et.set(u,d)}or.delete(o),h!==r&&h.parentNode?.removeChild(h)}});return Zs.set(c,f),c}let Zs=new WeakMap;class $n{anchor;#e=new Map;#t=new Map;#n=new Map;#r=new Set;#l=!0;constructor(e,r=!0){this.anchor=e,this.#l=r}#i=()=>{var e=F;if(this.#e.has(e)){var r=this.#e.get(e),n=this.#t.get(r);if(n)Cr(n),this.#r.delete(r);else{var i=this.#n.get(r);i&&(this.#t.set(r,i.effect),this.#n.delete(r),i.fragment.lastChild.remove(),this.anchor.before(i.fragment),n=i.effect)}for(const[s,a]of this.#e){if(this.#e.delete(s),s===e)break;const l=this.#n.get(a);l&&(ee(l.effect),this.#n.delete(a))}for(const[s,a]of this.#t){if(s===r||this.#r.has(s))continue;const l=()=>{if(Array.from(this.#e.values()).includes(s)){var c=document.createDocumentFragment();En(a,c),c.append(Oe()),this.#n.set(s,{effect:a,fragment:c})}else ee(a);this.#r.delete(s),this.#t.delete(s)};this.#l||!n?(this.#r.add(s),Ge(a,l,!1)):l()}}};#s=e=>{this.#e.delete(e);const r=Array.from(this.#e.values());for(const[n,i]of this.#n)r.includes(n)||(ee(i.effect),this.#n.delete(n))};ensure(e,r){var n=F,i=pn();if(r&&!this.#t.has(e)&&!this.#n.has(e))if(i){var s=document.createDocumentFragment(),a=Oe();s.append(a),this.#n.set(e,{effect:le(()=>r(a)),fragment:s})}else this.#t.set(e,le(()=>r(this.anchor)));if(this.#e.set(n,e),i){for(const[l,o]of this.#t)l===e?n.skipped_effects.delete(o):n.skipped_effects.add(o);for(const[l,o]of this.#n)l===e?n.skipped_effects.delete(o.effect):n.skipped_effects.add(o.effect);n.oncommit(this.#i),n.ondiscard(this.#s)}else this.#i()}}function ue(t,e,r=!1){var n=new $n(t),i=r?je:0;function s(a,l){n.ensure(a,l)}Wt(()=>{var a=!1;e((l,o=!0)=>{a=!0,s(o,l)}),a||s(!1,null)},i)}function Gt(t,e){return e}function Qs(t,e,r){for(var n=[],i=e.length,s,a=e.length,l=0;l<i;l++){let h=e[l];Ge(h,()=>{if(s){if(s.pending.delete(h),s.done.add(h),s.pending.size===0){var u=t.outrogroups;lr(Yt(s.done)),u.delete(s),u.size===0&&(t.outrogroups=null)}}else a-=1},!1)}if(a===0){var o=n.length===0&&r!==null;if(o){var c=r,f=c.parentNode;Ls(f),f.append(c),t.items.clear()}lr(e,!o)}else s={pending:new Set(e),done:new Set},(t.outrogroups??=new Set).add(s)}function lr(t,e=!0){for(var r=0;r<t.length;r++)ee(t[r],e)}var zr;function Mt(t,e,r,n,i,s=null){var a=t,l=new Map,o=(e&en)!==0;if(o){var c=t;a=c.appendChild(Oe())}var f=null,h=yr(()=>{var _=r();return Wr(_)?_:_==null?[]:Yt(_)}),u,d=!0;function g(){v.fallback=f,ei(v,u,a,e,n),f!==null&&(u.length===0?(f.f&xe)===0?Cr(f):(f.f^=xe,wt(f,null,a)):Ge(f,()=>{f=null}))}var w=Wt(()=>{u=p(h);for(var _=u.length,k=new Set,x=F,C=pn(),y=0;y<_;y+=1){var m=u[y],S=n(m,y),E=d?null:l.get(S);E?(E.v&&ct(E.v,m),E.i&&ct(E.i,y),C&&x.skipped_effects.delete(E.e)):(E=ti(l,d?a:zr??=Oe(),m,S,y,i,e,r),d||(E.e.f|=xe),l.set(S,E)),k.add(S)}if(_===0&&s&&!f&&(d?f=le(()=>s(a)):(f=le(()=>s(zr??=Oe())),f.f|=xe)),!d)if(C){for(const[$,A]of l)k.has($)||x.skipped_effects.add(A.e);x.oncommit(g),x.ondiscard(()=>{})}else g();p(h)}),v={effect:w,items:l,outrogroups:null,fallback:f};d=!1}function ei(t,e,r,n,i){var s=(n&ls)!==0,a=e.length,l=t.items,o=t.effect.first,c,f=null,h,u=[],d=[],g,w,v,_;if(s)for(_=0;_<a;_+=1)g=e[_],w=i(g,_),v=l.get(w).e,(v.f&xe)===0&&(v.nodes?.a?.measure(),(h??=new Set).add(v));for(_=0;_<a;_+=1){if(g=e[_],w=i(g,_),v=l.get(w).e,t.outrogroups!==null)for(const A of t.outrogroups)A.pending.delete(v),A.done.delete(v);if((v.f&xe)!==0)if(v.f^=xe,v===o)wt(v,null,r);else{var k=f?f.next:o;v===t.effect.last&&(t.effect.last=v.prev),v.prev&&(v.prev.next=v.next),v.next&&(v.next.prev=v.prev),Ie(t,f,v),Ie(t,v,k),wt(v,k,r),f=v,u=[],d=[],o=f.next;continue}if((v.f&ne)!==0&&(Cr(v),s&&(v.nodes?.a?.unfix(),(h??=new Set).delete(v))),v!==o){if(c!==void 0&&c.has(v)){if(u.length<d.length){var x=d[0],C;f=x.prev;var y=u[0],m=u[u.length-1];for(C=0;C<u.length;C+=1)wt(u[C],x,r);for(C=0;C<d.length;C+=1)c.delete(d[C]);Ie(t,y.prev,m.next),Ie(t,f,y),Ie(t,m,x),o=x,f=m,_-=1,u=[],d=[]}else c.delete(v),wt(v,o,r),Ie(t,v.prev,v.next),Ie(t,v,f===null?t.effect.first:f.next),Ie(t,f,v),f=v;continue}for(u=[],d=[];o!==null&&o!==v;)(c??=new Set).add(o),d.push(o),o=o.next;if(o===null)continue}(v.f&xe)===0&&u.push(v),f=v,o=v.next}if(t.outrogroups!==null){for(const A of t.outrogroups)A.pending.size===0&&(lr(Yt(A.done)),t.outrogroups?.delete(A));t.outrogroups.size===0&&(t.outrogroups=null)}if(o!==null||c!==void 0){var S=[];if(c!==void 0)for(v of c)(v.f&ne)===0&&S.push(v);for(;o!==null;)(o.f&ne)===0&&o!==t.fallback&&S.push(o),o=o.next;var E=S.length;if(E>0){var $=(n&en)!==0&&a===0?r:null;if(s){for(_=0;_<E;_+=1)S[_].nodes?.a?.measure();for(_=0;_<E;_+=1)S[_].nodes?.a?.fix()}Qs(t,S,$)}}s&&vt(()=>{if(h!==void 0)for(v of h)v.nodes?.a?.apply()})}function ti(t,e,r,n,i,s,a,l){var o=(a&as)!==0?(a&cs)===0?fe(r,!1,!1):We(r):null,c=(a&os)!==0?We(i):null;return{v:o,i:c,e:le(()=>(s(e,o??r,c??i,l),()=>{t.delete(n)}))}}function wt(t,e,r){if(t.nodes)for(var n=t.nodes.start,i=t.nodes.end,s=e&&(e.f&xe)===0?e.nodes.start:r;n!==null;){var a=At(n);if(s.before(n),n===i)return;n=a}}function Ie(t,e,r){e===null?t.effect.first=r:e.next=r,r===null?t.effect.last=e:r.prev=e}function ri(t,e,r=!1,n=!1,i=!1){var s=t,a="";j(()=>{var l=P;if(a!==(a=e()??"")&&(l.nodes!==null&&(wn(l.nodes.start,l.nodes.end),l.nodes=null),a!=="")){var o=a+"";r?o=`<svg>${o}</svg>`:n&&(o=`<math>${o}</math>`);var c=Pn(o);if((r||n)&&(c=$e(c)),zt($e(c),c.lastChild),r||n)for(;$e(c);)s.before($e(c));else s.before(c)}})}function ni(t,e,...r){var n=new $n(t);Wt(()=>{const i=e()??null;n.ensure(i,i&&(s=>i(s,...r)))},je)}function Ln(t){var e,r,n="";if(typeof t=="string"||typeof t=="number")n+=t;else if(typeof t=="object")if(Array.isArray(t)){var i=t.length;for(e=0;e<i;e++)t[e]&&(r=Ln(t[e]))&&(n&&(n+=" "),n+=r)}else for(r in t)t[r]&&(n&&(n+=" "),n+=r);return n}function si(){for(var t,e,r=0,n="",i=arguments.length;r<i;r++)(t=arguments[r])&&(e=Ln(t))&&(n&&(n+=" "),n+=e);return n}function ii(t){return typeof t=="object"?si(t):t??""}const Gr=[...` 	
\r\f \v\uFEFF`];function ai(t,e,r){var n=t==null?"":""+t;if(e&&(n=n?n+" "+e:e),r){for(var i in r)if(r[i])n=n?n+" "+i:i;else if(n.length)for(var s=i.length,a=0;(a=n.indexOf(i,a))>=0;){var l=a+s;(a===0||Gr.includes(n[a-1]))&&(l===n.length||Gr.includes(n[l]))?n=(a===0?"":n.substring(0,a))+n.substring(l+1):a=l}}return n===""?null:n}function oi(t,e){return t==null?null:String(t)}function de(t,e,r,n,i,s){var a=t.__className;if(a!==r||a===void 0){var l=ai(r,n,s);l==null?t.removeAttribute("class"):t.className=l,t.__className=r}else if(s&&i!==s)for(var o in s){var c=!!s[o];(i==null||c!==!!i[o])&&t.classList.toggle(o,c)}return s}function Rn(t,e,r,n){var i=t.__style;if(i!==e){var s=oi(e);s==null?t.removeAttribute("style"):t.style.cssText=s,t.__style=e}return n}const li=Symbol("is custom element"),ci=Symbol("is html");function fi(t,e){var r=On(t);r.value===(r.value=e??void 0)||t.value===e&&(e!==0||t.nodeName!=="PROGRESS")||(t.value=e??"")}function ke(t,e,r,n){var i=On(t);i[e]!==(i[e]=r)&&(e==="loading"&&(t[Vn]=r),r==null?t.removeAttribute(e):typeof r!="string"&&ui(t).includes(e)?t[e]=r:t.setAttribute(e,r))}function On(t){return t.__attributes??={[li]:t.nodeName.includes("-"),[ci]:t.namespaceURI===_s}}var Yr=new Map;function ui(t){var e=t.getAttribute("is")||t.nodeName,r=Yr.get(e);if(r)return r;Yr.set(e,r=[]);for(var n,i=t,s=Element.prototype;s!==i;){n=Vr(i);for(var a in n)n[a].set&&r.push(a);i=gr(i)}return r}function Ur(t,e){return t===e||t?.[ze]===e}function cr(t={},e,r,n){return Fs(()=>{var i,s;return Xt(()=>{i=s,s=[],L(()=>{t!==r(...s)&&(e(t,...s),i&&Ur(r(...i),t)&&e(null,...i))})}),()=>{vt(()=>{s&&Ur(r(...s),t)&&e(null,...s)})}}),t}function Vt(t=!1){const e=N,r=e.l.u;if(!r)return;let n=()=>qs(e.s);if(t){let i=0,s={};const a=qt(()=>{let l=!1;const o=e.s;for(const c in o)o[c]!==s[c]&&(s[c]=o[c],l=!0);return l&&i++,i});n=()=>p(a)}r.b.length&&Os(()=>{jr(e,n),Ot(r.b)}),ir(()=>{const i=L(()=>r.m.map(Xn));return()=>{for(const s of i)typeof s=="function"&&s()}}),r.a.length&&ir(()=>{jr(e,n),Ot(r.a)})}function jr(t,e){if(t.l.s)for(const r of t.l.s)p(r);e()}function kr(t,e,r){if(t==null)return e(void 0),r&&r(void 0),Ee;const n=L(()=>t.subscribe(e,r));return n.unsubscribe?()=>n.unsubscribe():n}const tt=[];function di(t,e){return{subscribe:De(t,e).subscribe}}function De(t,e=Ee){let r=null;const n=new Set;function i(l){if(rn(t,l)&&(t=l,r)){const o=!tt.length;for(const c of n)c[1](),tt.push(c,t);if(o){for(let c=0;c<tt.length;c+=2)tt[c][0](tt[c+1]);tt.length=0}}}function s(l){i(l(t))}function a(l,o=Ee){const c=[l,o];return n.add(c),n.size===1&&(r=e(i,s)||Ee),l(t),()=>{n.delete(c),n.size===0&&r&&(r(),r=null)}}return{set:i,update:s,subscribe:a}}function Ar(t,e,r){const n=!Array.isArray(t),i=n?[t]:t;if(!i.every(Boolean))throw new Error("derived() expects stores as input, got a falsy value");const s=e.length<2;return di(r,(a,l)=>{let o=!1;const c=[];let f=0,h=Ee;const u=()=>{if(f)return;h();const g=e(n?c[0]:c,a,l);s?a(g):h=typeof g=="function"?g:Ee},d=i.map((g,w)=>kr(g,v=>{c[w]=v,f&=~(1<<w),o&&u()},()=>{f|=1<<w}));return o=!0,u(),function(){Ot(d),h(),o=!1}})}function Tt(t){let e;return kr(t,r=>e=r)(),e}let Pt=!1,fr=Symbol();function q(t,e,r){const n=r[e]??={store:null,source:fe(void 0),unsubscribe:Ee};if(n.store!==t&&!(fr in r))if(n.unsubscribe(),n.store=t??null,t==null)n.source.v=void 0,n.unsubscribe=Ee;else{var i=!0;n.unsubscribe=kr(t,s=>{i?n.source.v=s:z(n.source,s)}),i=!1}return t&&fr in r?Tt(t):p(n.source)}function Dt(){const t={};function e(){Er(()=>{for(var r in t)t[r].unsubscribe();Hr(t,fr,{enumerable:!1,value:!0})})}return[t,e]}function hi(t){var e=Pt;try{return Pt=!1,[t(),Pt]}finally{Pt=e}}function ge(t,e,r,n){var i=!ht||(r&us)!==0,s=(r&hs)!==0,a=(r&vs)!==0,l=n,o=!0,c=()=>(o&&(o=!1,l=a?L(n):n),l),f;if(s){var h=ze in t||Hn in t;f=it(t,e)?.set??(h&&e in t?x=>t[e]=x:void 0)}var u,d=!1;s?[u,d]=hi(()=>t[e]):u=t[e],u===void 0&&n!==void 0&&(u=c(),f&&(i&&ts(),f(u)));var g;if(i?g=()=>{var x=t[e];return x===void 0?c():(o=!0,x)}:g=()=>{var x=t[e];return x!==void 0&&(l=void 0),x===void 0?l:x},i&&(r&ds)===0)return g;if(f){var w=t.$$legacy;return(function(x,C){return arguments.length>0?((!i||!C||w||d)&&f(C?g():x),x):g()})}var v=!1,_=((r&fs)!==0?qt:yr)(()=>(v=!1,g()));s&&p(_);var k=P;return(function(x,C){if(arguments.length>0){const y=C?p(_):i&&s?st(x):x;return z(_,y),v=!0,l!==void 0&&(l=y),x}return Je&&v||(k.f&Me)!==0?_.v:p(_)})}function Tr(t){N===null&&Qr(),ht&&N.l!==null?pi(N).m.push(t):ir(()=>{const e=L(t);if(typeof e=="function")return e})}function vi(t){N===null&&Qr(),Tr(()=>()=>L(t))}function pi(t){var e=t.l;return e.u??={a:[],b:[],m:[]}}const gi="5";typeof window<"u"&&((window.__svelte??={}).v??=new Set).add(gi);ws();class _i{propagator=null;config;currentSeed;isInitialized=!1;wasmModule=null;currentBackend="cpu";gpuAvailable=!1;constructor(e,r){this.config=e,this.currentSeed=r}async initialize(e="cpu"){try{const n="/autoverse/preview/pr-56/pkg/flow_lenia.js";this.wasmModule=await import(n),await this.wasmModule.default(),this.gpuAvailable=await this.checkWebGPU();const i=e==="gpu"&&this.gpuAvailable?"gpu":"cpu";await this.createPropagator(i),this.isInitialized=!0}catch(r){throw new Error(`Failed to initialize WASM: ${r}`)}}async checkWebGPU(){if(typeof navigator>"u"||!("gpu"in navigator))return!1;try{return await navigator.gpu.requestAdapter()!==null}catch{return!1}}async createPropagator(e){if(!this.wasmModule)throw new Error("WASM module not loaded");const r=JSON.stringify(this.config),n=JSON.stringify(this.currentSeed);e==="gpu"&&this.gpuAvailable?(this.propagator=await new this.wasmModule.WasmGpuPropagator(r,n),this.currentBackend="gpu"):(this.propagator=new this.wasmModule.WasmPropagator(r,n),this.currentBackend="cpu")}async switchBackend(e){if(!this.isInitialized)throw new Error("Simulation not initialized");return e==="gpu"&&!this.gpuAvailable?!1:(e===this.currentBackend||await this.createPropagator(e),!0)}isGpuAvailable(){return this.gpuAvailable}getBackend(){return this.currentBackend}async step(){this.ensureInitialized(),this.currentBackend==="gpu"?await this.propagator.step():this.propagator.step()}async run(e){this.ensureInitialized(),this.currentBackend==="gpu"?await this.propagator.run(BigInt(e)):this.propagator.run(BigInt(e))}getState(){return this.ensureInitialized(),this.propagator.getState()}reset(e){this.ensureInitialized(),e&&(this.currentSeed=e),this.propagator.reset(JSON.stringify(this.currentSeed))}totalMass(){return this.ensureInitialized(),this.propagator.totalMass()}getTime(){return this.ensureInitialized(),this.propagator.getTime()}getStep(){return this.ensureInitialized(),this.propagator.getStep()}getWidth(){return this.config.width}getHeight(){return this.config.height}getConfig(){return{...this.config}}extractRegion(e,r,n,i){this.ensureInitialized();const s=this.getState(),a=[];for(let l=0;l<s.channels.length;l++){const o=[];for(let c=0;c<i;c++)for(let f=0;f<n;f++){const h=(e+f)%s.width,d=(r+c)%s.height*s.width+h;o.push(s.channels[l][d])}a.push(o)}return{width:n,height:i,channels:a,sourceX:e,sourceY:r}}placeRegion(e,r,n){this.ensureInitialized();const i=this.getState(),s=new Map;for(let o=0;o<i.channels.length;o++)for(let c=0;c<i.height;c++)for(let f=0;f<i.width;f++){const h=c*i.width+f,u=i.channels[o][h];u>.001&&s.set(`${f},${c},${o}`,u)}for(let o=0;o<e.channels.length;o++)for(let c=0;c<e.height;c++)for(let f=0;f<e.width;f++){const h=(r+f)%this.config.width,u=(n+c)%this.config.height,d=c*e.width+f,g=e.channels[o][d];g>.001&&s.set(`${h},${u},${o}`,g)}const a=[];for(const[o,c]of s){const[f,h,u]=o.split(",").map(Number);a.push([f,h,u,c])}const l={pattern:{type:"Custom",values:a}};this.reset(l)}drawAt(e,r,n,i,s=0){this.ensureInitialized();const a=this.getState(),l=[];for(let c=0;c<a.channels.length;c++)for(let f=0;f<a.height;f++)for(let h=0;h<a.width;h++){const u=f*a.width+h;let d=a.channels[c][u];if(c===s){const g=h-e,w=f-r,v=Math.sqrt(g*g+w*w);if(v<=n){const _=1-v/n;d=Math.min(1,d+i*_*_)}}d>.001&&l.push([h,f,c,d])}const o={pattern:{type:"Custom",values:l}};this.reset(o)}eraseAt(e,r,n,i=0){this.ensureInitialized();const s=this.getState(),a=[];for(let o=0;o<s.channels.length;o++)for(let c=0;c<s.height;c++)for(let f=0;f<s.width;f++){const h=c*s.width+f;let u=s.channels[o][h];if(o===i){const d=f-e,g=c-r,w=Math.sqrt(d*d+g*g);if(w<=n){const v=1-w/n;u=Math.max(0,u*(1-v*v))}}u>.001&&a.push([f,c,o,u])}const l={pattern:{type:"Custom",values:a}};this.reset(l)}ensureInitialized(){if(!this.isInitialized||!this.propagator)throw new Error("Simulation not initialized. Call initialize() first.")}}const ur={width:128,height:128,channels:1,dt:.1,kernel_radius:13,kernels:[{radius:1,rings:[{amplitude:1,distance:.5,width:.15}],weight:1,mu:.15,sigma:.015,source_channel:0,target_channel:0}],flow:{beta_a:1,n:2,distribution_size:1}},mi={pattern:{type:"GaussianBlob",center:[.5,.5],radius:.1,amplitude:1,channel:0}},bi={initialized:!1,playing:!1,step:0,time:0,totalMass:0,fps:0,frameTime:0,backend:"cpu",gpuAvailable:!1,config:ur,state:null},J=De(bi),Nn=De([]);function U(t,e="info"){Nn.update(r=>[...r.slice(-100),{message:t,level:e,timestamp:Date.now()}])}let B=null,$t=null,St=0,Lt=0,dr=0,Fn=60,Rt=0;function hr(){return B}function wi(t){Fn=Math.max(1,Math.min(480,t)),Rt=0}async function yi(){B=new _i(ur,mi),await B.initialize();const t=B.getState();J.update(e=>({...e,initialized:!0,step:B.getStep(),time:B.getTime(),totalMass:B.totalMass(),backend:B.getBackend(),gpuAvailable:B.isGpuAvailable(),config:ur,state:t}))}function Si(){!B||Tt(J).playing||(J.update(e=>({...e,playing:!0})),St=performance.now(),dr=St,Lt=0,zn(St),U("Simulation started","info"))}function xi(){J.update(t=>({...t,playing:!1})),$t!==null&&(cancelAnimationFrame($t),$t=null),U("Simulation paused","info")}async function Ei(){B&&(await B.step(),Dr())}function Bn(t){B&&(B.reset(t),Dr(),U("Simulation reset","info"))}async function Mi(t){if(!B)return!1;const e=await B.switchBackend(t);return e?(J.update(r=>({...r,backend:t})),U(`Switched to ${t.toUpperCase()} backend`,"success")):U(`Failed to switch to ${t} backend`,"error"),e}async function zn(t){if(!Tt(J).playing||!B)return;let r=t-St;St=t;const n=250;r>n&&(r=n,Rt=0);const i=Fn*r/1e3+Rt,s=Math.floor(i);Rt=i-s,s>0&&await B.run(s),Dr(),Lt++,t-dr>=1e3&&(J.update(a=>({...a,fps:Lt,frameTime:r})),Lt=0,dr=t),$t=requestAnimationFrame(a=>zn(a))}function Dr(){if(!B)return;const t=B.getState();J.update(e=>({...e,step:B.getStep(),time:B.getTime(),totalMass:B.totalMass(),state:t}))}const Ci=Ar(J,t=>t.time.toFixed(2)),ki=Ar(J,t=>t.totalMass.toLocaleString(void 0,{maximumFractionDigits:0})),Ai=Ar(J,t=>t.step.toString().padStart(8,"0")),Ti={mode:"view",brushSize:5,brushIntensity:.8,colorScheme:"theme",visualizationMode:"mass",showGrid:!1,showScanlines:!0,showSelection:!0,zoom:1,panX:0,panY:0},gt=De(Ti);function Di(t){gt.update(e=>({...e,mode:t}))}function Ii(t){gt.update(e=>({...e,brushSize:Math.max(1,Math.min(50,t))}))}function Pi(t){gt.update(e=>({...e,brushIntensity:Math.max(0,Math.min(1,t))}))}const Ct=[{id:"void",name:"VOID",colors:{primary:"#a855f7",primaryDim:"#6b21a8",primaryGlow:"rgba(168, 85, 247, 0.4)",secondary:"#3b82f6",secondaryDim:"#1e40af",secondaryGlow:"rgba(59, 130, 246, 0.4)",tertiary:"#ec4899",tertiaryDim:"#9d174d",tertiaryGlow:"rgba(236, 72, 153, 0.4)",success:"#a855f7",warning:"#f59e0b",danger:"#ef4444"}},{id:"neon-tokyo",name:"NEON TOKYO",colors:{primary:"#ff2d95",primaryDim:"#9d1a5a",primaryGlow:"rgba(255, 45, 149, 0.4)",secondary:"#00f0ff",secondaryDim:"#0891b2",secondaryGlow:"rgba(0, 240, 255, 0.4)",tertiary:"#ffee00",tertiaryDim:"#a38a00",tertiaryGlow:"rgba(255, 238, 0, 0.4)",success:"#00f0ff",warning:"#ffee00",danger:"#ff2d95"}},{id:"synthwave",name:"SYNTHWAVE",colors:{primary:"#f472b6",primaryDim:"#a21caf",primaryGlow:"rgba(244, 114, 182, 0.4)",secondary:"#818cf8",secondaryDim:"#4338ca",secondaryGlow:"rgba(129, 140, 248, 0.4)",tertiary:"#22d3ee",tertiaryDim:"#0e7490",tertiaryGlow:"rgba(34, 211, 238, 0.4)",success:"#22d3ee",warning:"#fbbf24",danger:"#f43f5e"}},{id:"bloodmoon",name:"BLOODMOON",colors:{primary:"#dc2626",primaryDim:"#7f1d1d",primaryGlow:"rgba(220, 38, 38, 0.4)",secondary:"#f97316",secondaryDim:"#9a3412",secondaryGlow:"rgba(249, 115, 22, 0.4)",tertiary:"#fbbf24",tertiaryDim:"#92400e",tertiaryGlow:"rgba(251, 191, 36, 0.4)",success:"#f97316",warning:"#fbbf24",danger:"#dc2626"}},{id:"toxic",name:"TOXIC",colors:{primary:"#84cc16",primaryDim:"#3f6212",primaryGlow:"rgba(132, 204, 22, 0.5)",secondary:"#facc15",secondaryDim:"#854d0e",secondaryGlow:"rgba(250, 204, 21, 0.4)",tertiary:"#22c55e",tertiaryDim:"#166534",tertiaryGlow:"rgba(34, 197, 94, 0.4)",success:"#22c55e",warning:"#facc15",danger:"#ef4444"}},{id:"ice",name:"ICE",colors:{primary:"#38bdf8",primaryDim:"#0369a1",primaryGlow:"rgba(56, 189, 248, 0.4)",secondary:"#e0f2fe",secondaryDim:"#7dd3fc",secondaryGlow:"rgba(224, 242, 254, 0.3)",tertiary:"#a5b4fc",tertiaryDim:"#4f46e5",tertiaryGlow:"rgba(165, 180, 252, 0.4)",success:"#38bdf8",warning:"#fcd34d",danger:"#f87171"}},{id:"hacker",name:"HACKER",colors:{primary:"#22c55e",primaryDim:"#166534",primaryGlow:"rgba(34, 197, 94, 0.5)",secondary:"#4ade80",secondaryDim:"#15803d",secondaryGlow:"rgba(74, 222, 128, 0.4)",tertiary:"#86efac",tertiaryDim:"#22c55e",tertiaryGlow:"rgba(134, 239, 172, 0.3)",success:"#22c55e",warning:"#fbbf24",danger:"#ef4444"}},{id:"phosphor",name:"PHOSPHOR",colors:{primary:"#fef08a",primaryDim:"#a16207",primaryGlow:"rgba(254, 240, 138, 0.5)",secondary:"#fde047",secondaryDim:"#854d0e",secondaryGlow:"rgba(253, 224, 71, 0.4)",tertiary:"#fbbf24",tertiaryDim:"#92400e",tertiaryGlow:"rgba(251, 191, 36, 0.4)",success:"#a3e635",warning:"#fbbf24",danger:"#f87171"}}],Kt=De(Ct[0]);function vr(t){const e=document.documentElement,{colors:r}=t;e.style.setProperty("--color-primary",r.primary),e.style.setProperty("--color-primary-dim",r.primaryDim),e.style.setProperty("--color-primary-glow",r.primaryGlow),e.style.setProperty("--color-secondary",r.secondary),e.style.setProperty("--color-secondary-dim",r.secondaryDim),e.style.setProperty("--color-secondary-glow",r.secondaryGlow),e.style.setProperty("--color-tertiary",r.tertiary),e.style.setProperty("--color-tertiary-dim",r.tertiaryDim),e.style.setProperty("--color-tertiary-glow",r.tertiaryGlow),e.style.setProperty("--color-success",r.success),e.style.setProperty("--color-warning",r.warning),e.style.setProperty("--color-danger",r.danger),Kt.set(t),localStorage.setItem("autoverse-theme",t.id)}function $i(t){const e=Ct.find(r=>r.id===t);e&&vr(e)}function Li(){const t=localStorage.getItem("autoverse-theme");if(t){const e=Ct.find(r=>r.id===t);if(e){vr(e);return}}vr(Ct[0])}var Ri=I("<button></button>"),Oi=I('<header class="header svelte-4b3o1e"><div class="header-left svelte-4b3o1e"><pre class="ascii-logo svelte-4b3o1e"></pre></div> <div class="header-right svelte-4b3o1e"><div class="theme-picker svelte-4b3o1e"><span class="picker-label svelte-4b3o1e">THEME</span> <div class="theme-swatches svelte-4b3o1e"></div></div> <div><span class="backend-label svelte-4b3o1e">COMPUTE</span> <span class="backend-value svelte-4b3o1e"> </span></div></div></header>');function Ni(t,e){Ve(e,!1);const r=()=>q(Kt,"$currentScheme",i),n=()=>q(J,"$simulationStore",i),[i,s]=Dt();Vt();var a=Oi(),l=b(a),o=b(l);o.textContent=`
 ▄▀▄ █ █ ▀█▀ ▄▀▄ █ █ █▀▀ █▀▄ ▄▀▀ █▀▀
 █▀█ █▄█  █  █ █ ▀▄▀ ██▄ █▀▄ ▄██ ██▄`;var c=M(l,2),f=b(c),h=M(b(f),2);Mt(h,5,()=>Ct,Gt,(v,_)=>{var k=Ri();let x;k.__click=()=>$i(p(_).id),j(()=>{x=de(k,1,"swatch svelte-4b3o1e",null,x,{active:r().id===p(_).id}),Rn(k,`--swatch-color: ${p(_).colors.primary??""}`),ke(k,"title",p(_).name)}),T(v,k)});var u=M(f,2);let d;var g=M(b(u),2),w=b(g);j(v=>{d=de(u,1,"backend-indicator svelte-4b3o1e",null,d,{gpu:n().backend==="gpu"}),G(w,v)},[()=>n().backend.toUpperCase()]),T(t,a),Ke(),s()}Ht(["click"]);var Fi=I('<footer class="footer svelte-ww03jg"></footer>');function Bi(t){var e=Fi();T(t,e)}var zi=I("<div> </div>"),Gi=I('<div><div class="corner top-left svelte-1gtc57s"></div> <div class="corner top-right svelte-1gtc57s"></div> <div class="corner bottom-left svelte-1gtc57s"></div> <div class="corner bottom-right svelte-1gtc57s"></div> <!> <div><!></div></div>');function Be(t,e){let r=ge(e,"borderColor",3,"primary"),n=ge(e,"noPadding",3,!1),i=ge(e,"class",3,"");const s={primary:"border-primary",secondary:"border-secondary",tertiary:"border-tertiary"};var a=Gi(),l=M(b(a),8);{var o=u=>{var d=zi(),g=b(d);j(()=>{de(d,1,`title ${s[r()]??""}`,"svelte-1gtc57s"),G(g,e.title)}),T(u,d)};ue(l,u=>{e.title&&u(o)})}var c=M(l,2);let f;var h=b(c);ni(h,()=>e.children??Ee),j(()=>{de(a,1,`tui-box ${s[r()]??""} ${i()??""}`,"svelte-1gtc57s"),f=de(c,1,"content svelte-1gtc57s",null,f,{"no-padding":n()})}),T(t,a)}var Yi=I('<span class="label svelte-1l5vt72"> </span>'),Ui=I("<span> </span>"),ji=I('<div class="slider-header svelte-1l5vt72"><!> <!></div>'),qi=I('<div class="slider-container svelte-1l5vt72"><!> <input type="range"/></div>');function er(t,e){Ve(e,!0);let r=ge(e,"value",15),n=ge(e,"min",3,0),i=ge(e,"max",3,100),s=ge(e,"step",3,1),a=ge(e,"showValue",3,!0),l=ge(e,"valueFormat",3,g=>String(g)),o=ge(e,"color",3,"tertiary");function c(g){const w=g.target;r(parseFloat(w.value)),e.onchange?.(r())}var f=qi(),h=b(f);{var u=g=>{var w=ji(),v=b(w);{var _=C=>{var y=Yi(),m=b(y);j(()=>G(m,e.label)),T(C,y)};ue(v,C=>{e.label&&C(_)})}var k=M(v,2);{var x=C=>{var y=Ui(),m=b(y);j(S=>{de(y,1,`value ${o()??""}`,"svelte-1l5vt72"),G(m,S)},[()=>l()(r())]),T(C,y)};ue(k,C=>{a()&&C(x)})}T(g,w)};ue(h,g=>{(e.label||a())&&g(u)})}var d=M(h,2);d.__input=c,j(()=>{de(d,1,ii(o()),"svelte-1l5vt72"),ke(d,"min",n()),ke(d,"max",i()),ke(d,"step",s()),fi(d,r())}),T(t,f),Ke()}Ht(["input"]);var Xi=I('<span class="icon svelte-oaxjxu">&#9724;</span> <span class="label svelte-oaxjxu">PAUSE</span>',1),Wi=I('<span class="icon svelte-oaxjxu">&#9654;</span> <span class="label svelte-oaxjxu">PLAY</span>',1),Hi=I('<div class="control-grid svelte-oaxjxu"><button><!></button> <button class="control-btn svelte-oaxjxu"><span class="icon svelte-oaxjxu">&#9655;</span> <span class="label svelte-oaxjxu">STEP</span></button> <button class="control-btn svelte-oaxjxu"><span class="icon svelte-oaxjxu">&#8634;</span> <span class="label svelte-oaxjxu">RESET</span></button></div> <div class="speed-control svelte-oaxjxu"><!></div>',1),Vi=I('<button><span class="icon svelte-oaxjxu"><!></span> <span class="label svelte-oaxjxu"> </span></button>'),Ki=I('<div class="brush-settings svelte-oaxjxu"><!> <!></div>'),Ji=I('<div class="tool-grid svelte-oaxjxu"></div> <!>',1),Zi=I('<div><span class="log-prefix svelte-oaxjxu">&gt;</span> <span class="log-message svelte-oaxjxu"> </span></div>'),Qi=I('<div class="log-container svelte-oaxjxu"></div>'),ea=I('<aside class="left-sidebar svelte-oaxjxu"><!> <!> <!></aside>');function ta(t,e){Ve(e,!0);const r=()=>q(J,"$simulationStore",s),n=()=>q(gt,"$settings",s),i=()=>q(Nn,"$systemLog",s),[s,a]=Dt();let l=ye(60);function o(w){z(l,w,!0),wi(w)}function c(w){Di(w)}const f=[{id:"view",label:"VIEW",icon:"&#9673;"},{id:"select",label:"SEL",icon:"&#9633;"},{id:"draw",label:"DRAW",icon:"&#9998;"},{id:"erase",label:"ERASE",icon:"&#9747;"}];var h=ea(),u=b(h);Be(u,{title:"SYS.CONTROL",borderColor:"primary",children:(w,v)=>{var _=Hi(),k=at(_),x=b(k);let C;x.__click=()=>r().playing?xi():Si();var y=b(x);{var m=R=>{var V=Xi();T(R,V)},S=R=>{var V=Wi();T(R,V)};ue(y,R=>{r().playing?R(m):R(S,!1)})}var E=M(x,2);E.__click=()=>Ei();var $=M(E,2);$.__click=()=>Bn();var A=M(k,2),Y=b(A);er(Y,{label:"SIM SPEED",min:15,max:480,step:15,color:"primary",valueFormat:R=>`${R} steps/s`,onchange:o,get value(){return p(l)},set value(R){z(l,R,!0)}}),j(()=>C=de(x,1,"control-btn svelte-oaxjxu",null,C,{active:!r().playing})),T(w,_)},$$slots:{default:!0}});var d=M(u,2);Be(d,{title:"TOOL.KIT",borderColor:"tertiary",children:(w,v)=>{var _=Ji(),k=at(_);Mt(k,21,()=>f,Gt,(y,m)=>{var S=Vi();let E;S.__click=()=>c(p(m).id);var $=b(S),A=b($);ri(A,()=>p(m).icon);var Y=M($,2),R=b(Y);j(()=>{E=de(S,1,"tool-btn svelte-oaxjxu",null,E,{active:n().mode===p(m).id}),G(R,p(m).label)}),T(y,S)});var x=M(k,2);{var C=y=>{var m=Ki(),S=b(m);er(S,{label:"BRUSH SIZE",get value(){return n().brushSize},min:1,max:30,step:1,color:"tertiary",valueFormat:A=>`${A}PX`,get onchange(){return Ii}});var E=M(S,2);{var $=A=>{er(A,{label:"INTENSITY",get value(){return n().brushIntensity},min:0,max:1,step:.05,color:"tertiary",valueFormat:Y=>`${Math.round(Y*100)}%`,get onchange(){return Pi}})};ue(E,A=>{n().mode==="draw"&&A($)})}T(y,m)};ue(x,y=>{(n().mode==="draw"||n().mode==="erase")&&y(C)})}T(w,_)},$$slots:{default:!0}});var g=M(d,2);Be(g,{title:"DEBUG.LOG",borderColor:"secondary",class:"debug-log-box",children:(w,v)=>{var _=Qi();Mt(_,5,i,Gt,(k,x)=>{var C=Zi(),y=M(b(C),2),m=b(y);j(()=>{de(C,1,`log-entry ${p(x).level??""}`,"svelte-oaxjxu"),G(m,p(x).message)}),T(k,C)}),T(w,_)},$$slots:{default:!0}}),T(t,h),Ke(),a()}Ht(["click"]);const qr="flow-lenia-presets";class ra{presets=new Map;listeners=new Set;constructor(){this.loadFromStorage()}generateId(){return`preset-${Date.now()}-${Math.random().toString(36).slice(2,9)}`}createThumbnail(e,r=64){const n=document.createElement("canvas");n.width=r,n.height=r;const i=n.getContext("2d"),s=i.createImageData(e.width,e.height),a=e.channels[0];for(let g=0;g<a.length;g++){const w=Math.max(0,Math.min(1,a[g])),v=Math.floor(w*255);s.data[g*4+0]=v,s.data[g*4+1]=v,s.data[g*4+2]=v,s.data[g*4+3]=255}const l=document.createElement("canvas");l.width=e.width,l.height=e.height,l.getContext("2d").putImageData(s,0,0),i.imageSmoothingEnabled=!0,i.fillStyle="#1a1a1a",i.fillRect(0,0,r,r);const c=Math.min(r/e.width,r/e.height),f=e.width*c,h=e.height*c,u=(r-f)/2,d=(r-h)/2;return i.drawImage(l,u,d,f,h),n.toDataURL("image/png")}savePreset(e,r,n){const i={id:this.generateId(),name:e,description:n,thumbnail:this.createThumbnail(r),region:r,createdAt:Date.now()};return this.presets.set(i.id,i),this.persistToStorage(),this.notifyListeners(),i}getPreset(e){return this.presets.get(e)}getAllPresets(){return Array.from(this.presets.values()).sort((e,r)=>r.createdAt-e.createdAt)}deletePreset(e){const r=this.presets.delete(e);return r&&(this.persistToStorage(),this.notifyListeners()),r}renamePreset(e,r){const n=this.presets.get(e);return n?(n.name=r,this.persistToStorage(),this.notifyListeners(),!0):!1}updateDescription(e,r){const n=this.presets.get(e);return n?(n.description=r,this.persistToStorage(),this.notifyListeners(),!0):!1}exportPresets(e){const r=e?e.map(n=>this.presets.get(n)).filter(Boolean):this.getAllPresets();return JSON.stringify(r,null,2)}importPresets(e){try{const r=JSON.parse(e);let n=0;for(const i of r){const s={...i,id:this.generateId(),createdAt:Date.now()};this.presets.set(s.id,s),n++}return this.persistToStorage(),this.notifyListeners(),n}catch{throw new Error("Invalid preset JSON format")}}subscribe(e){return this.listeners.add(e),()=>this.listeners.delete(e)}notifyListeners(){const e=this.getAllPresets();for(const r of this.listeners)r(e)}persistToStorage(){try{const e=JSON.stringify(Array.from(this.presets.entries()));localStorage.setItem(qr,e)}catch(e){console.warn("Failed to persist presets to storage:",e)}}loadFromStorage(){try{const e=localStorage.getItem(qr);if(e){const r=JSON.parse(e);this.presets=new Map(r)}}catch(e){console.warn("Failed to load presets from storage:",e),this.presets=new Map}}clearAll(){this.presets.clear(),this.persistToStorage(),this.notifyListeners()}}const na=[{name:"Glider",description:"A simple glider that moves across the grid",seed:{pattern:{type:"GaussianBlob",center:[.5,.5],radius:.1,amplitude:1,channel:0}}},{name:"Ring",description:"A ring pattern that expands",seed:{pattern:{type:"Ring",center:[.5,.5],inner_radius:.05,outer_radius:.1,amplitude:1,channel:0}}},{name:"Dual Blobs",description:"Two interacting blobs",seed:{pattern:{type:"MultiBlob",blobs:[{center:[.35,.5],radius:.08,amplitude:1,channel:0},{center:[.65,.5],radius:.08,amplitude:1,channel:0}]}}},{name:"Random Noise",description:"Random initial conditions",seed:{pattern:{type:"Noise",seed:42,amplitude:.5,channel:0}}}],pr=De(null),Gn=De(0);function sa(){Gn.update(t=>t+1)}function ia(t,e){const r=Tt(pr);r&&r.startDragFromLibrary(t,e)}const Xr=De(null),ut=new ra,Ir=De(ut.getAllPresets());ut.subscribe(t=>{Ir.set(t)});function aa(t){const e=ut.getAllPresets().find(r=>r.id===t);ut.deletePreset(t),e&&U(`Deleted preset: ${e.name}`,"info")}function oa(){const t=ut.exportPresets();return U(`Exported ${Tt(Ir).length} presets`,"success"),t}function la(t){try{const e=ut.importPresets(t);return U(`Imported ${e} presets`,"success"),sa(),e}catch(e){throw U(`Import failed: ${e}`,"error"),e}}function ca(){const t=oa(),e=new Blob([t],{type:"application/json"}),r=URL.createObjectURL(e),n=document.createElement("a");n.href=r,n.download="flow-lenia-presets.json",n.click(),URL.revokeObjectURL(r)}var fa=I('<div class="metric-display svelte-1baw31t"><div class="metric-main svelte-1baw31t"><span class="metric-value svelte-1baw31t"> </span> <span class="metric-unit svelte-1baw31t">STEPS</span></div> <div class="metric-row svelte-1baw31t"><div class="metric-item svelte-1baw31t"><span class="metric-label svelte-1baw31t">TIME</span> <span class="metric-num svelte-1baw31t"> </span></div> <div class="metric-item svelte-1baw31t"><span class="metric-label svelte-1baw31t">MASS</span> <span class="metric-num highlight svelte-1baw31t"> </span></div></div> <div class="metric-row svelte-1baw31t"><div class="metric-item svelte-1baw31t"><span class="metric-label svelte-1baw31t">FPS</span> <span class="metric-num accent svelte-1baw31t"> </span></div> <div class="metric-item svelte-1baw31t"><span class="metric-label svelte-1baw31t">BACKEND</span> <button> </button></div></div></div>'),ua=I('<div class="config-grid svelte-1baw31t"><div class="config-item svelte-1baw31t"><span class="cfg-label svelte-1baw31t">mu</span> <span class="cfg-value svelte-1baw31t"> </span></div> <div class="config-item svelte-1baw31t"><span class="cfg-label svelte-1baw31t">sigma</span> <span class="cfg-value svelte-1baw31t"> </span></div> <div class="config-item svelte-1baw31t"><span class="cfg-label svelte-1baw31t">R</span> <span class="cfg-value svelte-1baw31t"> </span></div> <div class="config-item svelte-1baw31t"><span class="cfg-label svelte-1baw31t">dt</span> <span class="cfg-value svelte-1baw31t"> </span></div></div>'),da=I('<button class="builtin-btn svelte-1baw31t"> </button>'),ha=I('<div class="builtin-grid svelte-1baw31t"></div>'),va=I('<img class="svelte-1baw31t"/>'),pa=I('<div class="preset-item svelte-1baw31t" draggable="true" role="button" tabindex="0"><div class="preset-thumbnail svelte-1baw31t"><!></div> <div class="preset-info svelte-1baw31t"><span class="preset-name svelte-1baw31t"> </span> <span class="preset-size svelte-1baw31t"> </span></div> <button class="delete-btn svelte-1baw31t">&#10005;</button></div>'),ga=I('<div class="empty-state svelte-1baw31t">No saved patterns</div>'),_a=I('<div class="patterns-header svelte-1baw31t"><button class="small-btn svelte-1baw31t">IMPORT</button> <button class="small-btn svelte-1baw31t">EXPORT</button></div> <div class="preset-list svelte-1baw31t"></div>',1),ma=I('<aside class="right-sidebar svelte-1baw31t"><!> <!> <!> <!></aside>');function ba(t,e){Ve(e,!1);const r=()=>q(J,"$simulationStore",l),n=()=>q(Ai,"$formattedStep",l),i=()=>q(Ci,"$formattedTime",l),s=()=>q(ki,"$formattedMass",l),a=()=>q(Ir,"$presets",l),[l,o]=Dt(),c=fe();function f(){const m=r().backend==="cpu"?"gpu":"cpu";Mi(m)}function h(m){const S=hr();if(!S)return;const E=Math.floor((S.getWidth()-m.region.width)/2),$=Math.floor((S.getHeight()-m.region.height)/2);S.placeRegion(m.region,E,$)}function u(m){Bn(m.seed),U(`Loaded pattern: ${m.name}`,"info")}function d(m,S){m.stopPropagation(),aa(S)}function g(){ca()}function w(){const m=document.createElement("input");m.type="file",m.accept=".json",m.onchange=async S=>{const E=S.target.files?.[0];if(!E)return;const $=await E.text();try{la($)}catch{}},m.click()}function v(m,S){m.dataTransfer.effectAllowed="copy",m.dataTransfer.setData("text/plain",S.id),ia(S,m)}Pe(()=>r(),()=>{z(c,r().config.kernels[0])}),Mr(),Vt();var _=ma(),k=b(_);Be(k,{title:"METRICS",borderColor:"secondary",children:(m,S)=>{var E=fa(),$=b(E),A=b($),Y=b(A),R=M($,2),V=b(R),O=M(b(V),2),se=b(O),ie=M(V,2),Ne=M(b(ie),2),_t=b(Ne),Ze=M(R,2),Fe=b(Ze),Jt=M(b(Fe),2),Zt=b(Jt),Qt=M(Fe,2),Qe=M(b(Qt),2);let ae;Qe.__click=f;var mt=b(Qe);j(Yn=>{G(Y,n()),G(se,`${i()??""}s`),G(_t,s()),G(Zt,(r(),L(()=>r().fps))),ae=de(Qe,1,"backend-btn svelte-1baw31t",null,ae,{gpu:r().backend==="gpu"}),Qe.disabled=(r(),L(()=>!r().gpuAvailable)),G(mt,Yn)},[()=>(r(),L(()=>r().backend.toUpperCase()))]),T(m,E)},$$slots:{default:!0}});var x=M(k,2);Be(x,{title:"KERNEL",borderColor:"primary",children:(m,S)=>{var E=ua(),$=b(E),A=M(b($),2),Y=b(A),R=M($,2),V=M(b(R),2),O=b(V),se=M(R,2),ie=M(b(se),2),Ne=b(ie),_t=M(se,2),Ze=M(b(_t),2),Fe=b(Ze);j(()=>{G(Y,(p(c),L(()=>p(c)?.mu??"—"))),G(O,(p(c),L(()=>p(c)?.sigma??"—"))),G(Ne,(r(),L(()=>r().config.kernel_radius))),G(Fe,(r(),L(()=>r().config.dt)))}),T(m,E)},$$slots:{default:!0}});var C=M(x,2);Be(C,{title:"SEEDS",borderColor:"tertiary",children:(m,S)=>{var E=ha();Mt(E,5,()=>na,Gt,($,A)=>{var Y=da();Y.__click=()=>u(p(A));var R=b(Y);j(()=>{ke(Y,"title",(p(A),L(()=>p(A).description))),G(R,(p(A),L(()=>p(A).name)))}),T($,Y)}),T(m,E)},$$slots:{default:!0}});var y=M(C,2);Be(y,{title:"SAVED",borderColor:"primary",class:"saved-box",children:(m,S)=>{var E=_a(),$=at(E),A=b($);A.__click=w;var Y=M(A,2);Y.__click=g;var R=M($,2);Mt(R,5,a,V=>V.id,(V,O)=>{var se=pa();se.__click=()=>h(p(O)),se.__keydown=ae=>ae.key==="Enter"&&h(p(O));var ie=b(se),Ne=b(ie);{var _t=ae=>{var mt=va();j(()=>{ke(mt,"src",(p(O),L(()=>p(O).thumbnail))),ke(mt,"alt",(p(O),L(()=>p(O).name)))}),T(ae,mt)};ue(Ne,ae=>{p(O),L(()=>p(O).thumbnail)&&ae(_t)})}var Ze=M(ie,2),Fe=b(Ze),Jt=b(Fe),Zt=M(Fe,2),Qt=b(Zt),Qe=M(Ze,2);Qe.__click=ae=>d(ae,p(O).id),j(()=>{G(Jt,(p(O),L(()=>p(O).name))),G(Qt,`${p(O),L(()=>p(O).region.width)??""}x${p(O),L(()=>p(O).region.height)??""}`)}),Vs("dragstart",se,ae=>v(ae,p(O))),T(V,se)},V=>{var O=ga();T(V,O)}),T(m,E)},$$slots:{default:!0}}),T(t,_),Ke(),o()}Ht(["click","keydown"]);class wa{canvas;ctx;offscreenCanvas;offscreenCtx;settings;grayscaleMap;thermalMap;viridisMap;themeMap;constructor(e,r){this.canvas=e;const n=e.getContext("2d");if(!n)throw new Error("Failed to get 2D context");this.ctx=n,this.offscreenCanvas=document.createElement("canvas");const i=this.offscreenCanvas.getContext("2d");if(!i)throw new Error("Failed to get offscreen 2D context");this.offscreenCtx=i,this.settings=r,this.grayscaleMap=this.buildGrayscaleMap(),this.thermalMap=this.buildThermalMap(),this.viridisMap=this.buildViridisMap(),this.themeMap=this.viridisMap}setThemeColors(e){this.themeMap=this.buildThemeMap(e)}updateSettings(e){this.settings={...this.settings,...e}}render(e,r,n){const{width:i,height:s,channels:a}=e;(this.offscreenCanvas.width!==i||this.offscreenCanvas.height!==s)&&(this.offscreenCanvas.width=i,this.offscreenCanvas.height=s);const l=this.getColorMap(),o=this.offscreenCtx.createImageData(i,s),c=a[0];for(let f=0;f<c.length;f++){const h=Math.max(0,Math.min(1,c[f])),u=Math.floor(h*255)*4;o.data[f*4+0]=l[u+0],o.data[f*4+1]=l[u+1],o.data[f*4+2]=l[u+2],o.data[f*4+3]=255}this.offscreenCtx.putImageData(o,0,0),this.ctx.imageSmoothingEnabled=!1,this.ctx.fillStyle="#000",this.ctx.fillRect(0,0,this.canvas.width,this.canvas.height),this.ctx.drawImage(this.offscreenCanvas,0,0,i,s,0,0,this.canvas.width,this.canvas.height),this.settings.showGrid&&this.drawGrid(i,s),n&&this.drawGhostPreview(n,i,s),r&&this.settings.showSelection&&this.drawSelection(r,i,s)}drawGrid(e,r){const n=this.canvas.width/e,i=this.canvas.height/r;if(this.ctx.strokeStyle="rgba(255, 255, 255, 0.1)",this.ctx.lineWidth=1,n>=4&&i>=4){this.ctx.beginPath();for(let s=0;s<=e;s++){const a=s*n;this.ctx.moveTo(a,0),this.ctx.lineTo(a,this.canvas.height)}for(let s=0;s<=r;s++){const a=s*i;this.ctx.moveTo(0,a),this.ctx.lineTo(this.canvas.width,a)}this.ctx.stroke()}}drawSelection(e,r,n){const i=this.canvas.width/r,s=this.canvas.height/n,a=Math.min(e.startX,e.endX)*i,l=Math.min(e.startY,e.endY)*s,o=Math.abs(e.endX-e.startX)*i,c=Math.abs(e.endY-e.startY)*s;this.ctx.fillStyle="rgba(79, 195, 247, 0.2)",this.ctx.fillRect(a,l,o,c),this.ctx.strokeStyle="#4fc3f7",this.ctx.lineWidth=2,this.ctx.setLineDash([5,5]),this.ctx.strokeRect(a,l,o,c),this.ctx.setLineDash([]);const f=Math.abs(e.endX-e.startX),h=Math.abs(e.endY-e.startY);f>0&&h>0&&(this.ctx.fillStyle="#4fc3f7",this.ctx.font="12px monospace",this.ctx.fillText(`${f} x ${h}`,a+4,l-4))}drawGhostPreview(e,r,n){const i=this.canvas.width/r,s=this.canvas.height/n,{region:a,x:l,y:o}=e,c=document.createElement("canvas");c.width=a.width,c.height=a.height;const f=c.getContext("2d"),h=f.createImageData(a.width,a.height),u=this.getColorMap();for(let d=0;d<a.channels[0].length;d++){const g=Math.max(0,Math.min(1,a.channels[0][d])),w=Math.floor(g*255)*4;h.data[d*4+0]=u[w+0],h.data[d*4+1]=u[w+1],h.data[d*4+2]=u[w+2],h.data[d*4+3]=g>.01?180:0}f.putImageData(h,0,0),this.ctx.globalAlpha=.7,this.ctx.drawImage(c,0,0,a.width,a.height,l*i,o*s,a.width*i,a.height*s),this.ctx.globalAlpha=1,this.ctx.strokeStyle="#4fc3f7",this.ctx.lineWidth=2,this.ctx.setLineDash([3,3]),this.ctx.strokeRect(l*i,o*s,a.width*i,a.height*s),this.ctx.setLineDash([])}canvasToSim(e,r,n,i){const s=this.canvas.getBoundingClientRect(),a=n/this.canvas.width,l=i/this.canvas.height;return{x:Math.floor((e-s.left)*a),y:Math.floor((r-s.top)*l)}}getColorMap(){switch(this.settings.colorScheme){case"thermal":return this.thermalMap;case"viridis":return this.viridisMap;case"theme":return this.themeMap;default:return this.grayscaleMap}}buildGrayscaleMap(){const e=new Uint8ClampedArray(1024);for(let r=0;r<256;r++)e[r*4+0]=r,e[r*4+1]=r,e[r*4+2]=r,e[r*4+3]=255;return e}buildThermalMap(){const e=new Uint8ClampedArray(1024);for(let r=0;r<256;r++){const n=r/255;let i,s,a;if(n<.2){const l=n/.2;i=0,s=0,a=Math.floor(l*128)}else if(n<.4){const l=(n-.2)/.2;i=0,s=Math.floor(l*255),a=128+Math.floor(l*127)}else if(n<.6){const l=(n-.4)/.2;i=Math.floor(l*255),s=255,a=255-Math.floor(l*255)}else if(n<.8){const l=(n-.6)/.2;i=255,s=255-Math.floor(l*255),a=0}else{const l=(n-.8)/.2;i=255,s=Math.floor(l*255),a=Math.floor(l*255)}e[r*4+0]=i,e[r*4+1]=s,e[r*4+2]=a,e[r*4+3]=255}return e}buildViridisMap(){const e=[[68,1,84],[72,35,116],[64,67,135],[52,94,141],[41,120,142],[32,144,140],[34,167,132],[68,190,112],[121,209,81],[189,222,38],[253,231,36]],r=new Uint8ClampedArray(256*4);for(let n=0;n<256;n++){const s=n/255*(e.length-1),a=Math.floor(s),l=Math.min(a+1,e.length-1),o=s-a;r[n*4+0]=Math.floor(e[a][0]+o*(e[l][0]-e[a][0])),r[n*4+1]=Math.floor(e[a][1]+o*(e[l][1]-e[a][1])),r[n*4+2]=Math.floor(e[a][2]+o*(e[l][2]-e[a][2])),r[n*4+3]=255}return r}getCanvas(){return this.canvas}buildThemeMap(e){const r=o=>{const c=o.replace("#","");return[parseInt(c.slice(0,2),16),parseInt(c.slice(2,4),16),parseInt(c.slice(4,6),16)]},n=r(e.primary),i=r(e.secondary),s=r(e.tertiary),a=[{t:0,color:[5,5,5]},{t:.15,color:[n[0]*.3,n[1]*.3,n[2]*.3]},{t:.35,color:n},{t:.6,color:i},{t:.85,color:s},{t:1,color:[255,255,255]}],l=new Uint8ClampedArray(256*4);for(let o=0;o<256;o++){const c=o/255;let f=a[0],h=a[1];for(let d=1;d<a.length;d++)if(c<=a[d].t){f=a[d-1],h=a[d];break}const u=(c-f.t)/(h.t-f.t);l[o*4+0]=Math.floor(f.color[0]+u*(h.color[0]-f.color[0])),l[o*4+1]=Math.floor(f.color[1]+u*(h.color[1]-f.color[1])),l[o*4+2]=Math.floor(f.color[2]+u*(h.color[2]-f.color[2])),l[o*4+3]=255}return l}}class ya{canvas;simulation;callbacks;mode="view";selection=null;isSelecting=!1;isDrawing=!1;isDragging=!1;draggedCreature=null;ghostPreview=null;brushSize=3;brushIntensity=.5;constructor(e,r,n,i={}){this.canvas=e,this.simulation=r,this.callbacks=i,this.setupEventListeners(),this.setupDragDrop()}setMode(e){switch(this.mode=e,this.selection=null,this.isSelecting=!1,this.isDrawing=!1,e){case"select":this.canvas.style.cursor="crosshair";break;case"draw":this.canvas.style.cursor="cell";break;case"erase":this.canvas.style.cursor="not-allowed";break;default:this.canvas.style.cursor="default"}this.callbacks.onModeChange?.(e)}getMode(){return this.mode}getSelection(){return this.selection}clearSelection(){this.selection=null,this.callbacks.onSelectionChange?.(null)}setBrushSize(e){this.brushSize=Math.max(1,Math.min(20,e))}setBrushIntensity(e){this.brushIntensity=Math.max(0,Math.min(1,e))}getGhostPreview(){return this.ghostPreview}startDragFromLibrary(e,r){this.isDragging=!0,this.draggedCreature={preset:e,offsetX:e.region.width/2,offsetY:e.region.height/2};const n=this.getSimCoords(r);this.ghostPreview={region:e.region,x:n.x-this.draggedCreature.offsetX,y:n.y-this.draggedCreature.offsetY}}setupEventListeners(){this.canvas.addEventListener("mousedown",this.handleMouseDown.bind(this)),this.canvas.addEventListener("mousemove",this.handleMouseMove.bind(this)),this.canvas.addEventListener("mouseup",this.handleMouseUp.bind(this)),this.canvas.addEventListener("mouseleave",this.handleMouseLeave.bind(this)),document.addEventListener("keydown",this.handleKeyDown.bind(this))}setupDragDrop(){this.canvas.addEventListener("dragover",e=>{if(e.preventDefault(),e.dataTransfer.dropEffect="copy",this.draggedCreature){const r=this.getSimCoords(e);this.ghostPreview={region:this.draggedCreature.preset.region,x:r.x-this.draggedCreature.offsetX,y:r.y-this.draggedCreature.offsetY}}}),this.canvas.addEventListener("drop",e=>{if(e.preventDefault(),this.draggedCreature){const r=this.getSimCoords(e),n=Math.floor(r.x-this.draggedCreature.offsetX),i=Math.floor(r.y-this.draggedCreature.offsetY);this.callbacks.onDrop?.(this.draggedCreature.preset,n,i),this.draggedCreature=null,this.ghostPreview=null,this.isDragging=!1}}),this.canvas.addEventListener("dragleave",()=>{this.ghostPreview=null})}handleMouseDown(e){const r=this.getSimCoords(e);switch(this.mode){case"select":this.isSelecting=!0,this.selection={startX:r.x,startY:r.y,endX:r.x,endY:r.y},this.callbacks.onSelectionChange?.(this.selection);break;case"draw":this.isDrawing=!0,this.callbacks.onDraw?.(r.x,r.y);break;case"erase":this.isDrawing=!0,this.callbacks.onErase?.(r.x,r.y);break}}handleMouseMove(e){const r=this.getSimCoords(e);this.isSelecting&&this.selection&&(this.selection.endX=r.x,this.selection.endY=r.y,this.callbacks.onSelectionChange?.(this.selection)),this.isDrawing&&(this.mode==="draw"?this.callbacks.onDraw?.(r.x,r.y):this.mode==="erase"&&this.callbacks.onErase?.(r.x,r.y)),this.isDragging&&this.draggedCreature&&(this.ghostPreview={region:this.draggedCreature.preset.region,x:r.x-this.draggedCreature.offsetX,y:r.y-this.draggedCreature.offsetY})}handleMouseUp(e){if(this.isSelecting&&this.selection){const r={startX:Math.min(this.selection.startX,this.selection.endX),startY:Math.min(this.selection.startY,this.selection.endY),endX:Math.max(this.selection.startX,this.selection.endX),endY:Math.max(this.selection.startY,this.selection.endY)};r.endX>r.startX&&r.endY>r.startY?(this.selection=r,this.callbacks.onSelectionComplete?.(r)):this.selection=null,this.callbacks.onSelectionChange?.(this.selection)}this.isSelecting=!1,this.isDrawing=!1}handleMouseLeave(e){this.isSelecting&&(this.isSelecting=!1,this.selection=null,this.callbacks.onSelectionChange?.(null)),this.isDrawing=!1,this.ghostPreview=null}handleKeyDown(e){const r=e.target;r.tagName==="INPUT"||r.tagName==="TEXTAREA"||(e.key==="v"||e.key==="Escape"?this.setMode("view"):e.key==="s"?this.setMode("select"):e.key==="d"?this.setMode("draw"):e.key==="e"&&this.setMode("erase"),e.key==="["?(this.setBrushSize(this.brushSize-1),this.callbacks.onBrushSizeChange?.(this.brushSize)):e.key==="]"&&(this.setBrushSize(this.brushSize+1),this.callbacks.onBrushSizeChange?.(this.brushSize)))}getSimCoords(e){const r=this.canvas.getBoundingClientRect(),n=e.clientX-r.left,i=e.clientY-r.top,s=this.simulation.getWidth(),a=this.simulation.getHeight();return{x:Math.floor(n/r.width*s),y:Math.floor(i/r.height*a)}}getBrushSize(){return this.brushSize}getBrushIntensity(){return this.brushIntensity}}var Sa=I('<div class="simulation-view svelte-145nxqv"><div class="canvas-frame svelte-145nxqv"><div class="canvas-header svelte-145nxqv"><span class="dim-label svelte-145nxqv"> </span></div> <div class="canvas-container svelte-145nxqv"><canvas class="svelte-145nxqv"></canvas> <div class="corner-marker top-left svelte-145nxqv"></div> <div class="corner-marker top-right svelte-145nxqv"></div> <div class="corner-marker bottom-left svelte-145nxqv"></div> <div class="corner-marker bottom-right svelte-145nxqv"></div> <div class="canvas-scanlines svelte-145nxqv"></div></div></div></div>');function xa(t,e){Ve(e,!1);const r=()=>q(gt,"$settings",a),n=()=>q(J,"$simulationStore",a),i=()=>q(Kt,"$currentScheme",a),s=()=>q(Gn,"$renderTrigger",a),[a,l]=Dt();let o=fe(),c=fe(),f=fe(null),h=fe(null);const u=512;Tr(()=>{const y=hr();!y||!p(c)||(Xr.set(p(c)),z(f,new wa(p(c),{colorScheme:r().colorScheme,showGrid:r().showGrid,showSelection:r().showSelection,brushSize:r().brushSize,brushIntensity:r().brushIntensity,backend:n().backend})),z(h,new ya(p(c),y,p(f),{onSelectionChange:()=>d(),onSelectionComplete:()=>{},onDrop:(m,S,E)=>{y.placeRegion(m.region,S,E),d()},onDraw:(m,S)=>{y.drawAt(m,S,r().brushSize,r().brushIntensity),d()},onErase:(m,S)=>{y.eraseAt(m,S,r().brushSize),d()},onModeChange:()=>{},onBrushSizeChange:()=>{}})),pr.set(p(h)),d())}),vi(()=>{pr.set(null),Xr.set(null),z(f,null),z(h,null)});function d(){if(!p(f))return;const y=hr();if(!y)return;const m=y.getState(),S=p(h)?.getSelection(),E=p(h)?.getGhostPreview();p(f).render(m,S,E)}Pe(()=>(n(),p(f)),()=>{n().state&&p(f)&&d()}),Pe(()=>(p(h),r()),()=>{p(h)&&r().mode&&p(h).setMode(r().mode)}),Pe(()=>(p(h),r()),()=>{p(h)&&(p(h).setBrushSize(r().brushSize),p(h).setBrushIntensity(r().brushIntensity))}),Pe(()=>(p(f),r()),()=>{p(f)&&r().colorScheme&&(p(f).updateSettings({colorScheme:r().colorScheme}),d())}),Pe(()=>(p(f),i()),()=>{p(f)&&i()&&(p(f).setThemeColors({primary:i().colors.primary,secondary:i().colors.secondary,tertiary:i().colors.tertiary}),d())}),Pe(()=>(s(),p(f)),()=>{s()&&p(f)&&d()}),Mr(),Vt();var g=Sa(),w=b(g),v=b(w),_=b(v),k=b(_),x=M(v,2),C=b(x);ke(C,"width",u),ke(C,"height",u),cr(C,y=>z(c,y),()=>p(c)),cr(x,y=>z(o,y),()=>p(o)),j(()=>G(k,`${n(),L(()=>n().config.width)??""}x${n(),L(()=>n().config.height)??""}`)),T(t,g),Ke(),l()}var Ea=I('<div class="loading-screen svelte-1n46o8q"><div class="loading-content svelte-1n46o8q"><div class="glitch-text svelte-1n46o8q" data-text="FLOW_LENIA">FLOW_LENIA</div> <div class="loading-status svelte-1n46o8q"><span class="animate-pulse">INITIALIZING SUBSTRATE</span> <span class="animate-blink">_</span></div></div></div>'),Ma=I('<div class="error-screen svelte-1n46o8q"><div class="error-content svelte-1n46o8q"><div class="error-title svelte-1n46o8q">SYSTEM FAILURE</div> <div class="error-message svelte-1n46o8q"> </div> <div class="error-hint svelte-1n46o8q">Ensure WASM is built: <code class="svelte-1n46o8q">wasm-pack build --target web --release</code></div></div></div>'),Ca=I('<div class="scanlines"></div>'),ka=I('<div class="app-container svelte-1n46o8q"><!> <div class="main-content svelte-1n46o8q"><!> <!> <!></div> <!></div> <!> <div class="vignette"></div>',1);function Aa(t,e){Ve(e,!1);const r=()=>q(J,"$simulationStore",s),n=()=>q(Kt,"$currentScheme",s),i=()=>q(gt,"$settings",s),[s,a]=Dt();let l=fe(!1),o=fe(null),c=fe(),f=fe("");function h(v,_){const k=parseInt(v.slice(1,3),16),x=parseInt(v.slice(3,5),16),C=parseInt(v.slice(5,7),16);return`rgba(${k}, ${x}, ${C}, ${_})`}Tr(async()=>{Li(),U("SYS.BOOT","info"),U("Loading WASM module...","info");try{await yi(),z(l,!0),U("WASM initialized","success"),U(`Backend: ${r().backend.toUpperCase()}`,"info"),U(`Theme: ${n().name}`,"info"),r().gpuAvailable?U("WebGPU available","success"):U("WebGPU not available","warn"),U("SYSTEM READY","success")}catch(v){z(o,String(v)),U(`INIT FAILED: ${v}`,"error")}}),Pe(()=>(r(),n()),()=>{const{width:v,height:_}=r().config,k=Math.max(1,v*_),x=r().totalMass/k,y=.15+Math.min(1,Math.max(0,x))*.45,m=n().colors;z(f,[`--color-primary-glow: ${h(m.primary,y)}`,`--color-secondary-glow: ${h(m.secondary,y)}`,`--color-tertiary-glow: ${h(m.tertiary,y)}`].join("; "))}),Mr(),Vt();var u=Br(),d=at(u);{var g=v=>{var _=Ea();T(v,_)},w=v=>{var _=Br(),k=at(_);{var x=y=>{var m=Ma(),S=b(m),E=M(b(S),2),$=b(E);j(()=>G($,p(o))),T(y,m)},C=y=>{var m=ka(),S=at(m),E=b(S);Ni(E,{});var $=M(E,2),A=b($);ta(A,{});var Y=M(A,2);xa(Y,{});var R=M(Y,2);ba(R,{});var V=M($,2);Bi(V),cr(S,ie=>z(c,ie),()=>p(c));var O=M(S,2);{var se=ie=>{var Ne=Ca();T(ie,Ne)};ue(O,ie=>{i(),L(()=>i().showScanlines)&&ie(se)})}j(()=>Rn(S,p(f))),T(y,m)};ue(k,y=>{p(o)?y(x):y(C,!1)},!0)}T(v,_)};ue(d,v=>{!p(l)&&!p(o)?v(g):v(w,!1)})}T(t,u),Ke(),a()}Ks(Aa,{target:document.getElementById("app")});
