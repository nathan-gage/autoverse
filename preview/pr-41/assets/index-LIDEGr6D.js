(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))n(a);new MutationObserver(a=>{for(const s of a)if(s.type==="childList")for(const i of s.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&n(i)}).observe(document,{childList:!0,subtree:!0});function r(a){const s={};return a.integrity&&(s.integrity=a.integrity),a.referrerPolicy&&(s.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?s.credentials="include":a.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function n(a){if(a.ep)return;a.ep=!0;const s=r(a);fetch(a.href,s)}})();const Lr=!1;var Vr=Array.isArray,ks=Array.prototype.indexOf,pr=Array.from,Cn=Object.defineProperty,wt=Object.getOwnPropertyDescriptor,Tn=Object.getOwnPropertyDescriptors,As=Object.prototype,$s=Array.prototype,Jr=Object.getPrototypeOf,un=Object.isExtensible;const Oe=()=>{};function Is(e){return e()}function or(e){for(var t=0;t<e.length;t++)e[t]()}function kn(){var e,t,r=new Promise((n,a)=>{e=n,t=a});return{promise:r,resolve:e,reject:t}}const Q=2,Kr=4,gr=8,Ds=1<<24,Ge=16,Be=32,dt=64,_r=128,we=512,K=1024,le=2048,ye=4096,fe=8192,Re=16384,Zr=32768,ot=65536,fn=1<<17,An=1<<18,Mt=1<<19,$n=1<<20,Le=1<<25,lt=32768,Or=1<<21,Qr=1<<22,Je=1<<23,Ne=Symbol("$state"),Ps=Symbol("legacy props"),Ls=Symbol(""),mt=new class extends Error{name="StaleReactionError";message="The reaction that called `getAbortSignal()` was re-run or destroyed"};function In(e){throw new Error("https://svelte.dev/e/lifecycle_outside_component")}function Os(){throw new Error("https://svelte.dev/e/async_derived_orphan")}function Rs(e){throw new Error("https://svelte.dev/e/effect_in_teardown")}function Ns(){throw new Error("https://svelte.dev/e/effect_in_unowned_derived")}function Fs(e){throw new Error("https://svelte.dev/e/effect_orphan")}function zs(){throw new Error("https://svelte.dev/e/effect_update_depth_exceeded")}function Gs(e){throw new Error("https://svelte.dev/e/props_invalid_value")}function Bs(){throw new Error("https://svelte.dev/e/state_descriptors_fixed")}function Us(){throw new Error("https://svelte.dev/e/state_prototype_fixed")}function Ys(){throw new Error("https://svelte.dev/e/state_unsafe_mutation")}function js(){throw new Error("https://svelte.dev/e/svelte_boundary_reset_onerror")}const qs=1,Xs=2,Dn=4,Ws=8,Hs=16,Vs=1,Js=2,Ks=4,Zs=8,Qs=16,ea=1,ta=2,te=Symbol(),ra="http://www.w3.org/1999/xhtml";function na(){console.warn("https://svelte.dev/e/select_multiple_invalid_value")}function sa(){console.warn("https://svelte.dev/e/svelte_boundary_reset_noop")}function Pn(e){return e===this.v}function Ln(e,t){return e!=e?t==t:e!==t||e!==null&&typeof e=="object"||typeof e=="function"}function On(e){return!Ln(e,this.v)}let Ct=!1,aa=!1;function ia(){Ct=!0}let j=null;function yt(e){j=e}function et(e,t=!1,r){j={p:j,i:!1,c:null,e:null,s:e,x:null,l:Ct&&!t?{s:null,u:null,$:[]}:null}}function tt(e){var t=j,r=t.e;if(r!==null){t.e=null;for(var n of r)Kn(n)}return t.i=!0,j=t.p,{}}function Ht(){return!Ct||j!==null&&j.l===null}let nt=[];function Rn(){var e=nt;nt=[],or(e)}function Tt(e){if(nt.length===0&&!Gt){var t=nt;queueMicrotask(()=>{t===nt&&Rn()})}nt.push(e)}function oa(){for(;nt.length>0;)Rn()}function Nn(e){var t=R;if(t===null)return P.f|=Je,e;if((t.f&Zr)===0){if((t.f&_r)===0)throw e;t.b.error(e)}else xt(e,t)}function xt(e,t){for(;t!==null;){if((t.f&_r)!==0)try{t.b.error(e);return}catch(r){e=r}t=t.parent}throw e}const er=new Set;let L=null,zt=null,pe=null,ve=[],mr=null,Rr=!1,Gt=!1;class Se{committed=!1;current=new Map;previous=new Map;#e=new Set;#t=new Set;#n=0;#r=0;#l=null;#a=new Set;#s=new Set;skipped_effects=new Set;is_fork=!1;is_deferred(){return this.is_fork||this.#r>0}process(t){ve=[],zt=null,this.apply();var r={parent:null,effect:null,effects:[],render_effects:[]};for(const n of t)this.#i(n,r);this.is_fork||this.#u(),this.is_deferred()?(this.#o(r.effects),this.#o(r.render_effects)):(zt=this,L=null,dn(r.render_effects),dn(r.effects),zt=null,this.#l?.resolve()),pe=null}#i(t,r){t.f^=K;for(var n=t.first;n!==null;){var a=n.f,s=(a&(Be|dt))!==0,i=s&&(a&K)!==0,l=i||(a&fe)!==0||this.skipped_effects.has(n);if((n.f&_r)!==0&&n.b?.is_pending()&&(r={parent:r,effect:n,effects:[],render_effects:[]}),!l&&n.fn!==null){s?n.f^=K:(a&Kr)!==0?r.effects.push(n):kt(n)&&((n.f&Ge)!==0&&this.#a.add(n),St(n));var o=n.first;if(o!==null){n=o;continue}}var c=n.parent;for(n=n.next;n===null&&c!==null;)c===r.effect&&(this.#o(r.effects),this.#o(r.render_effects),r=r.parent),n=c.next,c=c.parent}}#o(t){for(const r of t)(r.f&le)!==0?this.#a.add(r):(r.f&ye)!==0&&this.#s.add(r),this.#c(r.deps),Z(r,K)}#c(t){if(t!==null)for(const r of t)(r.f&Q)===0||(r.f&lt)===0||(r.f^=lt,this.#c(r.deps))}capture(t,r){this.previous.has(t)||this.previous.set(t,r),(t.f&Je)===0&&(this.current.set(t,t.v),pe?.set(t,t.v))}activate(){L=this,this.apply()}deactivate(){L===this&&(L=null,pe=null)}flush(){if(this.activate(),ve.length>0){if(Fn(),L!==null&&L!==this)return}else this.#n===0&&this.process([]);this.deactivate()}discard(){for(const t of this.#t)t(this);this.#t.clear()}#u(){if(this.#r===0){for(const t of this.#e)t();this.#e.clear()}this.#n===0&&this.#f()}#f(){if(er.size>1){this.previous.clear();var t=pe,r=!0,n={parent:null,effect:null,effects:[],render_effects:[]};for(const s of er){if(s===this){r=!1;continue}const i=[];for(const[o,c]of this.current){if(s.current.has(o))if(r&&c!==s.current.get(o))s.current.set(o,c);else continue;i.push(o)}if(i.length===0)continue;const l=[...s.current.keys()].filter(o=>!this.current.has(o));if(l.length>0){var a=ve;ve=[];const o=new Set,c=new Map;for(const u of i)zn(u,l,o,c);if(ve.length>0){L=s,s.apply();for(const u of ve)s.#i(u,n);s.deactivate()}ve=a}}L=null,pe=t}this.committed=!0,er.delete(this)}increment(t){this.#n+=1,t&&(this.#r+=1)}decrement(t){this.#n-=1,t&&(this.#r-=1),this.revive()}revive(){for(const t of this.#a)this.#s.delete(t),Z(t,le),ct(t);for(const t of this.#s)Z(t,ye),ct(t);this.flush()}oncommit(t){this.#e.add(t)}ondiscard(t){this.#t.add(t)}settled(){return(this.#l??=kn()).promise}static ensure(){if(L===null){const t=L=new Se;er.add(L),Gt||Se.enqueue(()=>{L===t&&t.flush()})}return L}static enqueue(t){Tt(t)}apply(){}}function la(e){var t=Gt;Gt=!0;try{for(var r;;){if(oa(),ve.length===0&&(L?.flush(),ve.length===0))return mr=null,r;Fn()}}finally{Gt=t}}function Fn(){var e=at;Rr=!0;var t=null;try{var r=0;for(cr(!0);ve.length>0;){var n=Se.ensure();if(r++>1e3){var a,s;ca()}n.process(ve),Ke.clear()}}finally{Rr=!1,cr(e),mr=null}}function ca(){try{zs()}catch(e){xt(e,mr)}}let De=null;function dn(e){var t=e.length;if(t!==0){for(var r=0;r<t;){var n=e[r++];if((n.f&(Re|fe))===0&&kt(n)&&(De=new Set,St(n),n.deps===null&&n.first===null&&n.nodes===null&&(n.teardown===null&&n.ac===null?rs(n):n.fn=null),De?.size>0)){Ke.clear();for(const a of De){if((a.f&(Re|fe))!==0)continue;const s=[a];let i=a.parent;for(;i!==null;)De.has(i)&&(De.delete(i),s.push(i)),i=i.parent;for(let l=s.length-1;l>=0;l--){const o=s[l];(o.f&(Re|fe))===0&&St(o)}}De.clear()}}De=null}}function zn(e,t,r,n){if(!r.has(e)&&(r.add(e),e.reactions!==null))for(const a of e.reactions){const s=a.f;(s&Q)!==0?zn(a,t,r,n):(s&(Qr|Ge))!==0&&(s&le)===0&&Gn(a,t,n)&&(Z(a,le),ct(a))}}function Gn(e,t,r){const n=r.get(e);if(n!==void 0)return n;if(e.deps!==null)for(const a of e.deps){if(t.includes(a))return!0;if((a.f&Q)!==0&&Gn(a,t,r))return r.set(a,!0),!0}return r.set(e,!1),!1}function ct(e){for(var t=mr=e;t.parent!==null;){t=t.parent;var r=t.f;if(Rr&&t===R&&(r&Ge)!==0&&(r&An)===0)return;if((r&(dt|Be))!==0){if((r&K)===0)return;t.f^=K}}ve.push(t)}function ua(e){let t=0,r=ut(0),n;return()=>{jt()&&(h(r),Jt(()=>(t===0&&(n=$(()=>e(()=>Bt(r)))),t+=1,()=>{Tt(()=>{t-=1,t===0&&(n?.(),n=void 0,Bt(r))})})))}}var fa=ot|Mt|_r;function da(e,t,r){new va(e,t,r)}class va{parent;#e=!1;#t;#n=null;#r;#l;#a;#s=null;#i=null;#o=null;#c=null;#u=null;#f=0;#d=0;#h=!1;#v=null;#b=ua(()=>(this.#v=ut(this.#f),()=>{this.#v=null}));constructor(t,r,n){this.#t=t,this.#r=r,this.#l=n,this.parent=R.b,this.#e=!!this.#r.pending,this.#a=Sr(()=>{R.b=this;{var a=this.#_();try{this.#s=he(()=>n(a))}catch(s){this.error(s)}this.#d>0?this.#g():this.#e=!1}return()=>{this.#u?.remove()}},fa)}#w(){try{this.#s=he(()=>this.#l(this.#t))}catch(t){this.error(t)}this.#e=!1}#y(){const t=this.#r.pending;t&&(this.#i=he(()=>t(this.#t)),Se.enqueue(()=>{var r=this.#_();this.#s=this.#p(()=>(Se.ensure(),he(()=>this.#l(r)))),this.#d>0?this.#g():(st(this.#i,()=>{this.#i=null}),this.#e=!1)}))}#_(){var t=this.#t;return this.#e&&(this.#u=Ze(),this.#t.before(this.#u),t=this.#u),t}is_pending(){return this.#e||!!this.parent&&this.parent.is_pending()}has_pending_snippet(){return!!this.#r.pending}#p(t){var r=R,n=P,a=j;Me(this.#a),ie(this.#a),yt(this.#a.ctx);try{return t()}catch(s){return Nn(s),null}finally{Me(r),ie(n),yt(a)}}#g(){const t=this.#r.pending;this.#s!==null&&(this.#c=document.createDocumentFragment(),this.#c.append(this.#u),as(this.#s,this.#c)),this.#i===null&&(this.#i=he(()=>t(this.#t)))}#m(t){if(!this.has_pending_snippet()){this.parent&&this.parent.#m(t);return}this.#d+=t,this.#d===0&&(this.#e=!1,this.#i&&st(this.#i,()=>{this.#i=null}),this.#c&&(this.#t.before(this.#c),this.#c=null))}update_pending_count(t){this.#m(t),this.#f+=t,this.#v&&ft(this.#v,this.#f)}get_effect_pending(){return this.#b(),h(this.#v)}error(t){var r=this.#r.onerror;let n=this.#r.failed;if(this.#h||!r&&!n)throw t;this.#s&&(oe(this.#s),this.#s=null),this.#i&&(oe(this.#i),this.#i=null),this.#o&&(oe(this.#o),this.#o=null);var a=!1,s=!1;const i=()=>{if(a){sa();return}a=!0,s&&js(),Se.ensure(),this.#f=0,this.#o!==null&&st(this.#o,()=>{this.#o=null}),this.#e=this.has_pending_snippet(),this.#s=this.#p(()=>(this.#h=!1,he(()=>this.#l(this.#t)))),this.#d>0?this.#g():this.#e=!1};var l=P;try{ie(null),s=!0,r?.(t,i),s=!1}catch(o){xt(o,this.#a&&this.#a.parent)}finally{ie(l)}n&&Tt(()=>{this.#o=this.#p(()=>{Se.ensure(),this.#h=!0;try{return he(()=>{n(this.#t,()=>t,()=>i)})}catch(o){return xt(o,this.#a.parent),null}finally{this.#h=!1}})})}}function ha(e,t,r,n){const a=Ht()?br:en;if(r.length===0&&e.length===0){n(t.map(a));return}var s=L,i=R,l=pa();function o(){Promise.all(r.map(c=>ga(c))).then(c=>{l();try{n([...t.map(a),...c])}catch(u){(i.f&Re)===0&&xt(u,i)}s?.deactivate(),lr()}).catch(c=>{xt(c,i)})}e.length>0?Promise.all(e).then(()=>{l();try{return o()}finally{s?.deactivate(),lr()}}):o()}function pa(){var e=R,t=P,r=j,n=L;return function(s=!0){Me(e),ie(t),yt(r),s&&n?.activate()}}function lr(){Me(null),ie(null),yt(null)}function br(e){var t=Q|le,r=P!==null&&(P.f&Q)!==0?P:null;return R!==null&&(R.f|=Mt),{ctx:j,deps:null,effects:null,equals:Pn,f:t,fn:e,reactions:null,rv:0,v:te,wv:0,parent:r??R,ac:null}}function ga(e,t){let r=R;r===null&&Os();var n=r.b,a=void 0,s=ut(te),i=!P,l=new Map;return Ta(()=>{var o=kn();a=o.promise;try{Promise.resolve(e()).then(o.resolve,o.reject).then(()=>{c===L&&c.committed&&c.deactivate(),lr()})}catch(f){o.reject(f),lr()}var c=L;if(i){var u=!n.is_pending();n.update_pending_count(1),c.increment(u),l.get(c)?.reject(mt),l.delete(c),l.set(c,o)}const d=(f,v=void 0)=>{if(c.activate(),v)v!==mt&&(s.f|=Je,ft(s,v));else{(s.f&Je)!==0&&(s.f^=Je),ft(s,f);for(const[_,x]of l){if(l.delete(_),_===c)break;x.reject(mt)}}i&&(n.update_pending_count(-1),c.decrement(u))};o.promise.then(d,f=>d(null,f||"unknown"))}),yr(()=>{for(const o of l.values())o.reject(mt)}),new Promise(o=>{function c(u){function d(){u===a?o(s):c(a)}u.then(d,d)}c(a)})}function en(e){const t=br(e);return t.equals=On,t}function Bn(e){var t=e.effects;if(t!==null){e.effects=null;for(var r=0;r<t.length;r+=1)oe(t[r])}}function _a(e){for(var t=e.parent;t!==null;){if((t.f&Q)===0)return(t.f&Re)===0?t:null;t=t.parent}return null}function tn(e){var t,r=R;Me(_a(e));try{e.f&=~lt,Bn(e),t=cs(e)}finally{Me(r)}return t}function Un(e){var t=tn(e);if(e.equals(t)||(L?.is_fork||(e.v=t),e.wv=os()),!vt)if(pe!==null)(jt()||L?.is_fork)&&pe.set(e,t);else{var r=(e.f&we)===0?ye:K;Z(e,r)}}let Nr=new Set;const Ke=new Map;let Yn=!1;function ut(e,t){var r={f:0,v:e,reactions:null,equals:Pn,rv:0,wv:0};return r}function Ie(e,t){const r=ut(e);return Ia(r),r}function V(e,t=!1,r=!0){const n=ut(e);return t||(n.equals=On),Ct&&r&&j!==null&&j.l!==null&&(j.l.s??=[]).push(n),n}function ma(e,t){return N(e,$(()=>h(e))),t}function N(e,t,r=!1){P!==null&&(!Ee||(P.f&fn)!==0)&&Ht()&&(P.f&(Q|Ge|Qr|fn))!==0&&!Fe?.includes(e)&&Ys();let n=r?bt(t):t;return ft(e,n)}function ft(e,t){if(!e.equals(t)){var r=e.v;vt?Ke.set(e,t):Ke.set(e,r),e.v=t;var n=Se.ensure();n.capture(e,r),(e.f&Q)!==0&&((e.f&le)!==0&&tn(e),Z(e,(e.f&we)!==0?K:ye)),e.wv=os(),jn(e,le),Ht()&&R!==null&&(R.f&K)!==0&&(R.f&(Be|dt))===0&&(de===null?Da([e]):de.push(e)),!n.is_fork&&Nr.size>0&&!Yn&&ba()}return t}function ba(){Yn=!1;var e=at;cr(!0);const t=Array.from(Nr);try{for(const r of t)(r.f&K)!==0&&Z(r,ye),kt(r)&&St(r)}finally{cr(e)}Nr.clear()}function Bt(e){N(e,e.v+1)}function jn(e,t){var r=e.reactions;if(r!==null)for(var n=Ht(),a=r.length,s=0;s<a;s++){var i=r[s],l=i.f;if(!(!n&&i===R)){var o=(l&le)===0;if(o&&Z(i,t),(l&Q)!==0){var c=i;pe?.delete(c),(l&lt)===0&&(l&we&&(i.f|=lt),jn(c,ye))}else o&&((l&Ge)!==0&&De!==null&&De.add(i),ct(i))}}}function bt(e){if(typeof e!="object"||e===null||Ne in e)return e;const t=Jr(e);if(t!==As&&t!==$s)return e;var r=new Map,n=Vr(e),a=Ie(0),s=it,i=l=>{if(it===s)return l();var o=P,c=it;ie(null),_n(s);var u=l();return ie(o),_n(c),u};return n&&r.set("length",Ie(e.length)),new Proxy(e,{defineProperty(l,o,c){(!("value"in c)||c.configurable===!1||c.enumerable===!1||c.writable===!1)&&Bs();var u=r.get(o);return u===void 0?u=i(()=>{var d=Ie(c.value);return r.set(o,d),d}):N(u,c.value,!0),!0},deleteProperty(l,o){var c=r.get(o);if(c===void 0){if(o in l){const u=i(()=>Ie(te));r.set(o,u),Bt(a)}}else N(c,te),Bt(a);return!0},get(l,o,c){if(o===Ne)return e;var u=r.get(o),d=o in l;if(u===void 0&&(!d||wt(l,o)?.writable)&&(u=i(()=>{var v=bt(d?l[o]:te),_=Ie(v);return _}),r.set(o,u)),u!==void 0){var f=h(u);return f===te?void 0:f}return Reflect.get(l,o,c)},getOwnPropertyDescriptor(l,o){var c=Reflect.getOwnPropertyDescriptor(l,o);if(c&&"value"in c){var u=r.get(o);u&&(c.value=h(u))}else if(c===void 0){var d=r.get(o),f=d?.v;if(d!==void 0&&f!==te)return{enumerable:!0,configurable:!0,value:f,writable:!0}}return c},has(l,o){if(o===Ne)return!0;var c=r.get(o),u=c!==void 0&&c.v!==te||Reflect.has(l,o);if(c!==void 0||R!==null&&(!u||wt(l,o)?.writable)){c===void 0&&(c=i(()=>{var f=u?bt(l[o]):te,v=Ie(f);return v}),r.set(o,c));var d=h(c);if(d===te)return!1}return u},set(l,o,c,u){var d=r.get(o),f=o in l;if(n&&o==="length")for(var v=c;v<d.v;v+=1){var _=r.get(v+"");_!==void 0?N(_,te):v in l&&(_=i(()=>Ie(te)),r.set(v+"",_))}if(d===void 0)(!f||wt(l,o)?.writable)&&(d=i(()=>Ie(void 0)),N(d,bt(c)),r.set(o,d));else{f=d.v!==te;var x=i(()=>bt(c));N(d,x)}var p=Reflect.getOwnPropertyDescriptor(l,o);if(p?.set&&p.set.call(u,c),!f){if(n&&typeof o=="string"){var b=r.get("length"),A=Number(o);Number.isInteger(A)&&A>=b.v&&N(b,A+1)}Bt(a)}return!0},ownKeys(l){h(a);var o=Reflect.ownKeys(l).filter(d=>{var f=r.get(d);return f===void 0||f.v!==te});for(var[c,u]of r)u.v!==te&&!(c in l)&&o.push(c);return o},setPrototypeOf(){Us()}})}function vn(e){try{if(e!==null&&typeof e=="object"&&Ne in e)return e[Ne]}catch{}return e}function wa(e,t){return Object.is(vn(e),vn(t))}var hn,qn,Xn,Wn;function ya(){if(hn===void 0){hn=window,qn=/Firefox/.test(navigator.userAgent);var e=Element.prototype,t=Node.prototype,r=Text.prototype;Xn=wt(t,"firstChild").get,Wn=wt(t,"nextSibling").get,un(e)&&(e.__click=void 0,e.__className=void 0,e.__attributes=null,e.__style=void 0,e.__e=void 0),un(r)&&(r.__t=void 0)}}function Ze(e=""){return document.createTextNode(e)}function He(e){return Xn.call(e)}function Vt(e){return Wn.call(e)}function g(e,t){return He(e)}function Qe(e,t=!1){{var r=He(e);return r instanceof Comment&&r.data===""?Vt(r):r}}function w(e,t=1,r=!1){let n=e;for(;t--;)n=Vt(n);return n}function xa(e){e.textContent=""}function Hn(){return!1}let pn=!1;function Sa(){pn||(pn=!0,document.addEventListener("reset",e=>{Promise.resolve().then(()=>{if(!e.defaultPrevented)for(const t of e.target.elements)t.__on_r?.()})},{capture:!0}))}function wr(e){var t=P,r=R;ie(null),Me(null);try{return e()}finally{ie(t),Me(r)}}function Vn(e,t,r,n=r){e.addEventListener(t,()=>wr(r));const a=e.__on_r;a?e.__on_r=()=>{a(),n(!0)}:e.__on_r=()=>n(!0),Sa()}function Jn(e){R===null&&(P===null&&Fs(),Ns()),vt&&Rs()}function Ea(e,t){var r=t.last;r===null?t.last=t.first=e:(r.next=e,e.prev=r,t.last=e)}function Ce(e,t,r){var n=R;n!==null&&(n.f&fe)!==0&&(e|=fe);var a={ctx:j,deps:null,nodes:null,f:e|le|we,first:null,fn:t,last:null,next:null,parent:n,b:n&&n.b,prev:null,teardown:null,wv:0,ac:null};if(r)try{St(a),a.f|=Zr}catch(l){throw oe(a),l}else t!==null&&ct(a);var s=a;if(r&&s.deps===null&&s.teardown===null&&s.nodes===null&&s.first===s.last&&(s.f&Mt)===0&&(s=s.first,(e&Ge)!==0&&(e&ot)!==0&&s!==null&&(s.f|=ot)),s!==null&&(s.parent=n,n!==null&&Ea(s,n),P!==null&&(P.f&Q)!==0&&(e&dt)===0)){var i=P;(i.effects??=[]).push(s)}return a}function jt(){return P!==null&&!Ee}function yr(e){const t=Ce(gr,null,!1);return Z(t,K),t.teardown=e,t}function Fr(e){Jn();var t=R.f,r=!P&&(t&Be)!==0&&(t&Zr)===0;if(r){var n=j;(n.e??=[]).push(e)}else return Kn(e)}function Kn(e){return Ce(Kr|$n,e,!1)}function Ma(e){return Jn(),Ce(gr|$n,e,!0)}function Ca(e){Se.ensure();const t=Ce(dt|Mt,e,!0);return(r={})=>new Promise(n=>{r.outro?st(t,()=>{oe(t),n(void 0)}):(oe(t),n(void 0))})}function Zn(e){return Ce(Kr,e,!1)}function Pe(e,t){var r=j,n={effect:null,ran:!1,deps:e};r.l.$.push(n),n.effect=Jt(()=>{e(),!n.ran&&(n.ran=!0,$(t))})}function xr(){var e=j;Jt(()=>{for(var t of e.l.$){t.deps();var r=t.effect;(r.f&K)!==0&&Z(r,ye),kt(r)&&St(r),t.ran=!1}})}function Ta(e){return Ce(Qr|Mt,e,!0)}function Jt(e,t=0){return Ce(gr|t,e,!0)}function X(e,t=[],r=[],n=[]){ha(n,t,r,a=>{Ce(gr,()=>e(...a.map(h)),!0)})}function Sr(e,t=0){var r=Ce(Ge|t,e,!0);return r}function he(e){return Ce(Be|Mt,e,!0)}function Qn(e){var t=e.teardown;if(t!==null){const r=vt,n=P;gn(!0),ie(null);try{t.call(null)}finally{gn(r),ie(n)}}}function es(e,t=!1){var r=e.first;for(e.first=e.last=null;r!==null;){const a=r.ac;a!==null&&wr(()=>{a.abort(mt)});var n=r.next;(r.f&dt)!==0?r.parent=null:oe(r,t),r=n}}function ka(e){for(var t=e.first;t!==null;){var r=t.next;(t.f&Be)===0&&oe(t),t=r}}function oe(e,t=!0){var r=!1;(t||(e.f&An)!==0)&&e.nodes!==null&&e.nodes.end!==null&&(ts(e.nodes.start,e.nodes.end),r=!0),es(e,t&&!r),ur(e,0),Z(e,Re);var n=e.nodes&&e.nodes.t;if(n!==null)for(const s of n)s.stop();Qn(e);var a=e.parent;a!==null&&a.first!==null&&rs(e),e.next=e.prev=e.teardown=e.ctx=e.deps=e.fn=e.nodes=e.ac=null}function ts(e,t){for(;e!==null;){var r=e===t?null:Vt(e);e.remove(),e=r}}function rs(e){var t=e.parent,r=e.prev,n=e.next;r!==null&&(r.next=n),n!==null&&(n.prev=r),t!==null&&(t.first===e&&(t.first=n),t.last===e&&(t.last=r))}function st(e,t,r=!0){var n=[];ns(e,n,!0);var a=()=>{r&&oe(e),t&&t()},s=n.length;if(s>0){var i=()=>--s||a();for(var l of n)l.out(i)}else a()}function ns(e,t,r){if((e.f&fe)===0){e.f^=fe;var n=e.nodes&&e.nodes.t;if(n!==null)for(const l of n)(l.is_global||r)&&t.push(l);for(var a=e.first;a!==null;){var s=a.next,i=(a.f&ot)!==0||(a.f&Be)!==0&&(e.f&Ge)!==0;ns(a,t,i?r:!1),a=s}}}function rn(e){ss(e,!0)}function ss(e,t){if((e.f&fe)!==0){e.f^=fe,(e.f&K)===0&&(Z(e,le),ct(e));for(var r=e.first;r!==null;){var n=r.next,a=(r.f&ot)!==0||(r.f&Be)!==0;ss(r,a?t:!1),r=n}var s=e.nodes&&e.nodes.t;if(s!==null)for(const i of s)(i.is_global||t)&&i.in()}}function as(e,t){if(e.nodes)for(var r=e.nodes.start,n=e.nodes.end;r!==null;){var a=r===n?null:Vt(r);t.append(r),r=a}}let _t=null;function Aa(e){var t=_t;try{if(_t=new Set,$(e),t!==null)for(var r of _t)t.add(r);return _t}finally{_t=t}}function $a(e){for(var t of Aa(e))ft(t,t.v)}let at=!1;function cr(e){at=e}let vt=!1;function gn(e){vt=e}let P=null,Ee=!1;function ie(e){P=e}let R=null;function Me(e){R=e}let Fe=null;function Ia(e){P!==null&&(Fe===null?Fe=[e]:Fe.push(e))}let re=null,ue=0,de=null;function Da(e){de=e}let is=1,qt=0,it=qt;function _n(e){it=e}function os(){return++is}function kt(e){var t=e.f;if((t&le)!==0)return!0;if(t&Q&&(e.f&=~lt),(t&ye)!==0){var r=e.deps;if(r!==null)for(var n=r.length,a=0;a<n;a++){var s=r[a];if(kt(s)&&Un(s),s.wv>e.wv)return!0}(t&we)!==0&&pe===null&&Z(e,K)}return!1}function ls(e,t,r=!0){var n=e.reactions;if(n!==null&&!Fe?.includes(e))for(var a=0;a<n.length;a++){var s=n[a];(s.f&Q)!==0?ls(s,t,!1):t===s&&(r?Z(s,le):(s.f&K)!==0&&Z(s,ye),ct(s))}}function cs(e){var t=re,r=ue,n=de,a=P,s=Fe,i=j,l=Ee,o=it,c=e.f;re=null,ue=0,de=null,P=(c&(Be|dt))===0?e:null,Fe=null,yt(e.ctx),Ee=!1,it=++qt,e.ac!==null&&(wr(()=>{e.ac.abort(mt)}),e.ac=null);try{e.f|=Or;var u=e.fn,d=u(),f=e.deps;if(re!==null){var v;if(ur(e,ue),f!==null&&ue>0)for(f.length=ue+re.length,v=0;v<re.length;v++)f[ue+v]=re[v];else e.deps=f=re;if(jt()&&(e.f&we)!==0)for(v=ue;v<f.length;v++)(f[v].reactions??=[]).push(e)}else f!==null&&ue<f.length&&(ur(e,ue),f.length=ue);if(Ht()&&de!==null&&!Ee&&f!==null&&(e.f&(Q|ye|le))===0)for(v=0;v<de.length;v++)ls(de[v],e);return a!==null&&a!==e&&(qt++,de!==null&&(n===null?n=de:n.push(...de))),(e.f&Je)!==0&&(e.f^=Je),d}catch(_){return Nn(_)}finally{e.f^=Or,re=t,ue=r,de=n,P=a,Fe=s,yt(i),Ee=l,it=o}}function Pa(e,t){let r=t.reactions;if(r!==null){var n=ks.call(r,e);if(n!==-1){var a=r.length-1;a===0?r=t.reactions=null:(r[n]=r[a],r.pop())}}r===null&&(t.f&Q)!==0&&(re===null||!re.includes(t))&&(Z(t,ye),(t.f&we)!==0&&(t.f^=we,t.f&=~lt),Bn(t),ur(t,0))}function ur(e,t){var r=e.deps;if(r!==null)for(var n=t;n<r.length;n++)Pa(e,r[n])}function St(e){var t=e.f;if((t&Re)===0){Z(e,K);var r=R,n=at;R=e,at=!0;try{(t&(Ge|Ds))!==0?ka(e):es(e),Qn(e);var a=cs(e);e.teardown=typeof a=="function"?a:null,e.wv=is;var s;Lr&&aa&&(e.f&le)!==0&&e.deps}finally{at=n,R=r}}}async function La(){await Promise.resolve(),la()}function h(e){var t=e.f,r=(t&Q)!==0;if(_t?.add(e),P!==null&&!Ee){var n=R!==null&&(R.f&Re)!==0;if(!n&&!Fe?.includes(e)){var a=P.deps;if((P.f&Or)!==0)e.rv<qt&&(e.rv=qt,re===null&&a!==null&&a[ue]===e?ue++:re===null?re=[e]:re.includes(e)||re.push(e));else{(P.deps??=[]).push(e);var s=e.reactions;s===null?e.reactions=[P]:s.includes(P)||s.push(P)}}}if(vt){if(Ke.has(e))return Ke.get(e);if(r){var i=e,l=i.v;return((i.f&K)===0&&i.reactions!==null||fs(i))&&(l=tn(i)),Ke.set(i,l),l}}else r&&(!pe?.has(e)||L?.is_fork&&!jt())&&(i=e,kt(i)&&Un(i),at&&jt()&&(i.f&we)===0&&us(i));if(pe?.has(e))return pe.get(e);if((e.f&Je)!==0)throw e.v;return e.v}function us(e){if(e.deps!==null){e.f^=we;for(const t of e.deps)(t.reactions??=[]).push(e),(t.f&Q)!==0&&(t.f&we)===0&&us(t)}}function fs(e){if(e.v===te)return!0;if(e.deps===null)return!1;for(const t of e.deps)if(Ke.has(t)||(t.f&Q)!==0&&fs(t))return!0;return!1}function $(e){var t=Ee;try{return Ee=!0,e()}finally{Ee=t}}const Oa=-7169;function Z(e,t){e.f=e.f&Oa|t}function Ra(e){if(!(typeof e!="object"||!e||e instanceof EventTarget)){if(Ne in e)zr(e);else if(!Array.isArray(e))for(let t in e){const r=e[t];typeof r=="object"&&r&&Ne in r&&zr(r)}}}function zr(e,t=new Set){if(typeof e=="object"&&e!==null&&!(e instanceof EventTarget)&&!t.has(e)){t.add(e),e instanceof Date&&e.getTime();for(let n in e)try{zr(e[n],t)}catch{}const r=Jr(e);if(r!==Object.prototype&&r!==Array.prototype&&r!==Map.prototype&&r!==Set.prototype&&r!==Date.prototype){const n=Tn(r);for(let a in n){const s=n[a].get;if(s)try{s.call(e)}catch{}}}}}const Na=["touchstart","touchmove"];function Fa(e){return Na.includes(e)}const ds=new Set,Gr=new Set;function za(e,t,r,n={}){function a(s){if(n.capture||Nt.call(t,s),!s.cancelBubble)return wr(()=>r?.call(this,s))}return e.startsWith("pointer")||e.startsWith("touch")||e==="wheel"?Tt(()=>{t.addEventListener(e,a,n)}):t.addEventListener(e,a,n),a}function Ga(e,t,r,n,a){var s={capture:n,passive:a},i=za(e,t,r,s);(t===document.body||t===window||t===document||t instanceof HTMLMediaElement)&&yr(()=>{t.removeEventListener(e,i,s)})}function Kt(e){for(var t=0;t<e.length;t++)ds.add(e[t]);for(var r of Gr)r(e)}let mn=null;function Nt(e){var t=this,r=t.ownerDocument,n=e.type,a=e.composedPath?.()||[],s=a[0]||e.target;mn=e;var i=0,l=mn===e&&e.__root;if(l){var o=a.indexOf(l);if(o!==-1&&(t===document||t===window)){e.__root=t;return}var c=a.indexOf(t);if(c===-1)return;o<=c&&(i=o)}if(s=a[i]||e.target,s!==t){Cn(e,"currentTarget",{configurable:!0,get(){return s||r}});var u=P,d=R;ie(null),Me(null);try{for(var f,v=[];s!==null;){var _=s.assignedSlot||s.parentNode||s.host||null;try{var x=s["__"+n];x!=null&&(!s.disabled||e.target===s)&&x.call(s,e)}catch(p){f?v.push(p):f=p}if(e.cancelBubble||_===t||_===null)break;s=_}if(f){for(let p of v)queueMicrotask(()=>{throw p});throw f}}finally{e.__root=t,delete e.currentTarget,ie(u),Me(d)}}}function vs(e){var t=document.createElement("template");return t.innerHTML=e.replaceAll("<!>","<!---->"),t.content}function fr(e,t){var r=R;r.nodes===null&&(r.nodes={start:e,end:t,a:null,t:null})}function I(e,t){var r=(t&ea)!==0,n=(t&ta)!==0,a,s=!e.startsWith("<!>");return()=>{a===void 0&&(a=vs(s?e:"<!>"+e),r||(a=He(a)));var i=n||qn?document.importNode(a,!0):a.cloneNode(!0);if(r){var l=He(i),o=i.lastChild;fr(l,o)}else fr(i,i);return i}}function Br(){var e=document.createDocumentFragment(),t=document.createComment(""),r=Ze();return e.append(t,r),fr(t,r),e}function k(e,t){e!==null&&e.before(t)}function Y(e,t){var r=t==null?"":typeof t=="object"?t+"":t;r!==(e.__t??=e.nodeValue)&&(e.__t=r,e.nodeValue=r+"")}function Ba(e,t){return Ua(e,t)}const pt=new Map;function Ua(e,{target:t,anchor:r,props:n={},events:a,context:s,intro:i=!0}){ya();var l=new Set,o=d=>{for(var f=0;f<d.length;f++){var v=d[f];if(!l.has(v)){l.add(v);var _=Fa(v);t.addEventListener(v,Nt,{passive:_});var x=pt.get(v);x===void 0?(document.addEventListener(v,Nt,{passive:_}),pt.set(v,1)):pt.set(v,x+1)}}};o(pr(ds)),Gr.add(o);var c=void 0,u=Ca(()=>{var d=r??t.appendChild(Ze());return da(d,{pending:()=>{}},f=>{if(s){et({});var v=j;v.c=s}a&&(n.$$events=a),c=e(f,n)||{},s&&tt()}),()=>{for(var f of l){t.removeEventListener(f,Nt);var v=pt.get(f);--v===0?(document.removeEventListener(f,Nt),pt.delete(f)):pt.set(f,v)}Gr.delete(o),d!==r&&d.parentNode?.removeChild(d)}});return Ya.set(c,u),c}let Ya=new WeakMap;class hs{anchor;#e=new Map;#t=new Map;#n=new Map;#r=new Set;#l=!0;constructor(t,r=!0){this.anchor=t,this.#l=r}#a=()=>{var t=L;if(this.#e.has(t)){var r=this.#e.get(t),n=this.#t.get(r);if(n)rn(n),this.#r.delete(r);else{var a=this.#n.get(r);a&&(this.#t.set(r,a.effect),this.#n.delete(r),a.fragment.lastChild.remove(),this.anchor.before(a.fragment),n=a.effect)}for(const[s,i]of this.#e){if(this.#e.delete(s),s===t)break;const l=this.#n.get(i);l&&(oe(l.effect),this.#n.delete(i))}for(const[s,i]of this.#t){if(s===r||this.#r.has(s))continue;const l=()=>{if(Array.from(this.#e.values()).includes(s)){var c=document.createDocumentFragment();as(i,c),c.append(Ze()),this.#n.set(s,{effect:i,fragment:c})}else oe(i);this.#r.delete(s),this.#t.delete(s)};this.#l||!n?(this.#r.add(s),st(i,l,!1)):l()}}};#s=t=>{this.#e.delete(t);const r=Array.from(this.#e.values());for(const[n,a]of this.#n)r.includes(n)||(oe(a.effect),this.#n.delete(n))};ensure(t,r){var n=L,a=Hn();if(r&&!this.#t.has(t)&&!this.#n.has(t))if(a){var s=document.createDocumentFragment(),i=Ze();s.append(i),this.#n.set(t,{effect:he(()=>r(i)),fragment:s})}else this.#t.set(t,he(()=>r(this.anchor)));if(this.#e.set(n,t),a){for(const[l,o]of this.#t)l===t?n.skipped_effects.delete(o):n.skipped_effects.add(o);for(const[l,o]of this.#n)l===t?n.skipped_effects.delete(o.effect):n.skipped_effects.add(o.effect);n.oncommit(this.#a),n.ondiscard(this.#s)}else this.#a()}}function ne(e,t,r=!1){var n=new hs(e),a=r?ot:0;function s(i,l){n.ensure(i,l)}Sr(()=>{var i=!1;t((l,o=!0)=>{i=!0,s(o,l)}),i||s(!1,null)},a)}function dr(e,t){return t}function ja(e,t,r){for(var n=[],a=t.length,s,i=t.length,l=0;l<a;l++){let d=t[l];st(d,()=>{if(s){if(s.pending.delete(d),s.done.add(d),s.pending.size===0){var f=e.outrogroups;Ur(pr(s.done)),f.delete(s),f.size===0&&(e.outrogroups=null)}}else i-=1},!1)}if(i===0){var o=n.length===0&&r!==null;if(o){var c=r,u=c.parentNode;xa(u),u.append(c),e.items.clear()}Ur(t,!o)}else s={pending:new Set(t),done:new Set},(e.outrogroups??=new Set).add(s)}function Ur(e,t=!0){for(var r=0;r<e.length;r++)oe(e[r],t)}var bn;function Xt(e,t,r,n,a,s=null){var i=e,l=new Map,o=(t&Dn)!==0;if(o){var c=e;i=c.appendChild(Ze())}var u=null,d=en(()=>{var b=r();return Vr(b)?b:b==null?[]:pr(b)}),f,v=!0;function _(){p.fallback=u,qa(p,f,i,t,n),u!==null&&(f.length===0?(u.f&Le)===0?rn(u):(u.f^=Le,Ft(u,null,i)):st(u,()=>{u=null}))}var x=Sr(()=>{f=h(d);for(var b=f.length,A=new Set,E=L,S=Hn(),y=0;y<b;y+=1){var C=f[y],m=n(C,y),M=v?null:l.get(m);M?(M.v&&ft(M.v,C),M.i&&ft(M.i,y),S&&E.skipped_effects.delete(M.e)):(M=Xa(l,v?i:bn??=Ze(),C,m,y,a,t,r),v||(M.e.f|=Le),l.set(m,M)),A.add(m)}if(b===0&&s&&!u&&(v?u=he(()=>s(i)):(u=he(()=>s(bn??=Ze())),u.f|=Le)),!v)if(S){for(const[D,T]of l)A.has(D)||E.skipped_effects.add(T.e);E.oncommit(_),E.ondiscard(()=>{})}else _();h(d)}),p={effect:x,items:l,outrogroups:null,fallback:u};v=!1}function qa(e,t,r,n,a){var s=(n&Ws)!==0,i=t.length,l=e.items,o=e.effect.first,c,u=null,d,f=[],v=[],_,x,p,b;if(s)for(b=0;b<i;b+=1)_=t[b],x=a(_,b),p=l.get(x).e,(p.f&Le)===0&&(p.nodes?.a?.measure(),(d??=new Set).add(p));for(b=0;b<i;b+=1){if(_=t[b],x=a(_,b),p=l.get(x).e,e.outrogroups!==null)for(const T of e.outrogroups)T.pending.delete(p),T.done.delete(p);if((p.f&Le)!==0)if(p.f^=Le,p===o)Ft(p,null,r);else{var A=u?u.next:o;p===e.effect.last&&(e.effect.last=p.prev),p.prev&&(p.prev.next=p.next),p.next&&(p.next.prev=p.prev),We(e,u,p),We(e,p,A),Ft(p,A,r),u=p,f=[],v=[],o=u.next;continue}if((p.f&fe)!==0&&(rn(p),s&&(p.nodes?.a?.unfix(),(d??=new Set).delete(p))),p!==o){if(c!==void 0&&c.has(p)){if(f.length<v.length){var E=v[0],S;u=E.prev;var y=f[0],C=f[f.length-1];for(S=0;S<f.length;S+=1)Ft(f[S],E,r);for(S=0;S<v.length;S+=1)c.delete(v[S]);We(e,y.prev,C.next),We(e,u,y),We(e,C,E),o=E,u=C,b-=1,f=[],v=[]}else c.delete(p),Ft(p,o,r),We(e,p.prev,p.next),We(e,p,u===null?e.effect.first:u.next),We(e,u,p),u=p;continue}for(f=[],v=[];o!==null&&o!==p;)(c??=new Set).add(o),v.push(o),o=o.next;if(o===null)continue}(p.f&Le)===0&&f.push(p),u=p,o=p.next}if(e.outrogroups!==null){for(const T of e.outrogroups)T.pending.size===0&&(Ur(pr(T.done)),e.outrogroups?.delete(T));e.outrogroups.size===0&&(e.outrogroups=null)}if(o!==null||c!==void 0){var m=[];if(c!==void 0)for(p of c)(p.f&fe)===0&&m.push(p);for(;o!==null;)(o.f&fe)===0&&o!==e.fallback&&m.push(o),o=o.next;var M=m.length;if(M>0){var D=(n&Dn)!==0&&i===0?r:null;if(s){for(b=0;b<M;b+=1)m[b].nodes?.a?.measure();for(b=0;b<M;b+=1)m[b].nodes?.a?.fix()}ja(e,m,D)}}s&&Tt(()=>{if(d!==void 0)for(p of d)p.nodes?.a?.apply()})}function Xa(e,t,r,n,a,s,i,l){var o=(i&qs)!==0?(i&Hs)===0?V(r,!1,!1):ut(r):null,c=(i&Xs)!==0?ut(a):null;return{v:o,i:c,e:he(()=>(s(t,o??r,c??a,l),()=>{e.delete(n)}))}}function Ft(e,t,r){if(e.nodes)for(var n=e.nodes.start,a=e.nodes.end,s=t&&(t.f&Le)===0?t.nodes.start:r;n!==null;){var i=Vt(n);if(s.before(n),n===a)return;n=i}}function We(e,t,r){t===null?e.effect.first=r:t.next=r,r===null?e.effect.last=t:r.prev=t}function Wa(e,t,r=!1,n=!1,a=!1){var s=e,i="";X(()=>{var l=R;if(i!==(i=t()??"")&&(l.nodes!==null&&(ts(l.nodes.start,l.nodes.end),l.nodes=null),i!=="")){var o=i+"";r?o=`<svg>${o}</svg>`:n&&(o=`<math>${o}</math>`);var c=vs(o);if((r||n)&&(c=He(c)),fr(He(c),c.lastChild),r||n)for(;He(c);)s.before(He(c));else s.before(c)}})}function Ha(e,t,...r){var n=new hs(e);Sr(()=>{const a=t()??null;n.ensure(a,a&&(s=>a(s,...r)))},ot)}function ps(e){var t,r,n="";if(typeof e=="string"||typeof e=="number")n+=e;else if(typeof e=="object")if(Array.isArray(e)){var a=e.length;for(t=0;t<a;t++)e[t]&&(r=ps(e[t]))&&(n&&(n+=" "),n+=r)}else for(r in e)e[r]&&(n&&(n+=" "),n+=r);return n}function Va(){for(var e,t,r=0,n="",a=arguments.length;r<a;r++)(e=arguments[r])&&(t=ps(e))&&(n&&(n+=" "),n+=t);return n}function Ja(e){return typeof e=="object"?Va(e):e??""}const wn=[...` 	
\r\f \v\uFEFF`];function Ka(e,t,r){var n=e==null?"":""+e;if(t&&(n=n?n+" "+t:t),r){for(var a in r)if(r[a])n=n?n+" "+a:a;else if(n.length)for(var s=a.length,i=0;(i=n.indexOf(a,i))>=0;){var l=i+s;(i===0||wn.includes(n[i-1]))&&(l===n.length||wn.includes(n[l]))?n=(i===0?"":n.substring(0,i))+n.substring(l+1):i=l}}return n===""?null:n}function Za(e,t){return e==null?null:String(e)}function be(e,t,r,n,a,s){var i=e.__className;if(i!==r||i===void 0){var l=Ka(r,n,s);l==null?e.removeAttribute("class"):e.className=l,e.__className=r}else if(s&&a!==s)for(var o in s){var c=!!s[o];(a==null||c!==!!a[o])&&e.classList.toggle(o,c)}return s}function nn(e,t,r,n){var a=e.__style;if(a!==t){var s=Za(t);s==null?e.removeAttribute("style"):e.style.cssText=s,e.__style=t}return n}function gs(e,t,r=!1){if(e.multiple){if(t==null)return;if(!Vr(t))return na();for(var n of e.options)n.selected=t.includes(Ut(n));return}for(n of e.options){var a=Ut(n);if(wa(a,t)){n.selected=!0;return}}(!r||t!==void 0)&&(e.selectedIndex=-1)}function Qa(e){var t=new MutationObserver(()=>{gs(e,e.__value)});t.observe(e,{childList:!0,subtree:!0,attributes:!0,attributeFilter:["value"]}),yr(()=>{t.disconnect()})}function ei(e,t,r=t){var n=new WeakSet,a=!0;Vn(e,"change",s=>{var i=s?"[selected]":":checked",l;if(e.multiple)l=[].map.call(e.querySelectorAll(i),Ut);else{var o=e.querySelector(i)??e.querySelector("option:not([disabled])");l=o&&Ut(o)}r(l),L!==null&&n.add(L)}),Zn(()=>{var s=t();if(e===document.activeElement){var i=zt??L;if(n.has(i))return}if(gs(e,s,a),a&&s===void 0){var l=e.querySelector(":checked");l!==null&&(s=Ut(l),r(s))}e.__value=s,a=!1}),Qa(e)}function Ut(e){return"__value"in e?e.__value:e.value}const ti=Symbol("is custom element"),ri=Symbol("is html");function ni(e,t){var r=_s(e);r.value===(r.value=t??void 0)||e.value===t&&(t!==0||e.nodeName!=="PROGRESS")||(e.value=t??"")}function ze(e,t,r,n){var a=_s(e);a[t]!==(a[t]=r)&&(t==="loading"&&(e[Ls]=r),r==null?e.removeAttribute(t):typeof r!="string"&&si(e).includes(t)?e[t]=r:e.setAttribute(t,r))}function _s(e){return e.__attributes??={[ti]:e.nodeName.includes("-"),[ri]:e.namespaceURI===ra}}var yn=new Map;function si(e){var t=e.getAttribute("is")||e.nodeName,r=yn.get(t);if(r)return r;yn.set(t,r=[]);for(var n,a=e,s=Element.prototype;s!==a;){n=Tn(a);for(var i in n)n[i].set&&r.push(i);a=Jr(a)}return r}function tr(e,t,r=t){var n=new WeakSet;Vn(e,"input",async a=>{var s=a?e.defaultValue:e.value;if(s=Ir(e)?Dr(s):s,r(s),L!==null&&n.add(L),await La(),s!==(s=t())){var i=e.selectionStart,l=e.selectionEnd,o=e.value.length;if(e.value=s??"",l!==null){var c=e.value.length;i===l&&l===o&&c>o?(e.selectionStart=c,e.selectionEnd=c):(e.selectionStart=i,e.selectionEnd=Math.min(l,c))}}}),$(t)==null&&e.value&&(r(Ir(e)?Dr(e.value):e.value),L!==null&&n.add(L)),Jt(()=>{var a=t();if(e===document.activeElement){var s=zt??L;if(n.has(s))return}Ir(e)&&a===Dr(e.value)||e.type==="date"&&!a&&!e.value||a!==e.value&&(e.value=a??"")})}function Ir(e){var t=e.type;return t==="number"||t==="range"}function Dr(e){return e===""?null:+e}function xn(e,t){return e===t||e?.[Ne]===t}function vr(e={},t,r,n){return Zn(()=>{var a,s;return Jt(()=>{a=s,s=[],$(()=>{e!==r(...s)&&(t(e,...s),a&&xn(r(...a),e)&&t(null,...a))})}),()=>{Tt(()=>{s&&xn(r(...s),e)&&t(null,...s)})}}),e}function Zt(e=!1){const t=j,r=t.l.u;if(!r)return;let n=()=>Ra(t.s);if(e){let a=0,s={};const i=br(()=>{let l=!1;const o=t.s;for(const c in o)o[c]!==s[c]&&(s[c]=o[c],l=!0);return l&&a++,a});n=()=>h(i)}r.b.length&&Ma(()=>{Sn(t,n),or(r.b)}),Fr(()=>{const a=$(()=>r.m.map(Is));return()=>{for(const s of a)typeof s=="function"&&s()}}),r.a.length&&Fr(()=>{Sn(t,n),or(r.a)})}function Sn(e,t){if(e.l.s)for(const r of e.l.s)h(r);t()}function sn(e,t,r){if(e==null)return t(void 0),r&&r(void 0),Oe;const n=$(()=>e.subscribe(t,r));return n.unsubscribe?()=>n.unsubscribe():n}const gt=[];function ai(e,t){return{subscribe:Te(e,t).subscribe}}function Te(e,t=Oe){let r=null;const n=new Set;function a(l){if(Ln(e,l)&&(e=l,r)){const o=!gt.length;for(const c of n)c[1](),gt.push(c,e);if(o){for(let c=0;c<gt.length;c+=2)gt[c][0](gt[c+1]);gt.length=0}}}function s(l){a(l(e))}function i(l,o=Oe){const c=[l,o];return n.add(c),n.size===1&&(r=t(a,s)||Oe),l(e),()=>{n.delete(c),n.size===0&&r&&(r(),r=null)}}return{set:a,update:s,subscribe:i}}function At(e,t,r){const n=!Array.isArray(e),a=n?[e]:e;if(!a.every(Boolean))throw new Error("derived() expects stores as input, got a falsy value");const s=t.length<2;return ai(r,(i,l)=>{let o=!1;const c=[];let u=0,d=Oe;const f=()=>{if(u)return;d();const _=t(n?c[0]:c,i,l);s?i(_):d=typeof _=="function"?_:Oe},v=a.map((_,x)=>sn(_,p=>{c[x]=p,u&=~(1<<x),o&&f()},()=>{u|=1<<x}));return o=!0,f(),function(){or(v),d(),o=!1}})}function Ue(e){let t;return sn(e,r=>t=r)(),t}let rr=!1,Yr=Symbol();function J(e,t,r){const n=r[t]??={store:null,source:V(void 0),unsubscribe:Oe};if(n.store!==e&&!(Yr in r))if(n.unsubscribe(),n.store=e??null,e==null)n.source.v=void 0,n.unsubscribe=Oe;else{var a=!0;n.unsubscribe=sn(e,s=>{a?n.source.v=s:N(n.source,s)}),a=!1}return e&&Yr in r?Ue(e):h(n.source)}function $t(){const e={};function t(){yr(()=>{for(var r in e)e[r].unsubscribe();Cn(e,Yr,{enumerable:!1,value:!0})})}return[e,t]}function ii(e){var t=rr;try{return rr=!1,[e(),rr]}finally{rr=t}}function xe(e,t,r,n){var a=!Ct||(r&Js)!==0,s=(r&Zs)!==0,i=(r&Qs)!==0,l=n,o=!0,c=()=>(o&&(o=!1,l=i?$(n):n),l),u;if(s){var d=Ne in e||Ps in e;u=wt(e,t)?.set??(d&&t in e?E=>e[t]=E:void 0)}var f,v=!1;s?[f,v]=ii(()=>e[t]):f=e[t],f===void 0&&n!==void 0&&(f=c(),u&&(a&&Gs(),u(f)));var _;if(a?_=()=>{var E=e[t];return E===void 0?c():(o=!0,E)}:_=()=>{var E=e[t];return E!==void 0&&(l=void 0),E===void 0?l:E},a&&(r&Ks)===0)return _;if(u){var x=e.$$legacy;return(function(E,S){return arguments.length>0?((!a||!S||x||v)&&u(S?_():E),E):_()})}var p=!1,b=((r&Vs)!==0?br:en)(()=>(p=!1,_()));s&&h(b);var A=R;return(function(E,S){if(arguments.length>0){const y=S?h(b):a&&s?bt(E):E;return N(b,y),p=!0,l!==void 0&&(l=y),E}return vt&&p||(A.f&Re)!==0?b.v:h(b)})}function Er(e){j===null&&In(),Ct&&j.l!==null?li(j).m.push(e):Fr(()=>{const t=$(e);if(typeof t=="function")return t})}function oi(e){j===null&&In(),Er(()=>()=>$(e))}function li(e){var t=e.l;return t.u??={a:[],b:[],m:[]}}const ci="5";typeof window<"u"&&((window.__svelte??={}).v??=new Set).add(ci);ia();class ui{propagator=null;config;currentSeed;isInitialized=!1;wasmModule=null;currentBackend="cpu";gpuAvailable=!1;constructor(t,r){this.config=t,this.currentSeed=r}async initialize(t="cpu"){try{const n="/autoverse/preview/pr-41/pkg/flow_lenia.js";this.wasmModule=await import(n),await this.wasmModule.default(),this.gpuAvailable=await this.checkWebGPU();const a=t==="gpu"&&this.gpuAvailable?"gpu":"cpu";await this.createPropagator(a),this.isInitialized=!0}catch(r){throw new Error(`Failed to initialize WASM: ${r}`)}}async checkWebGPU(){if(typeof navigator>"u"||!("gpu"in navigator))return!1;try{return await navigator.gpu.requestAdapter()!==null}catch{return!1}}async createPropagator(t){if(!this.wasmModule)throw new Error("WASM module not loaded");const r=JSON.stringify(this.config),n=JSON.stringify(this.currentSeed);t==="gpu"&&this.gpuAvailable?(this.propagator=await new this.wasmModule.WasmGpuPropagator(r,n),this.currentBackend="gpu"):(this.propagator=new this.wasmModule.WasmPropagator(r,n),this.currentBackend="cpu")}async switchBackend(t){if(!this.isInitialized)throw new Error("Simulation not initialized");return t==="gpu"&&!this.gpuAvailable?!1:(t===this.currentBackend||await this.createPropagator(t),!0)}isGpuAvailable(){return this.gpuAvailable}getBackend(){return this.currentBackend}async step(){this.ensureInitialized(),this.currentBackend==="gpu"?await this.propagator.step():this.propagator.step()}async run(t){this.ensureInitialized(),this.currentBackend==="gpu"?await this.propagator.run(BigInt(t)):this.propagator.run(BigInt(t))}getState(){return this.ensureInitialized(),this.propagator.getState()}reset(t){this.ensureInitialized(),t&&(this.currentSeed=t),this.propagator.reset(JSON.stringify(this.currentSeed))}totalMass(){return this.ensureInitialized(),this.propagator.totalMass()}getTime(){return this.ensureInitialized(),this.propagator.getTime()}getStep(){return this.ensureInitialized(),this.propagator.getStep()}getWidth(){return this.config.width}getHeight(){return this.config.height}getConfig(){return{...this.config}}extractRegion(t,r,n,a){this.ensureInitialized();const s=this.getState(),i=[];for(let l=0;l<s.channels.length;l++){const o=[];for(let c=0;c<a;c++)for(let u=0;u<n;u++){const d=(t+u)%s.width,v=(r+c)%s.height*s.width+d;o.push(s.channels[l][v])}i.push(o)}return{width:n,height:a,channels:i,sourceX:t,sourceY:r}}placeRegion(t,r,n){this.ensureInitialized();const a=this.getState(),s=new Map;for(let o=0;o<a.channels.length;o++)for(let c=0;c<a.height;c++)for(let u=0;u<a.width;u++){const d=c*a.width+u,f=a.channels[o][d];f>.001&&s.set(`${u},${c},${o}`,f)}for(let o=0;o<t.channels.length;o++)for(let c=0;c<t.height;c++)for(let u=0;u<t.width;u++){const d=(r+u)%this.config.width,f=(n+c)%this.config.height,v=c*t.width+u,_=t.channels[o][v];_>.001&&s.set(`${d},${f},${o}`,_)}const i=[];for(const[o,c]of s){const[u,d,f]=o.split(",").map(Number);i.push([u,d,f,c])}const l={pattern:{type:"Custom",values:i}};this.reset(l)}drawAt(t,r,n,a,s=0){this.ensureInitialized();const i=this.getState(),l=[];for(let c=0;c<i.channels.length;c++)for(let u=0;u<i.height;u++)for(let d=0;d<i.width;d++){const f=u*i.width+d;let v=i.channels[c][f];if(c===s){const _=d-t,x=u-r,p=Math.sqrt(_*_+x*x);if(p<=n){const b=1-p/n;v=Math.min(1,v+a*b*b)}}v>.001&&l.push([d,u,c,v])}const o={pattern:{type:"Custom",values:l}};this.reset(o)}eraseAt(t,r,n,a=0){this.ensureInitialized();const s=this.getState(),i=[];for(let o=0;o<s.channels.length;o++)for(let c=0;c<s.height;c++)for(let u=0;u<s.width;u++){const d=c*s.width+u;let f=s.channels[o][d];if(o===a){const v=u-t,_=c-r,x=Math.sqrt(v*v+_*_);if(x<=n){const p=1-x/n;f=Math.max(0,f*(1-p*p))}}f>.001&&i.push([u,c,o,f])}const l={pattern:{type:"Custom",values:i}};this.reset(l)}ensureInitialized(){if(!this.isInitialized||!this.propagator)throw new Error("Simulation not initialized. Call initialize() first.")}}const jr={width:128,height:128,channels:1,dt:.1,kernel_radius:13,kernels:[{radius:1,rings:[{amplitude:1,distance:.5,width:.15}],weight:1,mu:.15,sigma:.015,source_channel:0,target_channel:0}],flow:{beta_a:1,n:2,distribution_size:1}},fi={pattern:{type:"GaussianBlob",center:[.5,.5],radius:.1,amplitude:1,channel:0}},di={initialized:!1,playing:!1,step:0,time:0,totalMass:0,fps:0,frameTime:0,backend:"cpu",gpuAvailable:!1,config:jr,state:null},ee=Te(di),ms=Te([]);function F(e,t="info"){ms.update(r=>[...r.slice(-100),{message:e,level:t,timestamp:Date.now()}])}let q=null,nr=null,Yt=0,sr=0,qr=0,bs=60,ar=0;function Xr(){return q}function vi(e){bs=Math.max(1,Math.min(480,e)),ar=0}async function hi(){q=new ui(jr,fi),await q.initialize();const e=q.getState();ee.update(t=>({...t,initialized:!0,step:q.getStep(),time:q.getTime(),totalMass:q.totalMass(),backend:q.getBackend(),gpuAvailable:q.isGpuAvailable(),config:jr,state:e}))}function pi(){!q||Ue(ee).playing||(ee.update(t=>({...t,playing:!0})),Yt=performance.now(),qr=Yt,sr=0,ys(Yt),F("Simulation started","info"))}function ws(){ee.update(e=>({...e,playing:!1})),nr!==null&&(cancelAnimationFrame(nr),nr=null),F("Simulation paused","info")}async function gi(){q&&(await q.step(),on())}function an(e){q&&(q.reset(e),on(),F("Simulation reset","info"))}async function _i(e){if(!q)return!1;const t=await q.switchBackend(e);return t?(ee.update(r=>({...r,backend:e})),F(`Switched to ${e.toUpperCase()} backend`,"success")):F(`Failed to switch to ${e} backend`,"error"),t}async function ys(e){if(!Ue(ee).playing||!q)return;let r=e-Yt;Yt=e;const n=250;r>n&&(r=n,ar=0);const a=bs*r/1e3+ar,s=Math.floor(a);ar=a-s,s>0&&await q.run(s),on(),sr++,e-qr>=1e3&&(ee.update(i=>({...i,fps:sr,frameTime:r})),sr=0,qr=e),nr=requestAnimationFrame(i=>ys(i))}function on(){if(!q)return;const e=q.getState();ee.update(t=>({...t,step:q.getStep(),time:q.getTime(),totalMass:q.totalMass(),state:e}))}const mi=At(ee,e=>e.time.toFixed(2)),bi=At(ee,e=>e.totalMass.toLocaleString(void 0,{maximumFractionDigits:0})),wi=At(ee,e=>e.step.toString().padStart(8,"0")),yi={mode:"view",brushSize:5,brushIntensity:.8,colorScheme:"theme",visualizationMode:"mass",showGrid:!1,showScanlines:!0,showSelection:!0,zoom:1,panX:0,panY:0},It=Te(yi);function xi(e){It.update(t=>({...t,mode:e}))}function Si(e){It.update(t=>({...t,brushSize:Math.max(1,Math.min(50,e))}))}function Ei(e){It.update(t=>({...t,brushIntensity:Math.max(0,Math.min(1,e))}))}const Wt=[{id:"void",name:"VOID",colors:{primary:"#a855f7",primaryDim:"#6b21a8",primaryGlow:"rgba(168, 85, 247, 0.4)",secondary:"#3b82f6",secondaryDim:"#1e40af",secondaryGlow:"rgba(59, 130, 246, 0.4)",tertiary:"#ec4899",tertiaryDim:"#9d174d",tertiaryGlow:"rgba(236, 72, 153, 0.4)",success:"#a855f7",warning:"#f59e0b",danger:"#ef4444"}},{id:"neon-tokyo",name:"NEON TOKYO",colors:{primary:"#ff2d95",primaryDim:"#9d1a5a",primaryGlow:"rgba(255, 45, 149, 0.4)",secondary:"#00f0ff",secondaryDim:"#0891b2",secondaryGlow:"rgba(0, 240, 255, 0.4)",tertiary:"#ffee00",tertiaryDim:"#a38a00",tertiaryGlow:"rgba(255, 238, 0, 0.4)",success:"#00f0ff",warning:"#ffee00",danger:"#ff2d95"}},{id:"synthwave",name:"SYNTHWAVE",colors:{primary:"#f472b6",primaryDim:"#a21caf",primaryGlow:"rgba(244, 114, 182, 0.4)",secondary:"#818cf8",secondaryDim:"#4338ca",secondaryGlow:"rgba(129, 140, 248, 0.4)",tertiary:"#22d3ee",tertiaryDim:"#0e7490",tertiaryGlow:"rgba(34, 211, 238, 0.4)",success:"#22d3ee",warning:"#fbbf24",danger:"#f43f5e"}},{id:"bloodmoon",name:"BLOODMOON",colors:{primary:"#dc2626",primaryDim:"#7f1d1d",primaryGlow:"rgba(220, 38, 38, 0.4)",secondary:"#f97316",secondaryDim:"#9a3412",secondaryGlow:"rgba(249, 115, 22, 0.4)",tertiary:"#fbbf24",tertiaryDim:"#92400e",tertiaryGlow:"rgba(251, 191, 36, 0.4)",success:"#f97316",warning:"#fbbf24",danger:"#dc2626"}},{id:"toxic",name:"TOXIC",colors:{primary:"#84cc16",primaryDim:"#3f6212",primaryGlow:"rgba(132, 204, 22, 0.5)",secondary:"#facc15",secondaryDim:"#854d0e",secondaryGlow:"rgba(250, 204, 21, 0.4)",tertiary:"#22c55e",tertiaryDim:"#166534",tertiaryGlow:"rgba(34, 197, 94, 0.4)",success:"#22c55e",warning:"#facc15",danger:"#ef4444"}},{id:"ice",name:"ICE",colors:{primary:"#38bdf8",primaryDim:"#0369a1",primaryGlow:"rgba(56, 189, 248, 0.4)",secondary:"#e0f2fe",secondaryDim:"#7dd3fc",secondaryGlow:"rgba(224, 242, 254, 0.3)",tertiary:"#a5b4fc",tertiaryDim:"#4f46e5",tertiaryGlow:"rgba(165, 180, 252, 0.4)",success:"#38bdf8",warning:"#fcd34d",danger:"#f87171"}},{id:"hacker",name:"HACKER",colors:{primary:"#22c55e",primaryDim:"#166534",primaryGlow:"rgba(34, 197, 94, 0.5)",secondary:"#4ade80",secondaryDim:"#15803d",secondaryGlow:"rgba(74, 222, 128, 0.4)",tertiary:"#86efac",tertiaryDim:"#22c55e",tertiaryGlow:"rgba(134, 239, 172, 0.3)",success:"#22c55e",warning:"#fbbf24",danger:"#ef4444"}},{id:"phosphor",name:"PHOSPHOR",colors:{primary:"#fef08a",primaryDim:"#a16207",primaryGlow:"rgba(254, 240, 138, 0.5)",secondary:"#fde047",secondaryDim:"#854d0e",secondaryGlow:"rgba(253, 224, 71, 0.4)",tertiary:"#fbbf24",tertiaryDim:"#92400e",tertiaryGlow:"rgba(251, 191, 36, 0.4)",success:"#a3e635",warning:"#fbbf24",danger:"#f87171"}}],Mr=Te(Wt[0]);function Wr(e){const t=document.documentElement,{colors:r}=e;t.style.setProperty("--color-primary",r.primary),t.style.setProperty("--color-primary-dim",r.primaryDim),t.style.setProperty("--color-primary-glow",r.primaryGlow),t.style.setProperty("--color-secondary",r.secondary),t.style.setProperty("--color-secondary-dim",r.secondaryDim),t.style.setProperty("--color-secondary-glow",r.secondaryGlow),t.style.setProperty("--color-tertiary",r.tertiary),t.style.setProperty("--color-tertiary-dim",r.tertiaryDim),t.style.setProperty("--color-tertiary-glow",r.tertiaryGlow),t.style.setProperty("--color-success",r.success),t.style.setProperty("--color-warning",r.warning),t.style.setProperty("--color-danger",r.danger),Mr.set(e),localStorage.setItem("autoverse-theme",e.id)}function Mi(e){const t=Wt.find(r=>r.id===e);t&&Wr(t)}function Ci(){const e=localStorage.getItem("autoverse-theme");if(e){const t=Wt.find(r=>r.id===e);if(t){Wr(t);return}}Wr(Wt[0])}var Ti=I("<button></button>"),ki=I('<header class="header svelte-4b3o1e"><div class="header-left svelte-4b3o1e"><pre class="ascii-logo svelte-4b3o1e"></pre></div> <div class="header-right svelte-4b3o1e"><div class="theme-picker svelte-4b3o1e"><span class="picker-label svelte-4b3o1e">THEME</span> <div class="theme-swatches svelte-4b3o1e"></div></div> <div><span class="backend-label svelte-4b3o1e">COMPUTE</span> <span class="backend-value svelte-4b3o1e"> </span></div></div></header>');function Ai(e,t){et(t,!1);const r=()=>J(Mr,"$currentScheme",a),n=()=>J(ee,"$simulationStore",a),[a,s]=$t();Zt();var i=ki(),l=g(i),o=g(l);o.textContent=`
 ▄▀▄ █ █ ▀█▀ ▄▀▄ █ █ █▀▀ █▀▄ ▄▀▀ █▀▀
 █▀█ █▄█  █  █ █ ▀▄▀ ██▄ █▀▄ ▄██ ██▄`;var c=w(l,2),u=g(c),d=w(g(u),2);Xt(d,5,()=>Wt,dr,(p,b)=>{var A=Ti();let E;A.__click=()=>Mi(h(b).id),X(()=>{E=be(A,1,"swatch svelte-4b3o1e",null,E,{active:r().id===h(b).id}),nn(A,`--swatch-color: ${h(b).colors.primary??""}`),ze(A,"title",h(b).name)}),k(p,A)});var f=w(u,2);let v;var _=w(g(f),2),x=g(_);X(p=>{v=be(f,1,"backend-indicator svelte-4b3o1e",null,v,{gpu:n().backend==="gpu"}),Y(x,p)},[()=>n().backend.toUpperCase()]),k(e,i),tt(),s()}Kt(["click"]);var $i=I('<footer class="footer svelte-ww03jg"></footer>');function Ii(e){var t=$i();k(e,t)}var Di=I("<div> </div>"),Pi=I('<div><div class="corner top-left svelte-1gtc57s"></div> <div class="corner top-right svelte-1gtc57s"></div> <div class="corner bottom-left svelte-1gtc57s"></div> <div class="corner bottom-right svelte-1gtc57s"></div> <!> <div><!></div></div>');function Ve(e,t){let r=xe(t,"borderColor",3,"primary"),n=xe(t,"noPadding",3,!1),a=xe(t,"class",3,"");const s={primary:"border-primary",secondary:"border-secondary",tertiary:"border-tertiary"};var i=Pi(),l=w(g(i),8);{var o=f=>{var v=Di(),_=g(v);X(()=>{be(v,1,`title ${s[r()]??""}`,"svelte-1gtc57s"),Y(_,t.title)}),k(f,v)};ne(l,f=>{t.title&&f(o)})}var c=w(l,2);let u;var d=g(c);Ha(d,()=>t.children??Oe),X(()=>{be(i,1,`tui-box ${s[r()]??""} ${a()??""}`,"svelte-1gtc57s"),u=be(c,1,"content svelte-1gtc57s",null,u,{"no-padding":n()})}),k(e,i)}var Li=I('<span class="label svelte-1l5vt72"> </span>'),Oi=I("<span> </span>"),Ri=I('<div class="slider-header svelte-1l5vt72"><!> <!></div>'),Ni=I('<div class="slider-container svelte-1l5vt72"><!> <input type="range"/></div>');function Pr(e,t){et(t,!0);let r=xe(t,"value",15),n=xe(t,"min",3,0),a=xe(t,"max",3,100),s=xe(t,"step",3,1),i=xe(t,"showValue",3,!0),l=xe(t,"valueFormat",3,_=>String(_)),o=xe(t,"color",3,"tertiary");function c(_){const x=_.target;r(parseFloat(x.value)),t.onchange?.(r())}var u=Ni(),d=g(u);{var f=_=>{var x=Ri(),p=g(x);{var b=S=>{var y=Li(),C=g(y);X(()=>Y(C,t.label)),k(S,y)};ne(p,S=>{t.label&&S(b)})}var A=w(p,2);{var E=S=>{var y=Oi(),C=g(y);X(m=>{be(y,1,`value ${o()??""}`,"svelte-1l5vt72"),Y(C,m)},[()=>l()(r())]),k(S,y)};ne(A,S=>{i()&&S(E)})}k(_,x)};ne(d,_=>{(t.label||i())&&_(f)})}var v=w(d,2);v.__input=c,X(()=>{be(v,1,Ja(o()),"svelte-1l5vt72"),ze(v,"min",n()),ze(v,"max",a()),ze(v,"step",s()),ni(v,r())}),k(e,u),tt()}Kt(["input"]);var Fi=I('<span class="icon svelte-oaxjxu">&#9724;</span> <span class="label svelte-oaxjxu">PAUSE</span>',1),zi=I('<span class="icon svelte-oaxjxu">&#9654;</span> <span class="label svelte-oaxjxu">PLAY</span>',1),Gi=I('<div class="control-grid svelte-oaxjxu"><button><!></button> <button class="control-btn svelte-oaxjxu"><span class="icon svelte-oaxjxu">&#9655;</span> <span class="label svelte-oaxjxu">STEP</span></button> <button class="control-btn svelte-oaxjxu"><span class="icon svelte-oaxjxu">&#8634;</span> <span class="label svelte-oaxjxu">RESET</span></button></div> <div class="speed-control svelte-oaxjxu"><!></div>',1),Bi=I('<button><span class="icon svelte-oaxjxu"><!></span> <span class="label svelte-oaxjxu"> </span></button>'),Ui=I('<div class="brush-settings svelte-oaxjxu"><!> <!></div>'),Yi=I('<div class="tool-grid svelte-oaxjxu"></div> <!>',1),ji=I('<div><span class="log-prefix svelte-oaxjxu">&gt;</span> <span class="log-message svelte-oaxjxu"> </span></div>'),qi=I('<div class="log-container svelte-oaxjxu"></div>'),Xi=I('<aside class="left-sidebar svelte-oaxjxu"><!> <!> <!></aside>');function Wi(e,t){et(t,!0);const r=()=>J(ee,"$simulationStore",s),n=()=>J(It,"$settings",s),a=()=>J(ms,"$systemLog",s),[s,i]=$t();let l=Ie(60);function o(x){N(l,x,!0),vi(x)}function c(x){xi(x)}const u=[{id:"view",label:"VIEW",icon:"&#9673;"},{id:"select",label:"SEL",icon:"&#9633;"},{id:"draw",label:"DRAW",icon:"&#9998;"},{id:"erase",label:"ERASE",icon:"&#9747;"}];var d=Xi(),f=g(d);Ve(f,{title:"SYS.CONTROL",borderColor:"primary",children:(x,p)=>{var b=Gi(),A=Qe(b),E=g(A);let S;E.__click=()=>r().playing?ws():pi();var y=g(E);{var C=O=>{var B=Fi();k(O,B)},m=O=>{var B=zi();k(O,B)};ne(y,O=>{r().playing?O(C):O(m,!1)})}var M=w(E,2);M.__click=()=>gi();var D=w(M,2);D.__click=()=>an();var T=w(A,2),z=g(T);Pr(z,{label:"SIM SPEED",min:15,max:480,step:15,color:"primary",valueFormat:O=>`${O} steps/s`,onchange:o,get value(){return h(l)},set value(O){N(l,O,!0)}}),X(()=>S=be(E,1,"control-btn svelte-oaxjxu",null,S,{active:!r().playing})),k(x,b)},$$slots:{default:!0}});var v=w(f,2);Ve(v,{title:"TOOL.KIT",borderColor:"tertiary",children:(x,p)=>{var b=Yi(),A=Qe(b);Xt(A,21,()=>u,dr,(y,C)=>{var m=Bi();let M;m.__click=()=>c(h(C).id);var D=g(m),T=g(D);Wa(T,()=>h(C).icon);var z=w(D,2),O=g(z);X(()=>{M=be(m,1,"tool-btn svelte-oaxjxu",null,M,{active:n().mode===h(C).id}),Y(O,h(C).label)}),k(y,m)});var E=w(A,2);{var S=y=>{var C=Ui(),m=g(C);Pr(m,{label:"BRUSH SIZE",get value(){return n().brushSize},min:1,max:30,step:1,color:"tertiary",valueFormat:T=>`${T}PX`,get onchange(){return Si}});var M=w(m,2);{var D=T=>{Pr(T,{label:"INTENSITY",get value(){return n().brushIntensity},min:0,max:1,step:.05,color:"tertiary",valueFormat:z=>`${Math.round(z*100)}%`,get onchange(){return Ei}})};ne(M,T=>{n().mode==="draw"&&T(D)})}k(y,C)};ne(E,y=>{(n().mode==="draw"||n().mode==="erase")&&y(S)})}k(x,b)},$$slots:{default:!0}});var _=w(v,2);Ve(_,{title:"DEBUG.LOG",borderColor:"secondary",class:"debug-log-box",children:(x,p)=>{var b=qi();Xt(b,5,a,dr,(A,E)=>{var S=ji(),y=w(g(S),2),C=g(y);X(()=>{be(S,1,`log-entry ${h(E).level??""}`,"svelte-oaxjxu"),Y(C,h(E).message)}),k(A,S)}),k(x,b)},$$slots:{default:!0}}),k(e,d),tt(),i()}Kt(["click"]);const Hi={initialized:!1,running:!1,progress:null,result:null,bestState:null,error:null},se=Te(Hi);At(se,e=>e.running);At(se,e=>e.progress);At(se,e=>e.bestState);let hr=null,me=null,ir=null;async function Vi(){try{hr=await import("/autoverse/preview/pr-41/pkg/flow_lenia.js"),await hr.default(),se.update(r=>({...r,initialized:!0})),F("Evolution engine initialized","success")}catch(e){throw F(`Failed to initialize evolution: ${e}`,"error"),e}}function Ji(){return{base_config:Ue(ee).config,seed_pattern_type:"Blob",constraints:{radius:{min:.05,max:.25},amplitude:{min:.5,max:2},x:{min:.3,max:.7},y:{min:.3,max:.7}},fitness:{metrics:[{metric:"Persistence",weight:1},{metric:"Compactness",weight:.5},{metric:"Locomotion",weight:.3}],aggregation:"WeightedSum"},evaluation:{steps:200,sample_interval:10,warmup_steps:20},population:{size:20,elitism:2},algorithm:{type:"GeneticAlgorithm",config:{mutation_rate:.15,crossover_rate:.7,selection_method:"Tournament",tournament_size:3}},archive:{enabled:!0,max_size:50,diversity_threshold:.1},max_generations:50,target_fitness:.95,stagnation_limit:15}}async function Ki(e){if(!hr)throw new Error("Evolution module not initialized");ws(),Ss();try{me&&me.free(),me=new hr.WasmEvolutionEngine(JSON.stringify(e)),se.update(t=>({...t,running:!0,progress:null,result:null,error:null})),F(`Evolution started: pop=${e.population.size}, gens=${e.max_generations}`,"info"),xs()}catch(t){throw se.update(r=>({...r,error:String(t)})),F(`Evolution error: ${t}`,"error"),t}}function xs(){if(!(!Ue(se).running||!me))try{const t=me.step(),r=JSON.parse(t),n=me.getBestCandidateState();if(se.update(a=>({...a,progress:r,bestState:n})),me.isComplete()){const a=me.getResult(),s=JSON.parse(a);se.update(i=>({...i,running:!1,result:s})),F(`Evolution complete: fitness=${s.best_fitness.toFixed(3)}, reason=${s.stop_reason}`,"success");return}ir=requestAnimationFrame(()=>xs())}catch(t){se.update(r=>({...r,running:!1,error:String(t)})),F(`Evolution error: ${t}`,"error")}}function Ss(){ir!==null&&(cancelAnimationFrame(ir),ir=null);const e=Ue(se);if(me&&e.running){me.cancel();try{const t=me.getResult(),r=JSON.parse(t);se.update(n=>({...n,result:r}))}catch{}F("Evolution cancelled","warn")}se.update(t=>({...t,running:!1}))}function Zi(){const e=Ue(se);if(!e.bestState){F("No evolved pattern to load","warn");return}const{width:t,height:r,data:n}=e.bestState,a=[];for(let s=0;s<r;s++)for(let i=0;i<t;i++){const l=s*t+i,o=n[l];o>.001&&a.push([i,s,0,o])}an({pattern:{type:"Custom",values:a}}),F("Loaded evolved pattern into simulation","success")}var Qi=I('<div class="progress-display svelte-auxm5"><div class="progress-row svelte-auxm5"><span class="label svelte-auxm5">GEN</span> <span class="value svelte-auxm5"> </span></div> <div class="progress-row svelte-auxm5"><span class="label svelte-auxm5">FIT</span> <span class="value highlight svelte-auxm5"> </span></div> <div class="progress-bar svelte-auxm5"><div class="progress-fill svelte-auxm5"></div></div></div>'),eo=I('<div class="result-display svelte-auxm5"><div class="result-row svelte-auxm5"><span class="label svelte-auxm5">RESULT</span> <span class="value success svelte-auxm5"> </span></div> <div class="result-reason svelte-auxm5"> </div></div>'),to=I('<div class="idle-status svelte-auxm5">READY</div>'),ro=I('<button class="evo-btn danger svelte-auxm5">STOP</button>'),no=I('<button class="evo-btn secondary svelte-auxm5">LOAD</button>'),so=I('<button class="evo-btn primary svelte-auxm5">EVOLVE</button> <!>',1),ao=I('<div class="evolution-panel svelte-auxm5"><div class="preview-container svelte-auxm5"><canvas width="64" height="64" class="preview-canvas svelte-auxm5"></canvas> <span class="preview-label svelte-auxm5">BEST</span></div> <!> <div class="controls svelte-auxm5"><!></div> <details class="settings svelte-auxm5"><summary class="svelte-auxm5">SETTINGS</summary> <div class="settings-grid svelte-auxm5"><label class="svelte-auxm5"><span class="svelte-auxm5">POP</span> <input type="number" min="4" max="50" step="2" class="svelte-auxm5"/></label> <label class="svelte-auxm5"><span class="svelte-auxm5">GENS</span> <input type="number" min="10" max="200" step="10" class="svelte-auxm5"/></label> <label class="svelte-auxm5"><span class="svelte-auxm5">MUT%</span> <input type="number" min="1" max="50" step="1" class="svelte-auxm5"/></label> <label class="svelte-auxm5"><span class="svelte-auxm5">STEPS</span> <input type="number" min="50" max="500" step="50" class="svelte-auxm5"/></label></div> <label class="goal-select svelte-auxm5"><span class="svelte-auxm5">GOAL</span> <select class="svelte-auxm5"><option>Survival</option><option>Glider</option><option>Oscillator</option><option>Complex</option></select></label></details></div>');function io(e,t){et(t,!1);const r=()=>J(se,"$evolutionStore",n),[n,a]=$t();let s=V(),i=V(null),l=V(20),o=V(50),c=.95,u=V(15),d=V(200),f=V("survival");function v(S){if(!h(i)||!h(s))return;const{width:y,height:C,data:m}=S,M=h(s).width,D=h(s).height,T=h(i).createImageData(y,C);for(let B=0;B<m.length;B++){const W=Math.floor(Math.min(1,Math.max(0,m[B]))*255);T.data[B*4]=W,T.data[B*4+1]=W,T.data[B*4+2]=W,T.data[B*4+3]=255}const z=new OffscreenCanvas(y,C),O=z.getContext("2d");O&&(O.putImageData(T,0,0),ma(i,h(i).imageSmoothingEnabled=!1),h(i).clearRect(0,0,M,D),h(i).drawImage(z,0,0,M,D))}function _(S){switch(S){case"glider":return[{metric:"Persistence",weight:1},{metric:"Locomotion",weight:1.5},{metric:"Compactness",weight:.5}];case"oscillator":return[{metric:"Persistence",weight:1},{metric:"Stability",weight:.8},{metric:"Compactness",weight:.5}];case"complex":return[{metric:"Persistence",weight:1},{metric:"Complexity",weight:1.2},{metric:"MassConcentration",weight:.3}];default:return[{metric:"Persistence",weight:1},{metric:"Compactness",weight:.5},{metric:"Stability",weight:.3}]}}function x(){return{...Ji(),population:{size:h(l),elitism:Math.max(1,Math.floor(h(l)/10))},max_generations:h(o),target_fitness:c,stagnation_limit:Math.max(5,Math.floor(h(o)/3)),algorithm:{type:"GeneticAlgorithm",config:{mutation_rate:h(u)/100,crossover_rate:.7,selection_method:"Tournament",tournament_size:3}},evaluation:{steps:h(d),sample_interval:Math.max(1,Math.floor(h(d)/20)),warmup_steps:Math.floor(h(d)/10)},fitness:{metrics:_(h(f)),aggregation:"WeightedSum"}}}async function p(){const S=x();try{await Ki(S)}catch(y){F(`Failed to start evolution: ${y}`,"error")}}function b(){Ss()}function A(){Zi()}function E(S){switch(S){case"TargetReached":return"TARGET HIT";case"MaxGenerations":return"MAX GENS";case"Stagnation":return"STAGNANT";case"Cancelled":return"CANCELLED";default:return S}}Er(async()=>{if(N(i,h(s)?.getContext("2d")??null),!r().initialized)try{await Vi()}catch{}}),Pe(()=>(h(i),r()),()=>{h(i)&&r().bestState&&v(r().bestState)}),xr(),Zt(),Ve(e,{title:"EVOLVE",borderColor:"tertiary",children:(S,y)=>{var C=ao(),m=g(C),M=g(m);vr(M,U=>N(s,U),()=>h(s));var D=w(m,2);{var T=U=>{var _e=Qi(),Xe=g(_e),Ot=w(g(Xe),2),Rt=g(Ot),ce=w(Xe,2),$e=w(g(ce),2),Qt=g($e),kr=w(ce,2),Ar=g(kr);X($r=>{Y(Rt,`${r(),$(()=>r().progress.generation)??""}/${h(o)??""}`),Y(Qt,$r),nn(Ar,`width: ${r(),h(o),$(()=>r().progress.generation/h(o)*100)??""}%`)},[()=>(r(),$(()=>r().progress.best_fitness.toFixed(3)))]),k(U,_e)},z=U=>{var _e=Br(),Xe=Qe(_e);{var Ot=ce=>{var $e=eo(),Qt=g($e),kr=w(g(Qt),2),Ar=g(kr),$r=w(Qt,2),Ms=g($r);X((Cs,Ts)=>{Y(Ar,Cs),Y(Ms,Ts)},[()=>(r(),$(()=>r().result.best_fitness.toFixed(3))),()=>(r(),$(()=>E(r().result.stop_reason)))]),k(ce,$e)},Rt=ce=>{var $e=to();k(ce,$e)};ne(Xe,ce=>{r(),$(()=>r().result)?ce(Ot):ce(Rt,!1)},!0)}k(U,_e)};ne(D,U=>{r(),$(()=>r().running&&r().progress)?U(T):U(z,!1)})}var O=w(D,2),B=g(O);{var W=U=>{var _e=ro();_e.__click=b,k(U,_e)},G=U=>{var _e=so(),Xe=Qe(_e);Xe.__click=p;var Ot=w(Xe,2);{var Rt=ce=>{var $e=no();$e.__click=A,k(ce,$e)};ne(Ot,ce=>{r(),$(()=>r().bestState)&&ce(Rt)})}X(()=>Xe.disabled=(r(),$(()=>!r().initialized))),k(U,_e)};ne(B,U=>{r(),$(()=>r().running)?U(W):U(G,!1)})}var H=w(O,2),ge=w(g(H),2),Ye=g(ge),rt=w(g(Ye),2),ke=w(Ye,2),Ae=w(g(ke),2),ht=w(ke,2),Dt=w(g(ht),2),Pt=w(ht,2),je=w(g(Pt),2),ae=w(ge,2),qe=w(g(ae),2);X(()=>{h(f),$a(()=>{})});var Lt=g(qe);Lt.value=Lt.__value="survival";var Cr=w(Lt);Cr.value=Cr.__value="glider";var Tr=w(Cr);Tr.value=Tr.__value="oscillator";var cn=w(Tr);cn.value=cn.__value="complex",tr(rt,()=>h(l),U=>N(l,U)),tr(Ae,()=>h(o),U=>N(o,U)),tr(Dt,()=>h(u),U=>N(u,U)),tr(je,()=>h(d),U=>N(d,U)),ei(qe,()=>h(f),U=>N(f,U)),k(S,C)},$$slots:{default:!0}}),tt(),a()}Kt(["click"]);const En="flow-lenia-presets";class oo{presets=new Map;listeners=new Set;constructor(){this.loadFromStorage()}generateId(){return`preset-${Date.now()}-${Math.random().toString(36).slice(2,9)}`}createThumbnail(t,r=64){const n=document.createElement("canvas");n.width=r,n.height=r;const a=n.getContext("2d"),s=a.createImageData(t.width,t.height),i=t.channels[0];for(let _=0;_<i.length;_++){const x=Math.max(0,Math.min(1,i[_])),p=Math.floor(x*255);s.data[_*4+0]=p,s.data[_*4+1]=p,s.data[_*4+2]=p,s.data[_*4+3]=255}const l=document.createElement("canvas");l.width=t.width,l.height=t.height,l.getContext("2d").putImageData(s,0,0),a.imageSmoothingEnabled=!0,a.fillStyle="#1a1a1a",a.fillRect(0,0,r,r);const c=Math.min(r/t.width,r/t.height),u=t.width*c,d=t.height*c,f=(r-u)/2,v=(r-d)/2;return a.drawImage(l,f,v,u,d),n.toDataURL("image/png")}savePreset(t,r,n){const a={id:this.generateId(),name:t,description:n,thumbnail:this.createThumbnail(r),region:r,createdAt:Date.now()};return this.presets.set(a.id,a),this.persistToStorage(),this.notifyListeners(),a}getPreset(t){return this.presets.get(t)}getAllPresets(){return Array.from(this.presets.values()).sort((t,r)=>r.createdAt-t.createdAt)}deletePreset(t){const r=this.presets.delete(t);return r&&(this.persistToStorage(),this.notifyListeners()),r}renamePreset(t,r){const n=this.presets.get(t);return n?(n.name=r,this.persistToStorage(),this.notifyListeners(),!0):!1}updateDescription(t,r){const n=this.presets.get(t);return n?(n.description=r,this.persistToStorage(),this.notifyListeners(),!0):!1}exportPresets(t){const r=t?t.map(n=>this.presets.get(n)).filter(Boolean):this.getAllPresets();return JSON.stringify(r,null,2)}importPresets(t){try{const r=JSON.parse(t);let n=0;for(const a of r){const s={...a,id:this.generateId(),createdAt:Date.now()};this.presets.set(s.id,s),n++}return this.persistToStorage(),this.notifyListeners(),n}catch{throw new Error("Invalid preset JSON format")}}subscribe(t){return this.listeners.add(t),()=>this.listeners.delete(t)}notifyListeners(){const t=this.getAllPresets();for(const r of this.listeners)r(t)}persistToStorage(){try{const t=JSON.stringify(Array.from(this.presets.entries()));localStorage.setItem(En,t)}catch(t){console.warn("Failed to persist presets to storage:",t)}}loadFromStorage(){try{const t=localStorage.getItem(En);if(t){const r=JSON.parse(t);this.presets=new Map(r)}}catch(t){console.warn("Failed to load presets from storage:",t),this.presets=new Map}}clearAll(){this.presets.clear(),this.persistToStorage(),this.notifyListeners()}}const lo=[{name:"Glider",description:"A simple glider that moves across the grid",seed:{pattern:{type:"GaussianBlob",center:[.5,.5],radius:.1,amplitude:1,channel:0}}},{name:"Ring",description:"A ring pattern that expands",seed:{pattern:{type:"Ring",center:[.5,.5],inner_radius:.05,outer_radius:.1,amplitude:1,channel:0}}},{name:"Dual Blobs",description:"Two interacting blobs",seed:{pattern:{type:"MultiBlob",blobs:[{center:[.35,.5],radius:.08,amplitude:1,channel:0},{center:[.65,.5],radius:.08,amplitude:1,channel:0}]}}},{name:"Random Noise",description:"Random initial conditions",seed:{pattern:{type:"Noise",seed:42,amplitude:.5,channel:0}}}],Hr=Te(null),Es=Te(0);function co(){Es.update(e=>e+1)}function uo(e,t){const r=Ue(Hr);r&&r.startDragFromLibrary(e,t)}const Mn=Te(null),Et=new oo,ln=Te(Et.getAllPresets());Et.subscribe(e=>{ln.set(e)});function fo(e){const t=Et.getAllPresets().find(r=>r.id===e);Et.deletePreset(e),t&&F(`Deleted preset: ${t.name}`,"info")}function vo(){const e=Et.exportPresets();return F(`Exported ${Ue(ln).length} presets`,"success"),e}function ho(e){try{const t=Et.importPresets(e);return F(`Imported ${t} presets`,"success"),co(),t}catch(t){throw F(`Import failed: ${t}`,"error"),t}}function po(){const e=vo(),t=new Blob([e],{type:"application/json"}),r=URL.createObjectURL(t),n=document.createElement("a");n.href=r,n.download="flow-lenia-presets.json",n.click(),URL.revokeObjectURL(r)}var go=I('<div class="metric-display svelte-1baw31t"><div class="metric-main svelte-1baw31t"><span class="metric-value svelte-1baw31t"> </span> <span class="metric-unit svelte-1baw31t">STEPS</span></div> <div class="metric-row svelte-1baw31t"><div class="metric-item svelte-1baw31t"><span class="metric-label svelte-1baw31t">TIME</span> <span class="metric-num svelte-1baw31t"> </span></div> <div class="metric-item svelte-1baw31t"><span class="metric-label svelte-1baw31t">MASS</span> <span class="metric-num highlight svelte-1baw31t"> </span></div></div> <div class="metric-row svelte-1baw31t"><div class="metric-item svelte-1baw31t"><span class="metric-label svelte-1baw31t">FPS</span> <span class="metric-num accent svelte-1baw31t"> </span></div> <div class="metric-item svelte-1baw31t"><span class="metric-label svelte-1baw31t">BACKEND</span> <button> </button></div></div></div>'),_o=I('<div class="config-grid svelte-1baw31t"><div class="config-item svelte-1baw31t"><span class="cfg-label svelte-1baw31t">mu</span> <span class="cfg-value svelte-1baw31t"> </span></div> <div class="config-item svelte-1baw31t"><span class="cfg-label svelte-1baw31t">sigma</span> <span class="cfg-value svelte-1baw31t"> </span></div> <div class="config-item svelte-1baw31t"><span class="cfg-label svelte-1baw31t">R</span> <span class="cfg-value svelte-1baw31t"> </span></div> <div class="config-item svelte-1baw31t"><span class="cfg-label svelte-1baw31t">dt</span> <span class="cfg-value svelte-1baw31t"> </span></div></div>'),mo=I('<button class="builtin-btn svelte-1baw31t"> </button>'),bo=I('<div class="builtin-grid svelte-1baw31t"></div>'),wo=I('<img class="svelte-1baw31t"/>'),yo=I('<div class="preset-item svelte-1baw31t" draggable="true" role="button" tabindex="0"><div class="preset-thumbnail svelte-1baw31t"><!></div> <div class="preset-info svelte-1baw31t"><span class="preset-name svelte-1baw31t"> </span> <span class="preset-size svelte-1baw31t"> </span></div> <button class="delete-btn svelte-1baw31t">&#10005;</button></div>'),xo=I('<div class="empty-state svelte-1baw31t">No saved patterns</div>'),So=I('<div class="patterns-header svelte-1baw31t"><button class="small-btn svelte-1baw31t">IMPORT</button> <button class="small-btn svelte-1baw31t">EXPORT</button></div> <div class="preset-list svelte-1baw31t"></div>',1),Eo=I('<aside class="right-sidebar svelte-1baw31t"><!> <!> <!> <!> <!></aside>');function Mo(e,t){et(t,!1);const r=()=>J(ee,"$simulationStore",l),n=()=>J(wi,"$formattedStep",l),a=()=>J(mi,"$formattedTime",l),s=()=>J(bi,"$formattedMass",l),i=()=>J(ln,"$presets",l),[l,o]=$t(),c=V();function u(){const m=r().backend==="cpu"?"gpu":"cpu";_i(m)}function d(m){const M=Xr();if(!M)return;const D=Math.floor((M.getWidth()-m.region.width)/2),T=Math.floor((M.getHeight()-m.region.height)/2);M.placeRegion(m.region,D,T)}function f(m){an(m.seed),F(`Loaded pattern: ${m.name}`,"info")}function v(m,M){m.stopPropagation(),fo(M)}function _(){po()}function x(){const m=document.createElement("input");m.type="file",m.accept=".json",m.onchange=async M=>{const D=M.target.files?.[0];if(!D)return;const T=await D.text();try{ho(T)}catch{}},m.click()}function p(m,M){m.dataTransfer.effectAllowed="copy",m.dataTransfer.setData("text/plain",M.id),uo(M,m)}Pe(()=>r(),()=>{N(c,r().config.kernels[0])}),xr(),Zt();var b=Eo(),A=g(b);io(A,{});var E=w(A,2);Ve(E,{title:"METRICS",borderColor:"secondary",children:(m,M)=>{var D=go(),T=g(D),z=g(T),O=g(z),B=w(T,2),W=g(B),G=w(g(W),2),H=g(G),ge=w(W,2),Ye=w(g(ge),2),rt=g(Ye),ke=w(B,2),Ae=g(ke),ht=w(g(Ae),2),Dt=g(ht),Pt=w(Ae,2),je=w(g(Pt),2);let ae;je.__click=u;var qe=g(je);X(Lt=>{Y(O,n()),Y(H,`${a()??""}s`),Y(rt,s()),Y(Dt,(r(),$(()=>r().fps))),ae=be(je,1,"backend-btn svelte-1baw31t",null,ae,{gpu:r().backend==="gpu"}),je.disabled=(r(),$(()=>!r().gpuAvailable)),Y(qe,Lt)},[()=>(r(),$(()=>r().backend.toUpperCase()))]),k(m,D)},$$slots:{default:!0}});var S=w(E,2);Ve(S,{title:"KERNEL",borderColor:"primary",children:(m,M)=>{var D=_o(),T=g(D),z=w(g(T),2),O=g(z),B=w(T,2),W=w(g(B),2),G=g(W),H=w(B,2),ge=w(g(H),2),Ye=g(ge),rt=w(H,2),ke=w(g(rt),2),Ae=g(ke);X(()=>{Y(O,(h(c),$(()=>h(c)?.mu??"—"))),Y(G,(h(c),$(()=>h(c)?.sigma??"—"))),Y(Ye,(r(),$(()=>r().config.kernel_radius))),Y(Ae,(r(),$(()=>r().config.dt)))}),k(m,D)},$$slots:{default:!0}});var y=w(S,2);Ve(y,{title:"SEEDS",borderColor:"tertiary",children:(m,M)=>{var D=bo();Xt(D,5,()=>lo,dr,(T,z)=>{var O=mo();O.__click=()=>f(h(z));var B=g(O);X(()=>{ze(O,"title",(h(z),$(()=>h(z).description))),Y(B,(h(z),$(()=>h(z).name)))}),k(T,O)}),k(m,D)},$$slots:{default:!0}});var C=w(y,2);Ve(C,{title:"SAVED",borderColor:"primary",class:"saved-box",children:(m,M)=>{var D=So(),T=Qe(D),z=g(T);z.__click=x;var O=w(z,2);O.__click=_;var B=w(T,2);Xt(B,5,i,W=>W.id,(W,G)=>{var H=yo();H.__click=()=>d(h(G)),H.__keydown=ae=>ae.key==="Enter"&&d(h(G));var ge=g(H),Ye=g(ge);{var rt=ae=>{var qe=wo();X(()=>{ze(qe,"src",(h(G),$(()=>h(G).thumbnail))),ze(qe,"alt",(h(G),$(()=>h(G).name)))}),k(ae,qe)};ne(Ye,ae=>{h(G),$(()=>h(G).thumbnail)&&ae(rt)})}var ke=w(ge,2),Ae=g(ke),ht=g(Ae),Dt=w(Ae,2),Pt=g(Dt),je=w(ke,2);je.__click=ae=>v(ae,h(G).id),X(()=>{Y(ht,(h(G),$(()=>h(G).name))),Y(Pt,`${h(G),$(()=>h(G).region.width)??""}x${h(G),$(()=>h(G).region.height)??""}`)}),Ga("dragstart",H,ae=>p(ae,h(G))),k(W,H)},W=>{var G=xo();k(W,G)}),k(m,D)},$$slots:{default:!0}}),k(e,b),tt(),o()}Kt(["click","keydown"]);class Co{canvas;ctx;offscreenCanvas;offscreenCtx;settings;grayscaleMap;thermalMap;viridisMap;themeMap;constructor(t,r){this.canvas=t;const n=t.getContext("2d");if(!n)throw new Error("Failed to get 2D context");this.ctx=n,this.offscreenCanvas=document.createElement("canvas");const a=this.offscreenCanvas.getContext("2d");if(!a)throw new Error("Failed to get offscreen 2D context");this.offscreenCtx=a,this.settings=r,this.grayscaleMap=this.buildGrayscaleMap(),this.thermalMap=this.buildThermalMap(),this.viridisMap=this.buildViridisMap(),this.themeMap=this.viridisMap}setThemeColors(t){this.themeMap=this.buildThemeMap(t)}updateSettings(t){this.settings={...this.settings,...t}}render(t,r,n){const{width:a,height:s,channels:i}=t;(this.offscreenCanvas.width!==a||this.offscreenCanvas.height!==s)&&(this.offscreenCanvas.width=a,this.offscreenCanvas.height=s);const l=this.getColorMap(),o=this.offscreenCtx.createImageData(a,s),c=i[0];for(let u=0;u<c.length;u++){const d=Math.max(0,Math.min(1,c[u])),f=Math.floor(d*255)*4;o.data[u*4+0]=l[f+0],o.data[u*4+1]=l[f+1],o.data[u*4+2]=l[f+2],o.data[u*4+3]=255}this.offscreenCtx.putImageData(o,0,0),this.ctx.imageSmoothingEnabled=!1,this.ctx.fillStyle="#000",this.ctx.fillRect(0,0,this.canvas.width,this.canvas.height),this.ctx.drawImage(this.offscreenCanvas,0,0,a,s,0,0,this.canvas.width,this.canvas.height),this.settings.showGrid&&this.drawGrid(a,s),n&&this.drawGhostPreview(n,a,s),r&&this.settings.showSelection&&this.drawSelection(r,a,s)}drawGrid(t,r){const n=this.canvas.width/t,a=this.canvas.height/r;if(this.ctx.strokeStyle="rgba(255, 255, 255, 0.1)",this.ctx.lineWidth=1,n>=4&&a>=4){this.ctx.beginPath();for(let s=0;s<=t;s++){const i=s*n;this.ctx.moveTo(i,0),this.ctx.lineTo(i,this.canvas.height)}for(let s=0;s<=r;s++){const i=s*a;this.ctx.moveTo(0,i),this.ctx.lineTo(this.canvas.width,i)}this.ctx.stroke()}}drawSelection(t,r,n){const a=this.canvas.width/r,s=this.canvas.height/n,i=Math.min(t.startX,t.endX)*a,l=Math.min(t.startY,t.endY)*s,o=Math.abs(t.endX-t.startX)*a,c=Math.abs(t.endY-t.startY)*s;this.ctx.fillStyle="rgba(79, 195, 247, 0.2)",this.ctx.fillRect(i,l,o,c),this.ctx.strokeStyle="#4fc3f7",this.ctx.lineWidth=2,this.ctx.setLineDash([5,5]),this.ctx.strokeRect(i,l,o,c),this.ctx.setLineDash([]);const u=Math.abs(t.endX-t.startX),d=Math.abs(t.endY-t.startY);u>0&&d>0&&(this.ctx.fillStyle="#4fc3f7",this.ctx.font="12px monospace",this.ctx.fillText(`${u} x ${d}`,i+4,l-4))}drawGhostPreview(t,r,n){const a=this.canvas.width/r,s=this.canvas.height/n,{region:i,x:l,y:o}=t,c=document.createElement("canvas");c.width=i.width,c.height=i.height;const u=c.getContext("2d"),d=u.createImageData(i.width,i.height),f=this.getColorMap();for(let v=0;v<i.channels[0].length;v++){const _=Math.max(0,Math.min(1,i.channels[0][v])),x=Math.floor(_*255)*4;d.data[v*4+0]=f[x+0],d.data[v*4+1]=f[x+1],d.data[v*4+2]=f[x+2],d.data[v*4+3]=_>.01?180:0}u.putImageData(d,0,0),this.ctx.globalAlpha=.7,this.ctx.drawImage(c,0,0,i.width,i.height,l*a,o*s,i.width*a,i.height*s),this.ctx.globalAlpha=1,this.ctx.strokeStyle="#4fc3f7",this.ctx.lineWidth=2,this.ctx.setLineDash([3,3]),this.ctx.strokeRect(l*a,o*s,i.width*a,i.height*s),this.ctx.setLineDash([])}canvasToSim(t,r,n,a){const s=this.canvas.getBoundingClientRect(),i=n/this.canvas.width,l=a/this.canvas.height;return{x:Math.floor((t-s.left)*i),y:Math.floor((r-s.top)*l)}}getColorMap(){switch(this.settings.colorScheme){case"thermal":return this.thermalMap;case"viridis":return this.viridisMap;case"theme":return this.themeMap;default:return this.grayscaleMap}}buildGrayscaleMap(){const t=new Uint8ClampedArray(1024);for(let r=0;r<256;r++)t[r*4+0]=r,t[r*4+1]=r,t[r*4+2]=r,t[r*4+3]=255;return t}buildThermalMap(){const t=new Uint8ClampedArray(1024);for(let r=0;r<256;r++){const n=r/255;let a,s,i;if(n<.2){const l=n/.2;a=0,s=0,i=Math.floor(l*128)}else if(n<.4){const l=(n-.2)/.2;a=0,s=Math.floor(l*255),i=128+Math.floor(l*127)}else if(n<.6){const l=(n-.4)/.2;a=Math.floor(l*255),s=255,i=255-Math.floor(l*255)}else if(n<.8){const l=(n-.6)/.2;a=255,s=255-Math.floor(l*255),i=0}else{const l=(n-.8)/.2;a=255,s=Math.floor(l*255),i=Math.floor(l*255)}t[r*4+0]=a,t[r*4+1]=s,t[r*4+2]=i,t[r*4+3]=255}return t}buildViridisMap(){const t=[[68,1,84],[72,35,116],[64,67,135],[52,94,141],[41,120,142],[32,144,140],[34,167,132],[68,190,112],[121,209,81],[189,222,38],[253,231,36]],r=new Uint8ClampedArray(256*4);for(let n=0;n<256;n++){const s=n/255*(t.length-1),i=Math.floor(s),l=Math.min(i+1,t.length-1),o=s-i;r[n*4+0]=Math.floor(t[i][0]+o*(t[l][0]-t[i][0])),r[n*4+1]=Math.floor(t[i][1]+o*(t[l][1]-t[i][1])),r[n*4+2]=Math.floor(t[i][2]+o*(t[l][2]-t[i][2])),r[n*4+3]=255}return r}getCanvas(){return this.canvas}buildThemeMap(t){const r=o=>{const c=o.replace("#","");return[parseInt(c.slice(0,2),16),parseInt(c.slice(2,4),16),parseInt(c.slice(4,6),16)]},n=r(t.primary),a=r(t.secondary),s=r(t.tertiary),i=[{t:0,color:[5,5,5]},{t:.15,color:[n[0]*.3,n[1]*.3,n[2]*.3]},{t:.35,color:n},{t:.6,color:a},{t:.85,color:s},{t:1,color:[255,255,255]}],l=new Uint8ClampedArray(256*4);for(let o=0;o<256;o++){const c=o/255;let u=i[0],d=i[1];for(let v=1;v<i.length;v++)if(c<=i[v].t){u=i[v-1],d=i[v];break}const f=(c-u.t)/(d.t-u.t);l[o*4+0]=Math.floor(u.color[0]+f*(d.color[0]-u.color[0])),l[o*4+1]=Math.floor(u.color[1]+f*(d.color[1]-u.color[1])),l[o*4+2]=Math.floor(u.color[2]+f*(d.color[2]-u.color[2])),l[o*4+3]=255}return l}}class To{canvas;simulation;callbacks;mode="view";selection=null;isSelecting=!1;isDrawing=!1;isDragging=!1;draggedCreature=null;ghostPreview=null;brushSize=3;brushIntensity=.5;constructor(t,r,n,a={}){this.canvas=t,this.simulation=r,this.callbacks=a,this.setupEventListeners(),this.setupDragDrop()}setMode(t){switch(this.mode=t,this.selection=null,this.isSelecting=!1,this.isDrawing=!1,t){case"select":this.canvas.style.cursor="crosshair";break;case"draw":this.canvas.style.cursor="cell";break;case"erase":this.canvas.style.cursor="not-allowed";break;default:this.canvas.style.cursor="default"}this.callbacks.onModeChange?.(t)}getMode(){return this.mode}getSelection(){return this.selection}clearSelection(){this.selection=null,this.callbacks.onSelectionChange?.(null)}setBrushSize(t){this.brushSize=Math.max(1,Math.min(20,t))}setBrushIntensity(t){this.brushIntensity=Math.max(0,Math.min(1,t))}getGhostPreview(){return this.ghostPreview}startDragFromLibrary(t,r){this.isDragging=!0,this.draggedCreature={preset:t,offsetX:t.region.width/2,offsetY:t.region.height/2};const n=this.getSimCoords(r);this.ghostPreview={region:t.region,x:n.x-this.draggedCreature.offsetX,y:n.y-this.draggedCreature.offsetY}}setupEventListeners(){this.canvas.addEventListener("mousedown",this.handleMouseDown.bind(this)),this.canvas.addEventListener("mousemove",this.handleMouseMove.bind(this)),this.canvas.addEventListener("mouseup",this.handleMouseUp.bind(this)),this.canvas.addEventListener("mouseleave",this.handleMouseLeave.bind(this)),document.addEventListener("keydown",this.handleKeyDown.bind(this))}setupDragDrop(){this.canvas.addEventListener("dragover",t=>{if(t.preventDefault(),t.dataTransfer.dropEffect="copy",this.draggedCreature){const r=this.getSimCoords(t);this.ghostPreview={region:this.draggedCreature.preset.region,x:r.x-this.draggedCreature.offsetX,y:r.y-this.draggedCreature.offsetY}}}),this.canvas.addEventListener("drop",t=>{if(t.preventDefault(),this.draggedCreature){const r=this.getSimCoords(t),n=Math.floor(r.x-this.draggedCreature.offsetX),a=Math.floor(r.y-this.draggedCreature.offsetY);this.callbacks.onDrop?.(this.draggedCreature.preset,n,a),this.draggedCreature=null,this.ghostPreview=null,this.isDragging=!1}}),this.canvas.addEventListener("dragleave",()=>{this.ghostPreview=null})}handleMouseDown(t){const r=this.getSimCoords(t);switch(this.mode){case"select":this.isSelecting=!0,this.selection={startX:r.x,startY:r.y,endX:r.x,endY:r.y},this.callbacks.onSelectionChange?.(this.selection);break;case"draw":this.isDrawing=!0,this.callbacks.onDraw?.(r.x,r.y);break;case"erase":this.isDrawing=!0,this.callbacks.onErase?.(r.x,r.y);break}}handleMouseMove(t){const r=this.getSimCoords(t);this.isSelecting&&this.selection&&(this.selection.endX=r.x,this.selection.endY=r.y,this.callbacks.onSelectionChange?.(this.selection)),this.isDrawing&&(this.mode==="draw"?this.callbacks.onDraw?.(r.x,r.y):this.mode==="erase"&&this.callbacks.onErase?.(r.x,r.y)),this.isDragging&&this.draggedCreature&&(this.ghostPreview={region:this.draggedCreature.preset.region,x:r.x-this.draggedCreature.offsetX,y:r.y-this.draggedCreature.offsetY})}handleMouseUp(t){if(this.isSelecting&&this.selection){const r={startX:Math.min(this.selection.startX,this.selection.endX),startY:Math.min(this.selection.startY,this.selection.endY),endX:Math.max(this.selection.startX,this.selection.endX),endY:Math.max(this.selection.startY,this.selection.endY)};r.endX>r.startX&&r.endY>r.startY?(this.selection=r,this.callbacks.onSelectionComplete?.(r)):this.selection=null,this.callbacks.onSelectionChange?.(this.selection)}this.isSelecting=!1,this.isDrawing=!1}handleMouseLeave(t){this.isSelecting&&(this.isSelecting=!1,this.selection=null,this.callbacks.onSelectionChange?.(null)),this.isDrawing=!1,this.ghostPreview=null}handleKeyDown(t){const r=t.target;r.tagName==="INPUT"||r.tagName==="TEXTAREA"||(t.key==="v"||t.key==="Escape"?this.setMode("view"):t.key==="s"?this.setMode("select"):t.key==="d"?this.setMode("draw"):t.key==="e"&&this.setMode("erase"),t.key==="["?(this.setBrushSize(this.brushSize-1),this.callbacks.onBrushSizeChange?.(this.brushSize)):t.key==="]"&&(this.setBrushSize(this.brushSize+1),this.callbacks.onBrushSizeChange?.(this.brushSize)))}getSimCoords(t){const r=this.canvas.getBoundingClientRect(),n=t.clientX-r.left,a=t.clientY-r.top,s=this.simulation.getWidth(),i=this.simulation.getHeight();return{x:Math.floor(n/r.width*s),y:Math.floor(a/r.height*i)}}getBrushSize(){return this.brushSize}getBrushIntensity(){return this.brushIntensity}}var ko=I('<div class="simulation-view svelte-145nxqv"><div class="canvas-frame svelte-145nxqv"><div class="canvas-header svelte-145nxqv"><span class="dim-label svelte-145nxqv"> </span></div> <div class="canvas-container svelte-145nxqv"><canvas class="svelte-145nxqv"></canvas> <div class="corner-marker top-left svelte-145nxqv"></div> <div class="corner-marker top-right svelte-145nxqv"></div> <div class="corner-marker bottom-left svelte-145nxqv"></div> <div class="corner-marker bottom-right svelte-145nxqv"></div> <div class="canvas-scanlines svelte-145nxqv"></div></div></div></div>');function Ao(e,t){et(t,!1);const r=()=>J(It,"$settings",i),n=()=>J(ee,"$simulationStore",i),a=()=>J(Mr,"$currentScheme",i),s=()=>J(Es,"$renderTrigger",i),[i,l]=$t();let o=V(),c=V(),u=V(null),d=V(null);const f=512;Er(()=>{const y=Xr();!y||!h(c)||(Mn.set(h(c)),N(u,new Co(h(c),{colorScheme:r().colorScheme,showGrid:r().showGrid,showSelection:r().showSelection,brushSize:r().brushSize,brushIntensity:r().brushIntensity,backend:n().backend})),N(d,new To(h(c),y,h(u),{onSelectionChange:()=>v(),onSelectionComplete:()=>{},onDrop:(C,m,M)=>{y.placeRegion(C.region,m,M),v()},onDraw:(C,m)=>{y.drawAt(C,m,r().brushSize,r().brushIntensity),v()},onErase:(C,m)=>{y.eraseAt(C,m,r().brushSize),v()},onModeChange:()=>{},onBrushSizeChange:()=>{}})),Hr.set(h(d)),v())}),oi(()=>{Hr.set(null),Mn.set(null),N(u,null),N(d,null)});function v(){if(!h(u))return;const y=Xr();if(!y)return;const C=y.getState(),m=h(d)?.getSelection(),M=h(d)?.getGhostPreview();h(u).render(C,m,M)}Pe(()=>(n(),h(u)),()=>{n().state&&h(u)&&v()}),Pe(()=>(h(d),r()),()=>{h(d)&&r().mode&&h(d).setMode(r().mode)}),Pe(()=>(h(d),r()),()=>{h(d)&&(h(d).setBrushSize(r().brushSize),h(d).setBrushIntensity(r().brushIntensity))}),Pe(()=>(h(u),r()),()=>{h(u)&&r().colorScheme&&(h(u).updateSettings({colorScheme:r().colorScheme}),v())}),Pe(()=>(h(u),a()),()=>{h(u)&&a()&&(h(u).setThemeColors({primary:a().colors.primary,secondary:a().colors.secondary,tertiary:a().colors.tertiary}),v())}),Pe(()=>(s(),h(u)),()=>{s()&&h(u)&&v()}),xr(),Zt();var _=ko(),x=g(_),p=g(x),b=g(p),A=g(b),E=w(p,2),S=g(E);ze(S,"width",f),ze(S,"height",f),vr(S,y=>N(c,y),()=>h(c)),vr(E,y=>N(o,y),()=>h(o)),X(()=>Y(A,`${n(),$(()=>n().config.width)??""}x${n(),$(()=>n().config.height)??""}`)),k(e,_),tt(),l()}var $o=I('<div class="loading-screen svelte-1n46o8q"><div class="loading-content svelte-1n46o8q"><div class="glitch-text svelte-1n46o8q" data-text="FLOW_LENIA">FLOW_LENIA</div> <div class="loading-status svelte-1n46o8q"><span class="animate-pulse">INITIALIZING SUBSTRATE</span> <span class="animate-blink">_</span></div></div></div>'),Io=I('<div class="error-screen svelte-1n46o8q"><div class="error-content svelte-1n46o8q"><div class="error-title svelte-1n46o8q">SYSTEM FAILURE</div> <div class="error-message svelte-1n46o8q"> </div> <div class="error-hint svelte-1n46o8q">Ensure WASM is built: <code class="svelte-1n46o8q">wasm-pack build --target web --release</code></div></div></div>'),Do=I('<div class="scanlines"></div>'),Po=I('<div class="app-container svelte-1n46o8q"><!> <div class="main-content svelte-1n46o8q"><!> <!> <!></div> <!></div> <!> <div class="vignette"></div>',1);function Lo(e,t){et(t,!1);const r=()=>J(ee,"$simulationStore",s),n=()=>J(Mr,"$currentScheme",s),a=()=>J(It,"$settings",s),[s,i]=$t();let l=V(!1),o=V(null),c=V(),u=V("");function d(p,b){const A=parseInt(p.slice(1,3),16),E=parseInt(p.slice(3,5),16),S=parseInt(p.slice(5,7),16);return`rgba(${A}, ${E}, ${S}, ${b})`}Er(async()=>{Ci(),F("SYS.BOOT","info"),F("Loading WASM module...","info");try{await hi(),N(l,!0),F("WASM initialized","success"),F(`Backend: ${r().backend.toUpperCase()}`,"info"),F(`Theme: ${n().name}`,"info"),r().gpuAvailable?F("WebGPU available","success"):F("WebGPU not available","warn"),F("SYSTEM READY","success")}catch(p){N(o,String(p)),F(`INIT FAILED: ${p}`,"error")}}),Pe(()=>(r(),n()),()=>{const{width:p,height:b}=r().config,A=Math.max(1,p*b),E=r().totalMass/A,y=.15+Math.min(1,Math.max(0,E))*.45,C=n().colors;N(u,[`--color-primary-glow: ${d(C.primary,y)}`,`--color-secondary-glow: ${d(C.secondary,y)}`,`--color-tertiary-glow: ${d(C.tertiary,y)}`].join("; "))}),xr(),Zt();var f=Br(),v=Qe(f);{var _=p=>{var b=$o();k(p,b)},x=p=>{var b=Br(),A=Qe(b);{var E=y=>{var C=Io(),m=g(C),M=w(g(m),2),D=g(M);X(()=>Y(D,h(o))),k(y,C)},S=y=>{var C=Po(),m=Qe(C),M=g(m);Ai(M,{});var D=w(M,2),T=g(D);Wi(T,{});var z=w(T,2);Ao(z,{});var O=w(z,2);Mo(O,{});var B=w(D,2);Ii(B),vr(m,H=>N(c,H),()=>h(c));var W=w(m,2);{var G=H=>{var ge=Do();k(H,ge)};ne(W,H=>{a(),$(()=>a().showScanlines)&&H(G)})}X(()=>nn(m,h(u))),k(y,C)};ne(A,y=>{h(o)?y(E):y(S,!1)},!0)}k(p,b)};ne(v,p=>{!h(l)&&!h(o)?p(_):p(x,!1)})}k(e,f),tt(),i()}Ba(Lo,{target:document.getElementById("app")});
