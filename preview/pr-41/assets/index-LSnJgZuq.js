(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))n(i);new MutationObserver(i=>{for(const r of i)if(r.type==="childList")for(const a of r.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&n(a)}).observe(document,{childList:!0,subtree:!0});function s(i){const r={};return i.integrity&&(r.integrity=i.integrity),i.referrerPolicy&&(r.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?r.credentials="include":i.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function n(i){if(i.ep)return;i.ep=!0;const r=s(i);fetch(i.href,r)}})();const an=!1;var yn=Array.isArray,Oi=Array.prototype.indexOf,Bs=Array.from,ar=Object.defineProperty,Ut=Object.getOwnPropertyDescriptor,or=Object.getOwnPropertyDescriptors,Li=Object.prototype,Ri=Array.prototype,xn=Object.getPrototypeOf,Yn=Object.isExtensible;const st=()=>{};function Ni(e){return e()}function Ls(e){for(var t=0;t<e.length;t++)e[t]()}function lr(){var e,t,s=new Promise((n,i)=>{e=n,t=i});return{promise:s,resolve:e,reject:t}}const ce=2,Sn=4,Ys=8,Fi=1<<24,at=16,ot=32,Ot=64,Xs=128,Ne=512,oe=1024,ye=2048,Fe=4096,Ee=8192,nt=16384,En=32768,$t=65536,Xn=1<<17,cr=1<<18,Vt=1<<19,ur=1<<20,tt=1<<25,It=32768,on=1<<21,Mn=1<<22,_t=1<<23,rt=Symbol("$state"),zi=Symbol("legacy props"),Gi=Symbol(""),Yt=new class extends Error{name="StaleReactionError";message="The reaction that called `getAbortSignal()` was re-run or destroyed"};function fr(e){throw new Error("https://svelte.dev/e/lifecycle_outside_component")}function Bi(){throw new Error("https://svelte.dev/e/async_derived_orphan")}function Yi(e){throw new Error("https://svelte.dev/e/effect_in_teardown")}function Xi(){throw new Error("https://svelte.dev/e/effect_in_unowned_derived")}function Ui(e){throw new Error("https://svelte.dev/e/effect_orphan")}function qi(){throw new Error("https://svelte.dev/e/effect_update_depth_exceeded")}function ji(e){throw new Error("https://svelte.dev/e/props_invalid_value")}function Wi(){throw new Error("https://svelte.dev/e/state_descriptors_fixed")}function Hi(){throw new Error("https://svelte.dev/e/state_prototype_fixed")}function Vi(){throw new Error("https://svelte.dev/e/state_unsafe_mutation")}function Ki(){throw new Error("https://svelte.dev/e/svelte_boundary_reset_onerror")}const Ji=1,Zi=2,dr=4,Qi=8,ea=16,ta=1,sa=2,na=4,ra=8,ia=16,aa=1,oa=2,fe=Symbol(),la="http://www.w3.org/1999/xhtml";function ca(){console.warn("https://svelte.dev/e/select_multiple_invalid_value")}function ua(){console.warn("https://svelte.dev/e/svelte_boundary_reset_noop")}function vr(e){return e===this.v}function hr(e,t){return e!=e?t==t:e!==t||e!==null&&typeof e=="object"||typeof e=="function"}function pr(e){return!hr(e,this.v)}let Kt=!1,fa=!1;function da(){Kt=!0}let K=null;function qt(e){K=e}function lt(e,t=!1,s){K={p:K,i:!1,c:null,e:null,s:e,x:null,l:Kt&&!t?{s:null,u:null,$:[]}:null}}function ct(e){var t=K,s=t.e;if(s!==null){t.e=null;for(var n of s)Ar(n)}return t.i=!0,K=t.p,{}}function bs(){return!Kt||K!==null&&K.l===null}let Mt=[];function gr(){var e=Mt;Mt=[],Ls(e)}function Jt(e){if(Mt.length===0&&!cs){var t=Mt;queueMicrotask(()=>{t===Mt&&gr()})}Mt.push(e)}function va(){for(;Mt.length>0;)gr()}function _r(e){var t=U;if(t===null)return G.f|=_t,e;if((t.f&En)===0){if((t.f&Xs)===0)throw e;t.b.error(e)}else jt(e,t)}function jt(e,t){for(;t!==null;){if((t.f&Xs)!==0)try{t.b.error(e);return}catch(s){e=s}t=t.parent}throw e}const ks=new Set;let B=null,ls=null,De=null,$e=[],Us=null,ln=!1,cs=!1;class je{committed=!1;current=new Map;previous=new Map;#e=new Set;#t=new Set;#n=0;#s=0;#l=null;#i=new Set;#r=new Set;skipped_effects=new Set;is_fork=!1;is_deferred(){return this.is_fork||this.#s>0}process(t){$e=[],ls=null,this.apply();var s={parent:null,effect:null,effects:[],render_effects:[]};for(const n of t)this.#a(n,s);this.is_fork||this.#u(),this.is_deferred()?(this.#o(s.effects),this.#o(s.render_effects)):(ls=this,B=null,Un(s.render_effects),Un(s.effects),ls=null,this.#l?.resolve()),De=null}#a(t,s){t.f^=oe;for(var n=t.first;n!==null;){var i=n.f,r=(i&(ot|Ot))!==0,a=r&&(i&oe)!==0,o=a||(i&Ee)!==0||this.skipped_effects.has(n);if((n.f&Xs)!==0&&n.b?.is_pending()&&(s={parent:s,effect:n,effects:[],render_effects:[]}),!o&&n.fn!==null){r?n.f^=oe:(i&Sn)!==0?s.effects.push(n):Zt(n)&&((n.f&at)!==0&&this.#i.add(n),Wt(n));var l=n.first;if(l!==null){n=l;continue}}var c=n.parent;for(n=n.next;n===null&&c!==null;)c===s.effect&&(this.#o(s.effects),this.#o(s.render_effects),s=s.parent),n=c.next,c=c.parent}}#o(t){for(const s of t)(s.f&ye)!==0?this.#i.add(s):(s.f&Fe)!==0&&this.#r.add(s),this.#c(s.deps),le(s,oe)}#c(t){if(t!==null)for(const s of t)(s.f&ce)===0||(s.f&It)===0||(s.f^=It,this.#c(s.deps))}capture(t,s){this.previous.has(t)||this.previous.set(t,s),(t.f&_t)===0&&(this.current.set(t,t.v),De?.set(t,t.v))}activate(){B=this,this.apply()}deactivate(){B===this&&(B=null,De=null)}flush(){if(this.activate(),$e.length>0){if(mr(),B!==null&&B!==this)return}else this.#n===0&&this.process([]);this.deactivate()}discard(){for(const t of this.#t)t(this);this.#t.clear()}#u(){if(this.#s===0){for(const t of this.#e)t();this.#e.clear()}this.#n===0&&this.#f()}#f(){if(ks.size>1){this.previous.clear();var t=De,s=!0,n={parent:null,effect:null,effects:[],render_effects:[]};for(const r of ks){if(r===this){s=!1;continue}const a=[];for(const[l,c]of this.current){if(r.current.has(l))if(s&&c!==r.current.get(l))r.current.set(l,c);else continue;a.push(l)}if(a.length===0)continue;const o=[...r.current.keys()].filter(l=>!this.current.has(l));if(o.length>0){var i=$e;$e=[];const l=new Set,c=new Map;for(const u of a)br(u,o,l,c);if($e.length>0){B=r,r.apply();for(const u of $e)r.#a(u,n);r.deactivate()}$e=i}}B=null,De=t}this.committed=!0,ks.delete(this)}increment(t){this.#n+=1,t&&(this.#s+=1)}decrement(t){this.#n-=1,t&&(this.#s-=1),this.revive()}revive(){for(const t of this.#i)this.#r.delete(t),le(t,ye),At(t);for(const t of this.#r)le(t,Fe),At(t);this.flush()}oncommit(t){this.#e.add(t)}ondiscard(t){this.#t.add(t)}settled(){return(this.#l??=lr()).promise}static ensure(){if(B===null){const t=B=new je;ks.add(B),cs||je.enqueue(()=>{B===t&&t.flush()})}return B}static enqueue(t){Jt(t)}apply(){}}function ha(e){var t=cs;cs=!0;try{for(var s;;){if(va(),$e.length===0&&(B?.flush(),$e.length===0))return Us=null,s;mr()}}finally{cs=t}}function mr(){var e=kt;ln=!0;var t=null;try{var s=0;for(Ns(!0);$e.length>0;){var n=je.ensure();if(s++>1e3){var i,r;pa()}n.process($e),mt.clear()}}finally{ln=!1,Ns(e),Us=null}}function pa(){try{qi()}catch(e){jt(e,Us)}}let Ze=null;function Un(e){var t=e.length;if(t!==0){for(var s=0;s<t;){var n=e[s++];if((n.f&(nt|Ee))===0&&Zt(n)&&(Ze=new Set,Wt(n),n.deps===null&&n.first===null&&n.nodes===null&&(n.teardown===null&&n.ac===null?Rr(n):n.fn=null),Ze?.size>0)){mt.clear();for(const i of Ze){if((i.f&(nt|Ee))!==0)continue;const r=[i];let a=i.parent;for(;a!==null;)Ze.has(a)&&(Ze.delete(a),r.push(a)),a=a.parent;for(let o=r.length-1;o>=0;o--){const l=r[o];(l.f&(nt|Ee))===0&&Wt(l)}}Ze.clear()}}Ze=null}}function br(e,t,s,n){if(!s.has(e)&&(s.add(e),e.reactions!==null))for(const i of e.reactions){const r=i.f;(r&ce)!==0?br(i,t,s,n):(r&(Mn|at))!==0&&(r&ye)===0&&wr(i,t,n)&&(le(i,ye),At(i))}}function wr(e,t,s){const n=s.get(e);if(n!==void 0)return n;if(e.deps!==null)for(const i of e.deps){if(t.includes(i))return!0;if((i.f&ce)!==0&&wr(i,t,s))return s.set(i,!0),!0}return s.set(e,!1),!1}function At(e){for(var t=Us=e;t.parent!==null;){t=t.parent;var s=t.f;if(ln&&t===U&&(s&at)!==0&&(s&cr)===0)return;if((s&(Ot|ot))!==0){if((s&oe)===0)return;t.f^=oe}}$e.push(t)}function ga(e){let t=0,s=Dt(0),n;return()=>{hs()&&(f(s),xs(()=>(t===0&&(n=R(()=>e(()=>us(s)))),t+=1,()=>{Jt(()=>{t-=1,t===0&&(n?.(),n=void 0,us(s))})})))}}var _a=$t|Vt|Xs;function ma(e,t,s){new ba(e,t,s)}class ba{parent;#e=!1;#t;#n=null;#s;#l;#i;#r=null;#a=null;#o=null;#c=null;#u=null;#f=0;#d=0;#h=!1;#v=null;#b=ga(()=>(this.#v=Dt(this.#f),()=>{this.#v=null}));constructor(t,s,n){this.#t=t,this.#s=s,this.#l=n,this.parent=U.b,this.#e=!!this.#s.pending,this.#i=Hs(()=>{U.b=this;{var i=this.#_();try{this.#r=Ie(()=>n(i))}catch(r){this.error(r)}this.#d>0?this.#g():this.#e=!1}return()=>{this.#u?.remove()}},_a)}#w(){try{this.#r=Ie(()=>this.#l(this.#t))}catch(t){this.error(t)}this.#e=!1}#y(){const t=this.#s.pending;t&&(this.#a=Ie(()=>t(this.#t)),je.enqueue(()=>{var s=this.#_();this.#r=this.#p(()=>(je.ensure(),Ie(()=>this.#l(s)))),this.#d>0?this.#g():(Tt(this.#a,()=>{this.#a=null}),this.#e=!1)}))}#_(){var t=this.#t;return this.#e&&(this.#u=bt(),this.#t.before(this.#u),t=this.#u),t}is_pending(){return this.#e||!!this.parent&&this.parent.is_pending()}has_pending_snippet(){return!!this.#s.pending}#p(t){var s=U,n=G,i=K;He(this.#i),be(this.#i),qt(this.#i.ctx);try{return t()}catch(r){return _r(r),null}finally{He(s),be(n),qt(i)}}#g(){const t=this.#s.pending;this.#r!==null&&(this.#c=document.createDocumentFragment(),this.#c.append(this.#u),zr(this.#r,this.#c)),this.#a===null&&(this.#a=Ie(()=>t(this.#t)))}#m(t){if(!this.has_pending_snippet()){this.parent&&this.parent.#m(t);return}this.#d+=t,this.#d===0&&(this.#e=!1,this.#a&&Tt(this.#a,()=>{this.#a=null}),this.#c&&(this.#t.before(this.#c),this.#c=null))}update_pending_count(t){this.#m(t),this.#f+=t,this.#v&&Pt(this.#v,this.#f)}get_effect_pending(){return this.#b(),f(this.#v)}error(t){var s=this.#s.onerror;let n=this.#s.failed;if(this.#h||!s&&!n)throw t;this.#r&&(we(this.#r),this.#r=null),this.#a&&(we(this.#a),this.#a=null),this.#o&&(we(this.#o),this.#o=null);var i=!1,r=!1;const a=()=>{if(i){ua();return}i=!0,r&&Ki(),je.ensure(),this.#f=0,this.#o!==null&&Tt(this.#o,()=>{this.#o=null}),this.#e=this.has_pending_snippet(),this.#r=this.#p(()=>(this.#h=!1,Ie(()=>this.#l(this.#t)))),this.#d>0?this.#g():this.#e=!1};var o=G;try{be(null),r=!0,s?.(t,a),r=!1}catch(l){jt(l,this.#i&&this.#i.parent)}finally{be(o)}n&&Jt(()=>{this.#o=this.#p(()=>{je.ensure(),this.#h=!0;try{return Ie(()=>{n(this.#t,()=>t,()=>a)})}catch(l){return jt(l,this.#i.parent),null}finally{this.#h=!1}})})}}function wa(e,t,s,n){const i=bs()?ws:Tn;if(s.length===0&&e.length===0){n(t.map(i));return}var r=B,a=U,o=ya();function l(){Promise.all(s.map(c=>xa(c))).then(c=>{o();try{n([...t.map(i),...c])}catch(u){(a.f&nt)===0&&jt(u,a)}r?.deactivate(),Rs()}).catch(c=>{jt(c,a)})}e.length>0?Promise.all(e).then(()=>{o();try{return l()}finally{r?.deactivate(),Rs()}}):l()}function ya(){var e=U,t=G,s=K,n=B;return function(r=!0){He(e),be(t),qt(s),r&&n?.activate()}}function Rs(){He(null),be(null),qt(null)}function ws(e){var t=ce|ye,s=G!==null&&(G.f&ce)!==0?G:null;return U!==null&&(U.f|=Vt),{ctx:K,deps:null,effects:null,equals:vr,f:t,fn:e,reactions:null,rv:0,v:fe,wv:0,parent:s??U,ac:null}}function xa(e,t){let s=U;s===null&&Bi();var n=s.b,i=void 0,r=Dt(fe),a=!G,o=new Map;return Oa(()=>{var l=lr();i=l.promise;try{Promise.resolve(e()).then(l.resolve,l.reject).then(()=>{c===B&&c.committed&&c.deactivate(),Rs()})}catch(d){l.reject(d),Rs()}var c=B;if(a){var u=!n.is_pending();n.update_pending_count(1),c.increment(u),o.get(c)?.reject(Yt),o.delete(c),o.set(c,l)}const v=(d,h=void 0)=>{if(c.activate(),h)h!==Yt&&(r.f|=_t,Pt(r,h));else{(r.f&_t)!==0&&(r.f^=_t),Pt(r,d);for(const[m,y]of o){if(o.delete(m),m===c)break;y.reject(Yt)}}a&&(n.update_pending_count(-1),c.decrement(u))};l.promise.then(v,d=>v(null,d||"unknown"))}),js(()=>{for(const l of o.values())l.reject(Yt)}),new Promise(l=>{function c(u){function v(){u===i?l(r):c(i)}u.then(v,v)}c(i)})}function Sa(e){const t=ws(e);return Gr(t),t}function Tn(e){const t=ws(e);return t.equals=pr,t}function yr(e){var t=e.effects;if(t!==null){e.effects=null;for(var s=0;s<t.length;s+=1)we(t[s])}}function Ea(e){for(var t=e.parent;t!==null;){if((t.f&ce)===0)return(t.f&nt)===0?t:null;t=t.parent}return null}function kn(e){var t,s=U;He(Ea(e));try{e.f&=~It,yr(e),t=Ur(e)}finally{He(s)}return t}function xr(e){var t=kn(e);if(e.equals(t)||(B?.is_fork||(e.v=t),e.wv=Yr()),!Lt)if(De!==null)(hs()||B?.is_fork)&&De.set(e,t);else{var s=(e.f&Ne)===0?Fe:oe;le(e,s)}}let cn=new Set;const mt=new Map;let Sr=!1;function Dt(e,t){var s={f:0,v:e,reactions:null,equals:vr,rv:0,wv:0};return s}function Xe(e,t){const s=Dt(e);return Gr(s),s}function ne(e,t=!1,s=!0){const n=Dt(e);return t||(n.equals=pr),Kt&&s&&K!==null&&K.l!==null&&(K.l.s??=[]).push(n),n}function Ma(e,t){return X(e,R(()=>f(e))),t}function X(e,t,s=!1){G!==null&&(!We||(G.f&Xn)!==0)&&bs()&&(G.f&(ce|at|Mn|Xn))!==0&&!it?.includes(e)&&Vi();let n=s?Xt(t):t;return Pt(e,n)}function Pt(e,t){if(!e.equals(t)){var s=e.v;Lt?mt.set(e,t):mt.set(e,s),e.v=t;var n=je.ensure();n.capture(e,s),(e.f&ce)!==0&&((e.f&ye)!==0&&kn(e),le(e,(e.f&Ne)!==0?oe:Fe)),e.wv=Yr(),Er(e,ye),bs()&&U!==null&&(U.f&oe)!==0&&(U.f&(ot|Ot))===0&&(Ce===null?Fa([e]):Ce.push(e)),!n.is_fork&&cn.size>0&&!Sr&&Ta()}return t}function Ta(){Sr=!1;var e=kt;Ns(!0);const t=Array.from(cn);try{for(const s of t)(s.f&oe)!==0&&le(s,Fe),Zt(s)&&Wt(s)}finally{Ns(e)}cn.clear()}function us(e){X(e,e.v+1)}function Er(e,t){var s=e.reactions;if(s!==null)for(var n=bs(),i=s.length,r=0;r<i;r++){var a=s[r],o=a.f;if(!(!n&&a===U)){var l=(o&ye)===0;if(l&&le(a,t),(o&ce)!==0){var c=a;De?.delete(c),(o&It)===0&&(o&Ne&&(a.f|=It),Er(c,Fe))}else l&&((o&at)!==0&&Ze!==null&&Ze.add(a),At(a))}}}function Xt(e){if(typeof e!="object"||e===null||rt in e)return e;const t=xn(e);if(t!==Li&&t!==Ri)return e;var s=new Map,n=yn(e),i=Xe(0),r=Ct,a=o=>{if(Ct===r)return o();var l=G,c=Ct;be(null),Vn(r);var u=o();return be(l),Vn(c),u};return n&&s.set("length",Xe(e.length)),new Proxy(e,{defineProperty(o,l,c){(!("value"in c)||c.configurable===!1||c.enumerable===!1||c.writable===!1)&&Wi();var u=s.get(l);return u===void 0?u=a(()=>{var v=Xe(c.value);return s.set(l,v),v}):X(u,c.value,!0),!0},deleteProperty(o,l){var c=s.get(l);if(c===void 0){if(l in o){const u=a(()=>Xe(fe));s.set(l,u),us(i)}}else X(c,fe),us(i);return!0},get(o,l,c){if(l===rt)return e;var u=s.get(l),v=l in o;if(u===void 0&&(!v||Ut(o,l)?.writable)&&(u=a(()=>{var h=Xt(v?o[l]:fe),m=Xe(h);return m}),s.set(l,u)),u!==void 0){var d=f(u);return d===fe?void 0:d}return Reflect.get(o,l,c)},getOwnPropertyDescriptor(o,l){var c=Reflect.getOwnPropertyDescriptor(o,l);if(c&&"value"in c){var u=s.get(l);u&&(c.value=f(u))}else if(c===void 0){var v=s.get(l),d=v?.v;if(v!==void 0&&d!==fe)return{enumerable:!0,configurable:!0,value:d,writable:!0}}return c},has(o,l){if(l===rt)return!0;var c=s.get(l),u=c!==void 0&&c.v!==fe||Reflect.has(o,l);if(c!==void 0||U!==null&&(!u||Ut(o,l)?.writable)){c===void 0&&(c=a(()=>{var d=u?Xt(o[l]):fe,h=Xe(d);return h}),s.set(l,c));var v=f(c);if(v===fe)return!1}return u},set(o,l,c,u){var v=s.get(l),d=l in o;if(n&&l==="length")for(var h=c;h<v.v;h+=1){var m=s.get(h+"");m!==void 0?X(m,fe):h in o&&(m=a(()=>Xe(fe)),s.set(h+"",m))}if(v===void 0)(!d||Ut(o,l)?.writable)&&(v=a(()=>Xe(void 0)),X(v,Xt(c)),s.set(l,v));else{d=v.v!==fe;var y=a(()=>Xt(c));X(v,y)}var _=Reflect.getOwnPropertyDescriptor(o,l);if(_?.set&&_.set.call(u,c),!d){if(n&&typeof l=="string"){var b=s.get("length"),A=Number(l);Number.isInteger(A)&&A>=b.v&&X(b,A+1)}us(i)}return!0},ownKeys(o){f(i);var l=Reflect.ownKeys(o).filter(v=>{var d=s.get(v);return d===void 0||d.v!==fe});for(var[c,u]of s)u.v!==fe&&!(c in o)&&l.push(c);return l},setPrototypeOf(){Hi()}})}function qn(e){try{if(e!==null&&typeof e=="object"&&rt in e)return e[rt]}catch{}return e}function ka(e,t){return Object.is(qn(e),qn(t))}var jn,Mr,Tr,kr;function Ca(){if(jn===void 0){jn=window,Mr=/Firefox/.test(navigator.userAgent);var e=Element.prototype,t=Node.prototype,s=Text.prototype;Tr=Ut(t,"firstChild").get,kr=Ut(t,"nextSibling").get,Yn(e)&&(e.__click=void 0,e.__className=void 0,e.__attributes=null,e.__style=void 0,e.__e=void 0),Yn(s)&&(s.__t=void 0)}}function bt(e=""){return document.createTextNode(e)}function pt(e){return Tr.call(e)}function ys(e){return kr.call(e)}function p(e,t){return pt(e)}function qe(e,t=!1){{var s=pt(e);return s instanceof Comment&&s.data===""?ys(s):s}}function g(e,t=1,s=!1){let n=e;for(;t--;)n=ys(n);return n}function $a(e){e.textContent=""}function Cr(){return!1}let Wn=!1;function Ia(){Wn||(Wn=!0,document.addEventListener("reset",e=>{Promise.resolve().then(()=>{if(!e.defaultPrevented)for(const t of e.target.elements)t.__on_r?.()})},{capture:!0}))}function qs(e){var t=G,s=U;be(null),He(null);try{return e()}finally{be(t),He(s)}}function $r(e,t,s,n=s){e.addEventListener(t,()=>qs(s));const i=e.__on_r;i?e.__on_r=()=>{i(),n(!0)}:e.__on_r=()=>n(!0),Ia()}function Ir(e){U===null&&(G===null&&Ui(),Xi()),Lt&&Yi()}function Aa(e,t){var s=t.last;s===null?t.last=t.first=e:(s.next=e,e.prev=s,t.last=e)}function Ve(e,t,s){var n=U;n!==null&&(n.f&Ee)!==0&&(e|=Ee);var i={ctx:K,deps:null,nodes:null,f:e|ye|Ne,first:null,fn:t,last:null,next:null,parent:n,b:n&&n.b,prev:null,teardown:null,wv:0,ac:null};if(s)try{Wt(i),i.f|=En}catch(o){throw we(i),o}else t!==null&&At(i);var r=i;if(s&&r.deps===null&&r.teardown===null&&r.nodes===null&&r.first===r.last&&(r.f&Vt)===0&&(r=r.first,(e&at)!==0&&(e&$t)!==0&&r!==null&&(r.f|=$t)),r!==null&&(r.parent=n,n!==null&&Aa(r,n),G!==null&&(G.f&ce)!==0&&(e&Ot)===0)){var a=G;(a.effects??=[]).push(r)}return i}function hs(){return G!==null&&!We}function js(e){const t=Ve(Ys,null,!1);return le(t,oe),t.teardown=e,t}function un(e){Ir();var t=U.f,s=!G&&(t&ot)!==0&&(t&En)===0;if(s){var n=K;(n.e??=[]).push(e)}else return Ar(e)}function Ar(e){return Ve(Sn|ur,e,!1)}function Da(e){return Ir(),Ve(Ys|ur,e,!0)}function Pa(e){je.ensure();const t=Ve(Ot|Vt,e,!0);return(s={})=>new Promise(n=>{s.outro?Tt(t,()=>{we(t),n(void 0)}):(we(t),n(void 0))})}function Dr(e){return Ve(Sn,e,!1)}function Qe(e,t){var s=K,n={effect:null,ran:!1,deps:e};s.l.$.push(n),n.effect=xs(()=>{e(),!n.ran&&(n.ran=!0,R(t))})}function Ws(){var e=K;xs(()=>{for(var t of e.l.$){t.deps();var s=t.effect;(s.f&oe)!==0&&le(s,Fe),Zt(s)&&Wt(s),t.ran=!1}})}function Oa(e){return Ve(Mn|Vt,e,!0)}function xs(e,t=0){return Ve(Ys|t,e,!0)}function z(e,t=[],s=[],n=[]){wa(n,t,s,i=>{Ve(Ys,()=>e(...i.map(f)),!0)})}function Hs(e,t=0){var s=Ve(at|t,e,!0);return s}function Ie(e){return Ve(ot|Vt,e,!0)}function Pr(e){var t=e.teardown;if(t!==null){const s=Lt,n=G;Hn(!0),be(null);try{t.call(null)}finally{Hn(s),be(n)}}}function Or(e,t=!1){var s=e.first;for(e.first=e.last=null;s!==null;){const i=s.ac;i!==null&&qs(()=>{i.abort(Yt)});var n=s.next;(s.f&Ot)!==0?s.parent=null:we(s,t),s=n}}function La(e){for(var t=e.first;t!==null;){var s=t.next;(t.f&ot)===0&&we(t),t=s}}function we(e,t=!0){var s=!1;(t||(e.f&cr)!==0)&&e.nodes!==null&&e.nodes.end!==null&&(Lr(e.nodes.start,e.nodes.end),s=!0),Or(e,t&&!s),Fs(e,0),le(e,nt);var n=e.nodes&&e.nodes.t;if(n!==null)for(const r of n)r.stop();Pr(e);var i=e.parent;i!==null&&i.first!==null&&Rr(e),e.next=e.prev=e.teardown=e.ctx=e.deps=e.fn=e.nodes=e.ac=null}function Lr(e,t){for(;e!==null;){var s=e===t?null:ys(e);e.remove(),e=s}}function Rr(e){var t=e.parent,s=e.prev,n=e.next;s!==null&&(s.next=n),n!==null&&(n.prev=s),t!==null&&(t.first===e&&(t.first=n),t.last===e&&(t.last=s))}function Tt(e,t,s=!0){var n=[];Nr(e,n,!0);var i=()=>{s&&we(e),t&&t()},r=n.length;if(r>0){var a=()=>--r||i();for(var o of n)o.out(a)}else i()}function Nr(e,t,s){if((e.f&Ee)===0){e.f^=Ee;var n=e.nodes&&e.nodes.t;if(n!==null)for(const o of n)(o.is_global||s)&&t.push(o);for(var i=e.first;i!==null;){var r=i.next,a=(i.f&$t)!==0||(i.f&ot)!==0&&(e.f&at)!==0;Nr(i,t,a?s:!1),i=r}}}function Cn(e){Fr(e,!0)}function Fr(e,t){if((e.f&Ee)!==0){e.f^=Ee,(e.f&oe)===0&&(le(e,ye),At(e));for(var s=e.first;s!==null;){var n=s.next,i=(s.f&$t)!==0||(s.f&ot)!==0;Fr(s,i?t:!1),s=n}var r=e.nodes&&e.nodes.t;if(r!==null)for(const a of r)(a.is_global||t)&&a.in()}}function zr(e,t){if(e.nodes)for(var s=e.nodes.start,n=e.nodes.end;s!==null;){var i=s===n?null:ys(s);t.append(s),s=i}}let Bt=null;function Ra(e){var t=Bt;try{if(Bt=new Set,R(e),t!==null)for(var s of Bt)t.add(s);return Bt}finally{Bt=t}}function Na(e){for(var t of Ra(e))Pt(t,t.v)}let kt=!1;function Ns(e){kt=e}let Lt=!1;function Hn(e){Lt=e}let G=null,We=!1;function be(e){G=e}let U=null;function He(e){U=e}let it=null;function Gr(e){G!==null&&(it===null?it=[e]:it.push(e))}let ge=null,Se=0,Ce=null;function Fa(e){Ce=e}let Br=1,ps=0,Ct=ps;function Vn(e){Ct=e}function Yr(){return++Br}function Zt(e){var t=e.f;if((t&ye)!==0)return!0;if(t&ce&&(e.f&=~It),(t&Fe)!==0){var s=e.deps;if(s!==null)for(var n=s.length,i=0;i<n;i++){var r=s[i];if(Zt(r)&&xr(r),r.wv>e.wv)return!0}(t&Ne)!==0&&De===null&&le(e,oe)}return!1}function Xr(e,t,s=!0){var n=e.reactions;if(n!==null&&!it?.includes(e))for(var i=0;i<n.length;i++){var r=n[i];(r.f&ce)!==0?Xr(r,t,!1):t===r&&(s?le(r,ye):(r.f&oe)!==0&&le(r,Fe),At(r))}}function Ur(e){var t=ge,s=Se,n=Ce,i=G,r=it,a=K,o=We,l=Ct,c=e.f;ge=null,Se=0,Ce=null,G=(c&(ot|Ot))===0?e:null,it=null,qt(e.ctx),We=!1,Ct=++ps,e.ac!==null&&(qs(()=>{e.ac.abort(Yt)}),e.ac=null);try{e.f|=on;var u=e.fn,v=u(),d=e.deps;if(ge!==null){var h;if(Fs(e,Se),d!==null&&Se>0)for(d.length=Se+ge.length,h=0;h<ge.length;h++)d[Se+h]=ge[h];else e.deps=d=ge;if(hs()&&(e.f&Ne)!==0)for(h=Se;h<d.length;h++)(d[h].reactions??=[]).push(e)}else d!==null&&Se<d.length&&(Fs(e,Se),d.length=Se);if(bs()&&Ce!==null&&!We&&d!==null&&(e.f&(ce|Fe|ye))===0)for(h=0;h<Ce.length;h++)Xr(Ce[h],e);return i!==null&&i!==e&&(ps++,Ce!==null&&(n===null?n=Ce:n.push(...Ce))),(e.f&_t)!==0&&(e.f^=_t),v}catch(m){return _r(m)}finally{e.f^=on,ge=t,Se=s,Ce=n,G=i,it=r,qt(a),We=o,Ct=l}}function za(e,t){let s=t.reactions;if(s!==null){var n=Oi.call(s,e);if(n!==-1){var i=s.length-1;i===0?s=t.reactions=null:(s[n]=s[i],s.pop())}}s===null&&(t.f&ce)!==0&&(ge===null||!ge.includes(t))&&(le(t,Fe),(t.f&Ne)!==0&&(t.f^=Ne,t.f&=~It),yr(t),Fs(t,0))}function Fs(e,t){var s=e.deps;if(s!==null)for(var n=t;n<s.length;n++)za(e,s[n])}function Wt(e){var t=e.f;if((t&nt)===0){le(e,oe);var s=U,n=kt;U=e,kt=!0;try{(t&(at|Fi))!==0?La(e):Or(e),Pr(e);var i=Ur(e);e.teardown=typeof i=="function"?i:null,e.wv=Br;var r;an&&fa&&(e.f&ye)!==0&&e.deps}finally{kt=n,U=s}}}async function Ga(){await Promise.resolve(),ha()}function f(e){var t=e.f,s=(t&ce)!==0;if(Bt?.add(e),G!==null&&!We){var n=U!==null&&(U.f&nt)!==0;if(!n&&!it?.includes(e)){var i=G.deps;if((G.f&on)!==0)e.rv<ps&&(e.rv=ps,ge===null&&i!==null&&i[Se]===e?Se++:ge===null?ge=[e]:ge.includes(e)||ge.push(e));else{(G.deps??=[]).push(e);var r=e.reactions;r===null?e.reactions=[G]:r.includes(G)||r.push(G)}}}if(Lt){if(mt.has(e))return mt.get(e);if(s){var a=e,o=a.v;return((a.f&oe)===0&&a.reactions!==null||jr(a))&&(o=kn(a)),mt.set(a,o),o}}else s&&(!De?.has(e)||B?.is_fork&&!hs())&&(a=e,Zt(a)&&xr(a),kt&&hs()&&(a.f&Ne)===0&&qr(a));if(De?.has(e))return De.get(e);if((e.f&_t)!==0)throw e.v;return e.v}function qr(e){if(e.deps!==null){e.f^=Ne;for(const t of e.deps)(t.reactions??=[]).push(e),(t.f&ce)!==0&&(t.f&Ne)===0&&qr(t)}}function jr(e){if(e.v===fe)return!0;if(e.deps===null)return!1;for(const t of e.deps)if(mt.has(t)||(t.f&ce)!==0&&jr(t))return!0;return!1}function R(e){var t=We;try{return We=!0,e()}finally{We=t}}const Ba=-7169;function le(e,t){e.f=e.f&Ba|t}function Ya(e){if(!(typeof e!="object"||!e||e instanceof EventTarget)){if(rt in e)fn(e);else if(!Array.isArray(e))for(let t in e){const s=e[t];typeof s=="object"&&s&&rt in s&&fn(s)}}}function fn(e,t=new Set){if(typeof e=="object"&&e!==null&&!(e instanceof EventTarget)&&!t.has(e)){t.add(e),e instanceof Date&&e.getTime();for(let n in e)try{fn(e[n],t)}catch{}const s=xn(e);if(s!==Object.prototype&&s!==Array.prototype&&s!==Map.prototype&&s!==Set.prototype&&s!==Date.prototype){const n=or(s);for(let i in n){const r=n[i].get;if(r)try{r.call(e)}catch{}}}}}const Xa=["touchstart","touchmove"];function Ua(e){return Xa.includes(e)}const Wr=new Set,dn=new Set;function qa(e,t,s,n={}){function i(r){if(n.capture||as.call(t,r),!r.cancelBubble)return qs(()=>s?.call(this,r))}return e.startsWith("pointer")||e.startsWith("touch")||e==="wheel"?Jt(()=>{t.addEventListener(e,i,n)}):t.addEventListener(e,i,n),i}function Hr(e,t,s,n,i){var r={capture:n,passive:i},a=qa(e,t,s,r);(t===document.body||t===window||t===document||t instanceof HTMLMediaElement)&&js(()=>{t.removeEventListener(e,a,r)})}function Qt(e){for(var t=0;t<e.length;t++)Wr.add(e[t]);for(var s of dn)s(e)}let Kn=null;function as(e){var t=this,s=t.ownerDocument,n=e.type,i=e.composedPath?.()||[],r=i[0]||e.target;Kn=e;var a=0,o=Kn===e&&e.__root;if(o){var l=i.indexOf(o);if(l!==-1&&(t===document||t===window)){e.__root=t;return}var c=i.indexOf(t);if(c===-1)return;l<=c&&(a=l)}if(r=i[a]||e.target,r!==t){ar(e,"currentTarget",{configurable:!0,get(){return r||s}});var u=G,v=U;be(null),He(null);try{for(var d,h=[];r!==null;){var m=r.assignedSlot||r.parentNode||r.host||null;try{var y=r["__"+n];y!=null&&(!r.disabled||e.target===r)&&y.call(r,e)}catch(_){d?h.push(_):d=_}if(e.cancelBubble||m===t||m===null)break;r=m}if(d){for(let _ of h)queueMicrotask(()=>{throw _});throw d}}finally{e.__root=t,delete e.currentTarget,be(u),He(v)}}}function Vr(e){var t=document.createElement("template");return t.innerHTML=e.replaceAll("<!>","<!---->"),t.content}function zs(e,t){var s=U;s.nodes===null&&(s.nodes={start:e,end:t,a:null,t:null})}function C(e,t){var s=(t&aa)!==0,n=(t&oa)!==0,i,r=!e.startsWith("<!>");return()=>{i===void 0&&(i=Vr(r?e:"<!>"+e),s||(i=pt(i)));var a=n||Mr?document.importNode(i,!0):i.cloneNode(!0);if(s){var o=pt(a),l=a.lastChild;zs(o,l)}else zs(a,a);return a}}function vn(){var e=document.createDocumentFragment(),t=document.createComment(""),s=bt();return e.append(t,s),zs(t,s),e}function M(e,t){e!==null&&e.before(t)}function N(e,t){var s=t==null?"":typeof t=="object"?t+"":t;s!==(e.__t??=e.nodeValue)&&(e.__t=s,e.nodeValue=s+"")}function ja(e,t){return Wa(e,t)}const zt=new Map;function Wa(e,{target:t,anchor:s,props:n={},events:i,context:r,intro:a=!0}){Ca();var o=new Set,l=v=>{for(var d=0;d<v.length;d++){var h=v[d];if(!o.has(h)){o.add(h);var m=Ua(h);t.addEventListener(h,as,{passive:m});var y=zt.get(h);y===void 0?(document.addEventListener(h,as,{passive:m}),zt.set(h,1)):zt.set(h,y+1)}}};l(Bs(Wr)),dn.add(l);var c=void 0,u=Pa(()=>{var v=s??t.appendChild(bt());return ma(v,{pending:()=>{}},d=>{if(r){lt({});var h=K;h.c=r}i&&(n.$$events=i),c=e(d,n)||{},r&&ct()}),()=>{for(var d of o){t.removeEventListener(d,as);var h=zt.get(d);--h===0?(document.removeEventListener(d,as),zt.delete(d)):zt.set(d,h)}dn.delete(l),v!==s&&v.parentNode?.removeChild(v)}});return Ha.set(c,u),c}let Ha=new WeakMap;class Kr{anchor;#e=new Map;#t=new Map;#n=new Map;#s=new Set;#l=!0;constructor(t,s=!0){this.anchor=t,this.#l=s}#i=()=>{var t=B;if(this.#e.has(t)){var s=this.#e.get(t),n=this.#t.get(s);if(n)Cn(n),this.#s.delete(s);else{var i=this.#n.get(s);i&&(this.#t.set(s,i.effect),this.#n.delete(s),i.fragment.lastChild.remove(),this.anchor.before(i.fragment),n=i.effect)}for(const[r,a]of this.#e){if(this.#e.delete(r),r===t)break;const o=this.#n.get(a);o&&(we(o.effect),this.#n.delete(a))}for(const[r,a]of this.#t){if(r===s||this.#s.has(r))continue;const o=()=>{if(Array.from(this.#e.values()).includes(r)){var c=document.createDocumentFragment();zr(a,c),c.append(bt()),this.#n.set(r,{effect:a,fragment:c})}else we(a);this.#s.delete(r),this.#t.delete(r)};this.#l||!n?(this.#s.add(r),Tt(a,o,!1)):o()}}};#r=t=>{this.#e.delete(t);const s=Array.from(this.#e.values());for(const[n,i]of this.#n)s.includes(n)||(we(i.effect),this.#n.delete(n))};ensure(t,s){var n=B,i=Cr();if(s&&!this.#t.has(t)&&!this.#n.has(t))if(i){var r=document.createDocumentFragment(),a=bt();r.append(a),this.#n.set(t,{effect:Ie(()=>s(a)),fragment:r})}else this.#t.set(t,Ie(()=>s(this.anchor)));if(this.#e.set(n,t),i){for(const[o,l]of this.#t)o===t?n.skipped_effects.delete(l):n.skipped_effects.add(l);for(const[o,l]of this.#n)o===t?n.skipped_effects.delete(l.effect):n.skipped_effects.add(l.effect);n.oncommit(this.#i),n.ondiscard(this.#r)}else this.#i()}}function te(e,t,s=!1){var n=new Kr(e),i=s?$t:0;function r(a,o){n.ensure(a,o)}Hs(()=>{var a=!1;t((o,l=!0)=>{a=!0,r(l,o)}),a||r(!1,null)},i)}function et(e,t){return t}function Va(e,t,s){for(var n=[],i=t.length,r,a=t.length,o=0;o<i;o++){let v=t[o];Tt(v,()=>{if(r){if(r.pending.delete(v),r.done.add(v),r.pending.size===0){var d=e.outrogroups;hn(Bs(r.done)),d.delete(r),d.size===0&&(e.outrogroups=null)}}else a-=1},!1)}if(a===0){var l=n.length===0&&s!==null;if(l){var c=s,u=c.parentNode;$a(u),u.append(c),e.items.clear()}hn(t,!l)}else r={pending:new Set(t),done:new Set},(e.outrogroups??=new Set).add(r)}function hn(e,t=!0){for(var s=0;s<e.length;s++)we(e[s],t)}var Jn;function Le(e,t,s,n,i,r=null){var a=e,o=new Map,l=(t&dr)!==0;if(l){var c=e;a=c.appendChild(bt())}var u=null,v=Tn(()=>{var b=s();return yn(b)?b:b==null?[]:Bs(b)}),d,h=!0;function m(){_.fallback=u,Ka(_,d,a,t,n),u!==null&&(d.length===0?(u.f&tt)===0?Cn(u):(u.f^=tt,os(u,null,a)):Tt(u,()=>{u=null}))}var y=Hs(()=>{d=f(v);for(var b=d.length,A=new Set,T=B,S=Cr(),E=0;E<b;E+=1){var $=d[E],w=n($,E),x=h?null:o.get(w);x?(x.v&&Pt(x.v,$),x.i&&Pt(x.i,E),S&&T.skipped_effects.delete(x.e)):(x=Ja(o,h?a:Jn??=bt(),$,w,E,i,t,s),h||(x.e.f|=tt),o.set(w,x)),A.add(w)}if(b===0&&r&&!u&&(h?u=Ie(()=>r(a)):(u=Ie(()=>r(Jn??=bt())),u.f|=tt)),!h)if(S){for(const[L,D]of o)A.has(L)||T.skipped_effects.add(D.e);T.oncommit(m),T.ondiscard(()=>{})}else m();f(v)}),_={effect:y,items:o,outrogroups:null,fallback:u};h=!1}function Ka(e,t,s,n,i){var r=(n&Qi)!==0,a=t.length,o=e.items,l=e.effect.first,c,u=null,v,d=[],h=[],m,y,_,b;if(r)for(b=0;b<a;b+=1)m=t[b],y=i(m,b),_=o.get(y).e,(_.f&tt)===0&&(_.nodes?.a?.measure(),(v??=new Set).add(_));for(b=0;b<a;b+=1){if(m=t[b],y=i(m,b),_=o.get(y).e,e.outrogroups!==null)for(const D of e.outrogroups)D.pending.delete(_),D.done.delete(_);if((_.f&tt)!==0)if(_.f^=tt,_===l)os(_,null,s);else{var A=u?u.next:l;_===e.effect.last&&(e.effect.last=_.prev),_.prev&&(_.prev.next=_.next),_.next&&(_.next.prev=_.prev),ht(e,u,_),ht(e,_,A),os(_,A,s),u=_,d=[],h=[],l=u.next;continue}if((_.f&Ee)!==0&&(Cn(_),r&&(_.nodes?.a?.unfix(),(v??=new Set).delete(_))),_!==l){if(c!==void 0&&c.has(_)){if(d.length<h.length){var T=h[0],S;u=T.prev;var E=d[0],$=d[d.length-1];for(S=0;S<d.length;S+=1)os(d[S],T,s);for(S=0;S<h.length;S+=1)c.delete(h[S]);ht(e,E.prev,$.next),ht(e,u,E),ht(e,$,T),l=T,u=$,b-=1,d=[],h=[]}else c.delete(_),os(_,l,s),ht(e,_.prev,_.next),ht(e,_,u===null?e.effect.first:u.next),ht(e,u,_),u=_;continue}for(d=[],h=[];l!==null&&l!==_;)(c??=new Set).add(l),h.push(l),l=l.next;if(l===null)continue}(_.f&tt)===0&&d.push(_),u=_,l=_.next}if(e.outrogroups!==null){for(const D of e.outrogroups)D.pending.size===0&&(hn(Bs(D.done)),e.outrogroups?.delete(D));e.outrogroups.size===0&&(e.outrogroups=null)}if(l!==null||c!==void 0){var w=[];if(c!==void 0)for(_ of c)(_.f&Ee)===0&&w.push(_);for(;l!==null;)(l.f&Ee)===0&&l!==e.fallback&&w.push(l),l=l.next;var x=w.length;if(x>0){var L=(n&dr)!==0&&a===0?s:null;if(r){for(b=0;b<x;b+=1)w[b].nodes?.a?.measure();for(b=0;b<x;b+=1)w[b].nodes?.a?.fix()}Va(e,w,L)}}r&&Jt(()=>{if(v!==void 0)for(_ of v)_.nodes?.a?.apply()})}function Ja(e,t,s,n,i,r,a,o){var l=(a&Ji)!==0?(a&ea)===0?ne(s,!1,!1):Dt(s):null,c=(a&Zi)!==0?Dt(i):null;return{v:l,i:c,e:Ie(()=>(r(t,l??s,c??i,o),()=>{e.delete(n)}))}}function os(e,t,s){if(e.nodes)for(var n=e.nodes.start,i=e.nodes.end,r=t&&(t.f&tt)===0?t.nodes.start:s;n!==null;){var a=ys(n);if(r.before(n),n===i)return;n=a}}function ht(e,t,s){t===null?e.effect.first=s:t.next=s,s===null?e.effect.last=t:s.prev=t}function Za(e,t,s=!1,n=!1,i=!1){var r=e,a="";z(()=>{var o=U;if(a!==(a=t()??"")&&(o.nodes!==null&&(Lr(o.nodes.start,o.nodes.end),o.nodes=null),a!=="")){var l=a+"";s?l=`<svg>${l}</svg>`:n&&(l=`<math>${l}</math>`);var c=Vr(l);if((s||n)&&(c=pt(c)),zs(pt(c),c.lastChild),s||n)for(;pt(c);)r.before(pt(c));else r.before(c)}})}function Qa(e,t,...s){var n=new Kr(e);Hs(()=>{const i=t()??null;n.ensure(i,i&&(r=>i(r,...s)))},$t)}function Jr(e){var t,s,n="";if(typeof e=="string"||typeof e=="number")n+=e;else if(typeof e=="object")if(Array.isArray(e)){var i=e.length;for(t=0;t<i;t++)e[t]&&(s=Jr(e[t]))&&(n&&(n+=" "),n+=s)}else for(s in e)e[s]&&(n&&(n+=" "),n+=s);return n}function eo(){for(var e,t,s=0,n="",i=arguments.length;s<i;s++)(e=arguments[s])&&(t=Jr(e))&&(n&&(n+=" "),n+=t);return n}function to(e){return typeof e=="object"?eo(e):e??""}const Zn=[...` 	
\r\fÂ \v\uFEFF`];function so(e,t,s){var n=e==null?"":""+e;if(t&&(n=n?n+" "+t:t),s){for(var i in s)if(s[i])n=n?n+" "+i:i;else if(n.length)for(var r=i.length,a=0;(a=n.indexOf(i,a))>=0;){var o=a+r;(a===0||Zn.includes(n[a-1]))&&(o===n.length||Zn.includes(n[o]))?n=(a===0?"":n.substring(0,a))+n.substring(o+1):a=o}}return n===""?null:n}function no(e,t){return e==null?null:String(e)}function ee(e,t,s,n,i,r){var a=e.__className;if(a!==s||a===void 0){var o=so(s,n,r);o==null?e.removeAttribute("class"):e.className=o,e.__className=s}else if(r&&i!==r)for(var l in r){var c=!!r[l];(i==null||c!==!!i[l])&&e.classList.toggle(l,c)}return r}function Vs(e,t,s,n){var i=e.__style;if(i!==t){var r=no(t);r==null?e.removeAttribute("style"):e.style.cssText=r,e.__style=t}return n}function Zr(e,t,s=!1){if(e.multiple){if(t==null)return;if(!yn(t))return ca();for(var n of e.options)n.selected=t.includes(fs(n));return}for(n of e.options){var i=fs(n);if(ka(i,t)){n.selected=!0;return}}(!s||t!==void 0)&&(e.selectedIndex=-1)}function ro(e){var t=new MutationObserver(()=>{Zr(e,e.__value)});t.observe(e,{childList:!0,subtree:!0,attributes:!0,attributeFilter:["value"]}),js(()=>{t.disconnect()})}function io(e,t,s=t){var n=new WeakSet,i=!0;$r(e,"change",r=>{var a=r?"[selected]":":checked",o;if(e.multiple)o=[].map.call(e.querySelectorAll(a),fs);else{var l=e.querySelector(a)??e.querySelector("option:not([disabled])");o=l&&fs(l)}s(o),B!==null&&n.add(B)}),Dr(()=>{var r=t();if(e===document.activeElement){var a=ls??B;if(n.has(a))return}if(Zr(e,r,i),i&&r===void 0){var o=e.querySelector(":checked");o!==null&&(r=fs(o),s(r))}e.__value=r,i=!1}),ro(e)}function fs(e){return"__value"in e?e.__value:e.value}const ao=Symbol("is custom element"),oo=Symbol("is html");function pn(e,t){var s=Qr(e);s.value===(s.value=t??void 0)||e.value===t&&(t!==0||e.nodeName!=="PROGRESS")||(e.value=t??"")}function Pe(e,t,s,n){var i=Qr(e);i[t]!==(i[t]=s)&&(t==="loading"&&(e[Gi]=s),s==null?e.removeAttribute(t):typeof s!="string"&&lo(e).includes(t)?e[t]=s:e.setAttribute(t,s))}function Qr(e){return e.__attributes??={[ao]:e.nodeName.includes("-"),[oo]:e.namespaceURI===la}}var Qn=new Map;function lo(e){var t=e.getAttribute("is")||e.nodeName,s=Qn.get(t);if(s)return s;Qn.set(t,s=[]);for(var n,i=e,r=Element.prototype;r!==i;){n=or(i);for(var a in n)n[a].set&&s.push(a);i=xn(i)}return s}function Cs(e,t,s=t){var n=new WeakSet;$r(e,"input",async i=>{var r=i?e.defaultValue:e.value;if(r=tn(e)?sn(r):r,s(r),B!==null&&n.add(B),await Ga(),r!==(r=t())){var a=e.selectionStart,o=e.selectionEnd,l=e.value.length;if(e.value=r??"",o!==null){var c=e.value.length;a===o&&o===l&&c>l?(e.selectionStart=c,e.selectionEnd=c):(e.selectionStart=a,e.selectionEnd=Math.min(o,c))}}}),R(t)==null&&e.value&&(s(tn(e)?sn(e.value):e.value),B!==null&&n.add(B)),xs(()=>{var i=t();if(e===document.activeElement){var r=ls??B;if(n.has(r))return}tn(e)&&i===sn(e.value)||e.type==="date"&&!i&&!e.value||i!==e.value&&(e.value=i??"")})}function tn(e){var t=e.type;return t==="number"||t==="range"}function sn(e){return e===""?null:+e}function er(e,t){return e===t||e?.[rt]===t}function gs(e={},t,s,n){return Dr(()=>{var i,r;return xs(()=>{i=r,r=[],R(()=>{e!==s(...r)&&(t(e,...r),i&&er(s(...i),e)&&t(null,...i))})}),()=>{Jt(()=>{r&&er(s(...r),e)&&t(null,...r)})}}),e}function Ss(e=!1){const t=K,s=t.l.u;if(!s)return;let n=()=>Ya(t.s);if(e){let i=0,r={};const a=ws(()=>{let o=!1;const l=t.s;for(const c in l)l[c]!==r[c]&&(r[c]=l[c],o=!0);return o&&i++,i});n=()=>f(a)}s.b.length&&Da(()=>{tr(t,n),Ls(s.b)}),un(()=>{const i=R(()=>s.m.map(Ni));return()=>{for(const r of i)typeof r=="function"&&r()}}),s.a.length&&un(()=>{tr(t,n),Ls(s.a)})}function tr(e,t){if(e.l.s)for(const s of e.l.s)f(s);t()}function $n(e,t,s){if(e==null)return t(void 0),s&&s(void 0),st;const n=R(()=>e.subscribe(t,s));return n.unsubscribe?()=>n.unsubscribe():n}const Gt=[];function co(e,t){return{subscribe:ze(e,t).subscribe}}function ze(e,t=st){let s=null;const n=new Set;function i(o){if(hr(e,o)&&(e=o,s)){const l=!Gt.length;for(const c of n)c[1](),Gt.push(c,e);if(l){for(let c=0;c<Gt.length;c+=2)Gt[c][0](Gt[c+1]);Gt.length=0}}}function r(o){i(o(e))}function a(o,l=st){const c=[o,l];return n.add(c),n.size===1&&(s=t(i,r)||st),o(e),()=>{n.delete(c),n.size===0&&s&&(s(),s=null)}}return{set:i,update:r,subscribe:a}}function Rt(e,t,s){const n=!Array.isArray(e),i=n?[e]:e;if(!i.every(Boolean))throw new Error("derived() expects stores as input, got a falsy value");const r=t.length<2;return co(s,(a,o)=>{let l=!1;const c=[];let u=0,v=st;const d=()=>{if(u)return;v();const m=t(n?c[0]:c,a,o);r?a(m):v=typeof m=="function"?m:st},h=i.map((m,y)=>$n(m,_=>{c[y]=_,u&=~(1<<y),l&&d()},()=>{u|=1<<y}));return l=!0,d(),function(){Ls(h),v(),l=!1}})}function Ke(e){let t;return $n(e,s=>t=s)(),t}let $s=!1,gn=Symbol();function H(e,t,s){const n=s[t]??={store:null,source:ne(void 0),unsubscribe:st};if(n.store!==e&&!(gn in s))if(n.unsubscribe(),n.store=e??null,e==null)n.source.v=void 0,n.unsubscribe=st;else{var i=!0;n.unsubscribe=$n(e,r=>{i?n.source.v=r:X(n.source,r)}),i=!1}return e&&gn in s?Ke(e):f(n.source)}function Nt(){const e={};function t(){js(()=>{for(var s in e)e[s].unsubscribe();ar(e,gn,{enumerable:!1,value:!0})})}return[e,t]}function uo(e){var t=$s;try{return $s=!1,[e(),$s]}finally{$s=t}}function Ue(e,t,s,n){var i=!Kt||(s&sa)!==0,r=(s&ra)!==0,a=(s&ia)!==0,o=n,l=!0,c=()=>(l&&(l=!1,o=a?R(n):n),o),u;if(r){var v=rt in e||zi in e;u=Ut(e,t)?.set??(v&&t in e?T=>e[t]=T:void 0)}var d,h=!1;r?[d,h]=uo(()=>e[t]):d=e[t],d===void 0&&n!==void 0&&(d=c(),u&&(i&&ji(),u(d)));var m;if(i?m=()=>{var T=e[t];return T===void 0?c():(l=!0,T)}:m=()=>{var T=e[t];return T!==void 0&&(o=void 0),T===void 0?o:T},i&&(s&na)===0)return m;if(u){var y=e.$$legacy;return(function(T,S){return arguments.length>0?((!i||!S||y||h)&&u(S?m():T),T):m()})}var _=!1,b=((s&ta)!==0?ws:Tn)(()=>(_=!1,m()));r&&f(b);var A=U;return(function(T,S){if(arguments.length>0){const E=S?f(b):i&&r?Xt(T):T;return X(b,E),_=!0,o!==void 0&&(o=E),T}return Lt&&_||(A.f&nt)!==0?b.v:f(b)})}function Ks(e){K===null&&fr(),Kt&&K.l!==null?fo(K).m.push(e):un(()=>{const t=R(e);if(typeof t=="function")return t})}function ei(e){K===null&&fr(),Ks(()=>()=>R(e))}function fo(e){var t=e.l;return t.u??={a:[],b:[],m:[]}}const vo="5";typeof window<"u"&&((window.__svelte??={}).v??=new Set).add(vo);da();class ho{propagator=null;config;currentSeed;isInitialized=!1;wasmModule=null;currentBackend="cpu";gpuAvailable=!1;constructor(t,s){this.config=t,this.currentSeed=s}async initialize(t="cpu"){try{const n="/autoverse/preview/pr-41/pkg/flow_lenia.js";this.wasmModule=await import(n),await this.wasmModule.default(),this.gpuAvailable=await this.checkWebGPU();const i=t==="gpu"&&this.gpuAvailable?"gpu":"cpu";await this.createPropagator(i),this.isInitialized=!0}catch(s){throw new Error(`Failed to initialize WASM: ${s}`)}}async checkWebGPU(){if(typeof navigator>"u"||!("gpu"in navigator))return!1;try{return await navigator.gpu.requestAdapter()!==null}catch{return!1}}async createPropagator(t){if(!this.wasmModule)throw new Error("WASM module not loaded");const s=JSON.stringify(this.config),n=JSON.stringify(this.currentSeed);t==="gpu"&&this.gpuAvailable?(this.propagator=await new this.wasmModule.WasmGpuPropagator(s,n),this.currentBackend="gpu"):(this.propagator=new this.wasmModule.WasmPropagator(s,n),this.currentBackend="cpu")}async switchBackend(t){if(!this.isInitialized)throw new Error("Simulation not initialized");return t==="gpu"&&!this.gpuAvailable?!1:(t===this.currentBackend||await this.createPropagator(t),!0)}isGpuAvailable(){return this.gpuAvailable}getBackend(){return this.currentBackend}async step(){this.ensureInitialized(),this.currentBackend==="gpu"?await this.propagator.step():this.propagator.step()}async run(t){this.ensureInitialized(),this.currentBackend==="gpu"?await this.propagator.run(BigInt(t)):this.propagator.run(BigInt(t))}getState(){return this.ensureInitialized(),this.propagator.getState()}reset(t){this.ensureInitialized(),t&&(this.currentSeed=t),this.propagator.reset(JSON.stringify(this.currentSeed))}totalMass(){return this.ensureInitialized(),this.propagator.totalMass()}getTime(){return this.ensureInitialized(),this.propagator.getTime()}getStep(){return this.ensureInitialized(),this.propagator.getStep()}getWidth(){return this.config.width}getHeight(){return this.config.height}getConfig(){return{...this.config}}extractRegion(t,s,n,i){this.ensureInitialized();const r=this.getState(),a=[];for(let o=0;o<r.channels.length;o++){const l=[];for(let c=0;c<i;c++)for(let u=0;u<n;u++){const v=(t+u)%r.width,h=(s+c)%r.height*r.width+v;l.push(r.channels[o][h])}a.push(l)}return{width:n,height:i,channels:a,sourceX:t,sourceY:s}}placeRegion(t,s,n){this.ensureInitialized();const i=this.getState(),r=new Map;for(let l=0;l<i.channels.length;l++)for(let c=0;c<i.height;c++)for(let u=0;u<i.width;u++){const v=c*i.width+u,d=i.channels[l][v];d>.001&&r.set(`${u},${c},${l}`,d)}for(let l=0;l<t.channels.length;l++)for(let c=0;c<t.height;c++)for(let u=0;u<t.width;u++){const v=(s+u)%this.config.width,d=(n+c)%this.config.height,h=c*t.width+u,m=t.channels[l][h];m>.001&&r.set(`${v},${d},${l}`,m)}const a=[];for(const[l,c]of r){const[u,v,d]=l.split(",").map(Number);a.push([u,v,d,c])}const o={pattern:{type:"Custom",values:a}};this.reset(o)}drawAt(t,s,n,i,r=0){this.ensureInitialized();const a=this.getState(),o=[];for(let c=0;c<a.channels.length;c++)for(let u=0;u<a.height;u++)for(let v=0;v<a.width;v++){const d=u*a.width+v;let h=a.channels[c][d];if(c===r){const m=v-t,y=u-s,_=Math.sqrt(m*m+y*y);if(_<=n){const b=1-_/n;h=Math.min(1,h+i*b*b)}}h>.001&&o.push([v,u,c,h])}const l={pattern:{type:"Custom",values:o}};this.reset(l)}eraseAt(t,s,n,i=0){this.ensureInitialized();const r=this.getState(),a=[];for(let l=0;l<r.channels.length;l++)for(let c=0;c<r.height;c++)for(let u=0;u<r.width;u++){const v=c*r.width+u;let d=r.channels[l][v];if(l===i){const h=u-t,m=c-s,y=Math.sqrt(h*h+m*m);if(y<=n){const _=1-y/n;d=Math.max(0,d*(1-_*_))}}d>.001&&a.push([u,c,l,d])}const o={pattern:{type:"Custom",values:a}};this.reset(o)}ensureInitialized(){if(!this.isInitialized||!this.propagator)throw new Error("Simulation not initialized. Call initialize() first.")}}const _n={width:128,height:128,channels:1,dt:.1,kernel_radius:13,kernels:[{radius:1,rings:[{amplitude:1,distance:.5,width:.15}],weight:1,mu:.15,sigma:.015,source_channel:0,target_channel:0}],flow:{beta_a:1,n:2,distribution_size:1}},po={pattern:{type:"GaussianBlob",center:[.5,.5],radius:.1,amplitude:1,channel:0}},go={initialized:!1,playing:!1,step:0,time:0,totalMass:0,fps:0,frameTime:0,backend:"cpu",gpuAvailable:!1,config:_n,state:null},re=ze(go),ti=ze([]);function Y(e,t="info"){ti.update(s=>[...s.slice(-100),{message:e,level:t,timestamp:Date.now()}])}let Q=null,Is=null,ds=0,As=0,mn=0,si=60,Ds=0;function Gs(){return Q}function ni(e){si=Math.max(1,Math.min(480,e)),Ds=0}function _o(e){ni(60*Math.max(1,Math.min(10,e)))}async function mo(){Q=new ho(_n,po),await Q.initialize();const e=Q.getState();re.update(t=>({...t,initialized:!0,step:Q.getStep(),time:Q.getTime(),totalMass:Q.totalMass(),backend:Q.getBackend(),gpuAvailable:Q.isGpuAvailable(),config:_n,state:e}))}function ri(){!Q||Ke(re).playing||(re.update(t=>({...t,playing:!0})),ds=performance.now(),mn=ds,As=0,oi(ds),Y("Simulation started","info"))}function In(){re.update(e=>({...e,playing:!1})),Is!==null&&(cancelAnimationFrame(Is),Is=null),Y("Simulation paused","info")}async function ii(){Q&&(await Q.step(),An())}function _s(e){Q&&(Q.reset(e),An(),Y("Simulation reset","info"))}async function ai(e){if(!Q)return!1;const t=await Q.switchBackend(e);return t?(re.update(s=>({...s,backend:e})),Y(`Switched to ${e.toUpperCase()} backend`,"success")):Y(`Failed to switch to ${e} backend`,"error"),t}async function oi(e){if(!Ke(re).playing||!Q)return;let s=e-ds;ds=e;const n=250;s>n&&(s=n,Ds=0);const i=si*s/1e3+Ds,r=Math.floor(i);Ds=i-r,r>0&&await Q.run(r),An(),As++,e-mn>=1e3&&(re.update(a=>({...a,fps:As,frameTime:s})),As=0,mn=e),Is=requestAnimationFrame(a=>oi(a))}function An(){if(!Q)return;const e=Q.getState();re.update(t=>({...t,step:Q.getStep(),time:Q.getTime(),totalMass:Q.totalMass(),state:e}))}const bo=Rt(re,e=>e.time.toFixed(2)),li=Rt(re,e=>e.totalMass.toLocaleString(void 0,{maximumFractionDigits:0})),ci=Rt(re,e=>e.step.toString().padStart(8,"0")),wo={mode:"view",brushSize:5,brushIntensity:.8,colorScheme:"theme",visualizationMode:"mass",showGrid:!1,showScanlines:!0,showSelection:!0,zoom:1,panX:0,panY:0},ut=ze(wo);function ui(e){ut.update(t=>({...t,mode:e}))}function fi(e){ut.update(t=>({...t,brushSize:Math.max(1,Math.min(50,e))}))}function di(e){ut.update(t=>({...t,brushIntensity:Math.max(0,Math.min(1,e))}))}function yo(e){ut.update(t=>({...t,colorScheme:e}))}function xo(){ut.update(e=>({...e,showScanlines:!e.showScanlines}))}const ms=[{id:"void",name:"VOID",colors:{primary:"#a855f7",primaryDim:"#6b21a8",primaryGlow:"rgba(168, 85, 247, 0.4)",secondary:"#3b82f6",secondaryDim:"#1e40af",secondaryGlow:"rgba(59, 130, 246, 0.4)",tertiary:"#ec4899",tertiaryDim:"#9d174d",tertiaryGlow:"rgba(236, 72, 153, 0.4)",success:"#a855f7",warning:"#f59e0b",danger:"#ef4444"}},{id:"neon-tokyo",name:"NEON TOKYO",colors:{primary:"#ff2d95",primaryDim:"#9d1a5a",primaryGlow:"rgba(255, 45, 149, 0.4)",secondary:"#00f0ff",secondaryDim:"#0891b2",secondaryGlow:"rgba(0, 240, 255, 0.4)",tertiary:"#ffee00",tertiaryDim:"#a38a00",tertiaryGlow:"rgba(255, 238, 0, 0.4)",success:"#00f0ff",warning:"#ffee00",danger:"#ff2d95"}},{id:"synthwave",name:"SYNTHWAVE",colors:{primary:"#f472b6",primaryDim:"#a21caf",primaryGlow:"rgba(244, 114, 182, 0.4)",secondary:"#818cf8",secondaryDim:"#4338ca",secondaryGlow:"rgba(129, 140, 248, 0.4)",tertiary:"#22d3ee",tertiaryDim:"#0e7490",tertiaryGlow:"rgba(34, 211, 238, 0.4)",success:"#22d3ee",warning:"#fbbf24",danger:"#f43f5e"}},{id:"bloodmoon",name:"BLOODMOON",colors:{primary:"#dc2626",primaryDim:"#7f1d1d",primaryGlow:"rgba(220, 38, 38, 0.4)",secondary:"#f97316",secondaryDim:"#9a3412",secondaryGlow:"rgba(249, 115, 22, 0.4)",tertiary:"#fbbf24",tertiaryDim:"#92400e",tertiaryGlow:"rgba(251, 191, 36, 0.4)",success:"#f97316",warning:"#fbbf24",danger:"#dc2626"}},{id:"toxic",name:"TOXIC",colors:{primary:"#84cc16",primaryDim:"#3f6212",primaryGlow:"rgba(132, 204, 22, 0.5)",secondary:"#facc15",secondaryDim:"#854d0e",secondaryGlow:"rgba(250, 204, 21, 0.4)",tertiary:"#22c55e",tertiaryDim:"#166534",tertiaryGlow:"rgba(34, 197, 94, 0.4)",success:"#22c55e",warning:"#facc15",danger:"#ef4444"}},{id:"ice",name:"ICE",colors:{primary:"#38bdf8",primaryDim:"#0369a1",primaryGlow:"rgba(56, 189, 248, 0.4)",secondary:"#e0f2fe",secondaryDim:"#7dd3fc",secondaryGlow:"rgba(224, 242, 254, 0.3)",tertiary:"#a5b4fc",tertiaryDim:"#4f46e5",tertiaryGlow:"rgba(165, 180, 252, 0.4)",success:"#38bdf8",warning:"#fcd34d",danger:"#f87171"}},{id:"hacker",name:"HACKER",colors:{primary:"#22c55e",primaryDim:"#166534",primaryGlow:"rgba(34, 197, 94, 0.5)",secondary:"#4ade80",secondaryDim:"#15803d",secondaryGlow:"rgba(74, 222, 128, 0.4)",tertiary:"#86efac",tertiaryDim:"#22c55e",tertiaryGlow:"rgba(134, 239, 172, 0.3)",success:"#22c55e",warning:"#fbbf24",danger:"#ef4444"}},{id:"phosphor",name:"PHOSPHOR",colors:{primary:"#fef08a",primaryDim:"#a16207",primaryGlow:"rgba(254, 240, 138, 0.5)",secondary:"#fde047",secondaryDim:"#854d0e",secondaryGlow:"rgba(253, 224, 71, 0.4)",tertiary:"#fbbf24",tertiaryDim:"#92400e",tertiaryGlow:"rgba(251, 191, 36, 0.4)",success:"#a3e635",warning:"#fbbf24",danger:"#f87171"}}],Js=ze(ms[0]);function bn(e){const t=document.documentElement,{colors:s}=e;t.style.setProperty("--color-primary",s.primary),t.style.setProperty("--color-primary-dim",s.primaryDim),t.style.setProperty("--color-primary-glow",s.primaryGlow),t.style.setProperty("--color-secondary",s.secondary),t.style.setProperty("--color-secondary-dim",s.secondaryDim),t.style.setProperty("--color-secondary-glow",s.secondaryGlow),t.style.setProperty("--color-tertiary",s.tertiary),t.style.setProperty("--color-tertiary-dim",s.tertiaryDim),t.style.setProperty("--color-tertiary-glow",s.tertiaryGlow),t.style.setProperty("--color-success",s.success),t.style.setProperty("--color-warning",s.warning),t.style.setProperty("--color-danger",s.danger),Js.set(e),localStorage.setItem("autoverse-theme",e.id)}function So(e){const t=ms.find(s=>s.id===e);t&&bn(t)}function Eo(){const e=localStorage.getItem("autoverse-theme");if(e){const t=ms.find(s=>s.id===e);if(t){bn(t);return}}bn(ms[0])}const sr=900,ke=["controls","display","presets","patterns"];function Mo(){const{subscribe:e,set:t,update:s}=ze({isMobile:typeof window<"u"&&window.innerWidth<=sr,activeTab:"controls",swipeOffset:0,isSwiping:!1});return{subscribe:e,set:t,update:s,checkViewport:()=>{if(typeof window>"u")return;const n=window.innerWidth<=sr;s(i=>({...i,isMobile:n}))},setTab:n=>{s(i=>({...i,activeTab:n,swipeOffset:0}))},nextTab:()=>{s(n=>{const i=ke.indexOf(n.activeTab),r=Math.min(i+1,ke.length-1);return{...n,activeTab:ke[r],swipeOffset:0}})},prevTab:()=>{s(n=>{const i=ke.indexOf(n.activeTab),r=Math.max(i-1,0);return{...n,activeTab:ke[r],swipeOffset:0}})},startSwipe:()=>{s(n=>({...n,isSwiping:!0}))},updateSwipe:n=>{s(i=>({...i,swipeOffset:n}))},endSwipe:n=>{const i=Ke({subscribe:e}),r=n*.2,a=i.swipeOffset;if(Math.abs(a)>r)if(a>0){const o=ke.indexOf(i.activeTab);if(o>0){t({...i,activeTab:ke[o-1],swipeOffset:0,isSwiping:!1});return}}else{const o=ke.indexOf(i.activeTab);if(o<ke.length-1){t({...i,activeTab:ke[o+1],swipeOffset:0,isSwiping:!1});return}}s(o=>({...o,swipeOffset:0,isSwiping:!1}))}}}const Ae=Mo(),To=Rt(Ae,e=>ke.indexOf(e.activeTab)),nn=ke;var ko=C("<button></button>"),Co=C('<header class="header svelte-4b3o1e"><div class="header-left svelte-4b3o1e"><pre class="ascii-logo svelte-4b3o1e"></pre></div> <div class="header-right svelte-4b3o1e"><div class="theme-picker svelte-4b3o1e"><span class="picker-label svelte-4b3o1e">THEME</span> <div class="theme-swatches svelte-4b3o1e"></div></div> <div><span class="backend-label svelte-4b3o1e">COMPUTE</span> <span class="backend-value svelte-4b3o1e"> </span></div></div></header>');function $o(e,t){lt(t,!1);const s=()=>H(Js,"$currentScheme",i),n=()=>H(re,"$simulationStore",i),[i,r]=Nt();Ss();var a=Co(),o=p(a),l=p(o);l.textContent=`
 âââ â â âââ âââ â â âââ âââ âââ âââ
 âââ âââ  â  â â âââ âââ âââ âââ âââ`;var c=g(o,2),u=p(c),v=g(p(u),2);Le(v,5,()=>ms,et,(_,b)=>{var A=ko();let T;A.__click=()=>So(f(b).id),z(()=>{T=ee(A,1,"swatch svelte-4b3o1e",null,T,{active:s().id===f(b).id}),Vs(A,`--swatch-color: ${f(b).colors.primary??""}`),Pe(A,"title",f(b).name)}),M(_,A)});var d=g(u,2);let h;var m=g(p(d),2),y=p(m);z(_=>{h=ee(d,1,"backend-indicator svelte-4b3o1e",null,h,{gpu:n().backend==="gpu"}),N(y,_)},[()=>n().backend.toUpperCase()]),M(e,a),ct(),r()}Qt(["click"]);var Io=C('<footer class="footer svelte-ww03jg"></footer>');function Ao(e){var t=Io();M(e,t)}var Do=C("<div> </div>"),Po=C('<div><div class="corner top-left svelte-1gtc57s"></div> <div class="corner top-right svelte-1gtc57s"></div> <div class="corner bottom-left svelte-1gtc57s"></div> <div class="corner bottom-right svelte-1gtc57s"></div> <!> <div><!></div></div>');function gt(e,t){let s=Ue(t,"borderColor",3,"primary"),n=Ue(t,"noPadding",3,!1),i=Ue(t,"class",3,"");const r={primary:"border-primary",secondary:"border-secondary",tertiary:"border-tertiary"};var a=Po(),o=g(p(a),8);{var l=d=>{var h=Do(),m=p(h);z(()=>{ee(h,1,`title ${r[s()]??""}`,"svelte-1gtc57s"),N(m,t.title)}),M(d,h)};te(o,d=>{t.title&&d(l)})}var c=g(o,2);let u;var v=p(c);Qa(v,()=>t.children??st),z(()=>{ee(a,1,`tui-box ${r[s()]??""} ${i()??""}`,"svelte-1gtc57s"),u=ee(c,1,"content svelte-1gtc57s",null,u,{"no-padding":n()})}),M(e,a)}var Oo=C('<span class="label svelte-1l5vt72"> </span>'),Lo=C("<span> </span>"),Ro=C('<div class="slider-header svelte-1l5vt72"><!> <!></div>'),No=C('<div class="slider-container svelte-1l5vt72"><!> <input type="range"/></div>');function rn(e,t){lt(t,!0);let s=Ue(t,"value",15),n=Ue(t,"min",3,0),i=Ue(t,"max",3,100),r=Ue(t,"step",3,1),a=Ue(t,"showValue",3,!0),o=Ue(t,"valueFormat",3,m=>String(m)),l=Ue(t,"color",3,"tertiary");function c(m){const y=m.target;s(parseFloat(y.value)),t.onchange?.(s())}var u=No(),v=p(u);{var d=m=>{var y=Ro(),_=p(y);{var b=S=>{var E=Oo(),$=p(E);z(()=>N($,t.label)),M(S,E)};te(_,S=>{t.label&&S(b)})}var A=g(_,2);{var T=S=>{var E=Lo(),$=p(E);z(w=>{ee(E,1,`value ${l()??""}`,"svelte-1l5vt72"),N($,w)},[()=>o()(s())]),M(S,E)};te(A,S=>{a()&&S(T)})}M(m,y)};te(v,m=>{(t.label||a())&&m(d)})}var h=g(v,2);h.__input=c,z(()=>{ee(h,1,to(l()),"svelte-1l5vt72"),Pe(h,"min",n()),Pe(h,"max",i()),Pe(h,"step",r()),pn(h,s())}),M(e,u),ct()}Qt(["input"]);var Fo=C('<span class="icon svelte-oaxjxu">&#9724;</span> <span class="label svelte-oaxjxu">PAUSE</span>',1),zo=C('<span class="icon svelte-oaxjxu">&#9654;</span> <span class="label svelte-oaxjxu">PLAY</span>',1),Go=C('<div class="control-grid svelte-oaxjxu"><button><!></button> <button class="control-btn svelte-oaxjxu"><span class="icon svelte-oaxjxu">&#9655;</span> <span class="label svelte-oaxjxu">STEP</span></button> <button class="control-btn svelte-oaxjxu"><span class="icon svelte-oaxjxu">&#8634;</span> <span class="label svelte-oaxjxu">RESET</span></button></div> <div class="speed-control svelte-oaxjxu"><!></div>',1),Bo=C('<button><span class="icon svelte-oaxjxu"><!></span> <span class="label svelte-oaxjxu"> </span></button>'),Yo=C('<div class="brush-settings svelte-oaxjxu"><!> <!></div>'),Xo=C('<div class="tool-grid svelte-oaxjxu"></div> <!>',1),Uo=C('<div><span class="log-prefix svelte-oaxjxu">&gt;</span> <span class="log-message svelte-oaxjxu"> </span></div>'),qo=C('<div class="log-container svelte-oaxjxu"></div>'),jo=C('<aside class="left-sidebar svelte-oaxjxu"><!> <!> <!></aside>');function Wo(e,t){lt(t,!0);const s=()=>H(re,"$simulationStore",r),n=()=>H(ut,"$settings",r),i=()=>H(ti,"$systemLog",r),[r,a]=Nt();let o=Xe(60);function l(y){X(o,y,!0),ni(y)}function c(y){ui(y)}const u=[{id:"view",label:"VIEW",icon:"&#9673;"},{id:"select",label:"SEL",icon:"&#9633;"},{id:"draw",label:"DRAW",icon:"&#9998;"},{id:"erase",label:"ERASE",icon:"&#9747;"}];var v=jo(),d=p(v);gt(d,{title:"SYS.CONTROL",borderColor:"primary",children:(y,_)=>{var b=Go(),A=qe(b),T=p(A);let S;T.__click=()=>s().playing?In():ri();var E=p(T);{var $=F=>{var J=Fo();M(F,J)},w=F=>{var J=zo();M(F,J)};te(E,F=>{s().playing?F($):F(w,!1)})}var x=g(T,2);x.__click=()=>ii();var L=g(x,2);L.__click=()=>_s();var D=g(A,2),q=p(D);rn(q,{label:"SIM SPEED",min:15,max:480,step:15,color:"primary",valueFormat:F=>`${F} steps/s`,onchange:l,get value(){return f(o)},set value(F){X(o,F,!0)}}),z(()=>S=ee(T,1,"control-btn svelte-oaxjxu",null,S,{active:!s().playing})),M(y,b)},$$slots:{default:!0}});var h=g(d,2);gt(h,{title:"TOOL.KIT",borderColor:"tertiary",children:(y,_)=>{var b=Xo(),A=qe(b);Le(A,21,()=>u,et,(E,$)=>{var w=Bo();let x;w.__click=()=>c(f($).id);var L=p(w),D=p(L);Za(D,()=>f($).icon);var q=g(L,2),F=p(q);z(()=>{x=ee(w,1,"tool-btn svelte-oaxjxu",null,x,{active:n().mode===f($).id}),N(F,f($).label)}),M(E,w)});var T=g(A,2);{var S=E=>{var $=Yo(),w=p($);rn(w,{label:"BRUSH SIZE",get value(){return n().brushSize},min:1,max:30,step:1,color:"tertiary",valueFormat:D=>`${D}PX`,get onchange(){return fi}});var x=g(w,2);{var L=D=>{rn(D,{label:"INTENSITY",get value(){return n().brushIntensity},min:0,max:1,step:.05,color:"tertiary",valueFormat:q=>`${Math.round(q*100)}%`,get onchange(){return di}})};te(x,D=>{n().mode==="draw"&&D(L)})}M(E,$)};te(T,E=>{(n().mode==="draw"||n().mode==="erase")&&E(S)})}M(y,b)},$$slots:{default:!0}});var m=g(h,2);gt(m,{title:"DEBUG.LOG",borderColor:"secondary",class:"debug-log-box",children:(y,_)=>{var b=qo();Le(b,5,i,et,(A,T)=>{var S=Uo(),E=g(p(S),2),$=p(E);z(()=>{ee(S,1,`log-entry ${f(T).level??""}`,"svelte-oaxjxu"),N($,f(T).message)}),M(A,S)}),M(y,b)},$$slots:{default:!0}}),M(e,v),ct(),a()}Qt(["click"]);const Ho={initialized:!1,running:!1,progress:null,result:null,bestState:null,error:null},de=ze(Ho);Rt(de,e=>e.running);Rt(de,e=>e.progress);Rt(de,e=>e.bestState);let vs=null,Re=null,Ps=null;function Os(e){if(e===null)return null;if(typeof e=="string")try{return JSON.parse(e)}catch{return null}return e}async function Vo(){if(vs){de.update(e=>({...e,initialized:!0}));return}try{vs=await import("/autoverse/preview/pr-41/pkg/flow_lenia.js"),await vs.default(),de.update(s=>({...s,initialized:!0})),Y("Evolution engine initialized","success")}catch(e){throw Y(`Failed to initialize evolution: ${e}`,"error"),e}}function Ko(){return{base_config:Ke(re).config,algorithm:{type:"GeneticAlgorithm",config:{mutation_rate:.15,crossover_rate:.7,mutation_strength:.1,elitism:2,selection:{method:"Tournament",size:3}}},fitness:{metrics:[{metric:"Persistence",weight:1},{metric:"Compactness",weight:.5},{metric:"Locomotion",weight:.3}],aggregation:"WeightedSum"},population:{size:20,max_generations:50,target_fitness:.95,stagnation_limit:15},evaluation:{steps:200,sample_interval:10,warmup_steps:20},constraints:{radius:{min:.05,max:.25},amplitude:{min:.5,max:2},x:{min:.3,max:.7},y:{min:.3,max:.7}},archive:{enabled:!0,max_size:50,diversity_threshold:.1}}}async function Jo(e){if(!vs)throw new Error("Evolution module not initialized");In(),hi();try{Re&&Re.free(),Re=new vs.WasmEvolutionEngine(JSON.stringify(e)),de.update(t=>({...t,running:!0,progress:null,result:null,error:null})),Y(`Evolution started: pop=${e.population.size}, gens=${e.population.max_generations}`,"info"),vi()}catch(t){throw de.update(s=>({...s,error:String(t)})),Y(`Evolution error: ${t}`,"error"),t}}function vi(){if(!(!Ke(de).running||!Re))try{const t=Re.step(),s=Os(t),n=Re.getBestCandidateState(),i=Os(n);if(de.update(r=>({...r,progress:s,bestState:i??r.bestState})),Re.isComplete()){const r=Re.getResult(),a=Os(r);de.update(o=>({...o,running:!1,result:a})),a&&Y(`Evolution complete: fitness=${a.stats.best_fitness.toFixed(3)}, reason=${a.stats.stop_reason}`,"success");return}Ps=window.setTimeout(()=>vi(),0)}catch(t){de.update(s=>({...s,running:!1,error:String(t)})),Y(`Evolution error: ${t}`,"error")}}function hi(){Ps!==null&&(clearTimeout(Ps),Ps=null);const e=Ke(de);if(Re&&e.running){Re.cancel();try{const t=Re.getResult(),s=Os(t);de.update(n=>({...n,result:s}))}catch{}Y("Evolution cancelled","warn")}de.update(t=>({...t,running:!1}))}function Zo(){const e=Ke(de);if(!e.bestState){Y("No evolved pattern to load","warn");return}const{width:t,height:s,channels:n}=e.bestState;if(!n||n.length===0){Y("No channel data in evolved pattern","warn");return}const i=n[0],r=[];for(let a=0;a<s;a++)for(let o=0;o<t;o++){const l=a*t+o,c=i[l];c>.001&&r.push([o,a,0,c])}_s({pattern:{type:"Custom",values:r}}),Y("Loaded evolved pattern into simulation","success")}var Qo=C('<div class="progress-display svelte-auxm5"><div class="progress-row svelte-auxm5"><span class="label svelte-auxm5">GEN</span> <span class="value svelte-auxm5"> </span></div> <div class="progress-row svelte-auxm5"><span class="label svelte-auxm5">FIT</span> <span class="value highlight svelte-auxm5"> </span></div> <div class="progress-bar svelte-auxm5"><div class="progress-fill svelte-auxm5"></div></div></div>'),el=C('<div class="result-display svelte-auxm5"><div class="result-row svelte-auxm5"><span class="label svelte-auxm5">RESULT</span> <span class="value success svelte-auxm5"> </span></div> <div class="result-reason svelte-auxm5"> </div></div>'),tl=C('<div class="idle-status svelte-auxm5">READY</div>'),sl=C('<button class="evo-btn danger svelte-auxm5">STOP</button>'),nl=C('<button class="evo-btn secondary svelte-auxm5">LOAD</button>'),rl=C('<button class="evo-btn primary svelte-auxm5">EVOLVE</button> <!>',1),il=C('<div class="evolution-panel svelte-auxm5"><div class="preview-container svelte-auxm5"><canvas width="64" height="64" class="preview-canvas svelte-auxm5"></canvas> <span class="preview-label svelte-auxm5">BEST</span></div> <!> <div class="controls svelte-auxm5"><!></div> <details class="settings svelte-auxm5"><summary class="svelte-auxm5">SETTINGS</summary> <div class="settings-grid svelte-auxm5"><label class="svelte-auxm5"><span class="svelte-auxm5">POP</span> <input type="number" min="4" max="50" step="2" class="svelte-auxm5"/></label> <label class="svelte-auxm5"><span class="svelte-auxm5">GENS</span> <input type="number" min="10" max="200" step="10" class="svelte-auxm5"/></label> <label class="svelte-auxm5"><span class="svelte-auxm5">MUT%</span> <input type="number" min="1" max="50" step="1" class="svelte-auxm5"/></label> <label class="svelte-auxm5"><span class="svelte-auxm5">STEPS</span> <input type="number" min="50" max="500" step="50" class="svelte-auxm5"/></label></div> <label class="goal-select svelte-auxm5"><span class="svelte-auxm5">GOAL</span> <select class="svelte-auxm5"><option>Survival</option><option>Glider</option><option>Oscillator</option><option>Complex</option></select></label></details></div>');function al(e,t){lt(t,!1);const s=()=>H(de,"$evolutionStore",n),[n,i]=Nt();let r=ne(),a=ne(null),o=ne(20),l=ne(50),c=.95,u=ne(15),v=ne(200),d=ne("survival");function h(S){if(!f(a)||!f(r))return;const{width:E,height:$,channels:w}=S;if(!w||w.length===0)return;const x=w[0];if(!x||x.length===0)return;const L=f(r).width,D=f(r).height,q=f(a).createImageData(E,$);for(let V=0;V<x.length;V++){const P=Math.floor(Math.min(1,Math.max(0,x[V]))*255);q.data[V*4]=P,q.data[V*4+1]=P,q.data[V*4+2]=P,q.data[V*4+3]=255}const F=new OffscreenCanvas(E,$),J=F.getContext("2d");J&&(J.putImageData(q,0,0),Ma(a,f(a).imageSmoothingEnabled=!1),f(a).clearRect(0,0,L,D),f(a).drawImage(F,0,0,L,D))}function m(S){switch(S){case"glider":return[{metric:"Persistence",weight:1},{metric:"Locomotion",weight:1.5},{metric:"Compactness",weight:.5}];case"oscillator":return[{metric:"Persistence",weight:1},{metric:"Stability",weight:.8},{metric:"Compactness",weight:.5}];case"complex":return[{metric:"Persistence",weight:1},{metric:"Complexity",weight:1.2},{metric:"MassConcentration",weight:.3}];default:return[{metric:"Persistence",weight:1},{metric:"Compactness",weight:.5},{metric:"Stability",weight:.3}]}}function y(){return{...Ko(),population:{size:f(o),max_generations:f(l),target_fitness:c,stagnation_limit:Math.max(5,Math.floor(f(l)/3))},algorithm:{type:"GeneticAlgorithm",config:{mutation_rate:f(u)/100,crossover_rate:.7,mutation_strength:.1,elitism:Math.max(1,Math.floor(f(o)/10)),selection:{method:"Tournament",size:3}}},evaluation:{steps:f(v),sample_interval:Math.max(1,Math.floor(f(v)/20)),warmup_steps:Math.floor(f(v)/10)},fitness:{metrics:m(f(d)),aggregation:"WeightedSum"}}}async function _(){const S=y();try{await Jo(S)}catch(E){Y(`Failed to start evolution: ${E}`,"error")}}function b(){hi()}function A(){Zo()}function T(S){switch(S){case"TargetReached":return"TARGET HIT";case"MaxGenerations":return"MAX GENS";case"Stagnation":return"STAGNANT";case"Cancelled":return"CANCELLED";default:return S}}Ks(async()=>{if(X(a,f(r)?.getContext("2d")??null),!s().initialized)try{await Vo()}catch{}}),Qe(()=>(f(a),s()),()=>{f(a)&&s().bestState&&h(s().bestState)}),Ws(),Ss(),gt(e,{title:"EVOLVE",borderColor:"tertiary",children:(S,E)=>{var $=il(),w=p($),x=p(w);gs(x,W=>X(r,W),()=>f(r));var L=g(w,2);{var D=W=>{var se=Qo(),Me=p(se),ft=g(p(Me),2),dt=p(ft),ue=g(Me,2),me=g(p(ue),2),xt=p(me),ss=g(ue,2),ns=p(ss);z(rs=>{N(dt,`${s(),R(()=>s().progress.generation)??""}/${f(l)??""}`),N(xt,rs),Vs(ns,`width: ${s(),f(l),R(()=>s().progress.generation/f(l)*100)??""}%`)},[()=>(s(),R(()=>s().progress.best_fitness.toFixed(3)))]),M(W,se)},q=W=>{var se=vn(),Me=qe(se);{var ft=ue=>{var me=el(),xt=p(me),ss=g(p(xt),2),ns=p(ss),rs=g(xt,2),Es=p(rs);z((Ms,Qs)=>{N(ns,Ms),N(Es,Qs)},[()=>(s(),R(()=>s().result.stats.best_fitness.toFixed(3))),()=>(s(),R(()=>T(s().result.stats.stop_reason)))]),M(ue,me)},dt=ue=>{var me=tl();M(ue,me)};te(Me,ue=>{s(),R(()=>s().result)?ue(ft):ue(dt,!1)},!0)}M(W,se)};te(L,W=>{s(),R(()=>s().running&&s().progress)?W(D):W(q,!1)})}var F=g(L,2),J=p(F);{var V=W=>{var se=sl();se.__click=b,M(W,se)},P=W=>{var se=rl(),Me=qe(se);Me.__click=_;var ft=g(Me,2);{var dt=ue=>{var me=nl();me.__click=A,M(ue,me)};te(ft,ue=>{s(),R(()=>s().bestState)&&ue(dt)})}z(()=>Me.disabled=(s(),R(()=>!s().initialized))),M(W,se)};te(J,W=>{s(),R(()=>s().running)?W(V):W(P,!1)})}var Z=g(F,2),ie=g(p(Z),2),ve=p(ie),he=g(p(ve),2),_e=g(ve,2),xe=g(p(_e),2),Ge=g(_e,2),wt=g(p(Ge),2),yt=g(Ge,2),Be=g(p(yt),2),ae=g(ie,2),Oe=g(p(ae),2);z(()=>{f(d),Na(()=>{})});var Ye=p(Oe);Ye.value=Ye.__value="survival";var Ft=g(Ye);Ft.value=Ft.__value="glider";var es=g(Ft);es.value=es.__value="oscillator";var ts=g(es);ts.value=ts.__value="complex",Cs(he,()=>f(o),W=>X(o,W)),Cs(xe,()=>f(l),W=>X(l,W)),Cs(wt,()=>f(u),W=>X(u,W)),Cs(Be,()=>f(v),W=>X(v,W)),io(Oe,()=>f(d),W=>X(d,W)),M(S,$)},$$slots:{default:!0}}),ct(),i()}Qt(["click"]);const nr="flow-lenia-presets";class ol{presets=new Map;listeners=new Set;constructor(){this.loadFromStorage()}generateId(){return`preset-${Date.now()}-${Math.random().toString(36).slice(2,9)}`}createThumbnail(t,s=64){const n=document.createElement("canvas");n.width=s,n.height=s;const i=n.getContext("2d"),r=i.createImageData(t.width,t.height),a=t.channels[0];for(let m=0;m<a.length;m++){const y=Math.max(0,Math.min(1,a[m])),_=Math.floor(y*255);r.data[m*4+0]=_,r.data[m*4+1]=_,r.data[m*4+2]=_,r.data[m*4+3]=255}const o=document.createElement("canvas");o.width=t.width,o.height=t.height,o.getContext("2d").putImageData(r,0,0),i.imageSmoothingEnabled=!0,i.fillStyle="#1a1a1a",i.fillRect(0,0,s,s);const c=Math.min(s/t.width,s/t.height),u=t.width*c,v=t.height*c,d=(s-u)/2,h=(s-v)/2;return i.drawImage(o,d,h,u,v),n.toDataURL("image/png")}savePreset(t,s,n){const i={id:this.generateId(),name:t,description:n,thumbnail:this.createThumbnail(s),region:s,createdAt:Date.now()};return this.presets.set(i.id,i),this.persistToStorage(),this.notifyListeners(),i}getPreset(t){return this.presets.get(t)}getAllPresets(){return Array.from(this.presets.values()).sort((t,s)=>s.createdAt-t.createdAt)}deletePreset(t){const s=this.presets.delete(t);return s&&(this.persistToStorage(),this.notifyListeners()),s}renamePreset(t,s){const n=this.presets.get(t);return n?(n.name=s,this.persistToStorage(),this.notifyListeners(),!0):!1}updateDescription(t,s){const n=this.presets.get(t);return n?(n.description=s,this.persistToStorage(),this.notifyListeners(),!0):!1}exportPresets(t){const s=t?t.map(n=>this.presets.get(n)).filter(Boolean):this.getAllPresets();return JSON.stringify(s,null,2)}importPresets(t){try{const s=JSON.parse(t);let n=0;for(const i of s){const r={...i,id:this.generateId(),createdAt:Date.now()};this.presets.set(r.id,r),n++}return this.persistToStorage(),this.notifyListeners(),n}catch{throw new Error("Invalid preset JSON format")}}subscribe(t){return this.listeners.add(t),()=>this.listeners.delete(t)}notifyListeners(){const t=this.getAllPresets();for(const s of this.listeners)s(t)}persistToStorage(){try{const t=JSON.stringify(Array.from(this.presets.entries()));localStorage.setItem(nr,t)}catch(t){console.warn("Failed to persist presets to storage:",t)}}loadFromStorage(){try{const t=localStorage.getItem(nr);if(t){const s=JSON.parse(t);this.presets=new Map(s)}}catch(t){console.warn("Failed to load presets from storage:",t),this.presets=new Map}}clearAll(){this.presets.clear(),this.persistToStorage(),this.notifyListeners()}}const pi=[{name:"Glider",description:"A simple glider that moves across the grid",seed:{pattern:{type:"GaussianBlob",center:[.5,.5],radius:.1,amplitude:1,channel:0}}},{name:"Ring",description:"A ring pattern that expands",seed:{pattern:{type:"Ring",center:[.5,.5],inner_radius:.05,outer_radius:.1,amplitude:1,channel:0}}},{name:"Dual Blobs",description:"Two interacting blobs",seed:{pattern:{type:"MultiBlob",blobs:[{center:[.35,.5],radius:.08,amplitude:1,channel:0},{center:[.65,.5],radius:.08,amplitude:1,channel:0}]}}},{name:"Random Noise",description:"Random initial conditions",seed:{pattern:{type:"Noise",seed:42,amplitude:.5,channel:0}}}],wn=ze(null),gi=ze(0);function ll(){gi.update(e=>e+1)}function cl(e,t){const s=Ke(wn);s&&s.startDragFromLibrary(e,t)}const rr=ze(null),Ht=new ol,Zs=ze(Ht.getAllPresets());Ht.subscribe(e=>{Zs.set(e)});function _i(e){const t=Ht.getAllPresets().find(s=>s.id===e);Ht.deletePreset(e),t&&Y(`Deleted preset: ${t.name}`,"info")}function ul(){const e=Ht.exportPresets();return Y(`Exported ${Ke(Zs).length} presets`,"success"),e}function mi(e){try{const t=Ht.importPresets(e);return Y(`Imported ${t} presets`,"success"),ll(),t}catch(t){throw Y(`Import failed: ${t}`,"error"),t}}function bi(){const e=ul(),t=new Blob([e],{type:"application/json"}),s=URL.createObjectURL(t),n=document.createElement("a");n.href=s,n.download="flow-lenia-presets.json",n.click(),URL.revokeObjectURL(s)}var fl=C('<div class="metric-display svelte-1baw31t"><div class="metric-main svelte-1baw31t"><span class="metric-value svelte-1baw31t"> </span> <span class="metric-unit svelte-1baw31t">STEPS</span></div> <div class="metric-row svelte-1baw31t"><div class="metric-item svelte-1baw31t"><span class="metric-label svelte-1baw31t">TIME</span> <span class="metric-num svelte-1baw31t"> </span></div> <div class="metric-item svelte-1baw31t"><span class="metric-label svelte-1baw31t">MASS</span> <span class="metric-num highlight svelte-1baw31t"> </span></div></div> <div class="metric-row svelte-1baw31t"><div class="metric-item svelte-1baw31t"><span class="metric-label svelte-1baw31t">FPS</span> <span class="metric-num accent svelte-1baw31t"> </span></div> <div class="metric-item svelte-1baw31t"><span class="metric-label svelte-1baw31t">BACKEND</span> <button> </button></div></div></div>'),dl=C('<div class="config-grid svelte-1baw31t"><div class="config-item svelte-1baw31t"><span class="cfg-label svelte-1baw31t">mu</span> <span class="cfg-value svelte-1baw31t"> </span></div> <div class="config-item svelte-1baw31t"><span class="cfg-label svelte-1baw31t">sigma</span> <span class="cfg-value svelte-1baw31t"> </span></div> <div class="config-item svelte-1baw31t"><span class="cfg-label svelte-1baw31t">R</span> <span class="cfg-value svelte-1baw31t"> </span></div> <div class="config-item svelte-1baw31t"><span class="cfg-label svelte-1baw31t">dt</span> <span class="cfg-value svelte-1baw31t"> </span></div></div>'),vl=C('<button class="builtin-btn svelte-1baw31t"> </button>'),hl=C('<div class="builtin-grid svelte-1baw31t"></div>'),pl=C('<img class="svelte-1baw31t"/>'),gl=C('<div class="preset-item svelte-1baw31t" draggable="true" role="button" tabindex="0"><div class="preset-thumbnail svelte-1baw31t"><!></div> <div class="preset-info svelte-1baw31t"><span class="preset-name svelte-1baw31t"> </span> <span class="preset-size svelte-1baw31t"> </span></div> <button class="delete-btn svelte-1baw31t">&#10005;</button></div>'),_l=C('<div class="empty-state svelte-1baw31t">No saved patterns</div>'),ml=C('<div class="patterns-header svelte-1baw31t"><button class="small-btn svelte-1baw31t">IMPORT</button> <button class="small-btn svelte-1baw31t">EXPORT</button></div> <div class="preset-list svelte-1baw31t"></div>',1),bl=C('<aside class="right-sidebar svelte-1baw31t"><!> <!> <!> <!> <!></aside>');function wl(e,t){lt(t,!1);const s=()=>H(re,"$simulationStore",o),n=()=>H(ci,"$formattedStep",o),i=()=>H(bo,"$formattedTime",o),r=()=>H(li,"$formattedMass",o),a=()=>H(Zs,"$presets",o),[o,l]=Nt(),c=ne();function u(){const w=s().backend==="cpu"?"gpu":"cpu";ai(w)}function v(w){const x=Gs();if(!x)return;const L=Math.floor((x.getWidth()-w.region.width)/2),D=Math.floor((x.getHeight()-w.region.height)/2);x.placeRegion(w.region,L,D)}function d(w){_s(w.seed),Y(`Loaded pattern: ${w.name}`,"info")}function h(w,x){w.stopPropagation(),_i(x)}function m(){bi()}function y(){const w=document.createElement("input");w.type="file",w.accept=".json",w.onchange=async x=>{const L=x.target.files?.[0];if(!L)return;const D=await L.text();try{mi(D)}catch{}},w.click()}function _(w,x){w.dataTransfer.effectAllowed="copy",w.dataTransfer.setData("text/plain",x.id),cl(x,w)}Qe(()=>s(),()=>{X(c,s().config.kernels[0])}),Ws(),Ss();var b=bl(),A=p(b);al(A,{});var T=g(A,2);gt(T,{title:"METRICS",borderColor:"secondary",children:(w,x)=>{var L=fl(),D=p(L),q=p(D),F=p(q),J=g(D,2),V=p(J),P=g(p(V),2),Z=p(P),ie=g(V,2),ve=g(p(ie),2),he=p(ve),_e=g(J,2),xe=p(_e),Ge=g(p(xe),2),wt=p(Ge),yt=g(xe,2),Be=g(p(yt),2);let ae;Be.__click=u;var Oe=p(Be);z(Ye=>{N(F,n()),N(Z,`${i()??""}s`),N(he,r()),N(wt,(s(),R(()=>s().fps))),ae=ee(Be,1,"backend-btn svelte-1baw31t",null,ae,{gpu:s().backend==="gpu"}),Be.disabled=(s(),R(()=>!s().gpuAvailable)),N(Oe,Ye)},[()=>(s(),R(()=>s().backend.toUpperCase()))]),M(w,L)},$$slots:{default:!0}});var S=g(T,2);gt(S,{title:"KERNEL",borderColor:"primary",children:(w,x)=>{var L=dl(),D=p(L),q=g(p(D),2),F=p(q),J=g(D,2),V=g(p(J),2),P=p(V),Z=g(J,2),ie=g(p(Z),2),ve=p(ie),he=g(Z,2),_e=g(p(he),2),xe=p(_e);z(()=>{N(F,(f(c),R(()=>f(c)?.mu??"â"))),N(P,(f(c),R(()=>f(c)?.sigma??"â"))),N(ve,(s(),R(()=>s().config.kernel_radius))),N(xe,(s(),R(()=>s().config.dt)))}),M(w,L)},$$slots:{default:!0}});var E=g(S,2);gt(E,{title:"SEEDS",borderColor:"tertiary",children:(w,x)=>{var L=hl();Le(L,5,()=>pi,et,(D,q)=>{var F=vl();F.__click=()=>d(f(q));var J=p(F);z(()=>{Pe(F,"title",(f(q),R(()=>f(q).description))),N(J,(f(q),R(()=>f(q).name)))}),M(D,F)}),M(w,L)},$$slots:{default:!0}});var $=g(E,2);gt($,{title:"SAVED",borderColor:"primary",class:"saved-box",children:(w,x)=>{var L=ml(),D=qe(L),q=p(D);q.__click=y;var F=g(q,2);F.__click=m;var J=g(D,2);Le(J,5,a,V=>V.id,(V,P)=>{var Z=gl();Z.__click=()=>v(f(P)),Z.__keydown=ae=>ae.key==="Enter"&&v(f(P));var ie=p(Z),ve=p(ie);{var he=ae=>{var Oe=pl();z(()=>{Pe(Oe,"src",(f(P),R(()=>f(P).thumbnail))),Pe(Oe,"alt",(f(P),R(()=>f(P).name)))}),M(ae,Oe)};te(ve,ae=>{f(P),R(()=>f(P).thumbnail)&&ae(he)})}var _e=g(ie,2),xe=p(_e),Ge=p(xe),wt=g(xe,2),yt=p(wt),Be=g(_e,2);Be.__click=ae=>h(ae,f(P).id),z(()=>{N(Ge,(f(P),R(()=>f(P).name))),N(yt,`${f(P),R(()=>f(P).region.width)??""}x${f(P),R(()=>f(P).region.height)??""}`)}),Hr("dragstart",Z,ae=>_(ae,f(P))),M(V,Z)},V=>{var P=_l();M(V,P)}),M(w,L)},$$slots:{default:!0}}),M(e,b),ct(),l()}Qt(["click","keydown"]);class yl{canvas;ctx;offscreenCanvas;offscreenCtx;settings;grayscaleMap;thermalMap;viridisMap;themeMap;constructor(t,s){this.canvas=t;const n=t.getContext("2d");if(!n)throw new Error("Failed to get 2D context");this.ctx=n,this.offscreenCanvas=document.createElement("canvas");const i=this.offscreenCanvas.getContext("2d");if(!i)throw new Error("Failed to get offscreen 2D context");this.offscreenCtx=i,this.settings=s,this.grayscaleMap=this.buildGrayscaleMap(),this.thermalMap=this.buildThermalMap(),this.viridisMap=this.buildViridisMap(),this.themeMap=this.viridisMap}setThemeColors(t){this.themeMap=this.buildThemeMap(t)}updateSettings(t){this.settings={...this.settings,...t}}render(t,s,n){const{width:i,height:r,channels:a}=t;(this.offscreenCanvas.width!==i||this.offscreenCanvas.height!==r)&&(this.offscreenCanvas.width=i,this.offscreenCanvas.height=r);const o=this.getColorMap(),l=this.offscreenCtx.createImageData(i,r),c=a[0];for(let u=0;u<c.length;u++){const v=Math.max(0,Math.min(1,c[u])),d=Math.floor(v*255)*4;l.data[u*4+0]=o[d+0],l.data[u*4+1]=o[d+1],l.data[u*4+2]=o[d+2],l.data[u*4+3]=255}this.offscreenCtx.putImageData(l,0,0),this.ctx.imageSmoothingEnabled=!1,this.ctx.fillStyle="#000",this.ctx.fillRect(0,0,this.canvas.width,this.canvas.height),this.ctx.drawImage(this.offscreenCanvas,0,0,i,r,0,0,this.canvas.width,this.canvas.height),this.settings.showGrid&&this.drawGrid(i,r),n&&this.drawGhostPreview(n,i,r),s&&this.settings.showSelection&&this.drawSelection(s,i,r)}drawGrid(t,s){const n=this.canvas.width/t,i=this.canvas.height/s;if(this.ctx.strokeStyle="rgba(255, 255, 255, 0.1)",this.ctx.lineWidth=1,n>=4&&i>=4){this.ctx.beginPath();for(let r=0;r<=t;r++){const a=r*n;this.ctx.moveTo(a,0),this.ctx.lineTo(a,this.canvas.height)}for(let r=0;r<=s;r++){const a=r*i;this.ctx.moveTo(0,a),this.ctx.lineTo(this.canvas.width,a)}this.ctx.stroke()}}drawSelection(t,s,n){const i=this.canvas.width/s,r=this.canvas.height/n,a=Math.min(t.startX,t.endX)*i,o=Math.min(t.startY,t.endY)*r,l=Math.abs(t.endX-t.startX)*i,c=Math.abs(t.endY-t.startY)*r;this.ctx.fillStyle="rgba(79, 195, 247, 0.2)",this.ctx.fillRect(a,o,l,c),this.ctx.strokeStyle="#4fc3f7",this.ctx.lineWidth=2,this.ctx.setLineDash([5,5]),this.ctx.strokeRect(a,o,l,c),this.ctx.setLineDash([]);const u=Math.abs(t.endX-t.startX),v=Math.abs(t.endY-t.startY);u>0&&v>0&&(this.ctx.fillStyle="#4fc3f7",this.ctx.font="12px monospace",this.ctx.fillText(`${u} x ${v}`,a+4,o-4))}drawGhostPreview(t,s,n){const i=this.canvas.width/s,r=this.canvas.height/n,{region:a,x:o,y:l}=t,c=document.createElement("canvas");c.width=a.width,c.height=a.height;const u=c.getContext("2d"),v=u.createImageData(a.width,a.height),d=this.getColorMap();for(let h=0;h<a.channels[0].length;h++){const m=Math.max(0,Math.min(1,a.channels[0][h])),y=Math.floor(m*255)*4;v.data[h*4+0]=d[y+0],v.data[h*4+1]=d[y+1],v.data[h*4+2]=d[y+2],v.data[h*4+3]=m>.01?180:0}u.putImageData(v,0,0),this.ctx.globalAlpha=.7,this.ctx.drawImage(c,0,0,a.width,a.height,o*i,l*r,a.width*i,a.height*r),this.ctx.globalAlpha=1,this.ctx.strokeStyle="#4fc3f7",this.ctx.lineWidth=2,this.ctx.setLineDash([3,3]),this.ctx.strokeRect(o*i,l*r,a.width*i,a.height*r),this.ctx.setLineDash([])}canvasToSim(t,s,n,i){const r=this.canvas.getBoundingClientRect(),a=n/this.canvas.width,o=i/this.canvas.height;return{x:Math.floor((t-r.left)*a),y:Math.floor((s-r.top)*o)}}getColorMap(){switch(this.settings.colorScheme){case"thermal":return this.thermalMap;case"viridis":return this.viridisMap;case"theme":return this.themeMap;default:return this.grayscaleMap}}buildGrayscaleMap(){const t=new Uint8ClampedArray(1024);for(let s=0;s<256;s++)t[s*4+0]=s,t[s*4+1]=s,t[s*4+2]=s,t[s*4+3]=255;return t}buildThermalMap(){const t=new Uint8ClampedArray(1024);for(let s=0;s<256;s++){const n=s/255;let i,r,a;if(n<.2){const o=n/.2;i=0,r=0,a=Math.floor(o*128)}else if(n<.4){const o=(n-.2)/.2;i=0,r=Math.floor(o*255),a=128+Math.floor(o*127)}else if(n<.6){const o=(n-.4)/.2;i=Math.floor(o*255),r=255,a=255-Math.floor(o*255)}else if(n<.8){const o=(n-.6)/.2;i=255,r=255-Math.floor(o*255),a=0}else{const o=(n-.8)/.2;i=255,r=Math.floor(o*255),a=Math.floor(o*255)}t[s*4+0]=i,t[s*4+1]=r,t[s*4+2]=a,t[s*4+3]=255}return t}buildViridisMap(){const t=[[68,1,84],[72,35,116],[64,67,135],[52,94,141],[41,120,142],[32,144,140],[34,167,132],[68,190,112],[121,209,81],[189,222,38],[253,231,36]],s=new Uint8ClampedArray(256*4);for(let n=0;n<256;n++){const r=n/255*(t.length-1),a=Math.floor(r),o=Math.min(a+1,t.length-1),l=r-a;s[n*4+0]=Math.floor(t[a][0]+l*(t[o][0]-t[a][0])),s[n*4+1]=Math.floor(t[a][1]+l*(t[o][1]-t[a][1])),s[n*4+2]=Math.floor(t[a][2]+l*(t[o][2]-t[a][2])),s[n*4+3]=255}return s}getCanvas(){return this.canvas}buildThemeMap(t){const s=l=>{const c=l.replace("#","");return[parseInt(c.slice(0,2),16),parseInt(c.slice(2,4),16),parseInt(c.slice(4,6),16)]},n=s(t.primary),i=s(t.secondary),r=s(t.tertiary),a=[{t:0,color:[5,5,5]},{t:.15,color:[n[0]*.3,n[1]*.3,n[2]*.3]},{t:.35,color:n},{t:.6,color:i},{t:.85,color:r},{t:1,color:[255,255,255]}],o=new Uint8ClampedArray(256*4);for(let l=0;l<256;l++){const c=l/255;let u=a[0],v=a[1];for(let h=1;h<a.length;h++)if(c<=a[h].t){u=a[h-1],v=a[h];break}const d=(c-u.t)/(v.t-u.t);o[l*4+0]=Math.floor(u.color[0]+d*(v.color[0]-u.color[0])),o[l*4+1]=Math.floor(u.color[1]+d*(v.color[1]-u.color[1])),o[l*4+2]=Math.floor(u.color[2]+d*(v.color[2]-u.color[2])),o[l*4+3]=255}return o}}class xl{canvas;simulation;callbacks;mode="view";selection=null;isSelecting=!1;isDrawing=!1;isDragging=!1;draggedCreature=null;ghostPreview=null;brushSize=3;brushIntensity=.5;constructor(t,s,n,i={}){this.canvas=t,this.simulation=s,this.callbacks=i,this.setupEventListeners(),this.setupDragDrop()}setMode(t){switch(this.mode=t,this.selection=null,this.isSelecting=!1,this.isDrawing=!1,t){case"select":this.canvas.style.cursor="crosshair";break;case"draw":this.canvas.style.cursor="cell";break;case"erase":this.canvas.style.cursor="not-allowed";break;default:this.canvas.style.cursor="default"}this.callbacks.onModeChange?.(t)}getMode(){return this.mode}getSelection(){return this.selection}clearSelection(){this.selection=null,this.callbacks.onSelectionChange?.(null)}setBrushSize(t){this.brushSize=Math.max(1,Math.min(20,t))}setBrushIntensity(t){this.brushIntensity=Math.max(0,Math.min(1,t))}getGhostPreview(){return this.ghostPreview}startDragFromLibrary(t,s){this.isDragging=!0,this.draggedCreature={preset:t,offsetX:t.region.width/2,offsetY:t.region.height/2};const n=this.getSimCoords(s);this.ghostPreview={region:t.region,x:n.x-this.draggedCreature.offsetX,y:n.y-this.draggedCreature.offsetY}}setupEventListeners(){this.canvas.addEventListener("mousedown",this.handleMouseDown.bind(this)),this.canvas.addEventListener("mousemove",this.handleMouseMove.bind(this)),this.canvas.addEventListener("mouseup",this.handleMouseUp.bind(this)),this.canvas.addEventListener("mouseleave",this.handleMouseLeave.bind(this)),this.canvas.addEventListener("touchstart",this.handleTouchStart.bind(this),{passive:!1}),this.canvas.addEventListener("touchmove",this.handleTouchMove.bind(this),{passive:!1}),this.canvas.addEventListener("touchend",this.handleTouchEnd.bind(this),{passive:!1}),this.canvas.addEventListener("touchcancel",this.handleTouchEnd.bind(this),{passive:!1}),document.addEventListener("keydown",this.handleKeyDown.bind(this))}setupDragDrop(){this.canvas.addEventListener("dragover",t=>{if(t.preventDefault(),t.dataTransfer.dropEffect="copy",this.draggedCreature){const s=this.getSimCoords(t);this.ghostPreview={region:this.draggedCreature.preset.region,x:s.x-this.draggedCreature.offsetX,y:s.y-this.draggedCreature.offsetY}}}),this.canvas.addEventListener("drop",t=>{if(t.preventDefault(),this.draggedCreature){const s=this.getSimCoords(t),n=Math.floor(s.x-this.draggedCreature.offsetX),i=Math.floor(s.y-this.draggedCreature.offsetY);this.callbacks.onDrop?.(this.draggedCreature.preset,n,i),this.draggedCreature=null,this.ghostPreview=null,this.isDragging=!1}}),this.canvas.addEventListener("dragleave",()=>{this.ghostPreview=null})}handleMouseDown(t){const s=this.getSimCoords(t);switch(this.mode){case"select":this.isSelecting=!0,this.selection={startX:s.x,startY:s.y,endX:s.x,endY:s.y},this.callbacks.onSelectionChange?.(this.selection);break;case"draw":this.isDrawing=!0,this.callbacks.onDraw?.(s.x,s.y);break;case"erase":this.isDrawing=!0,this.callbacks.onErase?.(s.x,s.y);break}}handleMouseMove(t){const s=this.getSimCoords(t);this.isSelecting&&this.selection&&(this.selection.endX=s.x,this.selection.endY=s.y,this.callbacks.onSelectionChange?.(this.selection)),this.isDrawing&&(this.mode==="draw"?this.callbacks.onDraw?.(s.x,s.y):this.mode==="erase"&&this.callbacks.onErase?.(s.x,s.y)),this.isDragging&&this.draggedCreature&&(this.ghostPreview={region:this.draggedCreature.preset.region,x:s.x-this.draggedCreature.offsetX,y:s.y-this.draggedCreature.offsetY})}handleMouseUp(t){if(this.isSelecting&&this.selection){const s={startX:Math.min(this.selection.startX,this.selection.endX),startY:Math.min(this.selection.startY,this.selection.endY),endX:Math.max(this.selection.startX,this.selection.endX),endY:Math.max(this.selection.startY,this.selection.endY)};s.endX>s.startX&&s.endY>s.startY?(this.selection=s,this.callbacks.onSelectionComplete?.(s)):this.selection=null,this.callbacks.onSelectionChange?.(this.selection)}this.isSelecting=!1,this.isDrawing=!1}handleMouseLeave(t){this.isSelecting&&(this.isSelecting=!1,this.selection=null,this.callbacks.onSelectionChange?.(null)),this.isDrawing=!1,this.ghostPreview=null}handleTouchStart(t){if(t.touches.length!==1)return;this.mode!=="view"&&t.preventDefault();const s=t.touches[0],n=this.getTouchSimCoords(s);switch(this.mode){case"select":this.isSelecting=!0,this.selection={startX:n.x,startY:n.y,endX:n.x,endY:n.y},this.callbacks.onSelectionChange?.(this.selection);break;case"draw":this.isDrawing=!0,this.callbacks.onDraw?.(n.x,n.y);break;case"erase":this.isDrawing=!0,this.callbacks.onErase?.(n.x,n.y);break}}handleTouchMove(t){if(t.touches.length!==1)return;this.mode!=="view"&&(this.isDrawing||this.isSelecting)&&t.preventDefault();const s=t.touches[0],n=this.getTouchSimCoords(s);this.isSelecting&&this.selection&&(this.selection.endX=n.x,this.selection.endY=n.y,this.callbacks.onSelectionChange?.(this.selection)),this.isDrawing&&(this.mode==="draw"?this.callbacks.onDraw?.(n.x,n.y):this.mode==="erase"&&this.callbacks.onErase?.(n.x,n.y))}handleTouchEnd(t){if(this.mode!=="view"&&(this.isDrawing||this.isSelecting)&&t.preventDefault(),this.isSelecting&&this.selection){const s={startX:Math.min(this.selection.startX,this.selection.endX),startY:Math.min(this.selection.startY,this.selection.endY),endX:Math.max(this.selection.startX,this.selection.endX),endY:Math.max(this.selection.startY,this.selection.endY)};s.endX>s.startX&&s.endY>s.startY?(this.selection=s,this.callbacks.onSelectionComplete?.(s)):this.selection=null,this.callbacks.onSelectionChange?.(this.selection)}this.isSelecting=!1,this.isDrawing=!1}getTouchSimCoords(t){const s=this.canvas.getBoundingClientRect(),n=t.clientX-s.left,i=t.clientY-s.top,r=this.simulation.getWidth(),a=this.simulation.getHeight();return{x:Math.floor(n/s.width*r),y:Math.floor(i/s.height*a)}}handleKeyDown(t){const s=t.target;s.tagName==="INPUT"||s.tagName==="TEXTAREA"||(t.key==="v"||t.key==="Escape"?this.setMode("view"):t.key==="s"?this.setMode("select"):t.key==="d"?this.setMode("draw"):t.key==="e"&&this.setMode("erase"),t.key==="["?(this.setBrushSize(this.brushSize-1),this.callbacks.onBrushSizeChange?.(this.brushSize)):t.key==="]"&&(this.setBrushSize(this.brushSize+1),this.callbacks.onBrushSizeChange?.(this.brushSize)))}getSimCoords(t){const s=this.canvas.getBoundingClientRect(),n=t.clientX-s.left,i=t.clientY-s.top,r=this.simulation.getWidth(),a=this.simulation.getHeight();return{x:Math.floor(n/s.width*r),y:Math.floor(i/s.height*a)}}getBrushSize(){return this.brushSize}getBrushIntensity(){return this.brushIntensity}}var Sl=C('<div class="simulation-view svelte-145nxqv"><div class="canvas-frame svelte-145nxqv"><div class="canvas-header svelte-145nxqv"><span class="dim-label svelte-145nxqv"> </span></div> <div class="canvas-container svelte-145nxqv"><canvas class="svelte-145nxqv"></canvas> <div class="corner-marker top-left svelte-145nxqv"></div> <div class="corner-marker top-right svelte-145nxqv"></div> <div class="corner-marker bottom-left svelte-145nxqv"></div> <div class="corner-marker bottom-right svelte-145nxqv"></div> <div class="canvas-scanlines svelte-145nxqv"></div></div></div></div>');function ir(e,t){lt(t,!1);const s=()=>H(ut,"$settings",a),n=()=>H(re,"$simulationStore",a),i=()=>H(Js,"$currentScheme",a),r=()=>H(gi,"$renderTrigger",a),[a,o]=Nt();let l=ne(),c=ne(),u=ne(null),v=ne(null);const d=512;Ks(()=>{const E=Gs();!E||!f(c)||(rr.set(f(c)),X(u,new yl(f(c),{colorScheme:s().colorScheme,showGrid:s().showGrid,showSelection:s().showSelection,brushSize:s().brushSize,brushIntensity:s().brushIntensity,backend:n().backend})),X(v,new xl(f(c),E,f(u),{onSelectionChange:()=>h(),onSelectionComplete:()=>{},onDrop:($,w,x)=>{E.placeRegion($.region,w,x),h()},onDraw:($,w)=>{E.drawAt($,w,s().brushSize,s().brushIntensity),h()},onErase:($,w)=>{E.eraseAt($,w,s().brushSize),h()},onModeChange:()=>{},onBrushSizeChange:()=>{}})),wn.set(f(v)),h())}),ei(()=>{wn.set(null),rr.set(null),X(u,null),X(v,null)});function h(){if(!f(u))return;const E=Gs();if(!E)return;const $=E.getState(),w=f(v)?.getSelection(),x=f(v)?.getGhostPreview();f(u).render($,w,x)}Qe(()=>(n(),f(u)),()=>{n().state&&f(u)&&h()}),Qe(()=>(f(v),s()),()=>{f(v)&&s().mode&&f(v).setMode(s().mode)}),Qe(()=>(f(v),s()),()=>{f(v)&&(f(v).setBrushSize(s().brushSize),f(v).setBrushIntensity(s().brushIntensity))}),Qe(()=>(f(u),s()),()=>{f(u)&&s().colorScheme&&(f(u).updateSettings({colorScheme:s().colorScheme}),h())}),Qe(()=>(f(u),i()),()=>{f(u)&&i()&&(f(u).setThemeColors({primary:i().colors.primary,secondary:i().colors.secondary,tertiary:i().colors.tertiary}),h())}),Qe(()=>(r(),f(u)),()=>{r()&&f(u)&&h()}),Ws(),Ss();var m=Sl(),y=p(m),_=p(y),b=p(_),A=p(b),T=g(_,2),S=p(T);Pe(S,"width",d),Pe(S,"height",d),gs(S,E=>X(c,E),()=>f(c)),gs(T,E=>X(l,E),()=>f(l)),z(()=>N(A,`${n(),R(()=>n().config.width)??""}x${n(),R(()=>n().config.height)??""}`)),M(e,m),ct(),o()}var El=C("<button> </button>"),Ml=C('<span class="icon svelte-xicwp9">â¸</span>'),Tl=C('<span class="icon svelte-xicwp9">â¶</span>'),kl=C('<button><span class="icon svelte-xicwp9"> </span> <span class="label svelte-xicwp9"> </span></button>'),Cl=C('<div class="brush-row svelte-xicwp9"><label class="svelte-xicwp9">INTENSITY</label> <input type="range" min="0" max="100" class="svelte-xicwp9"/> <span class="svelte-xicwp9"> </span></div>'),$l=C('<div class="brush-settings svelte-xicwp9"><div class="brush-row svelte-xicwp9"><label class="svelte-xicwp9">SIZE</label> <input type="range" min="1" max="30" class="svelte-xicwp9"/> <span class="svelte-xicwp9"> </span></div> <!></div>'),Il=C("<button> </button>"),Al=C('<img class="svelte-xicwp9"/>'),Dl=C('<div class="preset-placeholder svelte-xicwp9"></div>'),Pl=C('<div class="preset-item svelte-xicwp9" role="button" tabindex="0"><!> <span class="preset-name svelte-xicwp9"> </span> <span class="preset-size svelte-xicwp9"> </span></div>'),Ol=C('<div class="empty-state svelte-xicwp9">No saved patterns</div>'),Ll=C('<button class="builtin-btn svelte-xicwp9"><span class="builtin-name svelte-xicwp9"> </span> <span class="builtin-desc svelte-xicwp9"> </span></button>'),Rl=C("<button></button>"),Nl=C('<div class="bottom-sheet svelte-xicwp9"><div class="mobile-stats svelte-xicwp9"><div class="stats-group svelte-xicwp9"><span>STEP: <strong class="svelte-xicwp9"> </strong></span> <span>MASS: <strong class="svelte-xicwp9"> </strong></span> <span>FPS: <strong class="svelte-xicwp9"> </strong></span></div> <div class="backend-toggle svelte-xicwp9"><span>CPU</span> <button aria-label="Toggle between CPU and GPU backend"><span class="toggle-knob svelte-xicwp9"></span></button> <span>GPU</span></div></div> <div class="tabs svelte-xicwp9"></div> <div class="panels-container svelte-xicwp9"><div><div class="panel svelte-xicwp9"><div class="playback-controls svelte-xicwp9"><button><!></button> <button class="ctrl-btn svelte-xicwp9"><span class="icon svelte-xicwp9">â­</span></button> <button class="ctrl-btn svelte-xicwp9"><span class="icon svelte-xicwp9">âº</span></button> <div class="speed-control svelte-xicwp9"><button class="speed-btn svelte-xicwp9">â</button> <strong> </strong> <button class="speed-btn svelte-xicwp9">+</button></div></div> <div class="tools-grid svelte-xicwp9"></div> <!></div> <div class="panel svelte-xicwp9"><div class="display-section svelte-xicwp9"><label class="section-label svelte-xicwp9">COLOR SCHEME</label> <div class="scheme-grid svelte-xicwp9"></div></div> <div class="display-section svelte-xicwp9"><label class="section-label svelte-xicwp9">EFFECTS</label> <div class="toggle-row svelte-xicwp9"><span>CRT Scanlines</span> <button aria-label="Toggle CRT scanlines effect"><span class="toggle-knob svelte-xicwp9"></span></button></div></div></div> <div class="panel svelte-xicwp9"><div class="preset-actions svelte-xicwp9"><button class="action-btn svelte-xicwp9">IMPORT</button> <button class="action-btn svelte-xicwp9">EXPORT</button></div> <div class="preset-grid svelte-xicwp9"></div></div> <div class="panel svelte-xicwp9"><div class="builtin-grid svelte-xicwp9"></div></div></div></div> <div class="swipe-indicator svelte-xicwp9"></div></div>');function Fl(e,t){lt(t,!0);const s=()=>H(Ae,"$mobileStore",c),n=()=>H(To,"$currentTabIndex",c),i=()=>H(ci,"$formattedStep",c),r=()=>H(li,"$formattedMass",c),a=()=>H(re,"$simulationStore",c),o=()=>H(ut,"$settings",c),l=()=>H(Zs,"$presets",c),[c,u]=Nt();let v,d=0,h=0,m=Xe(1);function y(k){const I=k.touches[0];d=I.clientX,h=I.clientX,Ae.startSwipe()}function _(k){if(!s().isSwiping)return;h=k.touches[0].clientX;const O=h-d,j=n();j===0&&O>0||j===nn.length-1&&O<0?Ae.updateSwipe(O*.3):Ae.updateSwipe(O)}function b(){!s().isSwiping||!v||Ae.endSwipe(v.clientWidth)}function A(k){Ae.setTab(k)}function T(k){X(m,Math.max(1,Math.min(10,f(m)+k)),!0),_o(f(m))}const S=[{id:"view",label:"VIEW",icon:"â"},{id:"select",label:"SEL",icon:"â¡"},{id:"draw",label:"DRAW",icon:"â"},{id:"erase",label:"ERASE",icon:"â"}],E=[{id:"theme",label:"THEME"},{id:"grayscale",label:"GRAY"},{id:"thermal",label:"THERMAL"},{id:"viridis",label:"VIRIDIS"}];function $(k){const I=Gs();if(!I)return;const O=Math.floor((I.getWidth()-k.region.width)/2),j=Math.floor((I.getHeight()-k.region.height)/2);I.placeRegion(k.region,O,j)}function w(k){_s(k.seed),Y(`Loaded: ${k.name}`,"info")}let x=null;function L(k){x=setTimeout(()=>{confirm(`Delete "${k.name}"?`)&&_i(k.id)},500)}function D(){x&&(clearTimeout(x),x=null)}function q(){const k=document.createElement("input");k.type="file",k.accept=".json",k.onchange=async I=>{const O=I.target.files?.[0];if(!O)return;const j=await O.text();try{mi(j)}catch{}},k.click()}let F=Sa(()=>{const k=-n()*100,I=v?s().swipeOffset/v.clientWidth*100:0;return`translateX(${k+I}%)`});var J=Nl(),V=p(J),P=p(V),Z=p(P),ie=g(p(Z)),ve=p(ie),he=g(Z,2),_e=g(p(he)),xe=p(_e),Ge=g(he,2),wt=g(p(Ge)),yt=p(wt),Be=g(P,2),ae=p(Be);let Oe;var Ye=g(ae,2);let Ft;Ye.__click=()=>ai(a().backend==="cpu"?"gpu":"cpu");var es=g(Ye,2);let ts;var W=g(V,2);Le(W,21,()=>nn,et,(k,I)=>{var O=El();let j;O.__click=()=>A(f(I));var pe=p(O);z(Je=>{j=ee(O,1,"tab svelte-xicwp9",null,j,{active:s().activeTab===f(I)}),N(pe,Je)},[()=>f(I).toUpperCase()]),M(k,O)});var se=g(W,2);se.__touchstart=y,se.__touchmove=_,se.__touchend=b;var Me=p(se);let ft;var dt=p(Me),ue=p(dt),me=p(ue);let xt;me.__click=()=>a().playing?In():ri();var ss=p(me);{var ns=k=>{var I=Ml();M(k,I)},rs=k=>{var I=Tl();M(k,I)};te(ss,k=>{a().playing?k(ns):k(rs,!1)})}var Es=g(me,2);Es.__click=()=>ii();var Ms=g(Es,2);Ms.__click=()=>_s();var Qs=g(Ms,2),Dn=p(Qs);Dn.__click=()=>T(-1);var Pn=g(Dn,2),wi=p(Pn),yi=g(Pn,2);yi.__click=()=>T(1);var On=g(ue,2);Le(On,21,()=>S,et,(k,I)=>{var O=kl();let j;O.__click=()=>ui(f(I).id);var pe=p(O),Je=p(pe),vt=g(pe,2),is=p(vt);z(()=>{j=ee(O,1,"tool-btn svelte-xicwp9",null,j,{active:o().mode===f(I).id}),N(Je,f(I).icon),N(is,f(I).label)}),M(k,O)});var xi=g(On,2);{var Si=k=>{var I=$l(),O=p(I),j=g(p(O),2);j.__input=St=>fi(parseInt(St.currentTarget.value));var pe=g(j,2),Je=p(pe),vt=g(O,2);{var is=St=>{var Ts=Cl(),Te=g(p(Ts),2);Te.__input=en=>di(parseInt(en.currentTarget.value)/100);var Et=g(Te,2),Di=p(Et);z((en,Pi)=>{pn(Te,en),N(Di,`${Pi??""}%`)},[()=>Math.round(o().brushIntensity*100),()=>Math.round(o().brushIntensity*100)]),M(St,Ts)};te(vt,St=>{o().mode==="draw"&&St(is)})}z(()=>{pn(j,o().brushSize),N(Je,o().brushSize)}),M(k,I)};te(xi,k=>{(o().mode==="draw"||o().mode==="erase")&&k(Si)})}var Ln=g(dt,2),Rn=p(Ln),Ei=g(p(Rn),2);Le(Ei,21,()=>E,et,(k,I)=>{var O=Il();let j;O.__click=()=>yo(f(I).id);var pe=p(O);z(()=>{j=ee(O,1,"scheme-btn svelte-xicwp9",null,j,{active:o().colorScheme===f(I).id}),N(pe,f(I).label)}),M(k,O)});var Mi=g(Rn,2),Ti=g(p(Mi),2),Nn=g(p(Ti),2);let Fn;Nn.__click=function(...k){xo?.apply(this,k)};var zn=g(Ln,2),Gn=p(zn),Bn=p(Gn);Bn.__click=q;var ki=g(Bn,2);ki.__click=function(...k){bi?.apply(this,k)};var Ci=g(Gn,2);Le(Ci,5,l,k=>k.id,(k,I)=>{var O=Pl();O.__click=()=>$(f(I)),O.__keydown=Te=>Te.key==="Enter"&&$(f(I)),O.__touchstart=()=>L(f(I)),O.__touchend=D,O.__touchmove=D;var j=p(O);{var pe=Te=>{var Et=Al();z(()=>{Pe(Et,"src",f(I).thumbnail),Pe(Et,"alt",f(I).name)}),M(Te,Et)},Je=Te=>{var Et=Dl();M(Te,Et)};te(j,Te=>{f(I).thumbnail?Te(pe):Te(Je,!1)})}var vt=g(j,2),is=p(vt),St=g(vt,2),Ts=p(St);z(()=>{N(is,f(I).name),N(Ts,`${f(I).region.width??""}Ã${f(I).region.height??""}`)}),M(k,O)},k=>{var I=Ol();M(k,I)});var $i=g(zn,2),Ii=p($i);Le(Ii,21,()=>pi,et,(k,I)=>{var O=Ll();O.__click=()=>w(f(I));var j=p(O),pe=p(j),Je=g(j,2),vt=p(Je);z(()=>{N(pe,f(I).name),N(vt,f(I).description)}),M(k,O)}),gs(se,k=>v=k,()=>v);var Ai=g(se,2);Le(Ai,21,()=>nn,et,(k,I,O)=>{var j=Rl();let pe;j.__click=()=>Ae.setTab(f(I)),z(()=>{pe=ee(j,1,"dot svelte-xicwp9",null,pe,{active:n()===O}),Pe(j,"aria-label",`Go to ${f(I)??""} panel`)}),M(k,j)}),z(()=>{N(ve,i()),N(xe,r()),N(yt,a().fps),Oe=ee(ae,1,"backend-label svelte-xicwp9",null,Oe,{active:a().backend==="cpu"}),Ft=ee(Ye,1,"toggle-btn svelte-xicwp9",null,Ft,{gpu:a().backend==="gpu"}),Ye.disabled=!a().gpuAvailable,ts=ee(es,1,"backend-label svelte-xicwp9",null,ts,{active:a().backend==="gpu",unavailable:!a().gpuAvailable}),ft=ee(Me,1,"panels-wrapper svelte-xicwp9",null,ft,{swiping:s().isSwiping}),Vs(Me,`transform: ${f(F)??""}`),xt=ee(me,1,"play-btn svelte-xicwp9",null,xt,{active:a().playing}),N(wi,`${f(m)??""}X`),Fn=ee(Nn,1,"toggle-btn small svelte-xicwp9",null,Fn,{on:o().showScanlines})}),Hr("touchcancel",se,b),M(e,J),ct(),u()}Qt(["click","touchstart","touchmove","touchend","input","keydown"]);var zl=C('<div class="loading-screen svelte-1n46o8q"><div class="loading-content svelte-1n46o8q"><div class="glitch-text svelte-1n46o8q" data-text="FLOW_LENIA">FLOW_LENIA</div> <div class="loading-status svelte-1n46o8q"><span class="animate-pulse">INITIALIZING SUBSTRATE</span> <span class="animate-blink">_</span></div></div></div>'),Gl=C('<div class="error-screen svelte-1n46o8q"><div class="error-content svelte-1n46o8q"><div class="error-title svelte-1n46o8q">SYSTEM FAILURE</div> <div class="error-message svelte-1n46o8q"> </div> <div class="error-hint svelte-1n46o8q">Ensure WASM is built: <code class="svelte-1n46o8q">wasm-pack build --target web --release</code></div></div></div>'),Bl=C('<div class="mobile-header svelte-1n46o8q"><span class="mobile-title svelte-1n46o8q">FLOW_LENIA</span></div> <div class="mobile-canvas-container svelte-1n46o8q"><!></div> <!>',1),Yl=C('<!> <div class="main-content svelte-1n46o8q"><!> <!> <!></div> <!>',1),Xl=C('<div class="scanlines"></div>'),Ul=C('<div><!></div> <!> <div class="vignette"></div>',1);function ql(e,t){lt(t,!1);const s=()=>H(re,"$simulationStore",a),n=()=>H(Js,"$currentScheme",a),i=()=>H(Ae,"$mobileStore",a),r=()=>H(ut,"$settings",a),[a,o]=Nt();let l=ne(!1),c=ne(null),u=ne(),v=ne("");function d(b,A){const T=parseInt(b.slice(1,3),16),S=parseInt(b.slice(3,5),16),E=parseInt(b.slice(5,7),16);return`rgba(${T}, ${S}, ${E}, ${A})`}Ks(async()=>{Eo(),Ae.checkViewport(),window.addEventListener("resize",Ae.checkViewport),Y("SYS.BOOT","info"),Y("Loading WASM module...","info");try{await mo(),X(l,!0),Y("WASM initialized","success"),Y(`Backend: ${s().backend.toUpperCase()}`,"info"),Y(`Theme: ${n().name}`,"info"),s().gpuAvailable?Y("WebGPU available","success"):Y("WebGPU not available","warn"),Y("SYSTEM READY","success")}catch(b){X(c,String(b)),Y(`INIT FAILED: ${b}`,"error")}}),ei(()=>{window.removeEventListener("resize",Ae.checkViewport)}),Qe(()=>(s(),n()),()=>{const{width:b,height:A}=s().config,T=Math.max(1,b*A),S=s().totalMass/T,$=.15+Math.min(1,Math.max(0,S))*.45,w=n().colors;X(v,[`--color-primary-glow: ${d(w.primary,$)}`,`--color-secondary-glow: ${d(w.secondary,$)}`,`--color-tertiary-glow: ${d(w.tertiary,$)}`].join("; "))}),Ws(),Ss();var h=vn(),m=qe(h);{var y=b=>{var A=zl();M(b,A)},_=b=>{var A=vn(),T=qe(A);{var S=$=>{var w=Gl(),x=p(w),L=g(p(x),2),D=p(L);z(()=>N(D,f(c))),M($,w)},E=$=>{var w=Ul(),x=qe(w);let L;var D=p(x);{var q=P=>{var Z=Bl(),ie=g(qe(Z),2),ve=p(ie);ir(ve,{});var he=g(ie,2);Fl(he,{}),M(P,Z)},F=P=>{var Z=Yl(),ie=qe(Z);$o(ie,{});var ve=g(ie,2),he=p(ve);Wo(he,{});var _e=g(he,2);ir(_e,{});var xe=g(_e,2);wl(xe,{});var Ge=g(ve,2);Ao(Ge),M(P,Z)};te(D,P=>{i(),R(()=>i().isMobile)?P(q):P(F,!1)})}gs(x,P=>X(u,P),()=>f(u));var J=g(x,2);{var V=P=>{var Z=Xl();M(P,Z)};te(J,P=>{r(),R(()=>r().showScanlines)&&P(V)})}z(()=>{L=ee(x,1,"app-container svelte-1n46o8q",null,L,{"mobile-layout":i().isMobile}),Vs(x,f(v))}),M($,w)};te(T,$=>{f(c)?$(S):$(E,!1)},!0)}M(b,A)};te(m,b=>{!f(l)&&!f(c)?b(y):b(_,!1)})}M(e,h),ct(),o()}ja(ql,{target:document.getElementById("app")});
