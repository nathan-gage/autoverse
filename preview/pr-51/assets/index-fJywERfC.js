(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))r(a);new MutationObserver(a=>{for(const s of a)if(s.type==="childList")for(const i of s.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&r(i)}).observe(document,{childList:!0,subtree:!0});function n(a){const s={};return a.integrity&&(s.integrity=a.integrity),a.referrerPolicy&&(s.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?s.credentials="include":a.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function r(a){if(a.ep)return;a.ep=!0;const s=n(a);fetch(a.href,s)}})();const Un=!1;var ar=Array.isArray,Ws=Array.prototype.indexOf,Mn=Array.from,Rr=Object.defineProperty,It=Object.getOwnPropertyDescriptor,Lr=Object.getOwnPropertyDescriptors,Hs=Object.prototype,Vs=Array.prototype,ir=Object.getPrototypeOf,br=Object.isExtensible;const Ye=()=>{};function Js(e){return e()}function mn(e){for(var t=0;t<e.length;t++)e[t]()}function Or(){var e,t,n=new Promise((r,a)=>{e=r,t=a});return{promise:n,resolve:e,reject:t}}const re=2,or=4,Cn=8,Ks=1<<24,Je=16,Ke=32,Mt=64,kn=128,Te=512,te=1024,pe=2048,Ae=4096,be=8192,je=16384,lr=32768,wt=65536,wr=1<<17,Nr=1<<18,Nt=1<<19,Fr=1<<20,Ue=1<<25,yt=32768,Yn=1<<21,cr=1<<22,at=1<<23,Xe=Symbol("$state"),Zs=Symbol("legacy props"),Qs=Symbol(""),Pt=new class extends Error{name="StaleReactionError";message="The reaction that called `getAbortSignal()` was re-run or destroyed"};function qr(e){throw new Error("https://svelte.dev/e/lifecycle_outside_component")}function ea(){throw new Error("https://svelte.dev/e/async_derived_orphan")}function ta(e){throw new Error("https://svelte.dev/e/effect_in_teardown")}function na(){throw new Error("https://svelte.dev/e/effect_in_unowned_derived")}function ra(e){throw new Error("https://svelte.dev/e/effect_orphan")}function sa(){throw new Error("https://svelte.dev/e/effect_update_depth_exceeded")}function aa(e){throw new Error("https://svelte.dev/e/props_invalid_value")}function ia(){throw new Error("https://svelte.dev/e/state_descriptors_fixed")}function oa(){throw new Error("https://svelte.dev/e/state_prototype_fixed")}function la(){throw new Error("https://svelte.dev/e/state_unsafe_mutation")}function ca(){throw new Error("https://svelte.dev/e/svelte_boundary_reset_onerror")}const ua=1,fa=2,zr=4,da=8,va=16,ha=1,pa=2,ga=4,_a=8,ma=16,ba=1,wa=2,ie=Symbol(),ya="http://www.w3.org/1999/xhtml";function Sa(){console.warn("https://svelte.dev/e/select_multiple_invalid_value")}function xa(){console.warn("https://svelte.dev/e/svelte_boundary_reset_noop")}function Gr(e){return e===this.v}function Br(e,t){return e!=e?t==t:e!==t||e!==null&&typeof e=="object"||typeof e=="function"}function Ur(e){return!Br(e,this.v)}let Ft=!1,Ea=!1;function Ma(){Ft=!0}let W=null;function Dt(e){W=e}function lt(e,t=!1,n){W={p:W,i:!1,c:null,e:null,s:e,x:null,l:Ft&&!t?{s:null,u:null,$:[]}:null}}function ct(e){var t=W,n=t.e;if(n!==null){t.e=null;for(var r of n)as(r)}return t.i=!0,W=t.p,{}}function on(){return!Ft||W!==null&&W.l===null}let gt=[];function Yr(){var e=gt;gt=[],mn(e)}function qt(e){if(gt.length===0&&!Jt){var t=gt;queueMicrotask(()=>{t===gt&&Yr()})}gt.push(e)}function Ca(){for(;gt.length>0;)Yr()}function jr(e){var t=G;if(t===null)return L.f|=at,e;if((t.f&lr)===0){if((t.f&kn)===0)throw e;t.b.error(e)}else Rt(e,t)}function Rt(e,t){for(;t!==null;){if((t.f&kn)!==0)try{t.b.error(e);return}catch(n){e=n}t=t.parent}throw e}const dn=new Set;let F=null,Vt=null,Ee=null,Se=[],Tn=null,jn=!1,Jt=!1;class De{committed=!1;current=new Map;previous=new Map;#e=new Set;#t=new Set;#r=0;#n=0;#l=null;#a=new Set;#s=new Set;skipped_effects=new Set;is_fork=!1;is_deferred(){return this.is_fork||this.#n>0}process(t){Se=[],Vt=null,this.apply();var n={parent:null,effect:null,effects:[],render_effects:[]};for(const r of t)this.#i(r,n);this.is_fork||this.#u(),this.is_deferred()?(this.#o(n.effects),this.#o(n.render_effects)):(Vt=this,F=null,yr(n.render_effects),yr(n.effects),Vt=null,this.#l?.resolve()),Ee=null}#i(t,n){t.f^=te;for(var r=t.first;r!==null;){var a=r.f,s=(a&(Ke|Mt))!==0,i=s&&(a&te)!==0,l=i||(a&be)!==0||this.skipped_effects.has(r);if((r.f&kn)!==0&&r.b?.is_pending()&&(n={parent:n,effect:r,effects:[],render_effects:[]}),!l&&r.fn!==null){s?r.f^=te:(a&or)!==0?n.effects.push(r):zt(r)&&((r.f&Je)!==0&&this.#a.add(r),Lt(r));var o=r.first;if(o!==null){r=o;continue}}var c=r.parent;for(r=r.next;r===null&&c!==null;)c===n.effect&&(this.#o(n.effects),this.#o(n.render_effects),n=n.parent),r=c.next,c=c.parent}}#o(t){for(const n of t)(n.f&pe)!==0?this.#a.add(n):(n.f&Ae)!==0&&this.#s.add(n),this.#c(n.deps),ne(n,te)}#c(t){if(t!==null)for(const n of t)(n.f&re)===0||(n.f&yt)===0||(n.f^=yt,this.#c(n.deps))}capture(t,n){this.previous.has(t)||this.previous.set(t,n),(t.f&at)===0&&(this.current.set(t,t.v),Ee?.set(t,t.v))}activate(){F=this,this.apply()}deactivate(){F===this&&(F=null,Ee=null)}flush(){if(this.activate(),Se.length>0){if(Xr(),F!==null&&F!==this)return}else this.#r===0&&this.process([]);this.deactivate()}discard(){for(const t of this.#t)t(this);this.#t.clear()}#u(){if(this.#n===0){for(const t of this.#e)t();this.#e.clear()}this.#r===0&&this.#f()}#f(){if(dn.size>1){this.previous.clear();var t=Ee,n=!0,r={parent:null,effect:null,effects:[],render_effects:[]};for(const s of dn){if(s===this){n=!1;continue}const i=[];for(const[o,c]of this.current){if(s.current.has(o))if(n&&c!==s.current.get(o))s.current.set(o,c);else continue;i.push(o)}if(i.length===0)continue;const l=[...s.current.keys()].filter(o=>!this.current.has(o));if(l.length>0){var a=Se;Se=[];const o=new Set,c=new Map;for(const u of i)Wr(u,l,o,c);if(Se.length>0){F=s,s.apply();for(const u of Se)s.#i(u,r);s.deactivate()}Se=a}}F=null,Ee=t}this.committed=!0,dn.delete(this)}increment(t){this.#r+=1,t&&(this.#n+=1)}decrement(t){this.#r-=1,t&&(this.#n-=1),this.revive()}revive(){for(const t of this.#a)this.#s.delete(t),ne(t,pe),St(t);for(const t of this.#s)ne(t,Ae),St(t);this.flush()}oncommit(t){this.#e.add(t)}ondiscard(t){this.#t.add(t)}settled(){return(this.#l??=Or()).promise}static ensure(){if(F===null){const t=F=new De;dn.add(F),Jt||De.enqueue(()=>{F===t&&t.flush()})}return F}static enqueue(t){qt(t)}apply(){}}function ka(e){var t=Jt;Jt=!0;try{for(var n;;){if(Ca(),Se.length===0&&(F?.flush(),Se.length===0))return Tn=null,n;Xr()}}finally{Jt=t}}function Xr(){var e=mt;jn=!0;var t=null;try{var n=0;for(wn(!0);Se.length>0;){var r=De.ensure();if(n++>1e3){var a,s;Ta()}r.process(Se),it.clear()}}finally{jn=!1,wn(e),Tn=null}}function Ta(){try{sa()}catch(e){Rt(e,Tn)}}let Ge=null;function yr(e){var t=e.length;if(t!==0){for(var n=0;n<t;){var r=e[n++];if((r.f&(je|be))===0&&zt(r)&&(Ge=new Set,Lt(r),r.deps===null&&r.first===null&&r.nodes===null&&(r.teardown===null&&r.ac===null?us(r):r.fn=null),Ge?.size>0)){it.clear();for(const a of Ge){if((a.f&(je|be))!==0)continue;const s=[a];let i=a.parent;for(;i!==null;)Ge.has(i)&&(Ge.delete(i),s.push(i)),i=i.parent;for(let l=s.length-1;l>=0;l--){const o=s[l];(o.f&(je|be))===0&&Lt(o)}}Ge.clear()}}Ge=null}}function Wr(e,t,n,r){if(!n.has(e)&&(n.add(e),e.reactions!==null))for(const a of e.reactions){const s=a.f;(s&re)!==0?Wr(a,t,n,r):(s&(cr|Je))!==0&&(s&pe)===0&&Hr(a,t,r)&&(ne(a,pe),St(a))}}function Hr(e,t,n){const r=n.get(e);if(r!==void 0)return r;if(e.deps!==null)for(const a of e.deps){if(t.includes(a))return!0;if((a.f&re)!==0&&Hr(a,t,n))return n.set(a,!0),!0}return n.set(e,!1),!1}function St(e){for(var t=Tn=e;t.parent!==null;){t=t.parent;var n=t.f;if(jn&&t===G&&(n&Je)!==0&&(n&Nr)===0)return;if((n&(Mt|Ke))!==0){if((n&te)===0)return;t.f^=te}}Se.push(t)}function Aa(e){let t=0,n=xt(0),r;return()=>{en()&&(f(n),cn(()=>(t===0&&(r=P(()=>e(()=>Kt(n)))),t+=1,()=>{qt(()=>{t-=1,t===0&&(r?.(),r=void 0,Kt(n))})})))}}var Pa=wt|Nt|kn;function $a(e,t,n){new Ia(e,t,n)}class Ia{parent;#e=!1;#t;#r=null;#n;#l;#a;#s=null;#i=null;#o=null;#c=null;#u=null;#f=0;#d=0;#h=!1;#v=null;#b=Aa(()=>(this.#v=xt(this.#f),()=>{this.#v=null}));constructor(t,n,r){this.#t=t,this.#n=n,this.#l=r,this.parent=G.b,this.#e=!!this.#n.pending,this.#a=Dn(()=>{G.b=this;{var a=this.#_();try{this.#s=xe(()=>r(a))}catch(s){this.error(s)}this.#d>0?this.#g():this.#e=!1}return()=>{this.#u?.remove()}},Pa)}#w(){try{this.#s=xe(()=>this.#l(this.#t))}catch(t){this.error(t)}this.#e=!1}#y(){const t=this.#n.pending;t&&(this.#i=xe(()=>t(this.#t)),De.enqueue(()=>{var n=this.#_();this.#s=this.#p(()=>(De.ensure(),xe(()=>this.#l(n)))),this.#d>0?this.#g():(_t(this.#i,()=>{this.#i=null}),this.#e=!1)}))}#_(){var t=this.#t;return this.#e&&(this.#u=We(),this.#t.before(this.#u),t=this.#u),t}is_pending(){return this.#e||!!this.parent&&this.parent.is_pending()}has_pending_snippet(){return!!this.#n.pending}#p(t){var n=G,r=L,a=W;Le(this.#a),ve(this.#a),Dt(this.#a.ctx);try{return t()}catch(s){return jr(s),null}finally{Le(n),ve(r),Dt(a)}}#g(){const t=this.#n.pending;this.#s!==null&&(this.#c=document.createDocumentFragment(),this.#c.append(this.#u),vs(this.#s,this.#c)),this.#i===null&&(this.#i=xe(()=>t(this.#t)))}#m(t){if(!this.has_pending_snippet()){this.parent&&this.parent.#m(t);return}this.#d+=t,this.#d===0&&(this.#e=!1,this.#i&&_t(this.#i,()=>{this.#i=null}),this.#c&&(this.#t.before(this.#c),this.#c=null))}update_pending_count(t){this.#m(t),this.#f+=t,this.#v&&Et(this.#v,this.#f)}get_effect_pending(){return this.#b(),f(this.#v)}error(t){var n=this.#n.onerror;let r=this.#n.failed;if(this.#h||!n&&!r)throw t;this.#s&&(he(this.#s),this.#s=null),this.#i&&(he(this.#i),this.#i=null),this.#o&&(he(this.#o),this.#o=null);var a=!1,s=!1;const i=()=>{if(a){xa();return}a=!0,s&&ca(),De.ensure(),this.#f=0,this.#o!==null&&_t(this.#o,()=>{this.#o=null}),this.#e=this.has_pending_snippet(),this.#s=this.#p(()=>(this.#h=!1,xe(()=>this.#l(this.#t)))),this.#d>0?this.#g():this.#e=!1};var l=L;try{ve(null),s=!0,n?.(t,i),s=!1}catch(o){Rt(o,this.#a&&this.#a.parent)}finally{ve(l)}r&&qt(()=>{this.#o=this.#p(()=>{De.ensure(),this.#h=!0;try{return xe(()=>{r(this.#t,()=>t,()=>i)})}catch(o){return Rt(o,this.#a.parent),null}finally{this.#h=!1}})})}}function Da(e,t,n,r){const a=on()?An:ur;if(n.length===0&&e.length===0){r(t.map(a));return}var s=F,i=G,l=Ra();function o(){Promise.all(n.map(c=>La(c))).then(c=>{l();try{r([...t.map(a),...c])}catch(u){(i.f&je)===0&&Rt(u,i)}s?.deactivate(),bn()}).catch(c=>{Rt(c,i)})}e.length>0?Promise.all(e).then(()=>{l();try{return o()}finally{s?.deactivate(),bn()}}):o()}function Ra(){var e=G,t=L,n=W,r=F;return function(s=!0){Le(e),ve(t),Dt(n),s&&r?.activate()}}function bn(){Le(null),ve(null),Dt(null)}function An(e){var t=re|pe,n=L!==null&&(L.f&re)!==0?L:null;return G!==null&&(G.f|=Nt),{ctx:W,deps:null,effects:null,equals:Gr,f:t,fn:e,reactions:null,rv:0,v:ie,wv:0,parent:n??G,ac:null}}function La(e,t){let n=G;n===null&&ea();var r=n.b,a=void 0,s=xt(ie),i=!L,l=new Map;return ja(()=>{var o=Or();a=o.promise;try{Promise.resolve(e()).then(o.resolve,o.reject).then(()=>{c===F&&c.committed&&c.deactivate(),bn()})}catch(v){o.reject(v),bn()}var c=F;if(i){var u=!r.is_pending();r.update_pending_count(1),c.increment(u),l.get(c)?.reject(Pt),l.delete(c),l.set(c,o)}const h=(v,d=void 0)=>{if(c.activate(),d)d!==Pt&&(s.f|=at,Et(s,d));else{(s.f&at)!==0&&(s.f^=at),Et(s,v);for(const[p,y]of l){if(l.delete(p),p===c)break;y.reject(Pt)}}i&&(r.update_pending_count(-1),c.decrement(u))};o.promise.then(h,v=>h(null,v||"unknown"))}),$n(()=>{for(const o of l.values())o.reject(Pt)}),new Promise(o=>{function c(u){function h(){u===a?o(s):c(a)}u.then(h,h)}c(a)})}function ur(e){const t=An(e);return t.equals=Ur,t}function Vr(e){var t=e.effects;if(t!==null){e.effects=null;for(var n=0;n<t.length;n+=1)he(t[n])}}function Oa(e){for(var t=e.parent;t!==null;){if((t.f&re)===0)return(t.f&je)===0?t:null;t=t.parent}return null}function fr(e){var t,n=G;Le(Oa(e));try{e.f&=~yt,Vr(e),t=_s(e)}finally{Le(n)}return t}function Jr(e){var t=fr(e);if(e.equals(t)||(F?.is_fork||(e.v=t),e.wv=ps()),!Ct)if(Ee!==null)(en()||F?.is_fork)&&Ee.set(e,t);else{var n=(e.f&Te)===0?Ae:te;ne(e,n)}}let Xn=new Set;const it=new Map;let Kr=!1;function xt(e,t){var n={f:0,v:e,reactions:null,equals:Gr,rv:0,wv:0};return n}function qe(e,t){const n=xt(e);return Va(n),n}function Z(e,t=!1,n=!0){const r=xt(e);return t||(r.equals=Ur),Ft&&n&&W!==null&&W.l!==null&&(W.l.s??=[]).push(r),r}function ze(e,t){return q(e,P(()=>f(e))),t}function q(e,t,n=!1){L!==null&&(!Re||(L.f&wr)!==0)&&on()&&(L.f&(re|Je|cr|wr))!==0&&!He?.includes(e)&&la();let r=n?$t(t):t;return Et(e,r)}function Et(e,t){if(!e.equals(t)){var n=e.v;Ct?it.set(e,t):it.set(e,n),e.v=t;var r=De.ensure();r.capture(e,n),(e.f&re)!==0&&((e.f&pe)!==0&&fr(e),ne(e,(e.f&Te)!==0?te:Ae)),e.wv=ps(),Zr(e,pe),on()&&G!==null&&(G.f&te)!==0&&(G.f&(Ke|Mt))===0&&(ye===null?Ja([e]):ye.push(e)),!r.is_fork&&Xn.size>0&&!Kr&&Na()}return t}function Na(){Kr=!1;var e=mt;wn(!0);const t=Array.from(Xn);try{for(const n of t)(n.f&te)!==0&&ne(n,Ae),zt(n)&&Lt(n)}finally{wn(e)}Xn.clear()}function Kt(e){q(e,e.v+1)}function Zr(e,t){var n=e.reactions;if(n!==null)for(var r=on(),a=n.length,s=0;s<a;s++){var i=n[s],l=i.f;if(!(!r&&i===G)){var o=(l&pe)===0;if(o&&ne(i,t),(l&re)!==0){var c=i;Ee?.delete(c),(l&yt)===0&&(l&Te&&(i.f|=yt),Zr(c,Ae))}else o&&((l&Je)!==0&&Ge!==null&&Ge.add(i),St(i))}}}function $t(e){if(typeof e!="object"||e===null||Xe in e)return e;const t=ir(e);if(t!==Hs&&t!==Vs)return e;var n=new Map,r=ar(e),a=qe(0),s=bt,i=l=>{if(bt===s)return l();var o=L,c=bt;ve(null),Cr(s);var u=l();return ve(o),Cr(c),u};return r&&n.set("length",qe(e.length)),new Proxy(e,{defineProperty(l,o,c){(!("value"in c)||c.configurable===!1||c.enumerable===!1||c.writable===!1)&&ia();var u=n.get(o);return u===void 0?u=i(()=>{var h=qe(c.value);return n.set(o,h),h}):q(u,c.value,!0),!0},deleteProperty(l,o){var c=n.get(o);if(c===void 0){if(o in l){const u=i(()=>qe(ie));n.set(o,u),Kt(a)}}else q(c,ie),Kt(a);return!0},get(l,o,c){if(o===Xe)return e;var u=n.get(o),h=o in l;if(u===void 0&&(!h||It(l,o)?.writable)&&(u=i(()=>{var d=$t(h?l[o]:ie),p=qe(d);return p}),n.set(o,u)),u!==void 0){var v=f(u);return v===ie?void 0:v}return Reflect.get(l,o,c)},getOwnPropertyDescriptor(l,o){var c=Reflect.getOwnPropertyDescriptor(l,o);if(c&&"value"in c){var u=n.get(o);u&&(c.value=f(u))}else if(c===void 0){var h=n.get(o),v=h?.v;if(h!==void 0&&v!==ie)return{enumerable:!0,configurable:!0,value:v,writable:!0}}return c},has(l,o){if(o===Xe)return!0;var c=n.get(o),u=c!==void 0&&c.v!==ie||Reflect.has(l,o);if(c!==void 0||G!==null&&(!u||It(l,o)?.writable)){c===void 0&&(c=i(()=>{var v=u?$t(l[o]):ie,d=qe(v);return d}),n.set(o,c));var h=f(c);if(h===ie)return!1}return u},set(l,o,c,u){var h=n.get(o),v=o in l;if(r&&o==="length")for(var d=c;d<h.v;d+=1){var p=n.get(d+"");p!==void 0?q(p,ie):d in l&&(p=i(()=>qe(ie)),n.set(d+"",p))}if(h===void 0)(!v||It(l,o)?.writable)&&(h=i(()=>qe(void 0)),q(h,$t(c)),n.set(o,h));else{v=h.v!==ie;var y=i(()=>$t(c));q(h,y)}var _=Reflect.getOwnPropertyDescriptor(l,o);if(_?.set&&_.set.call(u,c),!v){if(r&&typeof o=="string"){var w=n.get("length"),$=Number(o);Number.isInteger($)&&$>=w.v&&q(w,$+1)}Kt(a)}return!0},ownKeys(l){f(a);var o=Reflect.ownKeys(l).filter(h=>{var v=n.get(h);return v===void 0||v.v!==ie});for(var[c,u]of n)u.v!==ie&&!(c in l)&&o.push(c);return o},setPrototypeOf(){oa()}})}function Sr(e){try{if(e!==null&&typeof e=="object"&&Xe in e)return e[Xe]}catch{}return e}function Fa(e,t){return Object.is(Sr(e),Sr(t))}var xr,Qr,es,ts;function qa(){if(xr===void 0){xr=window,Qr=/Firefox/.test(navigator.userAgent);var e=Element.prototype,t=Node.prototype,n=Text.prototype;es=It(t,"firstChild").get,ts=It(t,"nextSibling").get,br(e)&&(e.__click=void 0,e.__className=void 0,e.__attributes=null,e.__style=void 0,e.__e=void 0),br(n)&&(n.__t=void 0)}}function We(e=""){return document.createTextNode(e)}function rt(e){return es.call(e)}function ln(e){return ts.call(e)}function g(e,t){return rt(e)}function ot(e,t=!1){{var n=rt(e);return n instanceof Comment&&n.data===""?ln(n):n}}function m(e,t=1,n=!1){let r=e;for(;t--;)r=ln(r);return r}function za(e){e.textContent=""}function ns(){return!1}let Er=!1;function Ga(){Er||(Er=!0,document.addEventListener("reset",e=>{Promise.resolve().then(()=>{if(!e.defaultPrevented)for(const t of e.target.elements)t.__on_r?.()})},{capture:!0}))}function Pn(e){var t=L,n=G;ve(null),Le(null);try{return e()}finally{ve(t),Le(n)}}function rs(e,t,n,r=n){e.addEventListener(t,()=>Pn(n));const a=e.__on_r;a?e.__on_r=()=>{a(),r(!0)}:e.__on_r=()=>r(!0),Ga()}function ss(e){G===null&&(L===null&&ra(),na()),Ct&&ta()}function Ba(e,t){var n=t.last;n===null?t.last=t.first=e:(n.next=e,e.prev=n,t.last=e)}function Oe(e,t,n){var r=G;r!==null&&(r.f&be)!==0&&(e|=be);var a={ctx:W,deps:null,nodes:null,f:e|pe|Te,first:null,fn:t,last:null,next:null,parent:r,b:r&&r.b,prev:null,teardown:null,wv:0,ac:null};if(n)try{Lt(a),a.f|=lr}catch(l){throw he(a),l}else t!==null&&St(a);var s=a;if(n&&s.deps===null&&s.teardown===null&&s.nodes===null&&s.first===s.last&&(s.f&Nt)===0&&(s=s.first,(e&Je)!==0&&(e&wt)!==0&&s!==null&&(s.f|=wt)),s!==null&&(s.parent=r,r!==null&&Ba(s,r),L!==null&&(L.f&re)!==0&&(e&Mt)===0)){var i=L;(i.effects??=[]).push(s)}return a}function en(){return L!==null&&!Re}function $n(e){const t=Oe(Cn,null,!1);return ne(t,te),t.teardown=e,t}function Wn(e){ss();var t=G.f,n=!L&&(t&Ke)!==0&&(t&lr)===0;if(n){var r=W;(r.e??=[]).push(e)}else return as(e)}function as(e){return Oe(or|Fr,e,!1)}function Ua(e){return ss(),Oe(Cn|Fr,e,!0)}function Ya(e){De.ensure();const t=Oe(Mt|Nt,e,!0);return(n={})=>new Promise(r=>{n.outro?_t(t,()=>{he(t),r(void 0)}):(he(t),r(void 0))})}function is(e){return Oe(or,e,!1)}function Be(e,t){var n=W,r={effect:null,ran:!1,deps:e};n.l.$.push(r),r.effect=cn(()=>{e(),!r.ran&&(r.ran=!0,P(t))})}function In(){var e=W;cn(()=>{for(var t of e.l.$){t.deps();var n=t.effect;(n.f&te)!==0&&ne(n,Ae),zt(n)&&Lt(n),t.ran=!1}})}function ja(e){return Oe(cr|Nt,e,!0)}function cn(e,t=0){return Oe(Cn|t,e,!0)}function X(e,t=[],n=[],r=[]){Da(r,t,n,a=>{Oe(Cn,()=>e(...a.map(f)),!0)})}function Dn(e,t=0){var n=Oe(Je|t,e,!0);return n}function xe(e){return Oe(Ke|Nt,e,!0)}function os(e){var t=e.teardown;if(t!==null){const n=Ct,r=L;Mr(!0),ve(null);try{t.call(null)}finally{Mr(n),ve(r)}}}function ls(e,t=!1){var n=e.first;for(e.first=e.last=null;n!==null;){const a=n.ac;a!==null&&Pn(()=>{a.abort(Pt)});var r=n.next;(n.f&Mt)!==0?n.parent=null:he(n,t),n=r}}function Xa(e){for(var t=e.first;t!==null;){var n=t.next;(t.f&Ke)===0&&he(t),t=n}}function he(e,t=!0){var n=!1;(t||(e.f&Nr)!==0)&&e.nodes!==null&&e.nodes.end!==null&&(cs(e.nodes.start,e.nodes.end),n=!0),ls(e,t&&!n),yn(e,0),ne(e,je);var r=e.nodes&&e.nodes.t;if(r!==null)for(const s of r)s.stop();os(e);var a=e.parent;a!==null&&a.first!==null&&us(e),e.next=e.prev=e.teardown=e.ctx=e.deps=e.fn=e.nodes=e.ac=null}function cs(e,t){for(;e!==null;){var n=e===t?null:ln(e);e.remove(),e=n}}function us(e){var t=e.parent,n=e.prev,r=e.next;n!==null&&(n.next=r),r!==null&&(r.prev=n),t!==null&&(t.first===e&&(t.first=r),t.last===e&&(t.last=n))}function _t(e,t,n=!0){var r=[];fs(e,r,!0);var a=()=>{n&&he(e),t&&t()},s=r.length;if(s>0){var i=()=>--s||a();for(var l of r)l.out(i)}else a()}function fs(e,t,n){if((e.f&be)===0){e.f^=be;var r=e.nodes&&e.nodes.t;if(r!==null)for(const l of r)(l.is_global||n)&&t.push(l);for(var a=e.first;a!==null;){var s=a.next,i=(a.f&wt)!==0||(a.f&Ke)!==0&&(e.f&Je)!==0;fs(a,t,i?n:!1),a=s}}}function dr(e){ds(e,!0)}function ds(e,t){if((e.f&be)!==0){e.f^=be,(e.f&te)===0&&(ne(e,pe),St(e));for(var n=e.first;n!==null;){var r=n.next,a=(n.f&wt)!==0||(n.f&Ke)!==0;ds(n,a?t:!1),n=r}var s=e.nodes&&e.nodes.t;if(s!==null)for(const i of s)(i.is_global||t)&&i.in()}}function vs(e,t){if(e.nodes)for(var n=e.nodes.start,r=e.nodes.end;n!==null;){var a=n===r?null:ln(n);t.append(n),n=a}}let At=null;function Wa(e){var t=At;try{if(At=new Set,P(e),t!==null)for(var n of At)t.add(n);return At}finally{At=t}}function Ha(e){for(var t of Wa(e))Et(t,t.v)}let mt=!1;function wn(e){mt=e}let Ct=!1;function Mr(e){Ct=e}let L=null,Re=!1;function ve(e){L=e}let G=null;function Le(e){G=e}let He=null;function Va(e){L!==null&&(He===null?He=[e]:He.push(e))}let le=null,me=0,ye=null;function Ja(e){ye=e}let hs=1,tn=0,bt=tn;function Cr(e){bt=e}function ps(){return++hs}function zt(e){var t=e.f;if((t&pe)!==0)return!0;if(t&re&&(e.f&=~yt),(t&Ae)!==0){var n=e.deps;if(n!==null)for(var r=n.length,a=0;a<r;a++){var s=n[a];if(zt(s)&&Jr(s),s.wv>e.wv)return!0}(t&Te)!==0&&Ee===null&&ne(e,te)}return!1}function gs(e,t,n=!0){var r=e.reactions;if(r!==null&&!He?.includes(e))for(var a=0;a<r.length;a++){var s=r[a];(s.f&re)!==0?gs(s,t,!1):t===s&&(n?ne(s,pe):(s.f&te)!==0&&ne(s,Ae),St(s))}}function _s(e){var t=le,n=me,r=ye,a=L,s=He,i=W,l=Re,o=bt,c=e.f;le=null,me=0,ye=null,L=(c&(Ke|Mt))===0?e:null,He=null,Dt(e.ctx),Re=!1,bt=++tn,e.ac!==null&&(Pn(()=>{e.ac.abort(Pt)}),e.ac=null);try{e.f|=Yn;var u=e.fn,h=u(),v=e.deps;if(le!==null){var d;if(yn(e,me),v!==null&&me>0)for(v.length=me+le.length,d=0;d<le.length;d++)v[me+d]=le[d];else e.deps=v=le;if(en()&&(e.f&Te)!==0)for(d=me;d<v.length;d++)(v[d].reactions??=[]).push(e)}else v!==null&&me<v.length&&(yn(e,me),v.length=me);if(on()&&ye!==null&&!Re&&v!==null&&(e.f&(re|Ae|pe))===0)for(d=0;d<ye.length;d++)gs(ye[d],e);return a!==null&&a!==e&&(tn++,ye!==null&&(r===null?r=ye:r.push(...ye))),(e.f&at)!==0&&(e.f^=at),h}catch(p){return jr(p)}finally{e.f^=Yn,le=t,me=n,ye=r,L=a,He=s,Dt(i),Re=l,bt=o}}function Ka(e,t){let n=t.reactions;if(n!==null){var r=Ws.call(n,e);if(r!==-1){var a=n.length-1;a===0?n=t.reactions=null:(n[r]=n[a],n.pop())}}n===null&&(t.f&re)!==0&&(le===null||!le.includes(t))&&(ne(t,Ae),(t.f&Te)!==0&&(t.f^=Te,t.f&=~yt),Vr(t),yn(t,0))}function yn(e,t){var n=e.deps;if(n!==null)for(var r=t;r<n.length;r++)Ka(e,n[r])}function Lt(e){var t=e.f;if((t&je)===0){ne(e,te);var n=G,r=mt;G=e,mt=!0;try{(t&(Je|Ks))!==0?Xa(e):ls(e),os(e);var a=_s(e);e.teardown=typeof a=="function"?a:null,e.wv=hs;var s;Un&&Ea&&(e.f&pe)!==0&&e.deps}finally{mt=r,G=n}}}async function Za(){await Promise.resolve(),ka()}function f(e){var t=e.f,n=(t&re)!==0;if(At?.add(e),L!==null&&!Re){var r=G!==null&&(G.f&je)!==0;if(!r&&!He?.includes(e)){var a=L.deps;if((L.f&Yn)!==0)e.rv<tn&&(e.rv=tn,le===null&&a!==null&&a[me]===e?me++:le===null?le=[e]:le.includes(e)||le.push(e));else{(L.deps??=[]).push(e);var s=e.reactions;s===null?e.reactions=[L]:s.includes(L)||s.push(L)}}}if(Ct){if(it.has(e))return it.get(e);if(n){var i=e,l=i.v;return((i.f&te)===0&&i.reactions!==null||bs(i))&&(l=fr(i)),it.set(i,l),l}}else n&&(!Ee?.has(e)||F?.is_fork&&!en())&&(i=e,zt(i)&&Jr(i),mt&&en()&&(i.f&Te)===0&&ms(i));if(Ee?.has(e))return Ee.get(e);if((e.f&at)!==0)throw e.v;return e.v}function ms(e){if(e.deps!==null){e.f^=Te;for(const t of e.deps)(t.reactions??=[]).push(e),(t.f&re)!==0&&(t.f&Te)===0&&ms(t)}}function bs(e){if(e.v===ie)return!0;if(e.deps===null)return!1;for(const t of e.deps)if(it.has(t)||(t.f&re)!==0&&bs(t))return!0;return!1}function P(e){var t=Re;try{return Re=!0,e()}finally{Re=t}}const Qa=-7169;function ne(e,t){e.f=e.f&Qa|t}function ei(e){if(!(typeof e!="object"||!e||e instanceof EventTarget)){if(Xe in e)Hn(e);else if(!Array.isArray(e))for(let t in e){const n=e[t];typeof n=="object"&&n&&Xe in n&&Hn(n)}}}function Hn(e,t=new Set){if(typeof e=="object"&&e!==null&&!(e instanceof EventTarget)&&!t.has(e)){t.add(e),e instanceof Date&&e.getTime();for(let r in e)try{Hn(e[r],t)}catch{}const n=ir(e);if(n!==Object.prototype&&n!==Array.prototype&&n!==Map.prototype&&n!==Set.prototype&&n!==Date.prototype){const r=Lr(n);for(let a in r){const s=r[a].get;if(s)try{s.call(e)}catch{}}}}}const ti=["touchstart","touchmove"];function ni(e){return ti.includes(e)}const ws=new Set,Vn=new Set;function ri(e,t,n,r={}){function a(s){if(r.capture||Wt.call(t,s),!s.cancelBubble)return Pn(()=>n?.call(this,s))}return e.startsWith("pointer")||e.startsWith("touch")||e==="wheel"?qt(()=>{t.addEventListener(e,a,r)}):t.addEventListener(e,a,r),a}function si(e,t,n,r,a){var s={capture:r,passive:a},i=ri(e,t,n,s);(t===document.body||t===window||t===document||t instanceof HTMLMediaElement)&&$n(()=>{t.removeEventListener(e,i,s)})}function Gt(e){for(var t=0;t<e.length;t++)ws.add(e[t]);for(var n of Vn)n(e)}let kr=null;function Wt(e){var t=this,n=t.ownerDocument,r=e.type,a=e.composedPath?.()||[],s=a[0]||e.target;kr=e;var i=0,l=kr===e&&e.__root;if(l){var o=a.indexOf(l);if(o!==-1&&(t===document||t===window)){e.__root=t;return}var c=a.indexOf(t);if(c===-1)return;o<=c&&(i=o)}if(s=a[i]||e.target,s!==t){Rr(e,"currentTarget",{configurable:!0,get(){return s||n}});var u=L,h=G;ve(null),Le(null);try{for(var v,d=[];s!==null;){var p=s.assignedSlot||s.parentNode||s.host||null;try{var y=s["__"+r];y!=null&&(!s.disabled||e.target===s)&&y.call(s,e)}catch(_){v?d.push(_):v=_}if(e.cancelBubble||p===t||p===null)break;s=p}if(v){for(let _ of d)queueMicrotask(()=>{throw _});throw v}}finally{e.__root=t,delete e.currentTarget,ve(u),Le(h)}}}function ys(e){var t=document.createElement("template");return t.innerHTML=e.replaceAll("<!>","<!---->"),t.content}function nn(e,t){var n=G;n.nodes===null&&(n.nodes={start:e,end:t,a:null,t:null})}function I(e,t){var n=(t&ba)!==0,r=(t&wa)!==0,a,s=!e.startsWith("<!>");return()=>{a===void 0&&(a=ys(s?e:"<!>"+e),n||(a=rt(a)));var i=r||Qr?document.importNode(a,!0):a.cloneNode(!0);if(n){var l=rt(i),o=i.lastChild;nn(l,o)}else nn(i,i);return i}}function Sn(e=""){{var t=We(e+"");return nn(t,t),t}}function Jn(){var e=document.createDocumentFragment(),t=document.createComment(""),n=We();return e.append(t,n),nn(t,n),e}function A(e,t){e!==null&&e.before(t)}function Y(e,t){var n=t==null?"":typeof t=="object"?t+"":t;n!==(e.__t??=e.nodeValue)&&(e.__t=n,e.nodeValue=n+"")}function ai(e,t){return ii(e,t)}const kt=new Map;function ii(e,{target:t,anchor:n,props:r={},events:a,context:s,intro:i=!0}){qa();var l=new Set,o=h=>{for(var v=0;v<h.length;v++){var d=h[v];if(!l.has(d)){l.add(d);var p=ni(d);t.addEventListener(d,Wt,{passive:p});var y=kt.get(d);y===void 0?(document.addEventListener(d,Wt,{passive:p}),kt.set(d,1)):kt.set(d,y+1)}}};o(Mn(ws)),Vn.add(o);var c=void 0,u=Ya(()=>{var h=n??t.appendChild(We());return $a(h,{pending:()=>{}},v=>{if(s){lt({});var d=W;d.c=s}a&&(r.$$events=a),c=e(v,r)||{},s&&ct()}),()=>{for(var v of l){t.removeEventListener(v,Wt);var d=kt.get(v);--d===0?(document.removeEventListener(v,Wt),kt.delete(v)):kt.set(v,d)}Vn.delete(o),h!==n&&h.parentNode?.removeChild(h)}});return oi.set(c,u),c}let oi=new WeakMap;class Ss{anchor;#e=new Map;#t=new Map;#r=new Map;#n=new Set;#l=!0;constructor(t,n=!0){this.anchor=t,this.#l=n}#a=()=>{var t=F;if(this.#e.has(t)){var n=this.#e.get(t),r=this.#t.get(n);if(r)dr(r),this.#n.delete(n);else{var a=this.#r.get(n);a&&(this.#t.set(n,a.effect),this.#r.delete(n),a.fragment.lastChild.remove(),this.anchor.before(a.fragment),r=a.effect)}for(const[s,i]of this.#e){if(this.#e.delete(s),s===t)break;const l=this.#r.get(i);l&&(he(l.effect),this.#r.delete(i))}for(const[s,i]of this.#t){if(s===n||this.#n.has(s))continue;const l=()=>{if(Array.from(this.#e.values()).includes(s)){var c=document.createDocumentFragment();vs(i,c),c.append(We()),this.#r.set(s,{effect:i,fragment:c})}else he(i);this.#n.delete(s),this.#t.delete(s)};this.#l||!r?(this.#n.add(s),_t(i,l,!1)):l()}}};#s=t=>{this.#e.delete(t);const n=Array.from(this.#e.values());for(const[r,a]of this.#r)n.includes(r)||(he(a.effect),this.#r.delete(r))};ensure(t,n){var r=F,a=ns();if(n&&!this.#t.has(t)&&!this.#r.has(t))if(a){var s=document.createDocumentFragment(),i=We();s.append(i),this.#r.set(t,{effect:xe(()=>n(i)),fragment:s})}else this.#t.set(t,xe(()=>n(this.anchor)));if(this.#e.set(r,t),a){for(const[l,o]of this.#t)l===t?r.skipped_effects.delete(o):r.skipped_effects.add(o);for(const[l,o]of this.#r)l===t?r.skipped_effects.delete(o.effect):r.skipped_effects.add(o.effect);r.oncommit(this.#a),r.ondiscard(this.#s)}else this.#a()}}function Q(e,t,n=!1){var r=new Ss(e),a=n?wt:0;function s(i,l){r.ensure(i,l)}Dn(()=>{var i=!1;t((l,o=!0)=>{i=!0,s(o,l)}),i||s(!1,null)},a)}function xn(e,t){return t}function li(e,t,n){for(var r=[],a=t.length,s,i=t.length,l=0;l<a;l++){let h=t[l];_t(h,()=>{if(s){if(s.pending.delete(h),s.done.add(h),s.pending.size===0){var v=e.outrogroups;Kn(Mn(s.done)),v.delete(s),v.size===0&&(e.outrogroups=null)}}else i-=1},!1)}if(i===0){var o=r.length===0&&n!==null;if(o){var c=n,u=c.parentNode;za(u),u.append(c),e.items.clear()}Kn(t,!o)}else s={pending:new Set(t),done:new Set},(e.outrogroups??=new Set).add(s)}function Kn(e,t=!0){for(var n=0;n<e.length;n++)he(e[n],t)}var Tr;function rn(e,t,n,r,a,s=null){var i=e,l=new Map,o=(t&zr)!==0;if(o){var c=e;i=c.appendChild(We())}var u=null,h=ur(()=>{var w=n();return ar(w)?w:w==null?[]:Mn(w)}),v,d=!0;function p(){_.fallback=u,ci(_,v,i,t,r),u!==null&&(v.length===0?(u.f&Ue)===0?dr(u):(u.f^=Ue,Ht(u,null,i)):_t(u,()=>{u=null}))}var y=Dn(()=>{v=f(h);for(var w=v.length,$=new Set,E=F,S=ns(),x=0;x<w;x+=1){var M=v[x],b=r(M,x),C=d?null:l.get(b);C?(C.v&&Et(C.v,M),C.i&&Et(C.i,x),S&&E.skipped_effects.delete(C.e)):(C=ui(l,d?i:Tr??=We(),M,b,x,a,t,n),d||(C.e.f|=Ue),l.set(b,C)),$.add(b)}if(w===0&&s&&!u&&(d?u=xe(()=>s(i)):(u=xe(()=>s(Tr??=We())),u.f|=Ue)),!d)if(S){for(const[T,k]of l)$.has(T)||E.skipped_effects.add(k.e);E.oncommit(p),E.ondiscard(()=>{})}else p();f(h)}),_={effect:y,items:l,outrogroups:null,fallback:u};d=!1}function ci(e,t,n,r,a){var s=(r&da)!==0,i=t.length,l=e.items,o=e.effect.first,c,u=null,h,v=[],d=[],p,y,_,w;if(s)for(w=0;w<i;w+=1)p=t[w],y=a(p,w),_=l.get(y).e,(_.f&Ue)===0&&(_.nodes?.a?.measure(),(h??=new Set).add(_));for(w=0;w<i;w+=1){if(p=t[w],y=a(p,w),_=l.get(y).e,e.outrogroups!==null)for(const k of e.outrogroups)k.pending.delete(_),k.done.delete(_);if((_.f&Ue)!==0)if(_.f^=Ue,_===o)Ht(_,null,n);else{var $=u?u.next:o;_===e.effect.last&&(e.effect.last=_.prev),_.prev&&(_.prev.next=_.next),_.next&&(_.next.prev=_.prev),nt(e,u,_),nt(e,_,$),Ht(_,$,n),u=_,v=[],d=[],o=u.next;continue}if((_.f&be)!==0&&(dr(_),s&&(_.nodes?.a?.unfix(),(h??=new Set).delete(_))),_!==o){if(c!==void 0&&c.has(_)){if(v.length<d.length){var E=d[0],S;u=E.prev;var x=v[0],M=v[v.length-1];for(S=0;S<v.length;S+=1)Ht(v[S],E,n);for(S=0;S<d.length;S+=1)c.delete(d[S]);nt(e,x.prev,M.next),nt(e,u,x),nt(e,M,E),o=E,u=M,w-=1,v=[],d=[]}else c.delete(_),Ht(_,o,n),nt(e,_.prev,_.next),nt(e,_,u===null?e.effect.first:u.next),nt(e,u,_),u=_;continue}for(v=[],d=[];o!==null&&o!==_;)(c??=new Set).add(o),d.push(o),o=o.next;if(o===null)continue}(_.f&Ue)===0&&v.push(_),u=_,o=_.next}if(e.outrogroups!==null){for(const k of e.outrogroups)k.pending.size===0&&(Kn(Mn(k.done)),e.outrogroups?.delete(k));e.outrogroups.size===0&&(e.outrogroups=null)}if(o!==null||c!==void 0){var b=[];if(c!==void 0)for(_ of c)(_.f&be)===0&&b.push(_);for(;o!==null;)(o.f&be)===0&&o!==e.fallback&&b.push(o),o=o.next;var C=b.length;if(C>0){var T=(r&zr)!==0&&i===0?n:null;if(s){for(w=0;w<C;w+=1)b[w].nodes?.a?.measure();for(w=0;w<C;w+=1)b[w].nodes?.a?.fix()}li(e,b,T)}}s&&qt(()=>{if(h!==void 0)for(_ of h)_.nodes?.a?.apply()})}function ui(e,t,n,r,a,s,i,l){var o=(i&ua)!==0?(i&va)===0?Z(n,!1,!1):xt(n):null,c=(i&fa)!==0?xt(a):null;return{v:o,i:c,e:xe(()=>(s(t,o??n,c??a,l),()=>{e.delete(r)}))}}function Ht(e,t,n){if(e.nodes)for(var r=e.nodes.start,a=e.nodes.end,s=t&&(t.f&Ue)===0?t.nodes.start:n;r!==null;){var i=ln(r);if(s.before(r),r===a)return;r=i}}function nt(e,t,n){t===null?e.effect.first=n:t.next=n,n===null?e.effect.last=t:n.prev=t}function fi(e,t,n=!1,r=!1,a=!1){var s=e,i="";X(()=>{var l=G;if(i!==(i=t()??"")&&(l.nodes!==null&&(cs(l.nodes.start,l.nodes.end),l.nodes=null),i!=="")){var o=i+"";n?o=`<svg>${o}</svg>`:r&&(o=`<math>${o}</math>`);var c=ys(o);if((n||r)&&(c=rt(c)),nn(rt(c),c.lastChild),n||r)for(;rt(c);)s.before(rt(c));else s.before(c)}})}function di(e,t,...n){var r=new Ss(e);Dn(()=>{const a=t()??null;r.ensure(a,a&&(s=>a(s,...n)))},wt)}function xs(e){var t,n,r="";if(typeof e=="string"||typeof e=="number")r+=e;else if(typeof e=="object")if(Array.isArray(e)){var a=e.length;for(t=0;t<a;t++)e[t]&&(n=xs(e[t]))&&(r&&(r+=" "),r+=n)}else for(n in e)e[n]&&(r&&(r+=" "),r+=n);return r}function vi(){for(var e,t,n=0,r="",a=arguments.length;n<a;n++)(e=arguments[n])&&(t=xs(e))&&(r&&(r+=" "),r+=t);return r}function hi(e){return typeof e=="object"?vi(e):e??""}const Ar=[...` 	
\r\f \v\uFEFF`];function pi(e,t,n){var r=e==null?"":""+e;if(t&&(r=r?r+" "+t:t),n){for(var a in n)if(n[a])r=r?r+" "+a:a;else if(r.length)for(var s=a.length,i=0;(i=r.indexOf(a,i))>=0;){var l=i+s;(i===0||Ar.includes(r[i-1]))&&(l===r.length||Ar.includes(r[l]))?r=(i===0?"":r.substring(0,i))+r.substring(l+1):i=l}}return r===""?null:r}function gi(e,t){return e==null?null:String(e)}function we(e,t,n,r,a,s){var i=e.__className;if(i!==n||i===void 0){var l=pi(n,r,s);l==null?e.removeAttribute("class"):e.className=l,e.__className=n}else if(s&&a!==s)for(var o in s){var c=!!s[o];(a==null||c!==!!a[o])&&e.classList.toggle(o,c)}return s}function Es(e,t,n,r){var a=e.__style;if(a!==t){var s=gi(t);s==null?e.removeAttribute("style"):e.style.cssText=s,e.__style=t}return r}function Ms(e,t,n=!1){if(e.multiple){if(t==null)return;if(!ar(t))return Sa();for(var r of e.options)r.selected=t.includes(Zt(r));return}for(r of e.options){var a=Zt(r);if(Fa(a,t)){r.selected=!0;return}}(!n||t!==void 0)&&(e.selectedIndex=-1)}function _i(e){var t=new MutationObserver(()=>{Ms(e,e.__value)});t.observe(e,{childList:!0,subtree:!0,attributes:!0,attributeFilter:["value"]}),$n(()=>{t.disconnect()})}function mi(e,t,n=t){var r=new WeakSet,a=!0;rs(e,"change",s=>{var i=s?"[selected]":":checked",l;if(e.multiple)l=[].map.call(e.querySelectorAll(i),Zt);else{var o=e.querySelector(i)??e.querySelector("option:not([disabled])");l=o&&Zt(o)}n(l),F!==null&&r.add(F)}),is(()=>{var s=t();if(e===document.activeElement){var i=Vt??F;if(r.has(i))return}if(Ms(e,s,a),a&&s===void 0){var l=e.querySelector(":checked");l!==null&&(s=Zt(l),n(s))}e.__value=s,a=!1}),_i(e)}function Zt(e){return"__value"in e?e.__value:e.value}const bi=Symbol("is custom element"),wi=Symbol("is html");function yi(e,t){var n=Cs(e);n.value===(n.value=t??void 0)||e.value===t&&(t!==0||e.nodeName!=="PROGRESS")||(e.value=t??"")}function Ve(e,t,n,r){var a=Cs(e);a[t]!==(a[t]=n)&&(t==="loading"&&(e[Qs]=n),n==null?e.removeAttribute(t):typeof n!="string"&&Si(e).includes(t)?e[t]=n:e.setAttribute(t,n))}function Cs(e){return e.__attributes??={[bi]:e.nodeName.includes("-"),[wi]:e.namespaceURI===ya}}var Pr=new Map;function Si(e){var t=e.getAttribute("is")||e.nodeName,n=Pr.get(t);if(n)return n;Pr.set(t,n=[]);for(var r,a=e,s=Element.prototype;s!==a;){r=Lr(a);for(var i in r)r[i].set&&n.push(i);a=ir(a)}return n}function vn(e,t,n=t){var r=new WeakSet;rs(e,"input",async a=>{var s=a?e.defaultValue:e.value;if(s=zn(e)?Gn(s):s,n(s),F!==null&&r.add(F),await Za(),s!==(s=t())){var i=e.selectionStart,l=e.selectionEnd,o=e.value.length;if(e.value=s??"",l!==null){var c=e.value.length;i===l&&l===o&&c>o?(e.selectionStart=c,e.selectionEnd=c):(e.selectionStart=i,e.selectionEnd=Math.min(l,c))}}}),P(t)==null&&e.value&&(n(zn(e)?Gn(e.value):e.value),F!==null&&r.add(F)),cn(()=>{var a=t();if(e===document.activeElement){var s=Vt??F;if(r.has(s))return}zn(e)&&a===Gn(e.value)||e.type==="date"&&!a&&!e.value||a!==e.value&&(e.value=a??"")})}function zn(e){var t=e.type;return t==="number"||t==="range"}function Gn(e){return e===""?null:+e}function $r(e,t){return e===t||e?.[Xe]===t}function sn(e={},t,n,r){return is(()=>{var a,s;return cn(()=>{a=s,s=[],P(()=>{e!==n(...s)&&(t(e,...s),a&&$r(n(...a),e)&&t(null,...a))})}),()=>{qt(()=>{s&&$r(n(...s),e)&&t(null,...s)})}}),e}function un(e=!1){const t=W,n=t.l.u;if(!n)return;let r=()=>ei(t.s);if(e){let a=0,s={};const i=An(()=>{let l=!1;const o=t.s;for(const c in o)o[c]!==s[c]&&(s[c]=o[c],l=!0);return l&&a++,a});r=()=>f(i)}n.b.length&&Ua(()=>{Ir(t,r),mn(n.b)}),Wn(()=>{const a=P(()=>n.m.map(Js));return()=>{for(const s of a)typeof s=="function"&&s()}}),n.a.length&&Wn(()=>{Ir(t,r),mn(n.a)})}function Ir(e,t){if(e.l.s)for(const n of e.l.s)f(n);t()}function vr(e,t,n){if(e==null)return t(void 0),n&&n(void 0),Ye;const r=P(()=>e.subscribe(t,n));return r.unsubscribe?()=>r.unsubscribe():r}const Tt=[];function xi(e,t){return{subscribe:Ne(e,t).subscribe}}function Ne(e,t=Ye){let n=null;const r=new Set;function a(l){if(Br(e,l)&&(e=l,n)){const o=!Tt.length;for(const c of r)c[1](),Tt.push(c,e);if(o){for(let c=0;c<Tt.length;c+=2)Tt[c][0](Tt[c+1]);Tt.length=0}}}function s(l){a(l(e))}function i(l,o=Ye){const c=[l,o];return r.add(c),r.size===1&&(n=t(a,s)||Ye),l(e),()=>{r.delete(c),r.size===0&&n&&(n(),n=null)}}return{set:a,update:s,subscribe:i}}function Bt(e,t,n){const r=!Array.isArray(e),a=r?[e]:e;if(!a.every(Boolean))throw new Error("derived() expects stores as input, got a falsy value");const s=t.length<2;return xi(n,(i,l)=>{let o=!1;const c=[];let u=0,h=Ye;const v=()=>{if(u)return;h();const p=t(r?c[0]:c,i,l);s?i(p):h=typeof p=="function"?p:Ye},d=a.map((p,y)=>vr(p,_=>{c[y]=_,u&=~(1<<y),o&&v()},()=>{u|=1<<y}));return o=!0,v(),function(){mn(d),h(),o=!1}})}function Ze(e){let t;return vr(e,n=>t=n)(),t}let hn=!1,Zn=Symbol();function V(e,t,n){const r=n[t]??={store:null,source:Z(void 0),unsubscribe:Ye};if(r.store!==e&&!(Zn in n))if(r.unsubscribe(),r.store=e??null,e==null)r.source.v=void 0,r.unsubscribe=Ye;else{var a=!0;r.unsubscribe=vr(e,s=>{a?r.source.v=s:q(r.source,s)}),a=!1}return e&&Zn in n?Ze(e):f(r.source)}function Ut(){const e={};function t(){$n(()=>{for(var n in e)e[n].unsubscribe();Rr(e,Zn,{enumerable:!1,value:!0})})}return[e,t]}function Ei(e){var t=hn;try{return hn=!1,[e(),hn]}finally{hn=t}}function Ie(e,t,n,r){var a=!Ft||(n&pa)!==0,s=(n&_a)!==0,i=(n&ma)!==0,l=r,o=!0,c=()=>(o&&(o=!1,l=i?P(r):r),l),u;if(s){var h=Xe in e||Zs in e;u=It(e,t)?.set??(h&&t in e?E=>e[t]=E:void 0)}var v,d=!1;s?[v,d]=Ei(()=>e[t]):v=e[t],v===void 0&&r!==void 0&&(v=c(),u&&(a&&aa(),u(v)));var p;if(a?p=()=>{var E=e[t];return E===void 0?c():(o=!0,E)}:p=()=>{var E=e[t];return E!==void 0&&(l=void 0),E===void 0?l:E},a&&(n&ga)===0)return p;if(u){var y=e.$$legacy;return(function(E,S){return arguments.length>0?((!a||!S||y||d)&&u(S?p():E),E):p()})}var _=!1,w=((n&ha)!==0?An:ur)(()=>(_=!1,p()));s&&f(w);var $=G;return(function(E,S){if(arguments.length>0){const x=S?f(w):a&&s?$t(E):E;return q(w,x),_=!0,l!==void 0&&(l=x),E}return Ct&&_||($.f&je)!==0?w.v:f(w)})}function Rn(e){W===null&&qr(),Ft&&W.l!==null?Mi(W).m.push(e):Wn(()=>{const t=P(e);if(typeof t=="function")return t})}function ks(e){W===null&&qr(),Rn(()=>()=>P(e))}function Mi(e){var t=e.l;return t.u??={a:[],b:[],m:[]}}const Ci="5";typeof window<"u"&&((window.__svelte??={}).v??=new Set).add(Ci);Ma();class ki{propagator=null;config;currentSeed;isInitialized=!1;wasmModule=null;currentBackend="cpu";gpuAvailable=!1;constructor(t,n){this.config=t,this.currentSeed=n}async initialize(t="cpu"){try{const r="/autoverse/preview/pr-51/pkg/flow_lenia.js";this.wasmModule=await import(r),await this.wasmModule.default(),this.gpuAvailable=await this.checkWebGPU();const a=t==="gpu"&&this.gpuAvailable?"gpu":"cpu";await this.createPropagator(a),this.isInitialized=!0}catch(n){throw new Error(`Failed to initialize WASM: ${n}`)}}async checkWebGPU(){if(typeof navigator>"u"||!("gpu"in navigator))return!1;try{return await navigator.gpu.requestAdapter()!==null}catch{return!1}}async createPropagator(t){if(!this.wasmModule)throw new Error("WASM module not loaded");const n=JSON.stringify(this.config),r=JSON.stringify(this.currentSeed);t==="gpu"&&this.gpuAvailable?(this.propagator=await new this.wasmModule.WasmGpuPropagator(n,r),this.currentBackend="gpu"):(this.propagator=new this.wasmModule.WasmPropagator(n,r),this.currentBackend="cpu")}async switchBackend(t){if(!this.isInitialized)throw new Error("Simulation not initialized");return t==="gpu"&&!this.gpuAvailable?!1:(t===this.currentBackend||await this.createPropagator(t),!0)}isGpuAvailable(){return this.gpuAvailable}getBackend(){return this.currentBackend}async step(){this.ensureInitialized(),this.currentBackend==="gpu"?await this.propagator.step():this.propagator.step()}async run(t){this.ensureInitialized(),this.currentBackend==="gpu"?await this.propagator.run(BigInt(t)):this.propagator.run(BigInt(t))}getState(){return this.ensureInitialized(),this.propagator.getState()}reset(t){this.ensureInitialized(),t&&(this.currentSeed=t),this.propagator.reset(JSON.stringify(this.currentSeed))}totalMass(){return this.ensureInitialized(),this.propagator.totalMass()}getTime(){return this.ensureInitialized(),this.propagator.getTime()}getStep(){return this.ensureInitialized(),this.propagator.getStep()}getWidth(){return this.config.width}getHeight(){return this.config.height}getConfig(){return{...this.config}}extractRegion(t,n,r,a){this.ensureInitialized();const s=this.getState(),i=[];for(let l=0;l<s.channels.length;l++){const o=[];for(let c=0;c<a;c++)for(let u=0;u<r;u++){const h=(t+u)%s.width,d=(n+c)%s.height*s.width+h;o.push(s.channels[l][d])}i.push(o)}return{width:r,height:a,channels:i,sourceX:t,sourceY:n}}placeRegion(t,n,r){this.ensureInitialized();const a=this.getState(),s=new Map;for(let o=0;o<a.channels.length;o++)for(let c=0;c<a.height;c++)for(let u=0;u<a.width;u++){const h=c*a.width+u,v=a.channels[o][h];v>.001&&s.set(`${u},${c},${o}`,v)}for(let o=0;o<t.channels.length;o++)for(let c=0;c<t.height;c++)for(let u=0;u<t.width;u++){const h=(n+u)%this.config.width,v=(r+c)%this.config.height,d=c*t.width+u,p=t.channels[o][d];p>.001&&s.set(`${h},${v},${o}`,p)}const i=[];for(const[o,c]of s){const[u,h,v]=o.split(",").map(Number);i.push([u,h,v,c])}const l={pattern:{type:"Custom",values:i}};this.reset(l)}drawAt(t,n,r,a,s=0){this.ensureInitialized();const i=this.getState(),l=[];for(let c=0;c<i.channels.length;c++)for(let u=0;u<i.height;u++)for(let h=0;h<i.width;h++){const v=u*i.width+h;let d=i.channels[c][v];if(c===s){const p=h-t,y=u-n,_=Math.sqrt(p*p+y*y);if(_<=r){const w=1-_/r;d=Math.min(1,d+a*w*w)}}d>.001&&l.push([h,u,c,d])}const o={pattern:{type:"Custom",values:l}};this.reset(o)}eraseAt(t,n,r,a=0){this.ensureInitialized();const s=this.getState(),i=[];for(let o=0;o<s.channels.length;o++)for(let c=0;c<s.height;c++)for(let u=0;u<s.width;u++){const h=c*s.width+u;let v=s.channels[o][h];if(o===a){const d=u-t,p=c-n,y=Math.sqrt(d*d+p*p);if(y<=r){const _=1-y/r;v=Math.max(0,v*(1-_*_))}}v>.001&&i.push([u,c,o,v])}const l={pattern:{type:"Custom",values:i}};this.reset(l)}ensureInitialized(){if(!this.isInitialized||!this.propagator)throw new Error("Simulation not initialized. Call initialize() first.")}}const Qn={width:128,height:128,channels:1,dt:.1,kernel_radius:13,kernels:[{radius:1,rings:[{amplitude:1,distance:.5,width:.15}],weight:1,mu:.15,sigma:.015,source_channel:0,target_channel:0}],flow:{beta_a:1,n:2,distribution_size:1}},Ti={pattern:{type:"GaussianBlob",center:[.5,.5],radius:.1,amplitude:1,channel:0}},Ai={initialized:!1,playing:!1,step:0,time:0,totalMass:0,fps:0,frameTime:0,backend:"cpu",gpuAvailable:!1,config:Qn,state:null},se=Ne(Ai),Ts=Ne([]);function B(e,t="info"){Ts.update(n=>[...n.slice(-100),{message:e,level:t,timestamp:Date.now()}])}let H=null,pn=null,Qt=0,gn=0,er=0,As=1;function tr(){return H}function Pi(e){As=Math.max(1,Math.min(10,e))}async function $i(){H=new ki(Qn,Ti),await H.initialize();const e=H.getState();se.update(t=>({...t,initialized:!0,step:H.getStep(),time:H.getTime(),totalMass:H.totalMass(),backend:H.getBackend(),gpuAvailable:H.isGpuAvailable(),config:Qn,state:e}))}function Ps(){!H||Ze(se).playing||(se.update(t=>({...t,playing:!0})),Qt=performance.now(),er=Qt,gn=0,Is(Qt),B("Simulation started","info"))}function hr(){se.update(e=>({...e,playing:!1})),pn!==null&&(cancelAnimationFrame(pn),pn=null),B("Simulation paused","info")}async function $s(){H&&(await H.step(),pr())}function Ln(e){H&&(H.reset(e),pr(),B("Simulation reset","info"))}async function Ii(e){if(!H)return!1;const t=await H.switchBackend(e);return t?(se.update(n=>({...n,backend:e})),B(`Switched to ${e.toUpperCase()} backend`,"success")):B(`Failed to switch to ${e} backend`,"error"),t}async function Is(e){if(!Ze(se).playing||!H)return;const n=e-Qt;Qt=e,await H.run(As),pr(),gn++,e-er>=1e3&&(se.update(r=>({...r,fps:gn,frameTime:n})),gn=0,er=e),pn=requestAnimationFrame(r=>Is(r))}function pr(){if(!H)return;const e=H.getState();se.update(t=>({...t,step:H.getStep(),time:H.getTime(),totalMass:H.totalMass(),state:e}))}const Ds=Bt(se,e=>e.time.toFixed(2)),Rs=Bt(se,e=>e.totalMass.toLocaleString(void 0,{maximumFractionDigits:0})),Ls=Bt(se,e=>e.step.toString().padStart(8,"0")),Di={mode:"view",brushSize:5,brushIntensity:.8,colorScheme:"theme",visualizationMode:"mass",showGrid:!1,showScanlines:!0,showSelection:!0,zoom:1,panX:0,panY:0,showPanels:!0},ut=Ne(Di);function Ri(e){ut.update(t=>({...t,mode:e}))}function Li(e){ut.update(t=>({...t,brushSize:Math.max(1,Math.min(50,e))}))}function Oi(e){ut.update(t=>({...t,brushIntensity:Math.max(0,Math.min(1,e))}))}function Os(){ut.update(e=>({...e,showPanels:!e.showPanels}))}const an=[{id:"void",name:"VOID",colors:{primary:"#a855f7",primaryDim:"#6b21a8",primaryGlow:"rgba(168, 85, 247, 0.4)",secondary:"#3b82f6",secondaryDim:"#1e40af",secondaryGlow:"rgba(59, 130, 246, 0.4)",tertiary:"#ec4899",tertiaryDim:"#9d174d",tertiaryGlow:"rgba(236, 72, 153, 0.4)",success:"#a855f7",warning:"#f59e0b",danger:"#ef4444"}},{id:"neon-tokyo",name:"NEON TOKYO",colors:{primary:"#ff2d95",primaryDim:"#9d1a5a",primaryGlow:"rgba(255, 45, 149, 0.4)",secondary:"#00f0ff",secondaryDim:"#0891b2",secondaryGlow:"rgba(0, 240, 255, 0.4)",tertiary:"#ffee00",tertiaryDim:"#a38a00",tertiaryGlow:"rgba(255, 238, 0, 0.4)",success:"#00f0ff",warning:"#ffee00",danger:"#ff2d95"}},{id:"synthwave",name:"SYNTHWAVE",colors:{primary:"#f472b6",primaryDim:"#a21caf",primaryGlow:"rgba(244, 114, 182, 0.4)",secondary:"#818cf8",secondaryDim:"#4338ca",secondaryGlow:"rgba(129, 140, 248, 0.4)",tertiary:"#22d3ee",tertiaryDim:"#0e7490",tertiaryGlow:"rgba(34, 211, 238, 0.4)",success:"#22d3ee",warning:"#fbbf24",danger:"#f43f5e"}},{id:"bloodmoon",name:"BLOODMOON",colors:{primary:"#dc2626",primaryDim:"#7f1d1d",primaryGlow:"rgba(220, 38, 38, 0.4)",secondary:"#f97316",secondaryDim:"#9a3412",secondaryGlow:"rgba(249, 115, 22, 0.4)",tertiary:"#fbbf24",tertiaryDim:"#92400e",tertiaryGlow:"rgba(251, 191, 36, 0.4)",success:"#f97316",warning:"#fbbf24",danger:"#dc2626"}},{id:"toxic",name:"TOXIC",colors:{primary:"#84cc16",primaryDim:"#3f6212",primaryGlow:"rgba(132, 204, 22, 0.5)",secondary:"#facc15",secondaryDim:"#854d0e",secondaryGlow:"rgba(250, 204, 21, 0.4)",tertiary:"#22c55e",tertiaryDim:"#166534",tertiaryGlow:"rgba(34, 197, 94, 0.4)",success:"#22c55e",warning:"#facc15",danger:"#ef4444"}},{id:"ice",name:"ICE",colors:{primary:"#38bdf8",primaryDim:"#0369a1",primaryGlow:"rgba(56, 189, 248, 0.4)",secondary:"#e0f2fe",secondaryDim:"#7dd3fc",secondaryGlow:"rgba(224, 242, 254, 0.3)",tertiary:"#a5b4fc",tertiaryDim:"#4f46e5",tertiaryGlow:"rgba(165, 180, 252, 0.4)",success:"#38bdf8",warning:"#fcd34d",danger:"#f87171"}},{id:"hacker",name:"HACKER",colors:{primary:"#22c55e",primaryDim:"#166534",primaryGlow:"rgba(34, 197, 94, 0.5)",secondary:"#4ade80",secondaryDim:"#15803d",secondaryGlow:"rgba(74, 222, 128, 0.4)",tertiary:"#86efac",tertiaryDim:"#22c55e",tertiaryGlow:"rgba(134, 239, 172, 0.3)",success:"#22c55e",warning:"#fbbf24",danger:"#ef4444"}},{id:"phosphor",name:"PHOSPHOR",colors:{primary:"#fef08a",primaryDim:"#a16207",primaryGlow:"rgba(254, 240, 138, 0.5)",secondary:"#fde047",secondaryDim:"#854d0e",secondaryGlow:"rgba(253, 224, 71, 0.4)",tertiary:"#fbbf24",tertiaryDim:"#92400e",tertiaryGlow:"rgba(251, 191, 36, 0.4)",success:"#a3e635",warning:"#fbbf24",danger:"#f87171"}}],On=Ne(an[0]);function nr(e){const t=document.documentElement,{colors:n}=e;t.style.setProperty("--color-primary",n.primary),t.style.setProperty("--color-primary-dim",n.primaryDim),t.style.setProperty("--color-primary-glow",n.primaryGlow),t.style.setProperty("--color-secondary",n.secondary),t.style.setProperty("--color-secondary-dim",n.secondaryDim),t.style.setProperty("--color-secondary-glow",n.secondaryGlow),t.style.setProperty("--color-tertiary",n.tertiary),t.style.setProperty("--color-tertiary-dim",n.tertiaryDim),t.style.setProperty("--color-tertiary-glow",n.tertiaryGlow),t.style.setProperty("--color-success",n.success),t.style.setProperty("--color-warning",n.warning),t.style.setProperty("--color-danger",n.danger),On.set(e),localStorage.setItem("autoverse-theme",e.id)}function Ni(e){const t=an.find(n=>n.id===e);t&&nr(t)}function Fi(){const e=localStorage.getItem("autoverse-theme");if(e){const t=an.find(n=>n.id===e);if(t){nr(t);return}}nr(an[0])}const rr=Ne(null),Ns=Ne(0);function qi(){Ns.update(e=>e+1)}function zi(e,t){const n=Ze(rr);n&&n.startDragFromLibrary(e,t)}const sr=Ne(null);var Gi=I("<button></button>"),Bi=I('<header class="header svelte-4b3o1e"><div class="header-left svelte-4b3o1e"><pre class="ascii-logo svelte-4b3o1e"></pre></div> <div class="header-right svelte-4b3o1e"><div class="panel-toggle svelte-4b3o1e"><span class="toggle-label svelte-4b3o1e">PANELS</span> <button class="toggle-btn svelte-4b3o1e"><!></button></div> <div class="theme-picker svelte-4b3o1e"><span class="picker-label svelte-4b3o1e">THEME</span> <div class="theme-swatches svelte-4b3o1e"></div></div> <div><span class="backend-label svelte-4b3o1e">COMPUTE</span> <span class="backend-value svelte-4b3o1e"> </span></div></div></header>');function Ui(e,t){lt(t,!1);const n=()=>V(ut,"$settings",s),r=()=>V(On,"$currentScheme",s),a=()=>V(se,"$simulationStore",s),[s,i]=Ut();un();var l=Bi(),o=g(l),c=g(o);c.textContent=`
 ▄▀▄ █ █ ▀█▀ ▄▀▄ █ █ █▀▀ █▀▄ ▄▀▀ █▀▀
 █▀█ █▄█  █  █ █ ▀▄▀ ██▄ █▀▄ ▄██ ██▄`;var u=m(o,2),h=g(u),v=m(g(h),2);v.__click=function(...M){Os?.apply(this,M)};var d=g(v);{var p=M=>{var b=Sn("HIDE");A(M,b)},y=M=>{var b=Sn("SHOW");A(M,b)};Q(d,M=>{n().showPanels?M(p):M(y,!1)})}var _=m(h,2),w=m(g(_),2);rn(w,5,()=>an,xn,(M,b)=>{var C=Gi();let T;C.__click=()=>Ni(f(b).id),X(()=>{T=we(C,1,"swatch svelte-4b3o1e",null,T,{active:r().id===f(b).id}),Es(C,`--swatch-color: ${f(b).colors.primary??""}`),Ve(C,"title",f(b).name)}),A(M,C)});var $=m(_,2);let E;var S=m(g($),2),x=g(S);X(M=>{E=we($,1,"backend-indicator svelte-4b3o1e",null,E,{gpu:a().backend==="gpu"}),Y(x,M)},[()=>a().backend.toUpperCase()]),A(e,l),ct(),i()}Gt(["click"]);var Yi=I('<footer class="footer svelte-ww03jg"></footer>');function ji(e){var t=Yi();A(e,t)}var Xi=I("<div> </div>"),Wi=I('<div><div class="corner top-left svelte-1gtc57s"></div> <div class="corner top-right svelte-1gtc57s"></div> <div class="corner bottom-left svelte-1gtc57s"></div> <div class="corner bottom-right svelte-1gtc57s"></div> <!> <div><!></div></div>');function st(e,t){let n=Ie(t,"borderColor",3,"primary"),r=Ie(t,"noPadding",3,!1),a=Ie(t,"class",3,"");const s={primary:"border-primary",secondary:"border-secondary",tertiary:"border-tertiary"};var i=Wi(),l=m(g(i),8);{var o=v=>{var d=Xi(),p=g(d);X(()=>{we(d,1,`title ${s[n()]??""}`,"svelte-1gtc57s"),Y(p,t.title)}),A(v,d)};Q(l,v=>{t.title&&v(o)})}var c=m(l,2);let u;var h=g(c);di(h,()=>t.children??Ye),X(()=>{we(i,1,`tui-box ${s[n()]??""} ${a()??""}`,"svelte-1gtc57s"),u=we(c,1,"content svelte-1gtc57s",null,u,{"no-padding":r()})}),A(e,i)}var Hi=I('<span class="label svelte-1l5vt72"> </span>'),Vi=I("<span> </span>"),Ji=I('<div class="slider-header svelte-1l5vt72"><!> <!></div>'),Ki=I('<div class="slider-container svelte-1l5vt72"><!> <input type="range"/></div>');function Bn(e,t){lt(t,!0);let n=Ie(t,"value",15),r=Ie(t,"min",3,0),a=Ie(t,"max",3,100),s=Ie(t,"step",3,1),i=Ie(t,"showValue",3,!0),l=Ie(t,"valueFormat",3,p=>String(p)),o=Ie(t,"color",3,"tertiary");function c(p){const y=p.target;n(parseFloat(y.value)),t.onchange?.(n())}var u=Ki(),h=g(u);{var v=p=>{var y=Ji(),_=g(y);{var w=S=>{var x=Hi(),M=g(x);X(()=>Y(M,t.label)),A(S,x)};Q(_,S=>{t.label&&S(w)})}var $=m(_,2);{var E=S=>{var x=Vi(),M=g(x);X(b=>{we(x,1,`value ${o()??""}`,"svelte-1l5vt72"),Y(M,b)},[()=>l()(n())]),A(S,x)};Q($,S=>{i()&&S(E)})}A(p,y)};Q(h,p=>{(t.label||i())&&p(v)})}var d=m(h,2);d.__input=c,X(()=>{we(d,1,hi(o()),"svelte-1l5vt72"),Ve(d,"min",r()),Ve(d,"max",a()),Ve(d,"step",s()),yi(d,n())}),A(e,u),ct()}Gt(["input"]);var Zi=I('<span class="icon svelte-oaxjxu">&#9724;</span> <span class="label svelte-oaxjxu">PAUSE</span>',1),Qi=I('<span class="icon svelte-oaxjxu">&#9654;</span> <span class="label svelte-oaxjxu">PLAY</span>',1),eo=I('<div class="control-grid svelte-oaxjxu"><button><!></button> <button class="control-btn svelte-oaxjxu"><span class="icon svelte-oaxjxu">&#9655;</span> <span class="label svelte-oaxjxu">STEP</span></button> <button class="control-btn svelte-oaxjxu"><span class="icon svelte-oaxjxu">&#8634;</span> <span class="label svelte-oaxjxu">RESET</span></button></div> <div class="speed-control svelte-oaxjxu"><!></div>',1),to=I('<button><span class="icon svelte-oaxjxu"><!></span> <span class="label svelte-oaxjxu"> </span></button>'),no=I('<div class="brush-settings svelte-oaxjxu"><!> <!></div>'),ro=I('<div class="tool-grid svelte-oaxjxu"></div> <!>',1),so=I('<div><span class="log-prefix svelte-oaxjxu">&gt;</span> <span class="log-message svelte-oaxjxu"> </span></div>'),ao=I('<div class="log-container svelte-oaxjxu"></div>'),io=I('<aside class="left-sidebar svelte-oaxjxu"><!> <!> <!></aside>');function oo(e,t){lt(t,!0);const n=()=>V(se,"$simulationStore",s),r=()=>V(ut,"$settings",s),a=()=>V(Ts,"$systemLog",s),[s,i]=Ut();let l=qe(1);function o(y){q(l,y,!0),Pi(y)}function c(y){Ri(y)}const u=[{id:"view",label:"VIEW",icon:"&#9673;"},{id:"select",label:"SEL",icon:"&#9633;"},{id:"draw",label:"DRAW",icon:"&#9998;"},{id:"erase",label:"ERASE",icon:"&#9747;"}];var h=io(),v=g(h);st(v,{title:"SYS.CONTROL",borderColor:"primary",children:(y,_)=>{var w=eo(),$=ot(w),E=g($);let S;E.__click=()=>n().playing?hr():Ps();var x=g(E);{var M=D=>{var U=Zi();A(D,U)},b=D=>{var U=Qi();A(D,U)};Q(x,D=>{n().playing?D(M):D(b,!1)})}var C=m(E,2);C.__click=()=>$s();var T=m(C,2);T.__click=()=>Ln();var k=m($,2),O=g(k);Bn(O,{label:"SIM SPEED",min:1,max:10,step:1,color:"primary",valueFormat:D=>`${D}X`,onchange:o,get value(){return f(l)},set value(D){q(l,D,!0)}}),X(()=>S=we(E,1,"control-btn svelte-oaxjxu",null,S,{active:!n().playing})),A(y,w)},$$slots:{default:!0}});var d=m(v,2);st(d,{title:"TOOL.KIT",borderColor:"tertiary",children:(y,_)=>{var w=ro(),$=ot(w);rn($,21,()=>u,xn,(x,M)=>{var b=to();let C;b.__click=()=>c(f(M).id);var T=g(b),k=g(T);fi(k,()=>f(M).icon);var O=m(T,2),D=g(O);X(()=>{C=we(b,1,"tool-btn svelte-oaxjxu",null,C,{active:r().mode===f(M).id}),Y(D,f(M).label)}),A(x,b)});var E=m($,2);{var S=x=>{var M=no(),b=g(M);Bn(b,{label:"BRUSH SIZE",get value(){return r().brushSize},min:1,max:30,step:1,color:"tertiary",valueFormat:k=>`${k}PX`,get onchange(){return Li}});var C=m(b,2);{var T=k=>{Bn(k,{label:"INTENSITY",get value(){return r().brushIntensity},min:0,max:1,step:.05,color:"tertiary",valueFormat:O=>`${Math.round(O*100)}%`,get onchange(){return Oi}})};Q(C,k=>{r().mode==="draw"&&k(T)})}A(x,M)};Q(E,x=>{(r().mode==="draw"||r().mode==="erase")&&x(S)})}A(y,w)},$$slots:{default:!0}});var p=m(d,2);st(p,{title:"DEBUG.LOG",borderColor:"secondary",class:"debug-log-box",children:(y,_)=>{var w=ao();rn(w,5,a,xn,($,E)=>{var S=so(),x=m(g(S),2),M=g(x);X(()=>{we(S,1,`log-entry ${f(E).level??""}`,"svelte-oaxjxu"),Y(M,f(E).message)}),A($,S)}),A(y,w)},$$slots:{default:!0}}),A(e,h),ct(),i()}Gt(["click"]);const lo={initialized:!1,running:!1,progress:null,result:null,bestState:null,error:null},ce=Ne(lo);Bt(ce,e=>e.running);Bt(ce,e=>e.progress);Bt(ce,e=>e.bestState);let En=null,ke=null,_n=null;async function co(){try{En=await import("/autoverse/preview/pr-51/pkg/flow_lenia.js"),await En.default(),ce.update(n=>({...n,initialized:!0})),B("Evolution engine initialized","success")}catch(e){throw B(`Failed to initialize evolution: ${e}`,"error"),e}}function uo(){return{base_config:Ze(se).config,seed_pattern_type:"Blob",constraints:{radius:{min:.05,max:.25},amplitude:{min:.5,max:2},x:{min:.3,max:.7},y:{min:.3,max:.7}},fitness:{metrics:[{metric:"Persistence",weight:1},{metric:"Compactness",weight:.5},{metric:"Locomotion",weight:.3}],aggregation:"WeightedSum"},evaluation:{steps:200,sample_interval:10,warmup_steps:20},population:{size:20,elitism:2},algorithm:{type:"GeneticAlgorithm",config:{mutation_rate:.15,crossover_rate:.7,selection_method:"Tournament",tournament_size:3}},archive:{enabled:!0,max_size:50,diversity_threshold:.1},max_generations:50,target_fitness:.95,stagnation_limit:15}}async function fo(e){if(!En)throw new Error("Evolution module not initialized");hr(),qs();try{ke&&ke.free(),ke=new En.WasmEvolutionEngine(JSON.stringify(e)),ce.update(t=>({...t,running:!0,progress:null,result:null,error:null})),B(`Evolution started: pop=${e.population.size}, gens=${e.max_generations}`,"info"),Fs()}catch(t){throw ce.update(n=>({...n,error:String(t)})),B(`Evolution error: ${t}`,"error"),t}}function Fs(){if(!(!Ze(ce).running||!ke))try{const t=ke.step(),n=JSON.parse(t),r=ke.getBestCandidateState();if(ce.update(a=>({...a,progress:n,bestState:r})),ke.isComplete()){const a=ke.getResult(),s=JSON.parse(a);ce.update(i=>({...i,running:!1,result:s})),B(`Evolution complete: fitness=${s.best_fitness.toFixed(3)}, reason=${s.stop_reason}`,"success");return}_n=requestAnimationFrame(()=>Fs())}catch(t){ce.update(n=>({...n,running:!1,error:String(t)})),B(`Evolution error: ${t}`,"error")}}function qs(){_n!==null&&(cancelAnimationFrame(_n),_n=null);const e=Ze(ce);if(ke&&e.running){ke.cancel();try{const t=ke.getResult(),n=JSON.parse(t);ce.update(r=>({...r,result:n}))}catch{}B("Evolution cancelled","warn")}ce.update(t=>({...t,running:!1}))}function vo(){const e=Ze(ce);if(!e.bestState){B("No evolved pattern to load","warn");return}const{width:t,height:n,data:r}=e.bestState,a=[];for(let s=0;s<n;s++)for(let i=0;i<t;i++){const l=s*t+i,o=r[l];o>.001&&a.push([i,s,0,o])}Ln({pattern:{type:"Custom",values:a}}),B("Loaded evolved pattern into simulation","success")}var ho=I('<div class="progress-display svelte-auxm5"><div class="progress-row svelte-auxm5"><span class="label svelte-auxm5">GEN</span> <span class="value svelte-auxm5"> </span></div> <div class="progress-row svelte-auxm5"><span class="label svelte-auxm5">FIT</span> <span class="value highlight svelte-auxm5"> </span></div> <div class="progress-bar svelte-auxm5"><div class="progress-fill svelte-auxm5"></div></div></div>'),po=I('<div class="result-display svelte-auxm5"><div class="result-row svelte-auxm5"><span class="label svelte-auxm5">RESULT</span> <span class="value success svelte-auxm5"> </span></div> <div class="result-reason svelte-auxm5"> </div></div>'),go=I('<div class="idle-status svelte-auxm5">READY</div>'),_o=I('<button class="evo-btn danger svelte-auxm5">STOP</button>'),mo=I('<button class="evo-btn secondary svelte-auxm5">LOAD</button>'),bo=I('<button class="evo-btn primary svelte-auxm5">EVOLVE</button> <!>',1),wo=I('<div class="evolution-panel svelte-auxm5"><div class="preview-container svelte-auxm5"><canvas width="64" height="64" class="preview-canvas svelte-auxm5"></canvas> <span class="preview-label svelte-auxm5">BEST</span></div> <!> <div class="controls svelte-auxm5"><!></div> <details class="settings svelte-auxm5"><summary class="svelte-auxm5">SETTINGS</summary> <div class="settings-grid svelte-auxm5"><label class="svelte-auxm5"><span class="svelte-auxm5">POP</span> <input type="number" min="4" max="50" step="2" class="svelte-auxm5"/></label> <label class="svelte-auxm5"><span class="svelte-auxm5">GENS</span> <input type="number" min="10" max="200" step="10" class="svelte-auxm5"/></label> <label class="svelte-auxm5"><span class="svelte-auxm5">MUT%</span> <input type="number" min="1" max="50" step="1" class="svelte-auxm5"/></label> <label class="svelte-auxm5"><span class="svelte-auxm5">STEPS</span> <input type="number" min="50" max="500" step="50" class="svelte-auxm5"/></label></div> <label class="goal-select svelte-auxm5"><span class="svelte-auxm5">GOAL</span> <select class="svelte-auxm5"><option>Survival</option><option>Glider</option><option>Oscillator</option><option>Complex</option></select></label></details></div>');function yo(e,t){lt(t,!1);const n=()=>V(ce,"$evolutionStore",r),[r,a]=Ut();let s=Z(),i=Z(null),l=Z(20),o=Z(50),c=.95,u=Z(15),h=Z(200),v=Z("survival");function d(S){if(!f(i)||!f(s))return;const{width:x,height:M,data:b}=S,C=f(s).width,T=f(s).height,k=f(i).createImageData(x,M);for(let U=0;U<b.length;U++){const N=Math.floor(Math.min(1,Math.max(0,b[U]))*255);k.data[U*4]=N,k.data[U*4+1]=N,k.data[U*4+2]=N,k.data[U*4+3]=255}const O=new OffscreenCanvas(x,M),D=O.getContext("2d");D&&(D.putImageData(k,0,0),ze(i,f(i).imageSmoothingEnabled=!1),f(i).clearRect(0,0,C,T),f(i).drawImage(O,0,0,C,T))}function p(S){switch(S){case"glider":return[{metric:"Persistence",weight:1},{metric:"Locomotion",weight:1.5},{metric:"Compactness",weight:.5}];case"oscillator":return[{metric:"Persistence",weight:1},{metric:"Stability",weight:.8},{metric:"Compactness",weight:.5}];case"complex":return[{metric:"Persistence",weight:1},{metric:"Complexity",weight:1.2},{metric:"MassConcentration",weight:.3}];default:return[{metric:"Persistence",weight:1},{metric:"Compactness",weight:.5},{metric:"Stability",weight:.3}]}}function y(){return{...uo(),population:{size:f(l),elitism:Math.max(1,Math.floor(f(l)/10))},max_generations:f(o),target_fitness:c,stagnation_limit:Math.max(5,Math.floor(f(o)/3)),algorithm:{type:"GeneticAlgorithm",config:{mutation_rate:f(u)/100,crossover_rate:.7,selection_method:"Tournament",tournament_size:3}},evaluation:{steps:f(h),sample_interval:Math.max(1,Math.floor(f(h)/20)),warmup_steps:Math.floor(f(h)/10)},fitness:{metrics:p(f(v)),aggregation:"WeightedSum"}}}async function _(){const S=y();try{await fo(S)}catch(x){B(`Failed to start evolution: ${x}`,"error")}}function w(){qs()}function $(){vo()}function E(S){switch(S){case"TargetReached":return"TARGET HIT";case"MaxGenerations":return"MAX GENS";case"Stagnation":return"STAGNANT";case"Cancelled":return"CANCELLED";default:return S}}Rn(async()=>{if(q(i,f(s)?.getContext("2d")??null),!n().initialized)try{await co()}catch{}}),Be(()=>(f(i),n()),()=>{f(i)&&n().bestState&&d(n().bestState)}),In(),un(),st(e,{title:"EVOLVE",borderColor:"tertiary",children:(S,x)=>{var M=wo(),b=g(M),C=g(b);sn(C,j=>q(s,j),()=>f(s));var T=m(b,2);{var k=j=>{var ge=ho(),_e=g(ge),et=m(g(_e),2),ht=g(et),oe=m(_e,2),Ce=m(g(oe),2),pt=g(Ce),Yt=m(oe,2),jt=g(Yt);X(Xt=>{Y(ht,`${n(),P(()=>n().progress.generation)??""}/${f(o)??""}`),Y(pt,Xt),Es(jt,`width: ${n(),f(o),P(()=>n().progress.generation/f(o)*100)??""}%`)},[()=>(n(),P(()=>n().progress.best_fitness.toFixed(3)))]),A(j,ge)},O=j=>{var ge=Jn(),_e=ot(ge);{var et=oe=>{var Ce=po(),pt=g(Ce),Yt=m(g(pt),2),jt=g(Yt),Xt=m(pt,2),fn=g(Xt);X((Nn,Fn)=>{Y(jt,Nn),Y(fn,Fn)},[()=>(n(),P(()=>n().result.best_fitness.toFixed(3))),()=>(n(),P(()=>E(n().result.stop_reason)))]),A(oe,Ce)},ht=oe=>{var Ce=go();A(oe,Ce)};Q(_e,oe=>{n(),P(()=>n().result)?oe(et):oe(ht,!1)},!0)}A(j,ge)};Q(T,j=>{n(),P(()=>n().running&&n().progress)?j(k):j(O,!1)})}var D=m(T,2),U=g(D);{var N=j=>{var ge=_o();ge.__click=w,A(j,ge)},R=j=>{var ge=bo(),_e=ot(ge);_e.__click=_;var et=m(_e,2);{var ht=oe=>{var Ce=mo();Ce.__click=$,A(oe,Ce)};Q(et,oe=>{n(),P(()=>n().bestState)&&oe(ht)})}X(()=>_e.disabled=(n(),P(()=>!n().initialized))),A(j,ge)};Q(U,j=>{n(),P(()=>n().running)?j(N):j(R,!1)})}var J=m(D,2),z=m(g(J),2),ee=g(z),ue=m(g(ee),2),fe=m(ee,2),de=m(g(fe),2),Qe=m(fe,2),ft=m(g(Qe),2),dt=m(Qe,2),Pe=m(g(dt),2),ae=m(z,2),$e=m(g(ae),2);X(()=>{f(v),Ha(()=>{})});var K=g($e);K.value=K.__value="survival";var Me=m(K);Me.value=Me.__value="glider";var Fe=m(Me);Fe.value=Fe.__value="oscillator";var vt=m(Fe);vt.value=vt.__value="complex",vn(ue,()=>f(l),j=>q(l,j)),vn(de,()=>f(o),j=>q(o,j)),vn(ft,()=>f(u),j=>q(u,j)),vn(Pe,()=>f(h),j=>q(h,j)),mi($e,()=>f(v),j=>q(v,j)),A(S,M)},$$slots:{default:!0}}),ct(),a()}Gt(["click"]);const Dr="flow-lenia-presets";class So{presets=new Map;listeners=new Set;constructor(){this.loadFromStorage()}generateId(){return`preset-${Date.now()}-${Math.random().toString(36).slice(2,9)}`}createThumbnail(t,n=64){const r=document.createElement("canvas");r.width=n,r.height=n;const a=r.getContext("2d"),s=a.createImageData(t.width,t.height),i=t.channels[0];for(let p=0;p<i.length;p++){const y=Math.max(0,Math.min(1,i[p])),_=Math.floor(y*255);s.data[p*4+0]=_,s.data[p*4+1]=_,s.data[p*4+2]=_,s.data[p*4+3]=255}const l=document.createElement("canvas");l.width=t.width,l.height=t.height,l.getContext("2d").putImageData(s,0,0),a.imageSmoothingEnabled=!0,a.fillStyle="#1a1a1a",a.fillRect(0,0,n,n);const c=Math.min(n/t.width,n/t.height),u=t.width*c,h=t.height*c,v=(n-u)/2,d=(n-h)/2;return a.drawImage(l,v,d,u,h),r.toDataURL("image/png")}savePreset(t,n,r){const a={id:this.generateId(),name:t,description:r,thumbnail:this.createThumbnail(n),region:n,createdAt:Date.now()};return this.presets.set(a.id,a),this.persistToStorage(),this.notifyListeners(),a}getPreset(t){return this.presets.get(t)}getAllPresets(){return Array.from(this.presets.values()).sort((t,n)=>n.createdAt-t.createdAt)}deletePreset(t){const n=this.presets.delete(t);return n&&(this.persistToStorage(),this.notifyListeners()),n}renamePreset(t,n){const r=this.presets.get(t);return r?(r.name=n,this.persistToStorage(),this.notifyListeners(),!0):!1}updateDescription(t,n){const r=this.presets.get(t);return r?(r.description=n,this.persistToStorage(),this.notifyListeners(),!0):!1}exportPresets(t){const n=t?t.map(r=>this.presets.get(r)).filter(Boolean):this.getAllPresets();return JSON.stringify(n,null,2)}importPresets(t){try{const n=JSON.parse(t);let r=0;for(const a of n){const s={...a,id:this.generateId(),createdAt:Date.now()};this.presets.set(s.id,s),r++}return this.persistToStorage(),this.notifyListeners(),r}catch{throw new Error("Invalid preset JSON format")}}subscribe(t){return this.listeners.add(t),()=>this.listeners.delete(t)}notifyListeners(){const t=this.getAllPresets();for(const n of this.listeners)n(t)}persistToStorage(){try{const t=JSON.stringify(Array.from(this.presets.entries()));localStorage.setItem(Dr,t)}catch(t){console.warn("Failed to persist presets to storage:",t)}}loadFromStorage(){try{const t=localStorage.getItem(Dr);if(t){const n=JSON.parse(t);this.presets=new Map(n)}}catch(t){console.warn("Failed to load presets from storage:",t),this.presets=new Map}}clearAll(){this.presets.clear(),this.persistToStorage(),this.notifyListeners()}}const xo=[{name:"Glider",description:"A simple glider that moves across the grid",seed:{pattern:{type:"GaussianBlob",center:[.5,.5],radius:.1,amplitude:1,channel:0}}},{name:"Ring",description:"A ring pattern that expands",seed:{pattern:{type:"Ring",center:[.5,.5],inner_radius:.05,outer_radius:.1,amplitude:1,channel:0}}},{name:"Dual Blobs",description:"Two interacting blobs",seed:{pattern:{type:"MultiBlob",blobs:[{center:[.35,.5],radius:.08,amplitude:1,channel:0},{center:[.65,.5],radius:.08,amplitude:1,channel:0}]}}},{name:"Random Noise",description:"Random initial conditions",seed:{pattern:{type:"Noise",seed:42,amplitude:.5,channel:0}}}],Ot=new So,gr=Ne(Ot.getAllPresets());Ot.subscribe(e=>{gr.set(e)});function Eo(e){const t=Ot.getAllPresets().find(n=>n.id===e);Ot.deletePreset(e),t&&B(`Deleted preset: ${t.name}`,"info")}function Mo(){const e=Ot.exportPresets();return B(`Exported ${Ze(gr).length} presets`,"success"),e}function Co(e){try{const t=Ot.importPresets(e);return B(`Imported ${t} presets`,"success"),qi(),t}catch(t){throw B(`Import failed: ${t}`,"error"),t}}function ko(){const e=Mo(),t=new Blob([e],{type:"application/json"}),n=URL.createObjectURL(t),r=document.createElement("a");r.href=n,r.download="flow-lenia-presets.json",r.click(),URL.revokeObjectURL(n)}var To=I('<div class="metric-display svelte-1baw31t"><div class="metric-main svelte-1baw31t"><span class="metric-value svelte-1baw31t"> </span> <span class="metric-unit svelte-1baw31t">STEPS</span></div> <div class="metric-row svelte-1baw31t"><div class="metric-item svelte-1baw31t"><span class="metric-label svelte-1baw31t">TIME</span> <span class="metric-num svelte-1baw31t"> </span></div> <div class="metric-item svelte-1baw31t"><span class="metric-label svelte-1baw31t">MASS</span> <span class="metric-num highlight svelte-1baw31t"> </span></div></div> <div class="metric-row svelte-1baw31t"><div class="metric-item svelte-1baw31t"><span class="metric-label svelte-1baw31t">FPS</span> <span class="metric-num accent svelte-1baw31t"> </span></div> <div class="metric-item svelte-1baw31t"><span class="metric-label svelte-1baw31t">BACKEND</span> <button> </button></div></div></div>'),Ao=I('<div class="config-grid svelte-1baw31t"><div class="config-item svelte-1baw31t"><span class="cfg-label svelte-1baw31t">mu</span> <span class="cfg-value svelte-1baw31t"> </span></div> <div class="config-item svelte-1baw31t"><span class="cfg-label svelte-1baw31t">sigma</span> <span class="cfg-value svelte-1baw31t"> </span></div> <div class="config-item svelte-1baw31t"><span class="cfg-label svelte-1baw31t">R</span> <span class="cfg-value svelte-1baw31t"> </span></div> <div class="config-item svelte-1baw31t"><span class="cfg-label svelte-1baw31t">dt</span> <span class="cfg-value svelte-1baw31t"> </span></div></div>'),Po=I('<button class="builtin-btn svelte-1baw31t"> </button>'),$o=I('<div class="builtin-grid svelte-1baw31t"></div>'),Io=I('<img class="svelte-1baw31t"/>'),Do=I('<div class="preset-item svelte-1baw31t" draggable="true" role="button" tabindex="0"><div class="preset-thumbnail svelte-1baw31t"><!></div> <div class="preset-info svelte-1baw31t"><span class="preset-name svelte-1baw31t"> </span> <span class="preset-size svelte-1baw31t"> </span></div> <button class="delete-btn svelte-1baw31t">&#10005;</button></div>'),Ro=I('<div class="empty-state svelte-1baw31t">No saved patterns</div>'),Lo=I('<div class="patterns-header svelte-1baw31t"><button class="small-btn svelte-1baw31t">IMPORT</button> <button class="small-btn svelte-1baw31t">EXPORT</button></div> <div class="preset-list svelte-1baw31t"></div>',1),Oo=I('<aside class="right-sidebar svelte-1baw31t"><!> <!> <!> <!> <!></aside>');function No(e,t){lt(t,!1);const n=()=>V(se,"$simulationStore",l),r=()=>V(Ls,"$formattedStep",l),a=()=>V(Ds,"$formattedTime",l),s=()=>V(Rs,"$formattedMass",l),i=()=>V(gr,"$presets",l),[l,o]=Ut(),c=Z();function u(){const b=n().backend==="cpu"?"gpu":"cpu";Ii(b)}function h(b){const C=tr();if(!C)return;const T=Math.floor((C.getWidth()-b.region.width)/2),k=Math.floor((C.getHeight()-b.region.height)/2);C.placeRegion(b.region,T,k)}function v(b){Ln(b.seed),B(`Loaded pattern: ${b.name}`,"info")}function d(b,C){b.stopPropagation(),Eo(C)}function p(){ko()}function y(){const b=document.createElement("input");b.type="file",b.accept=".json",b.onchange=async C=>{const T=C.target.files?.[0];if(!T)return;const k=await T.text();try{Co(k)}catch{}},b.click()}function _(b,C){b.dataTransfer.effectAllowed="copy",b.dataTransfer.setData("text/plain",C.id),zi(C,b)}Be(()=>n(),()=>{q(c,n().config.kernels[0])}),In(),un();var w=Oo(),$=g(w);yo($,{});var E=m($,2);st(E,{title:"METRICS",borderColor:"secondary",children:(b,C)=>{var T=To(),k=g(T),O=g(k),D=g(O),U=m(k,2),N=g(U),R=m(g(N),2),J=g(R),z=m(N,2),ee=m(g(z),2),ue=g(ee),fe=m(U,2),de=g(fe),Qe=m(g(de),2),ft=g(Qe),dt=m(de,2),Pe=m(g(dt),2);let ae;Pe.__click=u;var $e=g(Pe);X(K=>{Y(D,r()),Y(J,`${a()??""}s`),Y(ue,s()),Y(ft,(n(),P(()=>n().fps))),ae=we(Pe,1,"backend-btn svelte-1baw31t",null,ae,{gpu:n().backend==="gpu"}),Pe.disabled=(n(),P(()=>!n().gpuAvailable)),Y($e,K)},[()=>(n(),P(()=>n().backend.toUpperCase()))]),A(b,T)},$$slots:{default:!0}});var S=m(E,2);st(S,{title:"KERNEL",borderColor:"primary",children:(b,C)=>{var T=Ao(),k=g(T),O=m(g(k),2),D=g(O),U=m(k,2),N=m(g(U),2),R=g(N),J=m(U,2),z=m(g(J),2),ee=g(z),ue=m(J,2),fe=m(g(ue),2),de=g(fe);X(()=>{Y(D,(f(c),P(()=>f(c)?.mu??"—"))),Y(R,(f(c),P(()=>f(c)?.sigma??"—"))),Y(ee,(n(),P(()=>n().config.kernel_radius))),Y(de,(n(),P(()=>n().config.dt)))}),A(b,T)},$$slots:{default:!0}});var x=m(S,2);st(x,{title:"SEEDS",borderColor:"tertiary",children:(b,C)=>{var T=$o();rn(T,5,()=>xo,xn,(k,O)=>{var D=Po();D.__click=()=>v(f(O));var U=g(D);X(()=>{Ve(D,"title",(f(O),P(()=>f(O).description))),Y(U,(f(O),P(()=>f(O).name)))}),A(k,D)}),A(b,T)},$$slots:{default:!0}});var M=m(x,2);st(M,{title:"SAVED",borderColor:"primary",class:"saved-box",children:(b,C)=>{var T=Lo(),k=ot(T),O=g(k);O.__click=y;var D=m(O,2);D.__click=p;var U=m(k,2);rn(U,5,i,N=>N.id,(N,R)=>{var J=Do();J.__click=()=>h(f(R)),J.__keydown=ae=>ae.key==="Enter"&&h(f(R));var z=g(J),ee=g(z);{var ue=ae=>{var $e=Io();X(()=>{Ve($e,"src",(f(R),P(()=>f(R).thumbnail))),Ve($e,"alt",(f(R),P(()=>f(R).name)))}),A(ae,$e)};Q(ee,ae=>{f(R),P(()=>f(R).thumbnail)&&ae(ue)})}var fe=m(z,2),de=g(fe),Qe=g(de),ft=m(de,2),dt=g(ft),Pe=m(fe,2);Pe.__click=ae=>d(ae,f(R).id),X(()=>{Y(Qe,(f(R),P(()=>f(R).name))),Y(dt,`${f(R),P(()=>f(R).region.width)??""}x${f(R),P(()=>f(R).region.height)??""}`)}),si("dragstart",J,ae=>_(ae,f(R))),A(N,J)},N=>{var R=Ro();A(N,R)}),A(b,T)},$$slots:{default:!0}}),A(e,w),ct(),o()}Gt(["click","keydown"]);class Fo{canvas;ctx;offscreenCanvas;offscreenCtx;settings;grayscaleMap;thermalMap;viridisMap;themeMap;constructor(t,n){this.canvas=t;const r=t.getContext("2d");if(!r)throw new Error("Failed to get 2D context");this.ctx=r,this.offscreenCanvas=document.createElement("canvas");const a=this.offscreenCanvas.getContext("2d");if(!a)throw new Error("Failed to get offscreen 2D context");this.offscreenCtx=a,this.settings=n,this.grayscaleMap=this.buildGrayscaleMap(),this.thermalMap=this.buildThermalMap(),this.viridisMap=this.buildViridisMap(),this.themeMap=this.viridisMap}setThemeColors(t){this.themeMap=this.buildThemeMap(t)}updateSettings(t){this.settings={...this.settings,...t}}render(t,n,r){const{width:a,height:s,channels:i}=t;(this.offscreenCanvas.width!==a||this.offscreenCanvas.height!==s)&&(this.offscreenCanvas.width=a,this.offscreenCanvas.height=s);const l=this.getColorMap(),o=this.offscreenCtx.createImageData(a,s),c=i[0];for(let u=0;u<c.length;u++){const h=Math.max(0,Math.min(1,c[u])),v=Math.floor(h*255)*4;o.data[u*4+0]=l[v+0],o.data[u*4+1]=l[v+1],o.data[u*4+2]=l[v+2],o.data[u*4+3]=255}this.offscreenCtx.putImageData(o,0,0),this.ctx.imageSmoothingEnabled=!1,this.ctx.fillStyle="#000",this.ctx.fillRect(0,0,this.canvas.width,this.canvas.height),this.ctx.drawImage(this.offscreenCanvas,0,0,a,s,0,0,this.canvas.width,this.canvas.height),this.settings.showGrid&&this.drawGrid(a,s),r&&this.drawGhostPreview(r,a,s),n&&this.settings.showSelection&&this.drawSelection(n,a,s)}drawGrid(t,n){const r=this.canvas.width/t,a=this.canvas.height/n;if(this.ctx.strokeStyle="rgba(255, 255, 255, 0.1)",this.ctx.lineWidth=1,r>=4&&a>=4){this.ctx.beginPath();for(let s=0;s<=t;s++){const i=s*r;this.ctx.moveTo(i,0),this.ctx.lineTo(i,this.canvas.height)}for(let s=0;s<=n;s++){const i=s*a;this.ctx.moveTo(0,i),this.ctx.lineTo(this.canvas.width,i)}this.ctx.stroke()}}drawSelection(t,n,r){const a=this.canvas.width/n,s=this.canvas.height/r,i=Math.min(t.startX,t.endX)*a,l=Math.min(t.startY,t.endY)*s,o=Math.abs(t.endX-t.startX)*a,c=Math.abs(t.endY-t.startY)*s;this.ctx.fillStyle="rgba(79, 195, 247, 0.2)",this.ctx.fillRect(i,l,o,c),this.ctx.strokeStyle="#4fc3f7",this.ctx.lineWidth=2,this.ctx.setLineDash([5,5]),this.ctx.strokeRect(i,l,o,c),this.ctx.setLineDash([]);const u=Math.abs(t.endX-t.startX),h=Math.abs(t.endY-t.startY);u>0&&h>0&&(this.ctx.fillStyle="#4fc3f7",this.ctx.font="12px monospace",this.ctx.fillText(`${u} x ${h}`,i+4,l-4))}drawGhostPreview(t,n,r){const a=this.canvas.width/n,s=this.canvas.height/r,{region:i,x:l,y:o}=t,c=document.createElement("canvas");c.width=i.width,c.height=i.height;const u=c.getContext("2d"),h=u.createImageData(i.width,i.height),v=this.getColorMap();for(let d=0;d<i.channels[0].length;d++){const p=Math.max(0,Math.min(1,i.channels[0][d])),y=Math.floor(p*255)*4;h.data[d*4+0]=v[y+0],h.data[d*4+1]=v[y+1],h.data[d*4+2]=v[y+2],h.data[d*4+3]=p>.01?180:0}u.putImageData(h,0,0),this.ctx.globalAlpha=.7,this.ctx.drawImage(c,0,0,i.width,i.height,l*a,o*s,i.width*a,i.height*s),this.ctx.globalAlpha=1,this.ctx.strokeStyle="#4fc3f7",this.ctx.lineWidth=2,this.ctx.setLineDash([3,3]),this.ctx.strokeRect(l*a,o*s,i.width*a,i.height*s),this.ctx.setLineDash([])}canvasToSim(t,n,r,a){const s=this.canvas.getBoundingClientRect(),i=r/this.canvas.width,l=a/this.canvas.height;return{x:Math.floor((t-s.left)*i),y:Math.floor((n-s.top)*l)}}getColorMap(){switch(this.settings.colorScheme){case"thermal":return this.thermalMap;case"viridis":return this.viridisMap;case"theme":return this.themeMap;default:return this.grayscaleMap}}buildGrayscaleMap(){const t=new Uint8ClampedArray(1024);for(let n=0;n<256;n++)t[n*4+0]=n,t[n*4+1]=n,t[n*4+2]=n,t[n*4+3]=255;return t}buildThermalMap(){const t=new Uint8ClampedArray(1024);for(let n=0;n<256;n++){const r=n/255;let a,s,i;if(r<.2){const l=r/.2;a=0,s=0,i=Math.floor(l*128)}else if(r<.4){const l=(r-.2)/.2;a=0,s=Math.floor(l*255),i=128+Math.floor(l*127)}else if(r<.6){const l=(r-.4)/.2;a=Math.floor(l*255),s=255,i=255-Math.floor(l*255)}else if(r<.8){const l=(r-.6)/.2;a=255,s=255-Math.floor(l*255),i=0}else{const l=(r-.8)/.2;a=255,s=Math.floor(l*255),i=Math.floor(l*255)}t[n*4+0]=a,t[n*4+1]=s,t[n*4+2]=i,t[n*4+3]=255}return t}buildViridisMap(){const t=[[68,1,84],[72,35,116],[64,67,135],[52,94,141],[41,120,142],[32,144,140],[34,167,132],[68,190,112],[121,209,81],[189,222,38],[253,231,36]],n=new Uint8ClampedArray(256*4);for(let r=0;r<256;r++){const s=r/255*(t.length-1),i=Math.floor(s),l=Math.min(i+1,t.length-1),o=s-i;n[r*4+0]=Math.floor(t[i][0]+o*(t[l][0]-t[i][0])),n[r*4+1]=Math.floor(t[i][1]+o*(t[l][1]-t[i][1])),n[r*4+2]=Math.floor(t[i][2]+o*(t[l][2]-t[i][2])),n[r*4+3]=255}return n}getCanvas(){return this.canvas}buildThemeMap(t){const n=o=>{const c=o.replace("#","");return[parseInt(c.slice(0,2),16),parseInt(c.slice(2,4),16),parseInt(c.slice(4,6),16)]},r=n(t.primary),a=n(t.secondary),s=n(t.tertiary),i=[{t:0,color:[5,5,5]},{t:.15,color:[r[0]*.3,r[1]*.3,r[2]*.3]},{t:.35,color:r},{t:.6,color:a},{t:.85,color:s},{t:1,color:[255,255,255]}],l=new Uint8ClampedArray(256*4);for(let o=0;o<256;o++){const c=o/255;let u=i[0],h=i[1];for(let d=1;d<i.length;d++)if(c<=i[d].t){u=i[d-1],h=i[d];break}const v=(c-u.t)/(h.t-u.t);l[o*4+0]=Math.floor(u.color[0]+v*(h.color[0]-u.color[0])),l[o*4+1]=Math.floor(u.color[1]+v*(h.color[1]-u.color[1])),l[o*4+2]=Math.floor(u.color[2]+v*(h.color[2]-u.color[2])),l[o*4+3]=255}return l}}class qo{canvas;simulation;callbacks;mode="view";selection=null;isSelecting=!1;isDrawing=!1;isDragging=!1;draggedCreature=null;ghostPreview=null;brushSize=3;brushIntensity=.5;constructor(t,n,r,a={}){this.canvas=t,this.simulation=n,this.callbacks=a,this.setupEventListeners(),this.setupDragDrop()}setMode(t){switch(this.mode=t,this.selection=null,this.isSelecting=!1,this.isDrawing=!1,t){case"select":this.canvas.style.cursor="crosshair";break;case"draw":this.canvas.style.cursor="cell";break;case"erase":this.canvas.style.cursor="not-allowed";break;default:this.canvas.style.cursor="default"}this.callbacks.onModeChange?.(t)}getMode(){return this.mode}getSelection(){return this.selection}clearSelection(){this.selection=null,this.callbacks.onSelectionChange?.(null)}setBrushSize(t){this.brushSize=Math.max(1,Math.min(20,t))}setBrushIntensity(t){this.brushIntensity=Math.max(0,Math.min(1,t))}getGhostPreview(){return this.ghostPreview}startDragFromLibrary(t,n){this.isDragging=!0,this.draggedCreature={preset:t,offsetX:t.region.width/2,offsetY:t.region.height/2};const r=this.getSimCoords(n);this.ghostPreview={region:t.region,x:r.x-this.draggedCreature.offsetX,y:r.y-this.draggedCreature.offsetY}}setupEventListeners(){this.canvas.addEventListener("mousedown",this.handleMouseDown.bind(this)),this.canvas.addEventListener("mousemove",this.handleMouseMove.bind(this)),this.canvas.addEventListener("mouseup",this.handleMouseUp.bind(this)),this.canvas.addEventListener("mouseleave",this.handleMouseLeave.bind(this)),document.addEventListener("keydown",this.handleKeyDown.bind(this))}setupDragDrop(){this.canvas.addEventListener("dragover",t=>{if(t.preventDefault(),t.dataTransfer.dropEffect="copy",this.draggedCreature){const n=this.getSimCoords(t);this.ghostPreview={region:this.draggedCreature.preset.region,x:n.x-this.draggedCreature.offsetX,y:n.y-this.draggedCreature.offsetY}}}),this.canvas.addEventListener("drop",t=>{if(t.preventDefault(),this.draggedCreature){const n=this.getSimCoords(t),r=Math.floor(n.x-this.draggedCreature.offsetX),a=Math.floor(n.y-this.draggedCreature.offsetY);this.callbacks.onDrop?.(this.draggedCreature.preset,r,a),this.draggedCreature=null,this.ghostPreview=null,this.isDragging=!1}}),this.canvas.addEventListener("dragleave",()=>{this.ghostPreview=null})}handleMouseDown(t){const n=this.getSimCoords(t);switch(this.mode){case"select":this.isSelecting=!0,this.selection={startX:n.x,startY:n.y,endX:n.x,endY:n.y},this.callbacks.onSelectionChange?.(this.selection);break;case"draw":this.isDrawing=!0,this.callbacks.onDraw?.(n.x,n.y);break;case"erase":this.isDrawing=!0,this.callbacks.onErase?.(n.x,n.y);break}}handleMouseMove(t){const n=this.getSimCoords(t);this.isSelecting&&this.selection&&(this.selection.endX=n.x,this.selection.endY=n.y,this.callbacks.onSelectionChange?.(this.selection)),this.isDrawing&&(this.mode==="draw"?this.callbacks.onDraw?.(n.x,n.y):this.mode==="erase"&&this.callbacks.onErase?.(n.x,n.y)),this.isDragging&&this.draggedCreature&&(this.ghostPreview={region:this.draggedCreature.preset.region,x:n.x-this.draggedCreature.offsetX,y:n.y-this.draggedCreature.offsetY})}handleMouseUp(t){if(this.isSelecting&&this.selection){const n={startX:Math.min(this.selection.startX,this.selection.endX),startY:Math.min(this.selection.startY,this.selection.endY),endX:Math.max(this.selection.startX,this.selection.endX),endY:Math.max(this.selection.startY,this.selection.endY)};n.endX>n.startX&&n.endY>n.startY?(this.selection=n,this.callbacks.onSelectionComplete?.(n)):this.selection=null,this.callbacks.onSelectionChange?.(this.selection)}this.isSelecting=!1,this.isDrawing=!1}handleMouseLeave(t){this.isSelecting&&(this.isSelecting=!1,this.selection=null,this.callbacks.onSelectionChange?.(null)),this.isDrawing=!1,this.ghostPreview=null}handleKeyDown(t){const n=t.target;n.tagName==="INPUT"||n.tagName==="TEXTAREA"||(t.key==="v"||t.key==="Escape"?this.setMode("view"):t.key==="s"?this.setMode("select"):t.key==="d"?this.setMode("draw"):t.key==="e"&&this.setMode("erase"),t.key==="["?(this.setBrushSize(this.brushSize-1),this.callbacks.onBrushSizeChange?.(this.brushSize)):t.key==="]"&&(this.setBrushSize(this.brushSize+1),this.callbacks.onBrushSizeChange?.(this.brushSize)))}getSimCoords(t){const n=this.canvas.getBoundingClientRect(),r=t.clientX-n.left,a=t.clientY-n.top,s=this.simulation.getWidth(),i=this.simulation.getHeight();return{x:Math.floor(r/n.width*s),y:Math.floor(a/n.height*i)}}getBrushSize(){return this.brushSize}getBrushIntensity(){return this.brushIntensity}}var zo=I('<div class="simulation-view svelte-145nxqv"><div class="canvas-frame svelte-145nxqv"><div class="canvas-header svelte-145nxqv"><span class="dim-label svelte-145nxqv"> </span></div> <div class="canvas-container svelte-145nxqv"><canvas class="svelte-145nxqv"></canvas> <div class="corner-marker top-left svelte-145nxqv"></div> <div class="corner-marker top-right svelte-145nxqv"></div> <div class="corner-marker bottom-left svelte-145nxqv"></div> <div class="corner-marker bottom-right svelte-145nxqv"></div> <div class="canvas-scanlines svelte-145nxqv"></div></div></div></div>');function Go(e,t){lt(t,!1);const n=()=>V(ut,"$settings",i),r=()=>V(se,"$simulationStore",i),a=()=>V(On,"$currentScheme",i),s=()=>V(Ns,"$renderTrigger",i),[i,l]=Ut();let o=Z(),c=Z(),u=Z(null),h=Z(null);const v=512;Rn(()=>{const x=tr();!x||!f(c)||(sr.set(f(c)),q(u,new Fo(f(c),{colorScheme:n().colorScheme,showGrid:n().showGrid,showSelection:n().showSelection,brushSize:n().brushSize,brushIntensity:n().brushIntensity,backend:r().backend})),q(h,new qo(f(c),x,f(u),{onSelectionChange:()=>d(),onSelectionComplete:()=>{},onDrop:(M,b,C)=>{x.placeRegion(M.region,b,C),d()},onDraw:(M,b)=>{x.drawAt(M,b,n().brushSize,n().brushIntensity),d()},onErase:(M,b)=>{x.eraseAt(M,b,n().brushSize),d()},onModeChange:()=>{},onBrushSizeChange:()=>{}})),rr.set(f(h)),d())}),ks(()=>{rr.set(null),sr.set(null),q(u,null),q(h,null)});function d(){if(!f(u))return;const x=tr();if(!x)return;const M=x.getState(),b=f(h)?.getSelection(),C=f(h)?.getGhostPreview();f(u).render(M,b,C)}Be(()=>(r(),f(u)),()=>{r().state&&f(u)&&d()}),Be(()=>(f(h),n()),()=>{f(h)&&n().mode&&f(h).setMode(n().mode)}),Be(()=>(f(h),n()),()=>{f(h)&&(f(h).setBrushSize(n().brushSize),f(h).setBrushIntensity(n().brushIntensity))}),Be(()=>(f(u),n()),()=>{f(u)&&n().colorScheme&&(f(u).updateSettings({colorScheme:n().colorScheme}),d())}),Be(()=>(f(u),a()),()=>{f(u)&&a()&&(f(u).setThemeColors({primary:a().colors.primary,secondary:a().colors.secondary,tertiary:a().colors.tertiary}),d())}),Be(()=>(s(),f(u)),()=>{s()&&f(u)&&d()}),In(),un();var p=zo(),y=g(p),_=g(y),w=g(_),$=g(w),E=m(_,2),S=g(E);Ve(S,"width",v),Ve(S,"height",v),sn(S,x=>q(c,x),()=>f(c)),sn(E,x=>q(o,x),()=>f(o)),X(()=>Y($,`${r(),P(()=>r().config.width)??""}x${r(),P(()=>r().config.height)??""}`)),A(e,p),ct(),l()}var Bo=I('<div class="loading-screen svelte-1n46o8q"><div class="loading-content svelte-1n46o8q"><div class="glitch-text svelte-1n46o8q" data-text="FLOW_LENIA">FLOW_LENIA</div> <div class="loading-status svelte-1n46o8q"><span class="animate-pulse">INITIALIZING SUBSTRATE</span> <span class="animate-blink">_</span></div></div></div>'),Uo=I('<div class="error-screen svelte-1n46o8q"><div class="error-content svelte-1n46o8q"><div class="error-title svelte-1n46o8q">SYSTEM FAILURE</div> <div class="error-message svelte-1n46o8q"> </div> <div class="error-hint svelte-1n46o8q">Ensure WASM is built: <code class="svelte-1n46o8q">wasm-pack build --target web --release</code></div></div></div>'),Yo=I('<div class="panel-deck svelte-1n46o8q"><!> <!></div>'),jo=I('<div class="compact-deck svelte-1n46o8q"><div class="compact-card svelte-1n46o8q"><div class="compact-header svelte-1n46o8q"><span>CONTROLS</span> <button class="compact-btn secondary svelte-1n46o8q">EXPAND</button></div> <div class="compact-controls svelte-1n46o8q"><button><!></button> <button class="svelte-1n46o8q">STEP</button> <button class="danger svelte-1n46o8q">RESET</button></div></div> <div class="compact-card svelte-1n46o8q"><div class="compact-header svelte-1n46o8q"><span>METRICS</span></div> <div class="compact-metrics svelte-1n46o8q"><div class="metric svelte-1n46o8q"><span class="metric-label svelte-1n46o8q">STEPS</span> <span class="metric-value svelte-1n46o8q"> </span></div> <div class="metric svelte-1n46o8q"><span class="metric-label svelte-1n46o8q">TIME</span> <span class="metric-value svelte-1n46o8q"> </span></div> <div class="metric svelte-1n46o8q"><span class="metric-label svelte-1n46o8q">MASS</span> <span class="metric-value svelte-1n46o8q"> </span></div> <div class="metric svelte-1n46o8q"><span class="metric-label svelte-1n46o8q">FPS</span> <span class="metric-value svelte-1n46o8q"> </span></div></div></div></div>'),Xo=I('<div class="scanlines"></div>'),Wo=I('<div class="app-container svelte-1n46o8q"><canvas class="glow-layer svelte-1n46o8q"></canvas> <!> <div><!> <!></div> <!></div> <!> <div class="vignette"></div>',1);function Ho(e,t){lt(t,!1);const n=()=>V(sr,"$simulationCanvas",c),r=()=>V(On,"$currentScheme",c),a=()=>V(se,"$simulationStore",c),s=()=>V(ut,"$settings",c),i=()=>V(Ls,"$formattedStep",c),l=()=>V(Ds,"$formattedTime",c),o=()=>V(Rs,"$formattedMass",c),[c,u]=Ut();let h=Z(!1),v=Z(null),d=Z(),p=Z(null),y,_=Z(!1),w=Z(),$=null,E=null;function S(){const T=n();if(!T||!f(p)||!f(d)){y=requestAnimationFrame(S);return}if($||($=document.createElement("canvas"),E=$.getContext("2d",{willReadFrequently:!0})),f(w)){const z=f(w).getBoundingClientRect(),ee=f(d).width!==z.width||f(d).height!==z.height,ue=$.width===0||$.height===0;(ee||ue)&&(ze(d,f(d).width=z.width),ze(d,f(d).height=z.height),$.width=z.width,$.height=z.height)}if(!E||$.width===0)return;const k=f(d).width,O=f(d).height,D=r().colors;E.drawImage(T,0,0,k,O);const U=E.getImageData(0,0,k,O),N=U.data,R=5,J=255-R;for(let z=0;z<N.length;z+=4){const ee=(N[z]+N[z+1]+N[z+2])/3,fe=Math.max(0,ee-R)/J,de=Math.pow(fe,.35);N[z]=255,N[z+1]=255,N[z+2]=255,N[z+3]=de*255}E.putImageData(U,0,0),f(p).clearRect(0,0,k,O),ze(p,f(p).fillStyle=D.primary),f(p).fillRect(180,0,80,O),ze(p,f(p).fillStyle=D.secondary),f(p).fillRect(k-220,0,80,O),ze(p,f(p).fillStyle=D.tertiary),f(p).fillRect(0,30,k,40),ze(p,f(p).fillStyle=D.tertiary),f(p).fillRect(0,O-60,k,40),ze(p,f(p).globalCompositeOperation="destination-in"),f(p).drawImage($,0,0),ze(p,f(p).globalCompositeOperation="source-over"),y=requestAnimationFrame(S)}Rn(async()=>{Fi(),B("SYS.BOOT","info"),B("Loading WASM module...","info");try{await $i(),q(h,!0),B("WASM initialized","success"),B(`Backend: ${a().backend.toUpperCase()}`,"info"),B(`Theme: ${r().name}`,"info"),a().gpuAvailable?B("WebGPU available","success"):B("WebGPU not available","warn"),B("SYSTEM READY","success")}catch(T){q(v,String(T)),B(`INIT FAILED: ${T}`,"error")}}),ks(()=>{y&&cancelAnimationFrame(y)}),Be(()=>(f(d),f(_)),()=>{f(d)&&!f(_)&&(q(p,f(d).getContext("2d")),q(_,!0),S())}),In(),un();var x=Jn(),M=ot(x);{var b=T=>{var k=Bo();A(T,k)},C=T=>{var k=Jn(),O=ot(k);{var D=N=>{var R=Uo(),J=g(R),z=m(g(J),2),ee=g(z);X(()=>Y(ee,f(v))),A(N,R)},U=N=>{var R=Wo(),J=ot(R),z=g(J);sn(z,K=>q(d,K),()=>f(d));var ee=m(z,2);Ui(ee,{});var ue=m(ee,2);let fe;var de=g(ue);Go(de,{});var Qe=m(de,2);{var ft=K=>{var Me=Yo(),Fe=g(Me);oo(Fe,{});var vt=m(Fe,2);No(vt,{}),A(K,Me)},dt=K=>{var Me=jo(),Fe=g(Me),vt=g(Fe),j=m(g(vt),2);j.__click=function(...tt){Os?.apply(this,tt)};var ge=m(vt,2),_e=g(ge);_e.__click=()=>a().playing?hr():Ps();let et;var ht=g(_e);{var oe=tt=>{var qn=Sn("STOP");A(tt,qn)},Ce=tt=>{var qn=Sn("START");A(tt,qn)};Q(ht,tt=>{a(),P(()=>a().playing)?tt(oe):tt(Ce,!1)})}var pt=m(_e,2);pt.__click=()=>$s();var Yt=m(pt,2);Yt.__click=()=>Ln();var jt=m(Fe,2),Xt=m(g(jt),2),fn=g(Xt),Nn=m(g(fn),2),Fn=g(Nn),_r=m(fn,2),zs=m(g(_r),2),Gs=g(zs),mr=m(_r,2),Bs=m(g(mr),2),Us=g(Bs),Ys=m(mr,2),js=m(g(Ys),2),Xs=g(js);X(()=>{et=we(_e,1,"svelte-1n46o8q",null,et,{active:!a().playing}),Y(Fn,i()),Y(Gs,`${l()??""}s`),Y(Us,o()),Y(Xs,(a(),P(()=>a().fps)))}),A(K,Me)};Q(Qe,K=>{s(),P(()=>s().showPanels)?K(ft):K(dt,!1)})}var Pe=m(ue,2);ji(Pe),sn(J,K=>q(w,K),()=>f(w));var ae=m(J,2);{var $e=K=>{var Me=Xo();A(K,Me)};Q(ae,K=>{s(),P(()=>s().showScanlines)&&K($e)})}X(()=>fe=we(ue,1,"main-content svelte-1n46o8q",null,fe,{"panel-hidden":!s().showPanels})),A(N,R)};Q(O,N=>{f(v)?N(D):N(U,!1)},!0)}A(T,k)};Q(M,T=>{!f(h)&&!f(v)?T(b):T(C,!1)})}A(e,x),ct(),u()}Gt(["click"]);ai(Ho,{target:document.getElementById("app")});
