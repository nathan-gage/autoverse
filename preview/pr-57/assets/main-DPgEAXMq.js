import"./modulepreload-polyfill-B5Qt9EMX.js";const nn=!1;var Hn=Array.isArray,jr=Array.prototype.indexOf,Xt=Array.from,Vn=Object.defineProperty,lt=Object.getOwnPropertyDescriptor,Kn=Object.getOwnPropertyDescriptors,qr=Object.prototype,Ur=Array.prototype,mn=Object.getPrototypeOf,Rn=Object.isExtensible;const Ae=()=>{};function Xr(t){return t()}function Bt(t){for(var e=0;e<t.length;e++)t[e]()}function Jn(){var t,e,n=new Promise((r,i)=>{t=r,e=i});return{promise:n,resolve:t,reject:e}}const K=2,bn=4,Wt=8,Wr=1<<24,Pe=16,$e=32,Qe=64,Ht=128,ve=512,H=1024,ne=2048,pe=4096,ie=8192,De=16384,wn=32768,Ve=65536,Ln=1<<17,Zn=1<<18,pt=1<<19,Qn=1<<20,ke=1<<25,Ke=32768,rn=1<<21,yn=1<<22,ze=1<<23,Ue=Symbol("$state"),Hr=Symbol("legacy props"),Vr=Symbol(""),it=new class extends Error{name="StaleReactionError";message="The reaction that called `getAbortSignal()` was re-run or destroyed"};function er(t){throw new Error("https://svelte.dev/e/lifecycle_outside_component")}function Kr(){throw new Error("https://svelte.dev/e/async_derived_orphan")}function Jr(t){throw new Error("https://svelte.dev/e/effect_in_teardown")}function Zr(){throw new Error("https://svelte.dev/e/effect_in_unowned_derived")}function Qr(t){throw new Error("https://svelte.dev/e/effect_orphan")}function es(){throw new Error("https://svelte.dev/e/effect_update_depth_exceeded")}function ts(t){throw new Error("https://svelte.dev/e/props_invalid_value")}function ns(){throw new Error("https://svelte.dev/e/state_descriptors_fixed")}function rs(){throw new Error("https://svelte.dev/e/state_prototype_fixed")}function ss(){throw new Error("https://svelte.dev/e/state_unsafe_mutation")}function is(){throw new Error("https://svelte.dev/e/svelte_boundary_reset_onerror")}const as=1,os=2,tr=4,ls=8,cs=16,fs=1,us=2,ds=4,hs=8,vs=16,ps=1,gs=2,J=Symbol(),_s="http://www.w3.org/1999/xhtml";function ms(){console.warn("https://svelte.dev/e/svelte_boundary_reset_noop")}function nr(t){return t===this.v}function rr(t,e){return t!=t?e==e:t!==e||t!==null&&typeof t=="object"||typeof t=="function"}function sr(t){return!rr(t,this.v)}let gt=!1,bs=!1;function ws(){gt=!0}let B=null;function ft(t){B=t}function et(t,e=!1,n){B={p:B,i:!1,c:null,e:null,s:t,x:null,l:gt&&!e?{s:null,u:null,$:[]}:null}}function tt(t){var e=B,n=e.e;if(n!==null){e.e=null;for(var r of n)_r(r)}return e.i=!0,B=e.p,{}}function It(){return!gt||B!==null&&B.l===null}let at=[];function ys(){var t=at;at=[],Bt(t)}function _t(t){if(at.length===0){var e=at;queueMicrotask(()=>{e===at&&ys()})}at.push(t)}function ir(t){var e=O;if(e===null)return I.f|=ze,t;if((e.f&wn)===0){if((e.f&Ht)===0)throw t;e.b.error(t)}else ut(t,e)}function ut(t,e){for(;e!==null;){if((e.f&Ht)!==0)try{e.b.error(t);return}catch(n){t=n}e=e.parent}throw t}const Lt=new Set;let G=null,fe=null,me=[],Sn=null,sn=!1;class we{committed=!1;current=new Map;previous=new Map;#e=new Set;#t=new Set;#r=0;#n=0;#l=null;#i=new Set;#s=new Set;skipped_effects=new Set;is_fork=!1;is_deferred(){return this.is_fork||this.#n>0}process(e){me=[],this.apply();var n={parent:null,effect:null,effects:[],render_effects:[]};for(const r of e)this.#a(r,n);this.is_fork||this.#f(),this.is_deferred()?(this.#o(n.effects),this.#o(n.render_effects)):(G=null,On(n.render_effects),On(n.effects),this.#l?.resolve()),fe=null}#a(e,n){e.f^=H;for(var r=e.first;r!==null;){var i=r.f,s=(i&($e|Qe))!==0,a=s&&(i&H)!==0,l=a||(i&ie)!==0||this.skipped_effects.has(r);if((r.f&Ht)!==0&&r.b?.is_pending()&&(n={parent:n,effect:r,effects:[],render_effects:[]}),!l&&r.fn!==null){s?r.f^=H:(i&bn)!==0?n.effects.push(r):mt(r)&&((r.f&Pe)!==0&&this.#i.add(r),ht(r));var o=r.first;if(o!==null){r=o;continue}}var c=r.parent;for(r=r.next;r===null&&c!==null;)c===n.effect&&(this.#o(n.effects),this.#o(n.render_effects),n=n.parent),r=c.next,c=c.parent}}#o(e){for(const n of e)(n.f&ne)!==0?this.#i.add(n):(n.f&pe)!==0&&this.#s.add(n),this.#c(n.deps),V(n,H)}#c(e){if(e!==null)for(const n of e)(n.f&K)===0||(n.f&Ke)===0||(n.f^=Ke,this.#c(n.deps))}capture(e,n){this.previous.has(e)||this.previous.set(e,n),(e.f&ze)===0&&(this.current.set(e,e.v),fe?.set(e,e.v))}activate(){G=this,this.apply()}deactivate(){G===this&&(G=null,fe=null)}flush(){if(this.activate(),me.length>0){if(Ss(),G!==null&&G!==this)return}else this.#r===0&&this.process([]);this.deactivate()}discard(){for(const e of this.#t)e(this);this.#t.clear()}#f(){if(this.#n===0){for(const e of this.#e)e();this.#e.clear()}this.#r===0&&this.#u()}#u(){if(Lt.size>1){this.previous.clear();var e=fe,n=!0,r={parent:null,effect:null,effects:[],render_effects:[]};for(const s of Lt){if(s===this){n=!1;continue}const a=[];for(const[o,c]of this.current){if(s.current.has(o))if(n&&c!==s.current.get(o))s.current.set(o,c);else continue;a.push(o)}if(a.length===0)continue;const l=[...s.current.keys()].filter(o=>!this.current.has(o));if(l.length>0){var i=me;me=[];const o=new Set,c=new Map;for(const f of a)ar(f,l,o,c);if(me.length>0){G=s,s.apply();for(const f of me)s.#a(f,r);s.deactivate()}me=i}}G=null,fe=e}this.committed=!0,Lt.delete(this)}increment(e){this.#r+=1,e&&(this.#n+=1)}decrement(e){this.#r-=1,e&&(this.#n-=1),this.revive()}revive(){for(const e of this.#i)this.#s.delete(e),V(e,ne),Je(e);for(const e of this.#s)V(e,pe),Je(e);this.flush()}oncommit(e){this.#e.add(e)}ondiscard(e){this.#t.add(e)}settled(){return(this.#l??=Jn()).promise}static ensure(){if(G===null){const e=G=new we;Lt.add(G),we.enqueue(()=>{G===e&&e.flush()})}return G}static enqueue(e){_t(e)}apply(){}}function Ss(){var t=We;sn=!0;var e=null;try{var n=0;for(zt(!0);me.length>0;){var r=we.ensure();if(n++>1e3){var i,s;xs()}r.process(me),Ye.clear()}}finally{sn=!1,zt(t),Sn=null}}function xs(){try{es()}catch(t){ut(t,Sn)}}let Ce=null;function On(t){var e=t.length;if(e!==0){for(var n=0;n<e;){var r=t[n++];if((r.f&(De|ie))===0&&mt(r)&&(Ce=new Set,ht(r),r.deps===null&&r.first===null&&r.nodes===null&&(r.teardown===null&&r.ac===null?yr(r):r.fn=null),Ce?.size>0)){Ye.clear();for(const i of Ce){if((i.f&(De|ie))!==0)continue;const s=[i];let a=i.parent;for(;a!==null;)Ce.has(a)&&(Ce.delete(a),s.push(a)),a=a.parent;for(let l=s.length-1;l>=0;l--){const o=s[l];(o.f&(De|ie))===0&&ht(o)}}Ce.clear()}}Ce=null}}function ar(t,e,n,r){if(!n.has(t)&&(n.add(t),t.reactions!==null))for(const i of t.reactions){const s=i.f;(s&K)!==0?ar(i,e,n,r):(s&(yn|Pe))!==0&&(s&ne)===0&&or(i,e,r)&&(V(i,ne),Je(i))}}function or(t,e,n){const r=n.get(t);if(r!==void 0)return r;if(t.deps!==null)for(const i of t.deps){if(e.includes(i))return!0;if((i.f&K)!==0&&or(i,e,n))return n.set(i,!0),!0}return n.set(t,!1),!1}function Je(t){for(var e=Sn=t;e.parent!==null;){e=e.parent;var n=e.f;if(sn&&e===O&&(n&Pe)!==0&&(n&Zn)===0)return;if((n&(Qe|$e))!==0){if((n&H)===0)return;e.f^=H}}me.push(e)}function Es(t){let e=0,n=Ze(0),r;return()=>{kt()&&(v(n),Kt(()=>(e===0&&(r=N(()=>t(()=>Mt(n)))),e+=1,()=>{_t(()=>{e-=1,e===0&&(r?.(),r=void 0,Mt(n))})})))}}var Ms=Ve|pt|Ht;function Cs(t,e,n){new ks(t,e,n)}class ks{parent;#e=!1;#t;#r=null;#n;#l;#i;#s=null;#a=null;#o=null;#c=null;#f=null;#u=0;#d=0;#v=!1;#h=null;#b=Es(()=>(this.#h=Ze(this.#u),()=>{this.#h=null}));constructor(e,n,r){this.#t=e,this.#n=n,this.#l=r,this.parent=O.b,this.#e=!!this.#n.pending,this.#i=Jt(()=>{O.b=this;{var i=this.#_();try{this.#s=ce(()=>r(i))}catch(s){this.error(s)}this.#d>0?this.#g():this.#e=!1}return()=>{this.#f?.remove()}},Ms)}#w(){try{this.#s=ce(()=>this.#l(this.#t))}catch(e){this.error(e)}this.#e=!1}#y(){const e=this.#n.pending;e&&(this.#a=ce(()=>e(this.#t)),we.enqueue(()=>{var n=this.#_();this.#s=this.#p(()=>(we.ensure(),ce(()=>this.#l(n)))),this.#d>0?this.#g():(Xe(this.#a,()=>{this.#a=null}),this.#e=!1)}))}#_(){var e=this.#t;return this.#e&&(this.#f=je(),this.#t.before(this.#f),e=this.#f),e}is_pending(){return this.#e||!!this.parent&&this.parent.is_pending()}has_pending_snippet(){return!!this.#n.pending}#p(e){var n=O,r=I,i=B;Se(this.#i),ee(this.#i),ft(this.#i.ctx);try{return e()}catch(s){return ir(s),null}finally{Se(n),ee(r),ft(i)}}#g(){const e=this.#n.pending;this.#s!==null&&(this.#c=document.createDocumentFragment(),this.#c.append(this.#f),Er(this.#s,this.#c)),this.#a===null&&(this.#a=ce(()=>e(this.#t)))}#m(e){if(!this.has_pending_snippet()){this.parent&&this.parent.#m(e);return}this.#d+=e,this.#d===0&&(this.#e=!1,this.#a&&Xe(this.#a,()=>{this.#a=null}),this.#c&&(this.#t.before(this.#c),this.#c=null))}update_pending_count(e){this.#m(e),this.#u+=e,this.#h&&dt(this.#h,this.#u)}get_effect_pending(){return this.#b(),v(this.#h)}error(e){var n=this.#n.onerror;let r=this.#n.failed;if(this.#v||!n&&!r)throw e;this.#s&&(te(this.#s),this.#s=null),this.#a&&(te(this.#a),this.#a=null),this.#o&&(te(this.#o),this.#o=null);var i=!1,s=!1;const a=()=>{if(i){ms();return}i=!0,s&&is(),we.ensure(),this.#u=0,this.#o!==null&&Xe(this.#o,()=>{this.#o=null}),this.#e=this.has_pending_snippet(),this.#s=this.#p(()=>(this.#v=!1,ce(()=>this.#l(this.#t)))),this.#d>0?this.#g():this.#e=!1};var l=I;try{ee(null),s=!0,n?.(e,a),s=!1}catch(o){ut(o,this.#i&&this.#i.parent)}finally{ee(l)}r&&_t(()=>{this.#o=this.#p(()=>{we.ensure(),this.#v=!0;try{return ce(()=>{r(this.#t,()=>e,()=>a)})}catch(o){return ut(o,this.#i.parent),null}finally{this.#v=!1}})})}}function As(t,e,n,r){const i=It()?Vt:xn;if(n.length===0&&t.length===0){r(e.map(i));return}var s=G,a=O,l=Ds();function o(){Promise.all(n.map(c=>Ts(c))).then(c=>{l();try{r([...e.map(i),...c])}catch(f){(a.f&De)===0&&ut(f,a)}s?.deactivate(),Gt()}).catch(c=>{ut(c,a)})}t.length>0?Promise.all(t).then(()=>{l();try{return o()}finally{s?.deactivate(),Gt()}}):o()}function Ds(){var t=O,e=I,n=B,r=G;return function(s=!0){Se(t),ee(e),ft(n),s&&r?.activate()}}function Gt(){Se(null),ee(null),ft(null)}function Vt(t){var e=K|ne,n=I!==null&&(I.f&K)!==0?I:null;return O!==null&&(O.f|=pt),{ctx:B,deps:null,effects:null,equals:nr,f:e,fn:t,reactions:null,rv:0,v:J,wv:0,parent:n??O,ac:null}}function Ts(t,e){let n=O;n===null&&Kr();var r=n.b,i=void 0,s=Ze(J),a=!I,l=new Map;return Bs(()=>{var o=Jn();i=o.promise;try{Promise.resolve(t()).then(o.resolve,o.reject).then(()=>{c===G&&c.committed&&c.deactivate(),Gt()})}catch(d){o.reject(d),Gt()}var c=G;if(a){var f=!r.is_pending();r.update_pending_count(1),c.increment(f),l.get(c)?.reject(it),l.delete(c),l.set(c,o)}const u=(d,h=void 0)=>{if(c.activate(),h)h!==it&&(s.f|=ze,dt(s,h));else{(s.f&ze)!==0&&(s.f^=ze),dt(s,d);for(const[g,m]of l){if(l.delete(g),g===c)break;m.reject(it)}}a&&(r.update_pending_count(-1),c.decrement(f))};o.promise.then(u,d=>u(null,d||"unknown"))}),Cn(()=>{for(const o of l.values())o.reject(it)}),new Promise(o=>{function c(f){function u(){f===i?o(s):c(i)}f.then(u,u)}c(i)})}function xn(t){const e=Vt(t);return e.equals=sr,e}function lr(t){var e=t.effects;if(e!==null){t.effects=null;for(var n=0;n<e.length;n+=1)te(e[n])}}function Is(t){for(var e=t.parent;e!==null;){if((e.f&K)===0)return(e.f&De)===0?e:null;e=e.parent}return null}function En(t){var e,n=O;Se(Is(t));try{t.f&=~Ke,lr(t),e=Ar(t)}finally{Se(n)}return e}function cr(t){var e=En(t);if(t.equals(e)||(G?.is_fork||(t.v=e),t.wv=Cr()),!nt)if(fe!==null)(kt()||G?.is_fork)&&fe.set(t,e);else{var n=(t.f&ve)===0?pe:H;V(t,n)}}let an=new Set;const Ye=new Map;let fr=!1;function Ze(t,e){var n={f:0,v:t,reactions:null,equals:nr,rv:0,wv:0};return n}function Me(t,e){const n=Ze(t);return zs(n),n}function se(t,e=!1,n=!0){const r=Ze(t);return e||(r.equals=sr),gt&&n&&B!==null&&B.l!==null&&(B.l.s??=[]).push(r),r}function Ne(t,e){return F(t,N(()=>v(t))),e}function F(t,e,n=!1){I!==null&&(!ye||(I.f&Ln)!==0)&&It()&&(I.f&(K|Pe|yn|Ln))!==0&&!Te?.includes(t)&&ss();let r=n?ot(e):e;return dt(t,r)}function dt(t,e){if(!t.equals(e)){var n=t.v;nt?Ye.set(t,e):Ye.set(t,n),t.v=e;var r=we.ensure();r.capture(t,n),(t.f&K)!==0&&((t.f&ne)!==0&&En(t),V(t,(t.f&ve)!==0?H:pe)),t.wv=Cr(),ur(t,ne),It()&&O!==null&&(O.f&H)!==0&&(O.f&($e|Qe))===0&&(le===null?Ys([t]):le.push(t)),!r.is_fork&&an.size>0&&!fr&&Ps()}return e}function Ps(){fr=!1;var t=We;zt(!0);const e=Array.from(an);try{for(const n of e)(n.f&H)!==0&&V(n,pe),mt(n)&&ht(n)}finally{zt(t)}an.clear()}function Mt(t){F(t,t.v+1)}function ur(t,e){var n=t.reactions;if(n!==null)for(var r=It(),i=n.length,s=0;s<i;s++){var a=n[s],l=a.f;if(!(!r&&a===O)){var o=(l&ne)===0;if(o&&V(a,e),(l&K)!==0){var c=a;fe?.delete(c),(l&Ke)===0&&(l&ve&&(a.f|=Ke),ur(c,pe))}else o&&((l&Pe)!==0&&Ce!==null&&Ce.add(a),Je(a))}}}function ot(t){if(typeof t!="object"||t===null||Ue in t)return t;const e=mn(t);if(e!==qr&&e!==Ur)return t;var n=new Map,r=Hn(t),i=Me(0),s=He,a=l=>{if(He===s)return l();var o=I,c=He;ee(null),Bn(s);var f=l();return ee(o),Bn(c),f};return r&&n.set("length",Me(t.length)),new Proxy(t,{defineProperty(l,o,c){(!("value"in c)||c.configurable===!1||c.enumerable===!1||c.writable===!1)&&ns();var f=n.get(o);return f===void 0?f=a(()=>{var u=Me(c.value);return n.set(o,u),u}):F(f,c.value,!0),!0},deleteProperty(l,o){var c=n.get(o);if(c===void 0){if(o in l){const f=a(()=>Me(J));n.set(o,f),Mt(i)}}else F(c,J),Mt(i);return!0},get(l,o,c){if(o===Ue)return t;var f=n.get(o),u=o in l;if(f===void 0&&(!u||lt(l,o)?.writable)&&(f=a(()=>{var h=ot(u?l[o]:J),g=Me(h);return g}),n.set(o,f)),f!==void 0){var d=v(f);return d===J?void 0:d}return Reflect.get(l,o,c)},getOwnPropertyDescriptor(l,o){var c=Reflect.getOwnPropertyDescriptor(l,o);if(c&&"value"in c){var f=n.get(o);f&&(c.value=v(f))}else if(c===void 0){var u=n.get(o),d=u?.v;if(u!==void 0&&d!==J)return{enumerable:!0,configurable:!0,value:d,writable:!0}}return c},has(l,o){if(o===Ue)return!0;var c=n.get(o),f=c!==void 0&&c.v!==J||Reflect.has(l,o);if(c!==void 0||O!==null&&(!f||lt(l,o)?.writable)){c===void 0&&(c=a(()=>{var d=f?ot(l[o]):J,h=Me(d);return h}),n.set(o,c));var u=v(c);if(u===J)return!1}return f},set(l,o,c,f){var u=n.get(o),d=o in l;if(r&&o==="length")for(var h=c;h<u.v;h+=1){var g=n.get(h+"");g!==void 0?F(g,J):h in l&&(g=a(()=>Me(J)),n.set(h+"",g))}if(u===void 0)(!d||lt(l,o)?.writable)&&(u=a(()=>Me(void 0)),F(u,ot(c)),n.set(o,u));else{d=u.v!==J;var m=a(()=>ot(c));F(u,m)}var p=Reflect.getOwnPropertyDescriptor(l,o);if(p?.set&&p.set.call(f,c),!d){if(r&&typeof o=="string"){var b=n.get("length"),D=Number(o);Number.isInteger(D)&&D>=b.v&&F(b,D+1)}Mt(i)}return!0},ownKeys(l){v(i);var o=Reflect.ownKeys(l).filter(u=>{var d=n.get(u);return d===void 0||d.v!==J});for(var[c,f]of n)f.v!==J&&!(c in l)&&o.push(c);return o},setPrototypeOf(){rs()}})}var Nn,dr,hr,vr;function $s(){if(Nn===void 0){Nn=window,dr=/Firefox/.test(navigator.userAgent);var t=Element.prototype,e=Node.prototype,n=Text.prototype;hr=lt(e,"firstChild").get,vr=lt(e,"nextSibling").get,Rn(t)&&(t.__click=void 0,t.__className=void 0,t.__attributes=null,t.__style=void 0,t.__e=void 0),Rn(n)&&(n.__t=void 0)}}function je(t=""){return document.createTextNode(t)}function Ge(t){return hr.call(t)}function Pt(t){return vr.call(t)}function w(t,e){return Ge(t)}function ct(t,e=!1){{var n=Ge(t);return n instanceof Comment&&n.data===""?Pt(n):n}}function E(t,e=1,n=!1){let r=t;for(;e--;)r=Pt(r);return r}function Rs(t){t.textContent=""}function pr(){return!1}function Mn(t){var e=I,n=O;ee(null),Se(null);try{return t()}finally{ee(e),Se(n)}}function gr(t){O===null&&(I===null&&Qr(),Zr()),nt&&Jr()}function Ls(t,e){var n=e.last;n===null?e.last=e.first=t:(n.next=t,t.prev=n,e.last=t)}function xe(t,e,n){var r=O;r!==null&&(r.f&ie)!==0&&(t|=ie);var i={ctx:B,deps:null,nodes:null,f:t|ne|ve,first:null,fn:e,last:null,next:null,parent:r,b:r&&r.b,prev:null,teardown:null,wv:0,ac:null};if(n)try{ht(i),i.f|=wn}catch(l){throw te(i),l}else e!==null&&Je(i);var s=i;if(n&&s.deps===null&&s.teardown===null&&s.nodes===null&&s.first===s.last&&(s.f&pt)===0&&(s=s.first,(t&Pe)!==0&&(t&Ve)!==0&&s!==null&&(s.f|=Ve)),s!==null&&(s.parent=r,r!==null&&Ls(s,r),I!==null&&(I.f&K)!==0&&(t&Qe)===0)){var a=I;(a.effects??=[]).push(s)}return i}function kt(){return I!==null&&!ye}function Cn(t){const e=xe(Wt,null,!1);return V(e,H),e.teardown=t,e}function on(t){gr();var e=O.f,n=!I&&(e&$e)!==0&&(e&wn)===0;if(n){var r=B;(r.e??=[]).push(t)}else return _r(t)}function _r(t){return xe(bn|Qn,t,!1)}function Os(t){return gr(),xe(Wt|Qn,t,!0)}function Ns(t){we.ensure();const e=xe(Qe|pt,t,!0);return(n={})=>new Promise(r=>{n.outro?Xe(e,()=>{te(e),r(void 0)}):(te(e),r(void 0))})}function Fs(t){return xe(bn,t,!1)}function Be(t,e){var n=B,r={effect:null,ran:!1,deps:t};n.l.$.push(r),r.effect=Kt(()=>{t(),!r.ran&&(r.ran=!0,N(e))})}function kn(){var t=B;Kt(()=>{for(var e of t.l.$){e.deps();var n=e.effect;(n.f&H)!==0&&V(n,pe),mt(n)&&ht(n),e.ran=!1}})}function Bs(t){return xe(yn|pt,t,!0)}function Kt(t,e=0){return xe(Wt|e,t,!0)}function X(t,e=[],n=[],r=[]){As(r,e,n,i=>{xe(Wt,()=>t(...i.map(v)),!0)})}function Jt(t,e=0){var n=xe(Pe|e,t,!0);return n}function ce(t){return xe($e|pt,t,!0)}function mr(t){var e=t.teardown;if(e!==null){const n=nt,r=I;Fn(!0),ee(null);try{e.call(null)}finally{Fn(n),ee(r)}}}function br(t,e=!1){var n=t.first;for(t.first=t.last=null;n!==null;){const i=n.ac;i!==null&&Mn(()=>{i.abort(it)});var r=n.next;(n.f&Qe)!==0?n.parent=null:te(n,e),n=r}}function Gs(t){for(var e=t.first;e!==null;){var n=e.next;(e.f&$e)===0&&te(e),e=n}}function te(t,e=!0){var n=!1;(e||(t.f&Zn)!==0)&&t.nodes!==null&&t.nodes.end!==null&&(wr(t.nodes.start,t.nodes.end),n=!0),br(t,e&&!n),Yt(t,0),V(t,De);var r=t.nodes&&t.nodes.t;if(r!==null)for(const s of r)s.stop();mr(t);var i=t.parent;i!==null&&i.first!==null&&yr(t),t.next=t.prev=t.teardown=t.ctx=t.deps=t.fn=t.nodes=t.ac=null}function wr(t,e){for(;t!==null;){var n=t===e?null:Pt(t);t.remove(),t=n}}function yr(t){var e=t.parent,n=t.prev,r=t.next;n!==null&&(n.next=r),r!==null&&(r.prev=n),e!==null&&(e.first===t&&(e.first=r),e.last===t&&(e.last=n))}function Xe(t,e,n=!0){var r=[];Sr(t,r,!0);var i=()=>{n&&te(t),e&&e()},s=r.length;if(s>0){var a=()=>--s||i();for(var l of r)l.out(a)}else i()}function Sr(t,e,n){if((t.f&ie)===0){t.f^=ie;var r=t.nodes&&t.nodes.t;if(r!==null)for(const l of r)(l.is_global||n)&&e.push(l);for(var i=t.first;i!==null;){var s=i.next,a=(i.f&Ve)!==0||(i.f&$e)!==0&&(t.f&Pe)!==0;Sr(i,e,a?n:!1),i=s}}}function An(t){xr(t,!0)}function xr(t,e){if((t.f&ie)!==0){t.f^=ie,(t.f&H)===0&&(V(t,ne),Je(t));for(var n=t.first;n!==null;){var r=n.next,i=(n.f&Ve)!==0||(n.f&$e)!==0;xr(n,i?e:!1),n=r}var s=t.nodes&&t.nodes.t;if(s!==null)for(const a of s)(a.is_global||e)&&a.in()}}function Er(t,e){if(t.nodes)for(var n=t.nodes.start,r=t.nodes.end;n!==null;){var i=n===r?null:Pt(n);e.append(n),n=i}}let We=!1;function zt(t){We=t}let nt=!1;function Fn(t){nt=t}let I=null,ye=!1;function ee(t){I=t}let O=null;function Se(t){O=t}let Te=null;function zs(t){I!==null&&(Te===null?Te=[t]:Te.push(t))}let Q=null,re=0,le=null;function Ys(t){le=t}let Mr=1,At=0,He=At;function Bn(t){He=t}function Cr(){return++Mr}function mt(t){var e=t.f;if((e&ne)!==0)return!0;if(e&K&&(t.f&=~Ke),(e&pe)!==0){var n=t.deps;if(n!==null)for(var r=n.length,i=0;i<r;i++){var s=n[i];if(mt(s)&&cr(s),s.wv>t.wv)return!0}(e&ve)!==0&&fe===null&&V(t,H)}return!1}function kr(t,e,n=!0){var r=t.reactions;if(r!==null&&!Te?.includes(t))for(var i=0;i<r.length;i++){var s=r[i];(s.f&K)!==0?kr(s,e,!1):e===s&&(n?V(s,ne):(s.f&H)!==0&&V(s,pe),Je(s))}}function Ar(t){var e=Q,n=re,r=le,i=I,s=Te,a=B,l=ye,o=He,c=t.f;Q=null,re=0,le=null,I=(c&($e|Qe))===0?t:null,Te=null,ft(t.ctx),ye=!1,He=++At,t.ac!==null&&(Mn(()=>{t.ac.abort(it)}),t.ac=null);try{t.f|=rn;var f=t.fn,u=f(),d=t.deps;if(Q!==null){var h;if(Yt(t,re),d!==null&&re>0)for(d.length=re+Q.length,h=0;h<Q.length;h++)d[re+h]=Q[h];else t.deps=d=Q;if(kt()&&(t.f&ve)!==0)for(h=re;h<d.length;h++)(d[h].reactions??=[]).push(t)}else d!==null&&re<d.length&&(Yt(t,re),d.length=re);if(It()&&le!==null&&!ye&&d!==null&&(t.f&(K|pe|ne))===0)for(h=0;h<le.length;h++)kr(le[h],t);return i!==null&&i!==t&&(At++,le!==null&&(r===null?r=le:r.push(...le))),(t.f&ze)!==0&&(t.f^=ze),u}catch(g){return ir(g)}finally{t.f^=rn,Q=e,re=n,le=r,I=i,Te=s,ft(a),ye=l,He=o}}function js(t,e){let n=e.reactions;if(n!==null){var r=jr.call(n,t);if(r!==-1){var i=n.length-1;i===0?n=e.reactions=null:(n[r]=n[i],n.pop())}}n===null&&(e.f&K)!==0&&(Q===null||!Q.includes(e))&&(V(e,pe),(e.f&ve)!==0&&(e.f^=ve,e.f&=~Ke),lr(e),Yt(e,0))}function Yt(t,e){var n=t.deps;if(n!==null)for(var r=e;r<n.length;r++)js(t,n[r])}function ht(t){var e=t.f;if((e&De)===0){V(t,H);var n=O,r=We;O=t,We=!0;try{(e&(Pe|Wr))!==0?Gs(t):br(t),mr(t);var i=Ar(t);t.teardown=typeof i=="function"?i:null,t.wv=Mr;var s;nn&&bs&&(t.f&ne)!==0&&t.deps}finally{We=r,O=n}}}function v(t){var e=t.f,n=(e&K)!==0;if(I!==null&&!ye){var r=O!==null&&(O.f&De)!==0;if(!r&&!Te?.includes(t)){var i=I.deps;if((I.f&rn)!==0)t.rv<At&&(t.rv=At,Q===null&&i!==null&&i[re]===t?re++:Q===null?Q=[t]:Q.includes(t)||Q.push(t));else{(I.deps??=[]).push(t);var s=t.reactions;s===null?t.reactions=[I]:s.includes(I)||s.push(I)}}}if(nt){if(Ye.has(t))return Ye.get(t);if(n){var a=t,l=a.v;return((a.f&H)===0&&a.reactions!==null||Tr(a))&&(l=En(a)),Ye.set(a,l),l}}else n&&(!fe?.has(t)||G?.is_fork&&!kt())&&(a=t,mt(a)&&cr(a),We&&kt()&&(a.f&ve)===0&&Dr(a));if(fe?.has(t))return fe.get(t);if((t.f&ze)!==0)throw t.v;return t.v}function Dr(t){if(t.deps!==null){t.f^=ve;for(const e of t.deps)(e.reactions??=[]).push(t),(e.f&K)!==0&&(e.f&ve)===0&&Dr(e)}}function Tr(t){if(t.v===J)return!0;if(t.deps===null)return!1;for(const e of t.deps)if(Ye.has(e)||(e.f&K)!==0&&Tr(e))return!0;return!1}function N(t){var e=ye;try{return ye=!0,t()}finally{ye=e}}const qs=-7169;function V(t,e){t.f=t.f&qs|e}function Us(t){if(!(typeof t!="object"||!t||t instanceof EventTarget)){if(Ue in t)ln(t);else if(!Array.isArray(t))for(let e in t){const n=t[e];typeof n=="object"&&n&&Ue in n&&ln(n)}}}function ln(t,e=new Set){if(typeof t=="object"&&t!==null&&!(t instanceof EventTarget)&&!e.has(t)){e.add(t),t instanceof Date&&t.getTime();for(let r in t)try{ln(t[r],e)}catch{}const n=mn(t);if(n!==Object.prototype&&n!==Array.prototype&&n!==Map.prototype&&n!==Set.prototype&&n!==Date.prototype){const r=Kn(n);for(let i in r){const s=r[i].get;if(s)try{s.call(t)}catch{}}}}}const Xs=["touchstart","touchmove"];function Ws(t){return Xs.includes(t)}const Ir=new Set,cn=new Set;function Hs(t,e,n,r={}){function i(s){if(r.capture||xt.call(e,s),!s.cancelBubble)return Mn(()=>n?.call(this,s))}return t.startsWith("pointer")||t.startsWith("touch")||t==="wheel"?_t(()=>{e.addEventListener(t,i,r)}):e.addEventListener(t,i,r),i}function Vs(t,e,n,r,i){var s={capture:r,passive:i},a=Hs(t,e,n,s);(e===document.body||e===window||e===document||e instanceof HTMLMediaElement)&&Cn(()=>{e.removeEventListener(t,a,s)})}function Zt(t){for(var e=0;e<t.length;e++)Ir.add(t[e]);for(var n of cn)n(t)}let Gn=null;function xt(t){var e=this,n=e.ownerDocument,r=t.type,i=t.composedPath?.()||[],s=i[0]||t.target;Gn=t;var a=0,l=Gn===t&&t.__root;if(l){var o=i.indexOf(l);if(o!==-1&&(e===document||e===window)){t.__root=e;return}var c=i.indexOf(e);if(c===-1)return;o<=c&&(a=o)}if(s=i[a]||t.target,s!==e){Vn(t,"currentTarget",{configurable:!0,get(){return s||n}});var f=I,u=O;ee(null),Se(null);try{for(var d,h=[];s!==null;){var g=s.assignedSlot||s.parentNode||s.host||null;try{var m=s["__"+r];m!=null&&(!s.disabled||t.target===s)&&m.call(s,t)}catch(p){d?h.push(p):d=p}if(t.cancelBubble||g===e||g===null)break;s=g}if(d){for(let p of h)queueMicrotask(()=>{throw p});throw d}}finally{t.__root=e,delete t.currentTarget,ee(f),Se(u)}}}function Pr(t){var e=document.createElement("template");return e.innerHTML=t.replaceAll("<!>","<!---->"),e.content}function jt(t,e){var n=O;n.nodes===null&&(n.nodes={start:t,end:e,a:null,t:null})}function R(t,e){var n=(e&ps)!==0,r=(e&gs)!==0,i,s=!t.startsWith("<!>");return()=>{i===void 0&&(i=Pr(s?t:"<!>"+t),n||(i=Ge(i)));var a=r||dr?document.importNode(i,!0):i.cloneNode(!0);if(n){var l=Ge(a),o=a.lastChild;jt(l,o)}else jt(a,a);return a}}function zn(){var t=document.createDocumentFragment(),e=document.createComment(""),n=je();return t.append(e,n),jt(e,n),t}function T(t,e){t!==null&&t.before(e)}function j(t,e){var n=e==null?"":typeof e=="object"?e+"":e;n!==(t.__t??=t.nodeValue)&&(t.__t=n,t.nodeValue=n+"")}function Ks(t,e){return Js(t,e)}const rt=new Map;function Js(t,{target:e,anchor:n,props:r={},events:i,context:s,intro:a=!0}){$s();var l=new Set,o=u=>{for(var d=0;d<u.length;d++){var h=u[d];if(!l.has(h)){l.add(h);var g=Ws(h);e.addEventListener(h,xt,{passive:g});var m=rt.get(h);m===void 0?(document.addEventListener(h,xt,{passive:g}),rt.set(h,1)):rt.set(h,m+1)}}};o(Xt(Ir)),cn.add(o);var c=void 0,f=Ns(()=>{var u=n??e.appendChild(je());return Cs(u,{pending:()=>{}},d=>{if(s){et({});var h=B;h.c=s}i&&(r.$$events=i),c=t(d,r)||{},s&&tt()}),()=>{for(var d of l){e.removeEventListener(d,xt);var h=rt.get(d);--h===0?(document.removeEventListener(d,xt),rt.delete(d)):rt.set(d,h)}cn.delete(o),u!==n&&u.parentNode?.removeChild(u)}});return Zs.set(c,f),c}let Zs=new WeakMap;class $r{anchor;#e=new Map;#t=new Map;#r=new Map;#n=new Set;#l=!0;constructor(e,n=!0){this.anchor=e,this.#l=n}#i=()=>{var e=G;if(this.#e.has(e)){var n=this.#e.get(e),r=this.#t.get(n);if(r)An(r),this.#n.delete(n);else{var i=this.#r.get(n);i&&(this.#t.set(n,i.effect),this.#r.delete(n),i.fragment.lastChild.remove(),this.anchor.before(i.fragment),r=i.effect)}for(const[s,a]of this.#e){if(this.#e.delete(s),s===e)break;const l=this.#r.get(a);l&&(te(l.effect),this.#r.delete(a))}for(const[s,a]of this.#t){if(s===n||this.#n.has(s))continue;const l=()=>{if(Array.from(this.#e.values()).includes(s)){var c=document.createDocumentFragment();Er(a,c),c.append(je()),this.#r.set(s,{effect:a,fragment:c})}else te(a);this.#n.delete(s),this.#t.delete(s)};this.#l||!r?(this.#n.add(s),Xe(a,l,!1)):l()}}};#s=e=>{this.#e.delete(e);const n=Array.from(this.#e.values());for(const[r,i]of this.#r)n.includes(r)||(te(i.effect),this.#r.delete(r))};ensure(e,n){var r=G,i=pr();if(n&&!this.#t.has(e)&&!this.#r.has(e))if(i){var s=document.createDocumentFragment(),a=je();s.append(a),this.#r.set(e,{effect:ce(()=>n(a)),fragment:s})}else this.#t.set(e,ce(()=>n(this.anchor)));if(this.#e.set(r,e),i){for(const[l,o]of this.#t)l===e?r.skipped_effects.delete(o):r.skipped_effects.add(o);for(const[l,o]of this.#r)l===e?r.skipped_effects.delete(o.effect):r.skipped_effects.add(o.effect);r.oncommit(this.#i),r.ondiscard(this.#s)}else this.#i()}}function de(t,e,n=!1){var r=new $r(t),i=n?Ve:0;function s(a,l){r.ensure(a,l)}Jt(()=>{var a=!1;e((l,o=!0)=>{a=!0,s(o,l)}),a||s(!1,null)},i)}function qt(t,e){return e}function Qs(t,e,n){for(var r=[],i=e.length,s,a=e.length,l=0;l<i;l++){let u=e[l];Xe(u,()=>{if(s){if(s.pending.delete(u),s.done.add(u),s.pending.size===0){var d=t.outrogroups;fn(Xt(s.done)),d.delete(s),d.size===0&&(t.outrogroups=null)}}else a-=1},!1)}if(a===0){var o=r.length===0&&n!==null;if(o){var c=n,f=c.parentNode;Rs(f),f.append(c),t.items.clear()}fn(e,!o)}else s={pending:new Set(e),done:new Set},(t.outrogroups??=new Set).add(s)}function fn(t,e=!0){for(var n=0;n<t.length;n++)te(t[n],e)}var Yn;function Dt(t,e,n,r,i,s=null){var a=t,l=new Map,o=(e&tr)!==0;if(o){var c=t;a=c.appendChild(je())}var f=null,u=xn(()=>{var b=n();return Hn(b)?b:b==null?[]:Xt(b)}),d,h=!0;function g(){p.fallback=f,ei(p,d,a,e,r),f!==null&&(d.length===0?(f.f&ke)===0?An(f):(f.f^=ke,Et(f,null,a)):Xe(f,()=>{f=null}))}var m=Jt(()=>{d=v(u);for(var b=d.length,D=new Set,x=G,k=pr(),M=0;M<b;M+=1){var _=d[M],y=r(_,M),S=h?null:l.get(y);S?(S.v&&dt(S.v,_),S.i&&dt(S.i,M),k&&x.skipped_effects.delete(S.e)):(S=ti(l,h?a:Yn??=je(),_,y,M,i,e,n),h||(S.e.f|=ke),l.set(y,S)),D.add(y)}if(b===0&&s&&!f&&(h?f=ce(()=>s(a)):(f=ce(()=>s(Yn??=je())),f.f|=ke)),!h)if(k){for(const[P,A]of l)D.has(P)||x.skipped_effects.add(A.e);x.oncommit(g),x.ondiscard(()=>{})}else g();v(u)}),p={effect:m,items:l,outrogroups:null,fallback:f};h=!1}function ei(t,e,n,r,i){var s=(r&ls)!==0,a=e.length,l=t.items,o=t.effect.first,c,f=null,u,d=[],h=[],g,m,p,b;if(s)for(b=0;b<a;b+=1)g=e[b],m=i(g,b),p=l.get(m).e,(p.f&ke)===0&&(p.nodes?.a?.measure(),(u??=new Set).add(p));for(b=0;b<a;b+=1){if(g=e[b],m=i(g,b),p=l.get(m).e,t.outrogroups!==null)for(const A of t.outrogroups)A.pending.delete(p),A.done.delete(p);if((p.f&ke)!==0)if(p.f^=ke,p===o)Et(p,null,n);else{var D=f?f.next:o;p===t.effect.last&&(t.effect.last=p.prev),p.prev&&(p.prev.next=p.next),p.next&&(p.next.prev=p.prev),Fe(t,f,p),Fe(t,p,D),Et(p,D,n),f=p,d=[],h=[],o=f.next;continue}if((p.f&ie)!==0&&(An(p),s&&(p.nodes?.a?.unfix(),(u??=new Set).delete(p))),p!==o){if(c!==void 0&&c.has(p)){if(d.length<h.length){var x=h[0],k;f=x.prev;var M=d[0],_=d[d.length-1];for(k=0;k<d.length;k+=1)Et(d[k],x,n);for(k=0;k<h.length;k+=1)c.delete(h[k]);Fe(t,M.prev,_.next),Fe(t,f,M),Fe(t,_,x),o=x,f=_,b-=1,d=[],h=[]}else c.delete(p),Et(p,o,n),Fe(t,p.prev,p.next),Fe(t,p,f===null?t.effect.first:f.next),Fe(t,f,p),f=p;continue}for(d=[],h=[];o!==null&&o!==p;)(c??=new Set).add(o),h.push(o),o=o.next;if(o===null)continue}(p.f&ke)===0&&d.push(p),f=p,o=p.next}if(t.outrogroups!==null){for(const A of t.outrogroups)A.pending.size===0&&(fn(Xt(A.done)),t.outrogroups?.delete(A));t.outrogroups.size===0&&(t.outrogroups=null)}if(o!==null||c!==void 0){var y=[];if(c!==void 0)for(p of c)(p.f&ie)===0&&y.push(p);for(;o!==null;)(o.f&ie)===0&&o!==t.fallback&&y.push(o),o=o.next;var S=y.length;if(S>0){var P=(r&tr)!==0&&a===0?n:null;if(s){for(b=0;b<S;b+=1)y[b].nodes?.a?.measure();for(b=0;b<S;b+=1)y[b].nodes?.a?.fix()}Qs(t,y,P)}}s&&_t(()=>{if(u!==void 0)for(p of u)p.nodes?.a?.apply()})}function ti(t,e,n,r,i,s,a,l){var o=(a&as)!==0?(a&cs)===0?se(n,!1,!1):Ze(n):null,c=(a&os)!==0?Ze(i):null;return{v:o,i:c,e:ce(()=>(s(e,o??n,c??i,l),()=>{t.delete(r)}))}}function Et(t,e,n){if(t.nodes)for(var r=t.nodes.start,i=t.nodes.end,s=e&&(e.f&ke)===0?e.nodes.start:n;r!==null;){var a=Pt(r);if(s.before(r),r===i)return;r=a}}function Fe(t,e,n){e===null?t.effect.first=n:e.next=n,n===null?t.effect.last=e:n.prev=e}function ni(t,e,n=!1,r=!1,i=!1){var s=t,a="";X(()=>{var l=O;if(a!==(a=e()??"")&&(l.nodes!==null&&(wr(l.nodes.start,l.nodes.end),l.nodes=null),a!=="")){var o=a+"";n?o=`<svg>${o}</svg>`:r&&(o=`<math>${o}</math>`);var c=Pr(o);if((n||r)&&(c=Ge(c)),jt(Ge(c),c.lastChild),n||r)for(;Ge(c);)s.before(Ge(c));else s.before(c)}})}function ri(t,e,...n){var r=new $r(t);Jt(()=>{const i=e()??null;r.ensure(i,i&&(s=>i(s,...n)))},Ve)}function Rr(t){var e,n,r="";if(typeof t=="string"||typeof t=="number")r+=t;else if(typeof t=="object")if(Array.isArray(t)){var i=t.length;for(e=0;e<i;e++)t[e]&&(n=Rr(t[e]))&&(r&&(r+=" "),r+=n)}else for(n in t)t[n]&&(r&&(r+=" "),r+=n);return r}function si(){for(var t,e,n=0,r="",i=arguments.length;n<i;n++)(t=arguments[n])&&(e=Rr(t))&&(r&&(r+=" "),r+=e);return r}function ii(t){return typeof t=="object"?si(t):t??""}const jn=[...` 	
\r\f \v\uFEFF`];function ai(t,e,n){var r=t==null?"":""+t;if(e&&(r=r?r+" "+e:e),n){for(var i in n)if(n[i])r=r?r+" "+i:i;else if(r.length)for(var s=i.length,a=0;(a=r.indexOf(i,a))>=0;){var l=a+s;(a===0||jn.includes(r[a-1]))&&(l===r.length||jn.includes(r[l]))?r=(a===0?"":r.substring(0,a))+r.substring(l+1):a=l}}return r===""?null:r}function oi(t,e){return t==null?null:String(t)}function he(t,e,n,r,i,s){var a=t.__className;if(a!==n||a===void 0){var l=ai(n,r,s);l==null?t.removeAttribute("class"):t.className=l,t.__className=n}else if(s&&i!==s)for(var o in s){var c=!!s[o];(i==null||c!==!!i[o])&&t.classList.toggle(o,c)}return s}function li(t,e,n,r){var i=t.__style;if(i!==e){var s=oi(e);s==null?t.removeAttribute("style"):t.style.cssText=s,t.__style=e}return r}const ci=Symbol("is custom element"),fi=Symbol("is html");function ui(t,e){var n=Lr(t);n.value===(n.value=e??void 0)||t.value===e&&(e!==0||t.nodeName!=="PROGRESS")||(t.value=e??"")}function Ie(t,e,n,r){var i=Lr(t);i[e]!==(i[e]=n)&&(e==="loading"&&(t[Vr]=n),n==null?t.removeAttribute(e):typeof n!="string"&&di(t).includes(e)?t[e]=n:t.setAttribute(e,n))}function Lr(t){return t.__attributes??={[ci]:t.nodeName.includes("-"),[fi]:t.namespaceURI===_s}}var qn=new Map;function di(t){var e=t.getAttribute("is")||t.nodeName,n=qn.get(e);if(n)return n;qn.set(e,n=[]);for(var r,i=t,s=Element.prototype;s!==i;){r=Kn(i);for(var a in r)r[a].set&&n.push(a);i=mn(i)}return n}function Un(t,e){return t===e||t?.[Ue]===e}function Ut(t={},e,n,r){return Fs(()=>{var i,s;return Kt(()=>{i=s,s=[],N(()=>{t!==n(...s)&&(e(t,...s),i&&Un(n(...i),t)&&e(null,...i))})}),()=>{_t(()=>{s&&Un(n(...s),t)&&e(null,...s)})}}),t}function Qt(t=!1){const e=B,n=e.l.u;if(!n)return;let r=()=>Us(e.s);if(t){let i=0,s={};const a=Vt(()=>{let l=!1;const o=e.s;for(const c in o)o[c]!==s[c]&&(s[c]=o[c],l=!0);return l&&i++,i});r=()=>v(a)}n.b.length&&Os(()=>{Xn(e,r),Bt(n.b)}),on(()=>{const i=N(()=>n.m.map(Xr));return()=>{for(const s of i)typeof s=="function"&&s()}}),n.a.length&&on(()=>{Xn(e,r),Bt(n.a)})}function Xn(t,e){if(t.l.s)for(const n of t.l.s)v(n);e()}function Dn(t,e,n){if(t==null)return e(void 0),n&&n(void 0),Ae;const r=N(()=>t.subscribe(e,n));return r.unsubscribe?()=>r.unsubscribe():r}const st=[];function hi(t,e){return{subscribe:Re(t,e).subscribe}}function Re(t,e=Ae){let n=null;const r=new Set;function i(l){if(rr(t,l)&&(t=l,n)){const o=!st.length;for(const c of r)c[1](),st.push(c,t);if(o){for(let c=0;c<st.length;c+=2)st[c][0](st[c+1]);st.length=0}}}function s(l){i(l(t))}function a(l,o=Ae){const c=[l,o];return r.add(c),r.size===1&&(n=e(i,s)||Ae),l(t),()=>{r.delete(c),r.size===0&&n&&(n(),n=null)}}return{set:i,update:s,subscribe:a}}function Tn(t,e,n){const r=!Array.isArray(t),i=r?[t]:t;if(!i.every(Boolean))throw new Error("derived() expects stores as input, got a falsy value");const s=e.length<2;return hi(n,(a,l)=>{let o=!1;const c=[];let f=0,u=Ae;const d=()=>{if(f)return;u();const g=e(r?c[0]:c,a,l);s?a(g):u=typeof g=="function"?g:Ae},h=i.map((g,m)=>Dn(g,p=>{c[m]=p,f&=~(1<<m),o&&d()},()=>{f|=1<<m}));return o=!0,d(),function(){Bt(h),u(),o=!1}})}function $t(t){let e;return Dn(t,n=>e=n)(),e}let Ot=!1,un=Symbol();function W(t,e,n){const r=n[e]??={store:null,source:se(void 0),unsubscribe:Ae};if(r.store!==t&&!(un in n))if(r.unsubscribe(),r.store=t??null,t==null)r.source.v=void 0,r.unsubscribe=Ae;else{var i=!0;r.unsubscribe=Dn(t,s=>{i?r.source.v=s:F(r.source,s)}),i=!1}return t&&un in n?$t(t):v(r.source)}function Rt(){const t={};function e(){Cn(()=>{for(var n in t)t[n].unsubscribe();Vn(t,un,{enumerable:!1,value:!0})})}return[t,e]}function vi(t){var e=Ot;try{return Ot=!1,[t(),Ot]}finally{Ot=e}}function be(t,e,n,r){var i=!gt||(n&us)!==0,s=(n&hs)!==0,a=(n&vs)!==0,l=r,o=!0,c=()=>(o&&(o=!1,l=a?N(r):r),l),f;if(s){var u=Ue in t||Hr in t;f=lt(t,e)?.set??(u&&e in t?x=>t[e]=x:void 0)}var d,h=!1;s?[d,h]=vi(()=>t[e]):d=t[e],d===void 0&&r!==void 0&&(d=c(),f&&(i&&ts(),f(d)));var g;if(i?g=()=>{var x=t[e];return x===void 0?c():(o=!0,x)}:g=()=>{var x=t[e];return x!==void 0&&(l=void 0),x===void 0?l:x},i&&(n&ds)===0)return g;if(f){var m=t.$$legacy;return(function(x,k){return arguments.length>0?((!i||!k||m||h)&&f(k?g():x),x):g()})}var p=!1,b=((n&fs)!==0?Vt:xn)(()=>(p=!1,g()));s&&v(b);var D=O;return(function(x,k){if(arguments.length>0){const M=k?v(b):i&&s?ot(x):x;return F(b,M),p=!0,l!==void 0&&(l=M),x}return nt&&p||(D.f&De)!==0?b.v:v(b)})}function In(t){B===null&&er(),gt&&B.l!==null?pi(B).m.push(t):on(()=>{const e=N(t);if(typeof e=="function")return e})}function Or(t){B===null&&er(),In(()=>()=>N(t))}function pi(t){var e=t.l;return e.u??={a:[],b:[],m:[]}}const gi="5";typeof window<"u"&&((window.__svelte??={}).v??=new Set).add(gi);ws();class _i{propagator=null;config;currentSeed;isInitialized=!1;wasmModule=null;currentBackend="cpu";gpuAvailable=!1;constructor(e,n){this.config=e,this.currentSeed=n}async initialize(e="cpu"){try{const n=new URL("/autoverse/preview/pr-57/assets/flow_lenia-BW9WIqjN.js",import.meta.url).href;this.wasmModule=await import(n),await this.wasmModule.default(),this.gpuAvailable=await this.checkWebGPU();const r=e==="gpu"&&this.gpuAvailable?"gpu":"cpu";await this.createPropagator(r),this.isInitialized=!0}catch(n){throw new Error(`Failed to initialize WASM: ${n}`)}}async checkWebGPU(){if(typeof navigator>"u"||!("gpu"in navigator))return!1;try{return await navigator.gpu.requestAdapter()!==null}catch{return!1}}async createPropagator(e){if(!this.wasmModule)throw new Error("WASM module not loaded");const n=JSON.stringify(this.config),r=JSON.stringify(this.currentSeed);e==="gpu"&&this.gpuAvailable?(this.propagator=await new this.wasmModule.WasmGpuPropagator(n,r),this.currentBackend="gpu"):(this.propagator=new this.wasmModule.WasmPropagator(n,r),this.currentBackend="cpu")}async switchBackend(e){if(!this.isInitialized)throw new Error("Simulation not initialized");return e==="gpu"&&!this.gpuAvailable?!1:(e===this.currentBackend||await this.createPropagator(e),!0)}isGpuAvailable(){return this.gpuAvailable}getBackend(){return this.currentBackend}async step(){this.ensureInitialized(),this.currentBackend==="gpu"?await this.propagator.step():this.propagator.step()}async run(e){this.ensureInitialized(),this.currentBackend==="gpu"?await this.propagator.run(BigInt(e)):this.propagator.run(BigInt(e))}getState(){return this.ensureInitialized(),this.propagator.getState()}reset(e){this.ensureInitialized(),e&&(this.currentSeed=e),this.propagator.reset(JSON.stringify(this.currentSeed))}totalMass(){return this.ensureInitialized(),this.propagator.totalMass()}getTime(){return this.ensureInitialized(),this.propagator.getTime()}getStep(){return this.ensureInitialized(),this.propagator.getStep()}getWidth(){return this.config.width}getHeight(){return this.config.height}getConfig(){return{...this.config}}extractRegion(e,n,r,i){this.ensureInitialized();const s=this.getState(),a=[];for(let l=0;l<s.channels.length;l++){const o=[];for(let c=0;c<i;c++)for(let f=0;f<r;f++){const u=(e+f)%s.width,h=(n+c)%s.height*s.width+u;o.push(s.channels[l][h])}a.push(o)}return{width:r,height:i,channels:a,sourceX:e,sourceY:n}}placeRegion(e,n,r){this.ensureInitialized();const i=this.getState(),s=new Map;for(let o=0;o<i.channels.length;o++)for(let c=0;c<i.height;c++)for(let f=0;f<i.width;f++){const u=c*i.width+f,d=i.channels[o][u];d>.001&&s.set(`${f},${c},${o}`,d)}for(let o=0;o<e.channels.length;o++)for(let c=0;c<e.height;c++)for(let f=0;f<e.width;f++){const u=(n+f)%this.config.width,d=(r+c)%this.config.height,h=c*e.width+f,g=e.channels[o][h];g>.001&&s.set(`${u},${d},${o}`,g)}const a=[];for(const[o,c]of s){const[f,u,d]=o.split(",").map(Number);a.push([f,u,d,c])}const l={pattern:{type:"Custom",values:a}};this.reset(l)}drawAt(e,n,r,i,s=0){this.ensureInitialized();const a=this.getState(),l=[];for(let c=0;c<a.channels.length;c++)for(let f=0;f<a.height;f++)for(let u=0;u<a.width;u++){const d=f*a.width+u;let h=a.channels[c][d];if(c===s){const g=u-e,m=f-n,p=Math.sqrt(g*g+m*m);if(p<=r){const b=1-p/r;h=Math.min(1,h+i*b*b)}}h>.001&&l.push([u,f,c,h])}const o={pattern:{type:"Custom",values:l}};this.reset(o)}eraseAt(e,n,r,i=0){this.ensureInitialized();const s=this.getState(),a=[];for(let o=0;o<s.channels.length;o++)for(let c=0;c<s.height;c++)for(let f=0;f<s.width;f++){const u=c*s.width+f;let d=s.channels[o][u];if(o===i){const h=f-e,g=c-n,m=Math.sqrt(h*h+g*g);if(m<=r){const p=1-m/r;d=Math.max(0,d*(1-p*p))}}d>.001&&a.push([f,c,o,d])}const l={pattern:{type:"Custom",values:a}};this.reset(l)}ensureInitialized(){if(!this.isInitialized||!this.propagator)throw new Error("Simulation not initialized. Call initialize() first.")}}const dn={width:128,height:128,channels:1,dt:.1,kernel_radius:13,kernels:[{radius:1,rings:[{amplitude:1,distance:.5,width:.15}],weight:1,mu:.15,sigma:.015,source_channel:0,target_channel:0}],flow:{beta_a:1,n:2,distribution_size:1}},mi={pattern:{type:"GaussianBlob",center:[.5,.5],radius:.1,amplitude:1,channel:0}},bi={initialized:!1,playing:!1,step:0,time:0,totalMass:0,fps:0,frameTime:0,backend:"cpu",gpuAvailable:!1,config:dn,state:null},Z=Re(bi),Nr=Re([]);function U(t,e="info"){Nr.update(n=>[...n.slice(-100),{message:t,level:e,timestamp:Date.now()}])}let z=null,Nt=null,Ct=0,Ft=0,hn=0,Fr=1;function vn(){return z}function wi(t){Fr=Math.max(1,Math.min(10,t))}async function yi(){z=new _i(dn,mi),await z.initialize();const t=z.getState();Z.update(e=>({...e,initialized:!0,step:z.getStep(),time:z.getTime(),totalMass:z.totalMass(),backend:z.getBackend(),gpuAvailable:z.isGpuAvailable(),config:dn,state:t}))}function Si(){!z||$t(Z).playing||(Z.update(e=>({...e,playing:!0})),Ct=performance.now(),hn=Ct,Ft=0,Gr(Ct),U("Simulation started","info"))}function xi(){Z.update(t=>({...t,playing:!1})),Nt!==null&&(cancelAnimationFrame(Nt),Nt=null),U("Simulation paused","info")}async function Ei(){z&&(await z.step(),Pn())}function Br(t){z&&(z.reset(t),Pn(),U("Simulation reset","info"))}async function Mi(t){if(!z)return!1;const e=await z.switchBackend(t);return e?(Z.update(n=>({...n,backend:t})),U(`Switched to ${t.toUpperCase()} backend`,"success")):U(`Failed to switch to ${t} backend`,"error"),e}async function Gr(t){if(!$t(Z).playing||!z)return;const n=t-Ct;Ct=t,await z.run(Fr),Pn(),Ft++,t-hn>=1e3&&(Z.update(r=>({...r,fps:Ft,frameTime:n})),Ft=0,hn=t),Nt=requestAnimationFrame(r=>Gr(r))}function Pn(){if(!z)return;const t=z.getState();Z.update(e=>({...e,step:z.getStep(),time:z.getTime(),totalMass:z.totalMass(),state:t}))}const Ci=Tn(Z,t=>t.time.toFixed(2)),ki=Tn(Z,t=>t.totalMass.toLocaleString(void 0,{maximumFractionDigits:0})),Ai=Tn(Z,t=>t.step.toString().padStart(8,"0")),Di={mode:"view",brushSize:5,brushIntensity:.8,colorScheme:"theme",visualizationMode:"mass",showGrid:!1,showScanlines:!0,showSelection:!0,zoom:1,panX:0,panY:0},bt=Re(Di);function Ti(t){bt.update(e=>({...e,mode:t}))}function Ii(t){bt.update(e=>({...e,brushSize:Math.max(1,Math.min(50,t))}))}function Pi(t){bt.update(e=>({...e,brushIntensity:Math.max(0,Math.min(1,t))}))}const Tt=[{id:"void",name:"VOID",colors:{primary:"#a855f7",primaryDim:"#6b21a8",primaryGlow:"rgba(168, 85, 247, 0.4)",secondary:"#3b82f6",secondaryDim:"#1e40af",secondaryGlow:"rgba(59, 130, 246, 0.4)",tertiary:"#ec4899",tertiaryDim:"#9d174d",tertiaryGlow:"rgba(236, 72, 153, 0.4)",success:"#a855f7",warning:"#f59e0b",danger:"#ef4444"}},{id:"neon-tokyo",name:"NEON TOKYO",colors:{primary:"#ff2d95",primaryDim:"#9d1a5a",primaryGlow:"rgba(255, 45, 149, 0.4)",secondary:"#00f0ff",secondaryDim:"#0891b2",secondaryGlow:"rgba(0, 240, 255, 0.4)",tertiary:"#ffee00",tertiaryDim:"#a38a00",tertiaryGlow:"rgba(255, 238, 0, 0.4)",success:"#00f0ff",warning:"#ffee00",danger:"#ff2d95"}},{id:"synthwave",name:"SYNTHWAVE",colors:{primary:"#f472b6",primaryDim:"#a21caf",primaryGlow:"rgba(244, 114, 182, 0.4)",secondary:"#818cf8",secondaryDim:"#4338ca",secondaryGlow:"rgba(129, 140, 248, 0.4)",tertiary:"#22d3ee",tertiaryDim:"#0e7490",tertiaryGlow:"rgba(34, 211, 238, 0.4)",success:"#22d3ee",warning:"#fbbf24",danger:"#f43f5e"}},{id:"bloodmoon",name:"BLOODMOON",colors:{primary:"#dc2626",primaryDim:"#7f1d1d",primaryGlow:"rgba(220, 38, 38, 0.4)",secondary:"#f97316",secondaryDim:"#9a3412",secondaryGlow:"rgba(249, 115, 22, 0.4)",tertiary:"#fbbf24",tertiaryDim:"#92400e",tertiaryGlow:"rgba(251, 191, 36, 0.4)",success:"#f97316",warning:"#fbbf24",danger:"#dc2626"}},{id:"toxic",name:"TOXIC",colors:{primary:"#84cc16",primaryDim:"#3f6212",primaryGlow:"rgba(132, 204, 22, 0.5)",secondary:"#facc15",secondaryDim:"#854d0e",secondaryGlow:"rgba(250, 204, 21, 0.4)",tertiary:"#22c55e",tertiaryDim:"#166534",tertiaryGlow:"rgba(34, 197, 94, 0.4)",success:"#22c55e",warning:"#facc15",danger:"#ef4444"}},{id:"ice",name:"ICE",colors:{primary:"#38bdf8",primaryDim:"#0369a1",primaryGlow:"rgba(56, 189, 248, 0.4)",secondary:"#e0f2fe",secondaryDim:"#7dd3fc",secondaryGlow:"rgba(224, 242, 254, 0.3)",tertiary:"#a5b4fc",tertiaryDim:"#4f46e5",tertiaryGlow:"rgba(165, 180, 252, 0.4)",success:"#38bdf8",warning:"#fcd34d",danger:"#f87171"}},{id:"hacker",name:"HACKER",colors:{primary:"#22c55e",primaryDim:"#166534",primaryGlow:"rgba(34, 197, 94, 0.5)",secondary:"#4ade80",secondaryDim:"#15803d",secondaryGlow:"rgba(74, 222, 128, 0.4)",tertiary:"#86efac",tertiaryDim:"#22c55e",tertiaryGlow:"rgba(134, 239, 172, 0.3)",success:"#22c55e",warning:"#fbbf24",danger:"#ef4444"}},{id:"phosphor",name:"PHOSPHOR",colors:{primary:"#fef08a",primaryDim:"#a16207",primaryGlow:"rgba(254, 240, 138, 0.5)",secondary:"#fde047",secondaryDim:"#854d0e",secondaryGlow:"rgba(253, 224, 71, 0.4)",tertiary:"#fbbf24",tertiaryDim:"#92400e",tertiaryGlow:"rgba(251, 191, 36, 0.4)",success:"#a3e635",warning:"#fbbf24",danger:"#f87171"}}],en=Re(Tt[0]);function pn(t){const e=document.documentElement,{colors:n}=t;e.style.setProperty("--color-primary",n.primary),e.style.setProperty("--color-primary-dim",n.primaryDim),e.style.setProperty("--color-primary-glow",n.primaryGlow),e.style.setProperty("--color-secondary",n.secondary),e.style.setProperty("--color-secondary-dim",n.secondaryDim),e.style.setProperty("--color-secondary-glow",n.secondaryGlow),e.style.setProperty("--color-tertiary",n.tertiary),e.style.setProperty("--color-tertiary-dim",n.tertiaryDim),e.style.setProperty("--color-tertiary-glow",n.tertiaryGlow),e.style.setProperty("--color-success",n.success),e.style.setProperty("--color-warning",n.warning),e.style.setProperty("--color-danger",n.danger),en.set(t),localStorage.setItem("autoverse-theme",t.id)}function $i(t){const e=Tt.find(n=>n.id===t);e&&pn(e)}function Ri(){const t=localStorage.getItem("autoverse-theme");if(t){const e=Tt.find(n=>n.id===t);if(e){pn(e);return}}pn(Tt[0])}const gn=Re(null),zr=Re(0);function Li(){zr.update(t=>t+1)}function Oi(t,e){const n=$t(gn);n&&n.startDragFromLibrary(t,e)}const _n=Re(null);var Ni=R("<button></button>"),Fi=R('<header class="header svelte-4b3o1e"><div class="header-left svelte-4b3o1e"><pre class="ascii-logo svelte-4b3o1e"></pre></div> <div class="header-right svelte-4b3o1e"><div class="theme-picker svelte-4b3o1e"><span class="picker-label svelte-4b3o1e">THEME</span> <div class="theme-swatches svelte-4b3o1e"></div></div> <div><span class="backend-label svelte-4b3o1e">COMPUTE</span> <span class="backend-value svelte-4b3o1e"> </span></div></div></header>');function Bi(t,e){et(e,!1);const n=()=>W(en,"$currentScheme",i),r=()=>W(Z,"$simulationStore",i),[i,s]=Rt();Qt();var a=Fi(),l=w(a),o=w(l);o.textContent=`
 ▄▀▄ █ █ ▀█▀ ▄▀▄ █ █ █▀▀ █▀▄ ▄▀▀ █▀▀
 █▀█ █▄█  █  █ █ ▀▄▀ ██▄ █▀▄ ▄██ ██▄`;var c=E(l,2),f=w(c),u=E(w(f),2);Dt(u,5,()=>Tt,qt,(p,b)=>{var D=Ni();let x;D.__click=()=>$i(v(b).id),X(()=>{x=he(D,1,"swatch svelte-4b3o1e",null,x,{active:n().id===v(b).id}),li(D,`--swatch-color: ${v(b).colors.primary??""}`),Ie(D,"title",v(b).name)}),T(p,D)});var d=E(f,2);let h;var g=E(w(d),2),m=w(g);X(p=>{h=he(d,1,"backend-indicator svelte-4b3o1e",null,h,{gpu:r().backend==="gpu"}),j(m,p)},[()=>r().backend.toUpperCase()]),T(t,a),tt(),s()}Zt(["click"]);var Gi=R('<footer class="footer svelte-ww03jg"></footer>');function zi(t){var e=Gi();T(t,e)}var Yi=R("<div> </div>"),ji=R('<div><div class="corner top-left svelte-1gtc57s"></div> <div class="corner top-right svelte-1gtc57s"></div> <div class="corner bottom-left svelte-1gtc57s"></div> <div class="corner bottom-right svelte-1gtc57s"></div> <!> <div><!></div></div>');function qe(t,e){let n=be(e,"borderColor",3,"primary"),r=be(e,"noPadding",3,!1),i=be(e,"class",3,"");const s={primary:"border-primary",secondary:"border-secondary",tertiary:"border-tertiary"};var a=ji(),l=E(w(a),8);{var o=d=>{var h=Yi(),g=w(h);X(()=>{he(h,1,`title ${s[n()]??""}`,"svelte-1gtc57s"),j(g,e.title)}),T(d,h)};de(l,d=>{e.title&&d(o)})}var c=E(l,2);let f;var u=w(c);ri(u,()=>e.children??Ae),X(()=>{he(a,1,`tui-box ${s[n()]??""} ${i()??""}`,"svelte-1gtc57s"),f=he(c,1,"content svelte-1gtc57s",null,f,{"no-padding":r()})}),T(t,a)}var qi=R('<span class="label svelte-1l5vt72"> </span>'),Ui=R("<span> </span>"),Xi=R('<div class="slider-header svelte-1l5vt72"><!> <!></div>'),Wi=R('<div class="slider-container svelte-1l5vt72"><!> <input type="range"/></div>');function tn(t,e){et(e,!0);let n=be(e,"value",15),r=be(e,"min",3,0),i=be(e,"max",3,100),s=be(e,"step",3,1),a=be(e,"showValue",3,!0),l=be(e,"valueFormat",3,g=>String(g)),o=be(e,"color",3,"tertiary");function c(g){const m=g.target;n(parseFloat(m.value)),e.onchange?.(n())}var f=Wi(),u=w(f);{var d=g=>{var m=Xi(),p=w(m);{var b=k=>{var M=qi(),_=w(M);X(()=>j(_,e.label)),T(k,M)};de(p,k=>{e.label&&k(b)})}var D=E(p,2);{var x=k=>{var M=Ui(),_=w(M);X(y=>{he(M,1,`value ${o()??""}`,"svelte-1l5vt72"),j(_,y)},[()=>l()(n())]),T(k,M)};de(D,k=>{a()&&k(x)})}T(g,m)};de(u,g=>{(e.label||a())&&g(d)})}var h=E(u,2);h.__input=c,X(()=>{he(h,1,ii(o()),"svelte-1l5vt72"),Ie(h,"min",r()),Ie(h,"max",i()),Ie(h,"step",s()),ui(h,n())}),T(t,f),tt()}Zt(["input"]);var Hi=R('<span class="icon svelte-oaxjxu">&#9724;</span> <span class="label svelte-oaxjxu">PAUSE</span>',1),Vi=R('<span class="icon svelte-oaxjxu">&#9654;</span> <span class="label svelte-oaxjxu">PLAY</span>',1),Ki=R('<div class="control-grid svelte-oaxjxu"><button><!></button> <button class="control-btn svelte-oaxjxu"><span class="icon svelte-oaxjxu">&#9655;</span> <span class="label svelte-oaxjxu">STEP</span></button> <button class="control-btn svelte-oaxjxu"><span class="icon svelte-oaxjxu">&#8634;</span> <span class="label svelte-oaxjxu">RESET</span></button></div> <div class="speed-control svelte-oaxjxu"><!></div>',1),Ji=R('<button><span class="icon svelte-oaxjxu"><!></span> <span class="label svelte-oaxjxu"> </span></button>'),Zi=R('<div class="brush-settings svelte-oaxjxu"><!> <!></div>'),Qi=R('<div class="tool-grid svelte-oaxjxu"></div> <!>',1),ea=R('<div><span class="log-prefix svelte-oaxjxu">&gt;</span> <span class="log-message svelte-oaxjxu"> </span></div>'),ta=R('<div class="log-container svelte-oaxjxu"></div>'),na=R('<aside class="left-sidebar svelte-oaxjxu"><!> <!> <!></aside>');function ra(t,e){et(e,!0);const n=()=>W(Z,"$simulationStore",s),r=()=>W(bt,"$settings",s),i=()=>W(Nr,"$systemLog",s),[s,a]=Rt();let l=Me(1);function o(m){F(l,m,!0),wi(m)}function c(m){Ti(m)}const f=[{id:"view",label:"VIEW",icon:"&#9673;"},{id:"select",label:"SEL",icon:"&#9633;"},{id:"draw",label:"DRAW",icon:"&#9998;"},{id:"erase",label:"ERASE",icon:"&#9747;"}];var u=na(),d=w(u);qe(d,{title:"SYS.CONTROL",borderColor:"primary",children:(m,p)=>{var b=Ki(),D=ct(b),x=w(D);let k;x.__click=()=>n().playing?xi():Si();var M=w(x);{var _=L=>{var Y=Hi();T(L,Y)},y=L=>{var Y=Vi();T(L,Y)};de(M,L=>{n().playing?L(_):L(y,!1)})}var S=E(x,2);S.__click=()=>Ei();var P=E(S,2);P.__click=()=>Br();var A=E(D,2),$=w(A);tn($,{label:"SIM SPEED",min:1,max:10,step:1,color:"primary",valueFormat:L=>`${L}X`,onchange:o,get value(){return v(l)},set value(L){F(l,L,!0)}}),X(()=>k=he(x,1,"control-btn svelte-oaxjxu",null,k,{active:!n().playing})),T(m,b)},$$slots:{default:!0}});var h=E(d,2);qe(h,{title:"TOOL.KIT",borderColor:"tertiary",children:(m,p)=>{var b=Qi(),D=ct(b);Dt(D,21,()=>f,qt,(M,_)=>{var y=Ji();let S;y.__click=()=>c(v(_).id);var P=w(y),A=w(P);ni(A,()=>v(_).icon);var $=E(P,2),L=w($);X(()=>{S=he(y,1,"tool-btn svelte-oaxjxu",null,S,{active:r().mode===v(_).id}),j(L,v(_).label)}),T(M,y)});var x=E(D,2);{var k=M=>{var _=Zi(),y=w(_);tn(y,{label:"BRUSH SIZE",get value(){return r().brushSize},min:1,max:30,step:1,color:"tertiary",valueFormat:A=>`${A}PX`,get onchange(){return Ii}});var S=E(y,2);{var P=A=>{tn(A,{label:"INTENSITY",get value(){return r().brushIntensity},min:0,max:1,step:.05,color:"tertiary",valueFormat:$=>`${Math.round($*100)}%`,get onchange(){return Pi}})};de(S,A=>{r().mode==="draw"&&A(P)})}T(M,_)};de(x,M=>{(r().mode==="draw"||r().mode==="erase")&&M(k)})}T(m,b)},$$slots:{default:!0}});var g=E(h,2);qe(g,{title:"DEBUG.LOG",borderColor:"secondary",class:"debug-log-box",children:(m,p)=>{var b=ta();Dt(b,5,i,qt,(D,x)=>{var k=ea(),M=E(w(k),2),_=w(M);X(()=>{he(k,1,`log-entry ${v(x).level??""}`,"svelte-oaxjxu"),j(_,v(x).message)}),T(D,k)}),T(m,b)},$$slots:{default:!0}}),T(t,u),tt(),a()}Zt(["click"]);const Wn="flow-lenia-presets";class sa{presets=new Map;listeners=new Set;constructor(){this.loadFromStorage()}generateId(){return`preset-${Date.now()}-${Math.random().toString(36).slice(2,9)}`}createThumbnail(e,n=64){const r=document.createElement("canvas");r.width=n,r.height=n;const i=r.getContext("2d"),s=i.createImageData(e.width,e.height),a=e.channels[0];for(let g=0;g<a.length;g++){const m=Math.max(0,Math.min(1,a[g])),p=Math.floor(m*255);s.data[g*4+0]=p,s.data[g*4+1]=p,s.data[g*4+2]=p,s.data[g*4+3]=255}const l=document.createElement("canvas");l.width=e.width,l.height=e.height,l.getContext("2d").putImageData(s,0,0),i.imageSmoothingEnabled=!0,i.fillStyle="#1a1a1a",i.fillRect(0,0,n,n);const c=Math.min(n/e.width,n/e.height),f=e.width*c,u=e.height*c,d=(n-f)/2,h=(n-u)/2;return i.drawImage(l,d,h,f,u),r.toDataURL("image/png")}savePreset(e,n,r){const i={id:this.generateId(),name:e,description:r,thumbnail:this.createThumbnail(n),region:n,createdAt:Date.now()};return this.presets.set(i.id,i),this.persistToStorage(),this.notifyListeners(),i}getPreset(e){return this.presets.get(e)}getAllPresets(){return Array.from(this.presets.values()).sort((e,n)=>n.createdAt-e.createdAt)}deletePreset(e){const n=this.presets.delete(e);return n&&(this.persistToStorage(),this.notifyListeners()),n}renamePreset(e,n){const r=this.presets.get(e);return r?(r.name=n,this.persistToStorage(),this.notifyListeners(),!0):!1}updateDescription(e,n){const r=this.presets.get(e);return r?(r.description=n,this.persistToStorage(),this.notifyListeners(),!0):!1}exportPresets(e){const n=e?e.map(r=>this.presets.get(r)).filter(Boolean):this.getAllPresets();return JSON.stringify(n,null,2)}importPresets(e){try{const n=JSON.parse(e);let r=0;for(const i of n){const s={...i,id:this.generateId(),createdAt:Date.now()};this.presets.set(s.id,s),r++}return this.persistToStorage(),this.notifyListeners(),r}catch{throw new Error("Invalid preset JSON format")}}subscribe(e){return this.listeners.add(e),()=>this.listeners.delete(e)}notifyListeners(){const e=this.getAllPresets();for(const n of this.listeners)n(e)}persistToStorage(){try{const e=JSON.stringify(Array.from(this.presets.entries()));localStorage.setItem(Wn,e)}catch(e){console.warn("Failed to persist presets to storage:",e)}}loadFromStorage(){try{const e=localStorage.getItem(Wn);if(e){const n=JSON.parse(e);this.presets=new Map(n)}}catch(e){console.warn("Failed to load presets from storage:",e),this.presets=new Map}}clearAll(){this.presets.clear(),this.persistToStorage(),this.notifyListeners()}}const ia=[{name:"Glider",description:"A simple glider that moves across the grid",seed:{pattern:{type:"GaussianBlob",center:[.5,.5],radius:.1,amplitude:1,channel:0}}},{name:"Ring",description:"A ring pattern that expands",seed:{pattern:{type:"Ring",center:[.5,.5],inner_radius:.05,outer_radius:.1,amplitude:1,channel:0}}},{name:"Dual Blobs",description:"Two interacting blobs",seed:{pattern:{type:"MultiBlob",blobs:[{center:[.35,.5],radius:.08,amplitude:1,channel:0},{center:[.65,.5],radius:.08,amplitude:1,channel:0}]}}},{name:"Random Noise",description:"Random initial conditions",seed:{pattern:{type:"Noise",seed:42,amplitude:.5,channel:0}}}],vt=new sa,$n=Re(vt.getAllPresets());vt.subscribe(t=>{$n.set(t)});function aa(t){const e=vt.getAllPresets().find(n=>n.id===t);vt.deletePreset(t),e&&U(`Deleted preset: ${e.name}`,"info")}function oa(){const t=vt.exportPresets();return U(`Exported ${$t($n).length} presets`,"success"),t}function la(t){try{const e=vt.importPresets(t);return U(`Imported ${e} presets`,"success"),Li(),e}catch(e){throw U(`Import failed: ${e}`,"error"),e}}function ca(){const t=oa(),e=new Blob([t],{type:"application/json"}),n=URL.createObjectURL(e),r=document.createElement("a");r.href=n,r.download="flow-lenia-presets.json",r.click(),URL.revokeObjectURL(n)}var fa=R('<div class="metric-display svelte-1baw31t"><div class="metric-main svelte-1baw31t"><span class="metric-value svelte-1baw31t"> </span> <span class="metric-unit svelte-1baw31t">STEPS</span></div> <div class="metric-row svelte-1baw31t"><div class="metric-item svelte-1baw31t"><span class="metric-label svelte-1baw31t">TIME</span> <span class="metric-num svelte-1baw31t"> </span></div> <div class="metric-item svelte-1baw31t"><span class="metric-label svelte-1baw31t">MASS</span> <span class="metric-num highlight svelte-1baw31t"> </span></div></div> <div class="metric-row svelte-1baw31t"><div class="metric-item svelte-1baw31t"><span class="metric-label svelte-1baw31t">FPS</span> <span class="metric-num accent svelte-1baw31t"> </span></div> <div class="metric-item svelte-1baw31t"><span class="metric-label svelte-1baw31t">BACKEND</span> <button> </button></div></div></div>'),ua=R('<div class="config-grid svelte-1baw31t"><div class="config-item svelte-1baw31t"><span class="cfg-label svelte-1baw31t">mu</span> <span class="cfg-value svelte-1baw31t"> </span></div> <div class="config-item svelte-1baw31t"><span class="cfg-label svelte-1baw31t">sigma</span> <span class="cfg-value svelte-1baw31t"> </span></div> <div class="config-item svelte-1baw31t"><span class="cfg-label svelte-1baw31t">R</span> <span class="cfg-value svelte-1baw31t"> </span></div> <div class="config-item svelte-1baw31t"><span class="cfg-label svelte-1baw31t">dt</span> <span class="cfg-value svelte-1baw31t"> </span></div></div>'),da=R('<button class="builtin-btn svelte-1baw31t"> </button>'),ha=R('<div class="builtin-grid svelte-1baw31t"></div>'),va=R('<img class="svelte-1baw31t"/>'),pa=R('<div class="preset-item svelte-1baw31t" draggable="true" role="button" tabindex="0"><div class="preset-thumbnail svelte-1baw31t"><!></div> <div class="preset-info svelte-1baw31t"><span class="preset-name svelte-1baw31t"> </span> <span class="preset-size svelte-1baw31t"> </span></div> <button class="delete-btn svelte-1baw31t">&#10005;</button></div>'),ga=R('<div class="empty-state svelte-1baw31t">No saved patterns</div>'),_a=R('<div class="patterns-header svelte-1baw31t"><button class="small-btn svelte-1baw31t">IMPORT</button> <button class="small-btn svelte-1baw31t">EXPORT</button></div> <div class="preset-list svelte-1baw31t"></div>',1),ma=R('<aside class="right-sidebar svelte-1baw31t"><!> <!> <!> <!></aside>');function ba(t,e){et(e,!1);const n=()=>W(Z,"$simulationStore",l),r=()=>W(Ai,"$formattedStep",l),i=()=>W(Ci,"$formattedTime",l),s=()=>W(ki,"$formattedMass",l),a=()=>W($n,"$presets",l),[l,o]=Rt(),c=se();function f(){const _=n().backend==="cpu"?"gpu":"cpu";Mi(_)}function u(_){const y=vn();if(!y)return;const S=Math.floor((y.getWidth()-_.region.width)/2),P=Math.floor((y.getHeight()-_.region.height)/2);y.placeRegion(_.region,S,P)}function d(_){Br(_.seed),U(`Loaded pattern: ${_.name}`,"info")}function h(_,y){_.stopPropagation(),aa(y)}function g(){ca()}function m(){const _=document.createElement("input");_.type="file",_.accept=".json",_.onchange=async y=>{const S=y.target.files?.[0];if(!S)return;const P=await S.text();try{la(P)}catch{}},_.click()}function p(_,y){_.dataTransfer.effectAllowed="copy",_.dataTransfer.setData("text/plain",y.id),Oi(y,_)}Be(()=>n(),()=>{F(c,n().config.kernels[0])}),kn(),Qt();var b=ma(),D=w(b);qe(D,{title:"METRICS",borderColor:"secondary",children:(_,y)=>{var S=fa(),P=w(S),A=w(P),$=w(A),L=E(P,2),Y=w(L),C=E(w(Y),2),q=w(C),ae=E(Y,2),ge=E(w(ae),2),_e=w(ge),Le=E(L,2),Ee=w(Le),wt=E(w(Ee),2),yt=w(wt),ue=E(Ee,2),Oe=E(w(ue),2);let oe;Oe.__click=f;var St=w(Oe);X(Yr=>{j($,r()),j(q,`${i()??""}s`),j(_e,s()),j(yt,(n(),N(()=>n().fps))),oe=he(Oe,1,"backend-btn svelte-1baw31t",null,oe,{gpu:n().backend==="gpu"}),Oe.disabled=(n(),N(()=>!n().gpuAvailable)),j(St,Yr)},[()=>(n(),N(()=>n().backend.toUpperCase()))]),T(_,S)},$$slots:{default:!0}});var x=E(D,2);qe(x,{title:"KERNEL",borderColor:"primary",children:(_,y)=>{var S=ua(),P=w(S),A=E(w(P),2),$=w(A),L=E(P,2),Y=E(w(L),2),C=w(Y),q=E(L,2),ae=E(w(q),2),ge=w(ae),_e=E(q,2),Le=E(w(_e),2),Ee=w(Le);X(()=>{j($,(v(c),N(()=>v(c)?.mu??"—"))),j(C,(v(c),N(()=>v(c)?.sigma??"—"))),j(ge,(n(),N(()=>n().config.kernel_radius))),j(Ee,(n(),N(()=>n().config.dt)))}),T(_,S)},$$slots:{default:!0}});var k=E(x,2);qe(k,{title:"SEEDS",borderColor:"tertiary",children:(_,y)=>{var S=ha();Dt(S,5,()=>ia,qt,(P,A)=>{var $=da();$.__click=()=>d(v(A));var L=w($);X(()=>{Ie($,"title",(v(A),N(()=>v(A).description))),j(L,(v(A),N(()=>v(A).name)))}),T(P,$)}),T(_,S)},$$slots:{default:!0}});var M=E(k,2);qe(M,{title:"SAVED",borderColor:"primary",class:"saved-box",children:(_,y)=>{var S=_a(),P=ct(S),A=w(P);A.__click=m;var $=E(A,2);$.__click=g;var L=E(P,2);Dt(L,5,a,Y=>Y.id,(Y,C)=>{var q=pa();q.__click=()=>u(v(C)),q.__keydown=oe=>oe.key==="Enter"&&u(v(C));var ae=w(q),ge=w(ae);{var _e=oe=>{var St=va();X(()=>{Ie(St,"src",(v(C),N(()=>v(C).thumbnail))),Ie(St,"alt",(v(C),N(()=>v(C).name)))}),T(oe,St)};de(ge,oe=>{v(C),N(()=>v(C).thumbnail)&&oe(_e)})}var Le=E(ae,2),Ee=w(Le),wt=w(Ee),yt=E(Ee,2),ue=w(yt),Oe=E(Le,2);Oe.__click=oe=>h(oe,v(C).id),X(()=>{j(wt,(v(C),N(()=>v(C).name))),j(ue,`${v(C),N(()=>v(C).region.width)??""}x${v(C),N(()=>v(C).region.height)??""}`)}),Vs("dragstart",q,oe=>p(oe,v(C))),T(Y,q)},Y=>{var C=ga();T(Y,C)}),T(_,S)},$$slots:{default:!0}}),T(t,b),tt(),o()}Zt(["click","keydown"]);class wa{canvas;ctx;offscreenCanvas;offscreenCtx;settings;grayscaleMap;thermalMap;viridisMap;themeMap;constructor(e,n){this.canvas=e;const r=e.getContext("2d");if(!r)throw new Error("Failed to get 2D context");this.ctx=r,this.offscreenCanvas=document.createElement("canvas");const i=this.offscreenCanvas.getContext("2d");if(!i)throw new Error("Failed to get offscreen 2D context");this.offscreenCtx=i,this.settings=n,this.grayscaleMap=this.buildGrayscaleMap(),this.thermalMap=this.buildThermalMap(),this.viridisMap=this.buildViridisMap(),this.themeMap=this.viridisMap}setThemeColors(e){this.themeMap=this.buildThemeMap(e)}updateSettings(e){this.settings={...this.settings,...e}}render(e,n,r){const{width:i,height:s,channels:a}=e;(this.offscreenCanvas.width!==i||this.offscreenCanvas.height!==s)&&(this.offscreenCanvas.width=i,this.offscreenCanvas.height=s);const l=this.getColorMap(),o=this.offscreenCtx.createImageData(i,s),c=a[0];for(let f=0;f<c.length;f++){const u=Math.max(0,Math.min(1,c[f])),d=Math.floor(u*255)*4;o.data[f*4+0]=l[d+0],o.data[f*4+1]=l[d+1],o.data[f*4+2]=l[d+2],o.data[f*4+3]=255}this.offscreenCtx.putImageData(o,0,0),this.ctx.imageSmoothingEnabled=!1,this.ctx.fillStyle="#000",this.ctx.fillRect(0,0,this.canvas.width,this.canvas.height),this.ctx.drawImage(this.offscreenCanvas,0,0,i,s,0,0,this.canvas.width,this.canvas.height),this.settings.showGrid&&this.drawGrid(i,s),r&&this.drawGhostPreview(r,i,s),n&&this.settings.showSelection&&this.drawSelection(n,i,s)}drawGrid(e,n){const r=this.canvas.width/e,i=this.canvas.height/n;if(this.ctx.strokeStyle="rgba(255, 255, 255, 0.1)",this.ctx.lineWidth=1,r>=4&&i>=4){this.ctx.beginPath();for(let s=0;s<=e;s++){const a=s*r;this.ctx.moveTo(a,0),this.ctx.lineTo(a,this.canvas.height)}for(let s=0;s<=n;s++){const a=s*i;this.ctx.moveTo(0,a),this.ctx.lineTo(this.canvas.width,a)}this.ctx.stroke()}}drawSelection(e,n,r){const i=this.canvas.width/n,s=this.canvas.height/r,a=Math.min(e.startX,e.endX)*i,l=Math.min(e.startY,e.endY)*s,o=Math.abs(e.endX-e.startX)*i,c=Math.abs(e.endY-e.startY)*s;this.ctx.fillStyle="rgba(79, 195, 247, 0.2)",this.ctx.fillRect(a,l,o,c),this.ctx.strokeStyle="#4fc3f7",this.ctx.lineWidth=2,this.ctx.setLineDash([5,5]),this.ctx.strokeRect(a,l,o,c),this.ctx.setLineDash([]);const f=Math.abs(e.endX-e.startX),u=Math.abs(e.endY-e.startY);f>0&&u>0&&(this.ctx.fillStyle="#4fc3f7",this.ctx.font="12px monospace",this.ctx.fillText(`${f} x ${u}`,a+4,l-4))}drawGhostPreview(e,n,r){const i=this.canvas.width/n,s=this.canvas.height/r,{region:a,x:l,y:o}=e,c=document.createElement("canvas");c.width=a.width,c.height=a.height;const f=c.getContext("2d"),u=f.createImageData(a.width,a.height),d=this.getColorMap();for(let h=0;h<a.channels[0].length;h++){const g=Math.max(0,Math.min(1,a.channels[0][h])),m=Math.floor(g*255)*4;u.data[h*4+0]=d[m+0],u.data[h*4+1]=d[m+1],u.data[h*4+2]=d[m+2],u.data[h*4+3]=g>.01?180:0}f.putImageData(u,0,0),this.ctx.globalAlpha=.7,this.ctx.drawImage(c,0,0,a.width,a.height,l*i,o*s,a.width*i,a.height*s),this.ctx.globalAlpha=1,this.ctx.strokeStyle="#4fc3f7",this.ctx.lineWidth=2,this.ctx.setLineDash([3,3]),this.ctx.strokeRect(l*i,o*s,a.width*i,a.height*s),this.ctx.setLineDash([])}canvasToSim(e,n,r,i){const s=this.canvas.getBoundingClientRect(),a=r/this.canvas.width,l=i/this.canvas.height;return{x:Math.floor((e-s.left)*a),y:Math.floor((n-s.top)*l)}}getColorMap(){switch(this.settings.colorScheme){case"thermal":return this.thermalMap;case"viridis":return this.viridisMap;case"theme":return this.themeMap;default:return this.grayscaleMap}}buildGrayscaleMap(){const e=new Uint8ClampedArray(1024);for(let n=0;n<256;n++)e[n*4+0]=n,e[n*4+1]=n,e[n*4+2]=n,e[n*4+3]=255;return e}buildThermalMap(){const e=new Uint8ClampedArray(1024);for(let n=0;n<256;n++){const r=n/255;let i,s,a;if(r<.2){const l=r/.2;i=0,s=0,a=Math.floor(l*128)}else if(r<.4){const l=(r-.2)/.2;i=0,s=Math.floor(l*255),a=128+Math.floor(l*127)}else if(r<.6){const l=(r-.4)/.2;i=Math.floor(l*255),s=255,a=255-Math.floor(l*255)}else if(r<.8){const l=(r-.6)/.2;i=255,s=255-Math.floor(l*255),a=0}else{const l=(r-.8)/.2;i=255,s=Math.floor(l*255),a=Math.floor(l*255)}e[n*4+0]=i,e[n*4+1]=s,e[n*4+2]=a,e[n*4+3]=255}return e}buildViridisMap(){const e=[[68,1,84],[72,35,116],[64,67,135],[52,94,141],[41,120,142],[32,144,140],[34,167,132],[68,190,112],[121,209,81],[189,222,38],[253,231,36]],n=new Uint8ClampedArray(256*4);for(let r=0;r<256;r++){const s=r/255*(e.length-1),a=Math.floor(s),l=Math.min(a+1,e.length-1),o=s-a;n[r*4+0]=Math.floor(e[a][0]+o*(e[l][0]-e[a][0])),n[r*4+1]=Math.floor(e[a][1]+o*(e[l][1]-e[a][1])),n[r*4+2]=Math.floor(e[a][2]+o*(e[l][2]-e[a][2])),n[r*4+3]=255}return n}getCanvas(){return this.canvas}buildThemeMap(e){const n=o=>{const c=o.replace("#","");return[parseInt(c.slice(0,2),16),parseInt(c.slice(2,4),16),parseInt(c.slice(4,6),16)]},r=n(e.primary),i=n(e.secondary),s=n(e.tertiary),a=[{t:0,color:[5,5,5]},{t:.15,color:[r[0]*.3,r[1]*.3,r[2]*.3]},{t:.35,color:r},{t:.6,color:i},{t:.85,color:s},{t:1,color:[255,255,255]}],l=new Uint8ClampedArray(256*4);for(let o=0;o<256;o++){const c=o/255;let f=a[0],u=a[1];for(let h=1;h<a.length;h++)if(c<=a[h].t){f=a[h-1],u=a[h];break}const d=(c-f.t)/(u.t-f.t);l[o*4+0]=Math.floor(f.color[0]+d*(u.color[0]-f.color[0])),l[o*4+1]=Math.floor(f.color[1]+d*(u.color[1]-f.color[1])),l[o*4+2]=Math.floor(f.color[2]+d*(u.color[2]-f.color[2])),l[o*4+3]=255}return l}}class ya{canvas;simulation;callbacks;mode="view";selection=null;isSelecting=!1;isDrawing=!1;isDragging=!1;draggedCreature=null;ghostPreview=null;brushSize=3;brushIntensity=.5;constructor(e,n,r,i={}){this.canvas=e,this.simulation=n,this.callbacks=i,this.setupEventListeners(),this.setupDragDrop()}setMode(e){switch(this.mode=e,this.selection=null,this.isSelecting=!1,this.isDrawing=!1,e){case"select":this.canvas.style.cursor="crosshair";break;case"draw":this.canvas.style.cursor="cell";break;case"erase":this.canvas.style.cursor="not-allowed";break;default:this.canvas.style.cursor="default"}this.callbacks.onModeChange?.(e)}getMode(){return this.mode}getSelection(){return this.selection}clearSelection(){this.selection=null,this.callbacks.onSelectionChange?.(null)}setBrushSize(e){this.brushSize=Math.max(1,Math.min(20,e))}setBrushIntensity(e){this.brushIntensity=Math.max(0,Math.min(1,e))}getGhostPreview(){return this.ghostPreview}startDragFromLibrary(e,n){this.isDragging=!0,this.draggedCreature={preset:e,offsetX:e.region.width/2,offsetY:e.region.height/2};const r=this.getSimCoords(n);this.ghostPreview={region:e.region,x:r.x-this.draggedCreature.offsetX,y:r.y-this.draggedCreature.offsetY}}setupEventListeners(){this.canvas.addEventListener("mousedown",this.handleMouseDown.bind(this)),this.canvas.addEventListener("mousemove",this.handleMouseMove.bind(this)),this.canvas.addEventListener("mouseup",this.handleMouseUp.bind(this)),this.canvas.addEventListener("mouseleave",this.handleMouseLeave.bind(this)),document.addEventListener("keydown",this.handleKeyDown.bind(this))}setupDragDrop(){this.canvas.addEventListener("dragover",e=>{if(e.preventDefault(),e.dataTransfer.dropEffect="copy",this.draggedCreature){const n=this.getSimCoords(e);this.ghostPreview={region:this.draggedCreature.preset.region,x:n.x-this.draggedCreature.offsetX,y:n.y-this.draggedCreature.offsetY}}}),this.canvas.addEventListener("drop",e=>{if(e.preventDefault(),this.draggedCreature){const n=this.getSimCoords(e),r=Math.floor(n.x-this.draggedCreature.offsetX),i=Math.floor(n.y-this.draggedCreature.offsetY);this.callbacks.onDrop?.(this.draggedCreature.preset,r,i),this.draggedCreature=null,this.ghostPreview=null,this.isDragging=!1}}),this.canvas.addEventListener("dragleave",()=>{this.ghostPreview=null})}handleMouseDown(e){const n=this.getSimCoords(e);switch(this.mode){case"select":this.isSelecting=!0,this.selection={startX:n.x,startY:n.y,endX:n.x,endY:n.y},this.callbacks.onSelectionChange?.(this.selection);break;case"draw":this.isDrawing=!0,this.callbacks.onDraw?.(n.x,n.y);break;case"erase":this.isDrawing=!0,this.callbacks.onErase?.(n.x,n.y);break}}handleMouseMove(e){const n=this.getSimCoords(e);this.isSelecting&&this.selection&&(this.selection.endX=n.x,this.selection.endY=n.y,this.callbacks.onSelectionChange?.(this.selection)),this.isDrawing&&(this.mode==="draw"?this.callbacks.onDraw?.(n.x,n.y):this.mode==="erase"&&this.callbacks.onErase?.(n.x,n.y)),this.isDragging&&this.draggedCreature&&(this.ghostPreview={region:this.draggedCreature.preset.region,x:n.x-this.draggedCreature.offsetX,y:n.y-this.draggedCreature.offsetY})}handleMouseUp(e){if(this.isSelecting&&this.selection){const n={startX:Math.min(this.selection.startX,this.selection.endX),startY:Math.min(this.selection.startY,this.selection.endY),endX:Math.max(this.selection.startX,this.selection.endX),endY:Math.max(this.selection.startY,this.selection.endY)};n.endX>n.startX&&n.endY>n.startY?(this.selection=n,this.callbacks.onSelectionComplete?.(n)):this.selection=null,this.callbacks.onSelectionChange?.(this.selection)}this.isSelecting=!1,this.isDrawing=!1}handleMouseLeave(e){this.isSelecting&&(this.isSelecting=!1,this.selection=null,this.callbacks.onSelectionChange?.(null)),this.isDrawing=!1,this.ghostPreview=null}handleKeyDown(e){const n=e.target;n.tagName==="INPUT"||n.tagName==="TEXTAREA"||(e.key==="v"||e.key==="Escape"?this.setMode("view"):e.key==="s"?this.setMode("select"):e.key==="d"?this.setMode("draw"):e.key==="e"&&this.setMode("erase"),e.key==="["?(this.setBrushSize(this.brushSize-1),this.callbacks.onBrushSizeChange?.(this.brushSize)):e.key==="]"&&(this.setBrushSize(this.brushSize+1),this.callbacks.onBrushSizeChange?.(this.brushSize)))}getSimCoords(e){const n=this.canvas.getBoundingClientRect(),r=e.clientX-n.left,i=e.clientY-n.top,s=this.simulation.getWidth(),a=this.simulation.getHeight();return{x:Math.floor(r/n.width*s),y:Math.floor(i/n.height*a)}}getBrushSize(){return this.brushSize}getBrushIntensity(){return this.brushIntensity}}var Sa=R('<div class="simulation-view svelte-145nxqv"><div class="canvas-frame svelte-145nxqv"><div class="canvas-header svelte-145nxqv"><span class="dim-label svelte-145nxqv"> </span></div> <div class="canvas-container svelte-145nxqv"><canvas class="svelte-145nxqv"></canvas> <div class="corner-marker top-left svelte-145nxqv"></div> <div class="corner-marker top-right svelte-145nxqv"></div> <div class="corner-marker bottom-left svelte-145nxqv"></div> <div class="corner-marker bottom-right svelte-145nxqv"></div> <div class="canvas-scanlines svelte-145nxqv"></div></div></div></div>');function xa(t,e){et(e,!1);const n=()=>W(bt,"$settings",a),r=()=>W(Z,"$simulationStore",a),i=()=>W(en,"$currentScheme",a),s=()=>W(zr,"$renderTrigger",a),[a,l]=Rt();let o=se(),c=se(),f=se(null),u=se(null);const d=512;In(()=>{const M=vn();!M||!v(c)||(_n.set(v(c)),F(f,new wa(v(c),{colorScheme:n().colorScheme,showGrid:n().showGrid,showSelection:n().showSelection,brushSize:n().brushSize,brushIntensity:n().brushIntensity,backend:r().backend})),F(u,new ya(v(c),M,v(f),{onSelectionChange:()=>h(),onSelectionComplete:()=>{},onDrop:(_,y,S)=>{M.placeRegion(_.region,y,S),h()},onDraw:(_,y)=>{M.drawAt(_,y,n().brushSize,n().brushIntensity),h()},onErase:(_,y)=>{M.eraseAt(_,y,n().brushSize),h()},onModeChange:()=>{},onBrushSizeChange:()=>{}})),gn.set(v(u)),h())}),Or(()=>{gn.set(null),_n.set(null),F(f,null),F(u,null)});function h(){if(!v(f))return;const M=vn();if(!M)return;const _=M.getState(),y=v(u)?.getSelection(),S=v(u)?.getGhostPreview();v(f).render(_,y,S)}Be(()=>(r(),v(f)),()=>{r().state&&v(f)&&h()}),Be(()=>(v(u),n()),()=>{v(u)&&n().mode&&v(u).setMode(n().mode)}),Be(()=>(v(u),n()),()=>{v(u)&&(v(u).setBrushSize(n().brushSize),v(u).setBrushIntensity(n().brushIntensity))}),Be(()=>(v(f),n()),()=>{v(f)&&n().colorScheme&&(v(f).updateSettings({colorScheme:n().colorScheme}),h())}),Be(()=>(v(f),i()),()=>{v(f)&&i()&&(v(f).setThemeColors({primary:i().colors.primary,secondary:i().colors.secondary,tertiary:i().colors.tertiary}),h())}),Be(()=>(s(),v(f)),()=>{s()&&v(f)&&h()}),kn(),Qt();var g=Sa(),m=w(g),p=w(m),b=w(p),D=w(b),x=E(p,2),k=w(x);Ie(k,"width",d),Ie(k,"height",d),Ut(k,M=>F(c,M),()=>v(c)),Ut(x,M=>F(o,M),()=>v(o)),X(()=>j(D,`${r(),N(()=>r().config.width)??""}x${r(),N(()=>r().config.height)??""}`)),T(t,g),tt(),l()}var Ea=R('<div class="loading-screen svelte-1n46o8q"><div class="loading-content svelte-1n46o8q"><div class="glitch-text svelte-1n46o8q" data-text="FLOW_LENIA">FLOW_LENIA</div> <div class="loading-status svelte-1n46o8q"><span class="animate-pulse">INITIALIZING SUBSTRATE</span> <span class="animate-blink">_</span></div></div></div>'),Ma=R('<div class="error-screen svelte-1n46o8q"><div class="error-content svelte-1n46o8q"><div class="error-title svelte-1n46o8q">SYSTEM FAILURE</div> <div class="error-message svelte-1n46o8q"> </div> <div class="error-hint svelte-1n46o8q">Ensure WASM is built: <code class="svelte-1n46o8q">wasm-pack build --target web --release</code></div></div></div>'),Ca=R('<div class="scanlines"></div>'),ka=R('<div class="app-container svelte-1n46o8q"><canvas class="glow-layer svelte-1n46o8q"></canvas> <!> <div class="main-content svelte-1n46o8q"><!> <!> <!></div> <!></div> <!> <div class="vignette"></div>',1);function Aa(t,e){et(e,!1);const n=()=>W(_n,"$simulationCanvas",a),r=()=>W(en,"$currentScheme",a),i=()=>W(Z,"$simulationStore",a),s=()=>W(bt,"$settings",a),[a,l]=Rt();let o=se(!1),c=se(null),f=se(),u=se(null),d,h=se(!1),g=se(),m=null,p=null;function b(){const _=n();if(!_||!v(u)||!v(f)){d=requestAnimationFrame(b);return}if(m||(m=document.createElement("canvas"),p=m.getContext("2d",{willReadFrequently:!0})),v(g)){const C=v(g).getBoundingClientRect(),q=v(f).width!==C.width||v(f).height!==C.height,ae=m.width===0||m.height===0;(q||ae)&&(Ne(f,v(f).width=C.width),Ne(f,v(f).height=C.height),m.width=C.width,m.height=C.height)}if(!p||m.width===0)return;const y=v(f).width,S=v(f).height,P=r().colors;p.drawImage(_,0,0,y,S);const A=p.getImageData(0,0,y,S),$=A.data,L=5,Y=255-L;for(let C=0;C<$.length;C+=4){const q=($[C]+$[C+1]+$[C+2])/3,ge=Math.max(0,q-L)/Y,_e=Math.pow(ge,.35);$[C]=255,$[C+1]=255,$[C+2]=255,$[C+3]=_e*255}p.putImageData(A,0,0),v(u).clearRect(0,0,y,S),Ne(u,v(u).fillStyle=P.primary),v(u).fillRect(180,0,80,S),Ne(u,v(u).fillStyle=P.secondary),v(u).fillRect(y-220,0,80,S),Ne(u,v(u).fillStyle=P.tertiary),v(u).fillRect(0,30,y,40),Ne(u,v(u).fillStyle=P.tertiary),v(u).fillRect(0,S-60,y,40),Ne(u,v(u).globalCompositeOperation="destination-in"),v(u).drawImage(m,0,0),Ne(u,v(u).globalCompositeOperation="source-over"),d=requestAnimationFrame(b)}In(async()=>{Ri(),U("SYS.BOOT","info"),U("Loading WASM module...","info");try{await yi(),F(o,!0),U("WASM initialized","success"),U(`Backend: ${i().backend.toUpperCase()}`,"info"),U(`Theme: ${r().name}`,"info"),i().gpuAvailable?U("WebGPU available","success"):U("WebGPU not available","warn"),U("SYSTEM READY","success")}catch(_){F(c,String(_)),U(`INIT FAILED: ${_}`,"error")}}),Or(()=>{d&&cancelAnimationFrame(d)}),Be(()=>(v(f),v(h)),()=>{v(f)&&!v(h)&&(F(u,v(f).getContext("2d")),F(h,!0),b())}),kn(),Qt();var D=zn(),x=ct(D);{var k=_=>{var y=Ea();T(_,y)},M=_=>{var y=zn(),S=ct(y);{var P=$=>{var L=Ma(),Y=w(L),C=E(w(Y),2),q=w(C);X(()=>j(q,v(c))),T($,L)},A=$=>{var L=ka(),Y=ct(L),C=w(Y);Ut(C,ue=>F(f,ue),()=>v(f));var q=E(C,2);Bi(q,{});var ae=E(q,2),ge=w(ae);ra(ge,{});var _e=E(ge,2);xa(_e,{});var Le=E(_e,2);ba(Le,{});var Ee=E(ae,2);zi(Ee),Ut(Y,ue=>F(g,ue),()=>v(g));var wt=E(Y,2);{var yt=ue=>{var Oe=Ca();T(ue,Oe)};de(wt,ue=>{s(),N(()=>s().showScanlines)&&ue(yt)})}T($,L)};de(S,$=>{v(c)?$(P):$(A,!1)},!0)}T(_,y)};de(x,_=>{!v(o)&&!v(c)?_(k):_(M,!1)})}T(t,D),tt(),l()}Ks(Aa,{target:document.getElementById("app")});
