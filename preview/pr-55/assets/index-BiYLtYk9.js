(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))n(r);new MutationObserver(r=>{for(const i of r)if(i.type==="childList")for(const a of i.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&n(a)}).observe(document,{childList:!0,subtree:!0});function s(r){const i={};return r.integrity&&(i.integrity=r.integrity),r.referrerPolicy&&(i.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?i.credentials="include":r.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function n(r){if(r.ep)return;r.ep=!0;const i=s(r);fetch(r.href,i)}})();const rn=!1;var yn=Array.isArray,Oi=Array.prototype.indexOf,Gs=Array.from,ar=Object.defineProperty,qt=Object.getOwnPropertyDescriptor,or=Object.getOwnPropertyDescriptors,Li=Object.prototype,Ri=Array.prototype,xn=Object.getPrototypeOf,Xn=Object.isExtensible;const it=()=>{};function Ni(e){return e()}function Os(e){for(var t=0;t<e.length;t++)e[t]()}function lr(){var e,t,s=new Promise((n,r)=>{e=n,t=r});return{promise:s,resolve:e,reject:t}}const ce=2,Sn=4,Ys=8,Fi=1<<24,ct=16,ut=32,Rt=64,Xs=128,Ye=512,oe=1024,Ee=2048,Xe=4096,$e=8192,at=16384,En=32768,At=65536,Un=1<<17,cr=1<<18,Jt=1<<19,ur=1<<20,rt=1<<25,Dt=32768,an=1<<21,Mn=1<<22,yt=1<<23,ot=Symbol("$state"),zi=Symbol("legacy props"),Bi=Symbol(""),Xt=new class extends Error{name="StaleReactionError";message="The reaction that called `getAbortSignal()` was re-run or destroyed"};function fr(e){throw new Error("https://svelte.dev/e/lifecycle_outside_component")}function Gi(){throw new Error("https://svelte.dev/e/async_derived_orphan")}function Yi(e){throw new Error("https://svelte.dev/e/effect_in_teardown")}function Xi(){throw new Error("https://svelte.dev/e/effect_in_unowned_derived")}function Ui(e){throw new Error("https://svelte.dev/e/effect_orphan")}function qi(){throw new Error("https://svelte.dev/e/effect_update_depth_exceeded")}function ji(e){throw new Error("https://svelte.dev/e/props_invalid_value")}function Wi(){throw new Error("https://svelte.dev/e/state_descriptors_fixed")}function Hi(){throw new Error("https://svelte.dev/e/state_prototype_fixed")}function Vi(){throw new Error("https://svelte.dev/e/state_unsafe_mutation")}function Ki(){throw new Error("https://svelte.dev/e/svelte_boundary_reset_onerror")}const Ji=1,Zi=2,dr=4,Qi=8,ea=16,ta=1,sa=2,na=4,ra=8,ia=16,aa=1,oa=2,de=Symbol(),la="http://www.w3.org/1999/xhtml";function ca(){console.warn("https://svelte.dev/e/select_multiple_invalid_value")}function ua(){console.warn("https://svelte.dev/e/svelte_boundary_reset_noop")}function vr(e){return e===this.v}function hr(e,t){return e!=e?t==t:e!==t||e!==null&&typeof e=="object"||typeof e=="function"}function pr(e){return!hr(e,this.v)}let Zt=!1,fa=!1;function da(){Zt=!0}let Z=null;function jt(e){Z=e}function ft(e,t=!1,s){Z={p:Z,i:!1,c:null,e:null,s:e,x:null,l:Zt&&!t?{s:null,u:null,$:[]}:null}}function dt(e){var t=Z,s=t.e;if(s!==null){t.e=null;for(var n of s)Ar(n)}return t.i=!0,Z=t.p,{}}function bs(){return!Zt||Z!==null&&Z.l===null}let Tt=[];function gr(){var e=Tt;Tt=[],Os(e)}function Qt(e){if(Tt.length===0&&!fs){var t=Tt;queueMicrotask(()=>{t===Tt&&gr()})}Tt.push(e)}function va(){for(;Tt.length>0;)gr()}function _r(e){var t=U;if(t===null)return Y.f|=yt,e;if((t.f&En)===0){if((t.f&Xs)===0)throw e;t.b.error(e)}else Wt(e,t)}function Wt(e,t){for(;t!==null;){if((t.f&Xs)!==0)try{t.b.error(e);return}catch(s){e=s}t=t.parent}throw e}const Ts=new Set;let X=null,us=null,Fe=null,Le=[],Us=null,on=!1,fs=!1;class He{committed=!1;current=new Map;previous=new Map;#e=new Set;#t=new Set;#n=0;#s=0;#l=null;#i=new Set;#r=new Set;skipped_effects=new Set;is_fork=!1;is_deferred(){return this.is_fork||this.#s>0}process(t){Le=[],us=null,this.apply();var s={parent:null,effect:null,effects:[],render_effects:[]};for(const n of t)this.#a(n,s);this.is_fork||this.#u(),this.is_deferred()?(this.#o(s.effects),this.#o(s.render_effects)):(us=this,X=null,qn(s.render_effects),qn(s.effects),us=null,this.#l?.resolve()),Fe=null}#a(t,s){t.f^=oe;for(var n=t.first;n!==null;){var r=n.f,i=(r&(ut|Rt))!==0,a=i&&(r&oe)!==0,o=a||(r&$e)!==0||this.skipped_effects.has(n);if((n.f&Xs)!==0&&n.b?.is_pending()&&(s={parent:s,effect:n,effects:[],render_effects:[]}),!o&&n.fn!==null){i?n.f^=oe:(r&Sn)!==0?s.effects.push(n):es(n)&&((n.f&ct)!==0&&this.#i.add(n),Ht(n));var l=n.first;if(l!==null){n=l;continue}}var c=n.parent;for(n=n.next;n===null&&c!==null;)c===s.effect&&(this.#o(s.effects),this.#o(s.render_effects),s=s.parent),n=c.next,c=c.parent}}#o(t){for(const s of t)(s.f&Ee)!==0?this.#i.add(s):(s.f&Xe)!==0&&this.#r.add(s),this.#c(s.deps),le(s,oe)}#c(t){if(t!==null)for(const s of t)(s.f&ce)===0||(s.f&Dt)===0||(s.f^=Dt,this.#c(s.deps))}capture(t,s){this.previous.has(t)||this.previous.set(t,s),(t.f&yt)===0&&(this.current.set(t,t.v),Fe?.set(t,t.v))}activate(){X=this,this.apply()}deactivate(){X===this&&(X=null,Fe=null)}flush(){if(this.activate(),Le.length>0){if(mr(),X!==null&&X!==this)return}else this.#n===0&&this.process([]);this.deactivate()}discard(){for(const t of this.#t)t(this);this.#t.clear()}#u(){if(this.#s===0){for(const t of this.#e)t();this.#e.clear()}this.#n===0&&this.#f()}#f(){if(Ts.size>1){this.previous.clear();var t=Fe,s=!0,n={parent:null,effect:null,effects:[],render_effects:[]};for(const i of Ts){if(i===this){s=!1;continue}const a=[];for(const[l,c]of this.current){if(i.current.has(l))if(s&&c!==i.current.get(l))i.current.set(l,c);else continue;a.push(l)}if(a.length===0)continue;const o=[...i.current.keys()].filter(l=>!this.current.has(l));if(o.length>0){var r=Le;Le=[];const l=new Set,c=new Map;for(const u of a)br(u,o,l,c);if(Le.length>0){X=i,i.apply();for(const u of Le)i.#a(u,n);i.deactivate()}Le=r}}X=null,Fe=t}this.committed=!0,Ts.delete(this)}increment(t){this.#n+=1,t&&(this.#s+=1)}decrement(t){this.#n-=1,t&&(this.#s-=1),this.revive()}revive(){for(const t of this.#i)this.#r.delete(t),le(t,Ee),Pt(t);for(const t of this.#r)le(t,Xe),Pt(t);this.flush()}oncommit(t){this.#e.add(t)}ondiscard(t){this.#t.add(t)}settled(){return(this.#l??=lr()).promise}static ensure(){if(X===null){const t=X=new He;Ts.add(X),fs||He.enqueue(()=>{X===t&&t.flush()})}return X}static enqueue(t){Qt(t)}apply(){}}function ha(e){var t=fs;fs=!0;try{for(var s;;){if(va(),Le.length===0&&(X?.flush(),Le.length===0))return Us=null,s;mr()}}finally{fs=t}}function mr(){var e=$t;on=!0;var t=null;try{var s=0;for(Rs(!0);Le.length>0;){var n=He.ensure();if(s++>1e3){var r,i;pa()}n.process(Le),xt.clear()}}finally{on=!1,Rs(e),Us=null}}function pa(){try{qi()}catch(e){Wt(e,Us)}}let tt=null;function qn(e){var t=e.length;if(t!==0){for(var s=0;s<t;){var n=e[s++];if((n.f&(at|$e))===0&&es(n)&&(tt=new Set,Ht(n),n.deps===null&&n.first===null&&n.nodes===null&&(n.teardown===null&&n.ac===null?Rr(n):n.fn=null),tt?.size>0)){xt.clear();for(const r of tt){if((r.f&(at|$e))!==0)continue;const i=[r];let a=r.parent;for(;a!==null;)tt.has(a)&&(tt.delete(a),i.push(a)),a=a.parent;for(let o=i.length-1;o>=0;o--){const l=i[o];(l.f&(at|$e))===0&&Ht(l)}}tt.clear()}}tt=null}}function br(e,t,s,n){if(!s.has(e)&&(s.add(e),e.reactions!==null))for(const r of e.reactions){const i=r.f;(i&ce)!==0?br(r,t,s,n):(i&(Mn|ct))!==0&&(i&Ee)===0&&wr(r,t,n)&&(le(r,Ee),Pt(r))}}function wr(e,t,s){const n=s.get(e);if(n!==void 0)return n;if(e.deps!==null)for(const r of e.deps){if(t.includes(r))return!0;if((r.f&ce)!==0&&wr(r,t,s))return s.set(r,!0),!0}return s.set(e,!1),!1}function Pt(e){for(var t=Us=e;t.parent!==null;){t=t.parent;var s=t.f;if(on&&t===U&&(s&ct)!==0&&(s&cr)===0)return;if((s&(Rt|ut))!==0){if((s&oe)===0)return;t.f^=oe}}Le.push(t)}function ga(e){let t=0,s=Ot(0),n;return()=>{ps()&&(f(s),xs(()=>(t===0&&(n=N(()=>e(()=>ds(s)))),t+=1,()=>{Qt(()=>{t-=1,t===0&&(n?.(),n=void 0,ds(s))})})))}}var _a=At|Jt|Xs;function ma(e,t,s){new ba(e,t,s)}class ba{parent;#e=!1;#t;#n=null;#s;#l;#i;#r=null;#a=null;#o=null;#c=null;#u=null;#f=0;#d=0;#h=!1;#v=null;#b=ga(()=>(this.#v=Ot(this.#f),()=>{this.#v=null}));constructor(t,s,n){this.#t=t,this.#s=s,this.#l=n,this.parent=U.b,this.#e=!!this.#s.pending,this.#i=Hs(()=>{U.b=this;{var r=this.#_();try{this.#r=Re(()=>n(r))}catch(i){this.error(i)}this.#d>0?this.#g():this.#e=!1}return()=>{this.#u?.remove()}},_a)}#w(){try{this.#r=Re(()=>this.#l(this.#t))}catch(t){this.error(t)}this.#e=!1}#y(){const t=this.#s.pending;t&&(this.#a=Re(()=>t(this.#t)),He.enqueue(()=>{var s=this.#_();this.#r=this.#p(()=>(He.ensure(),Re(()=>this.#l(s)))),this.#d>0?this.#g():(kt(this.#a,()=>{this.#a=null}),this.#e=!1)}))}#_(){var t=this.#t;return this.#e&&(this.#u=St(),this.#t.before(this.#u),t=this.#u),t}is_pending(){return this.#e||!!this.parent&&this.parent.is_pending()}has_pending_snippet(){return!!this.#s.pending}#p(t){var s=U,n=Y,r=Z;Ke(this.#i),xe(this.#i),jt(this.#i.ctx);try{return t()}catch(i){return _r(i),null}finally{Ke(s),xe(n),jt(r)}}#g(){const t=this.#s.pending;this.#r!==null&&(this.#c=document.createDocumentFragment(),this.#c.append(this.#u),zr(this.#r,this.#c)),this.#a===null&&(this.#a=Re(()=>t(this.#t)))}#m(t){if(!this.has_pending_snippet()){this.parent&&this.parent.#m(t);return}this.#d+=t,this.#d===0&&(this.#e=!1,this.#a&&kt(this.#a,()=>{this.#a=null}),this.#c&&(this.#t.before(this.#c),this.#c=null))}update_pending_count(t){this.#m(t),this.#f+=t,this.#v&&Lt(this.#v,this.#f)}get_effect_pending(){return this.#b(),f(this.#v)}error(t){var s=this.#s.onerror;let n=this.#s.failed;if(this.#h||!s&&!n)throw t;this.#r&&(Se(this.#r),this.#r=null),this.#a&&(Se(this.#a),this.#a=null),this.#o&&(Se(this.#o),this.#o=null);var r=!1,i=!1;const a=()=>{if(r){ua();return}r=!0,i&&Ki(),He.ensure(),this.#f=0,this.#o!==null&&kt(this.#o,()=>{this.#o=null}),this.#e=this.has_pending_snippet(),this.#r=this.#p(()=>(this.#h=!1,Re(()=>this.#l(this.#t)))),this.#d>0?this.#g():this.#e=!1};var o=Y;try{xe(null),i=!0,s?.(t,a),i=!1}catch(l){Wt(l,this.#i&&this.#i.parent)}finally{xe(o)}n&&Qt(()=>{this.#o=this.#p(()=>{He.ensure(),this.#h=!0;try{return Re(()=>{n(this.#t,()=>t,()=>a)})}catch(l){return Wt(l,this.#i.parent),null}finally{this.#h=!1}})})}}function wa(e,t,s,n){const r=bs()?ws:Cn;if(s.length===0&&e.length===0){n(t.map(r));return}var i=X,a=U,o=ya();function l(){Promise.all(s.map(c=>xa(c))).then(c=>{o();try{n([...t.map(r),...c])}catch(u){(a.f&at)===0&&Wt(u,a)}i?.deactivate(),Ls()}).catch(c=>{Wt(c,a)})}e.length>0?Promise.all(e).then(()=>{o();try{return l()}finally{i?.deactivate(),Ls()}}):l()}function ya(){var e=U,t=Y,s=Z,n=X;return function(i=!0){Ke(e),xe(t),jt(s),i&&n?.activate()}}function Ls(){Ke(null),xe(null),jt(null)}function ws(e){var t=ce|Ee,s=Y!==null&&(Y.f&ce)!==0?Y:null;return U!==null&&(U.f|=Jt),{ctx:Z,deps:null,effects:null,equals:vr,f:t,fn:e,reactions:null,rv:0,v:de,wv:0,parent:s??U,ac:null}}function xa(e,t){let s=U;s===null&&Gi();var n=s.b,r=void 0,i=Ot(de),a=!Y,o=new Map;return Pa(()=>{var l=lr();r=l.promise;try{Promise.resolve(e()).then(l.resolve,l.reject).then(()=>{c===X&&c.committed&&c.deactivate(),Ls()})}catch(d){l.reject(d),Ls()}var c=X;if(a){var u=!n.is_pending();n.update_pending_count(1),c.increment(u),o.get(c)?.reject(Xt),o.delete(c),o.set(c,l)}const v=(d,h=void 0)=>{if(c.activate(),h)h!==Xt&&(i.f|=yt,Lt(i,h));else{(i.f&yt)!==0&&(i.f^=yt),Lt(i,d);for(const[m,y]of o){if(o.delete(m),m===c)break;y.reject(Xt)}}a&&(n.update_pending_count(-1),c.decrement(u))};l.promise.then(v,d=>v(null,d||"unknown"))}),js(()=>{for(const l of o.values())l.reject(Xt)}),new Promise(l=>{function c(u){function v(){u===r?l(i):c(r)}u.then(v,v)}c(r)})}function Sa(e){const t=ws(e);return Br(t),t}function Cn(e){const t=ws(e);return t.equals=pr,t}function yr(e){var t=e.effects;if(t!==null){e.effects=null;for(var s=0;s<t.length;s+=1)Se(t[s])}}function Ea(e){for(var t=e.parent;t!==null;){if((t.f&ce)===0)return(t.f&at)===0?t:null;t=t.parent}return null}function Tn(e){var t,s=U;Ke(Ea(e));try{e.f&=~Dt,yr(e),t=Ur(e)}finally{Ke(s)}return t}function xr(e){var t=Tn(e);if(e.equals(t)||(X?.is_fork||(e.v=t),e.wv=Yr()),!Nt)if(Fe!==null)(ps()||X?.is_fork)&&Fe.set(e,t);else{var s=(e.f&Ye)===0?Xe:oe;le(e,s)}}let ln=new Set;const xt=new Map;let Sr=!1;function Ot(e,t){var s={f:0,v:e,reactions:null,equals:vr,rv:0,wv:0};return s}function qe(e,t){const s=Ot(e);return Br(s),s}function ne(e,t=!1,s=!0){const n=Ot(e);return t||(n.equals=pr),Zt&&s&&Z!==null&&Z.l!==null&&(Z.l.s??=[]).push(n),n}function et(e,t){return G(e,N(()=>f(e))),t}function G(e,t,s=!1){Y!==null&&(!Ve||(Y.f&Un)!==0)&&bs()&&(Y.f&(ce|ct|Mn|Un))!==0&&!lt?.includes(e)&&Vi();let n=s?Ut(t):t;return Lt(e,n)}function Lt(e,t){if(!e.equals(t)){var s=e.v;Nt?xt.set(e,t):xt.set(e,s),e.v=t;var n=He.ensure();n.capture(e,s),(e.f&ce)!==0&&((e.f&Ee)!==0&&Tn(e),le(e,(e.f&Ye)!==0?oe:Xe)),e.wv=Yr(),Er(e,Ee),bs()&&U!==null&&(U.f&oe)!==0&&(U.f&(ut|Rt))===0&&(Oe===null?Na([e]):Oe.push(e)),!n.is_fork&&ln.size>0&&!Sr&&Ma()}return t}function Ma(){Sr=!1;var e=$t;Rs(!0);const t=Array.from(ln);try{for(const s of t)(s.f&oe)!==0&&le(s,Xe),es(s)&&Ht(s)}finally{Rs(e)}ln.clear()}function ds(e){G(e,e.v+1)}function Er(e,t){var s=e.reactions;if(s!==null)for(var n=bs(),r=s.length,i=0;i<r;i++){var a=s[i],o=a.f;if(!(!n&&a===U)){var l=(o&Ee)===0;if(l&&le(a,t),(o&ce)!==0){var c=a;Fe?.delete(c),(o&Dt)===0&&(o&Ye&&(a.f|=Dt),Er(c,Xe))}else l&&((o&ct)!==0&&tt!==null&&tt.add(a),Pt(a))}}}function Ut(e){if(typeof e!="object"||e===null||ot in e)return e;const t=xn(e);if(t!==Li&&t!==Ri)return e;var s=new Map,n=yn(e),r=qe(0),i=It,a=o=>{if(It===i)return o();var l=Y,c=It;xe(null),Kn(i);var u=o();return xe(l),Kn(c),u};return n&&s.set("length",qe(e.length)),new Proxy(e,{defineProperty(o,l,c){(!("value"in c)||c.configurable===!1||c.enumerable===!1||c.writable===!1)&&Wi();var u=s.get(l);return u===void 0?u=a(()=>{var v=qe(c.value);return s.set(l,v),v}):G(u,c.value,!0),!0},deleteProperty(o,l){var c=s.get(l);if(c===void 0){if(l in o){const u=a(()=>qe(de));s.set(l,u),ds(r)}}else G(c,de),ds(r);return!0},get(o,l,c){if(l===ot)return e;var u=s.get(l),v=l in o;if(u===void 0&&(!v||qt(o,l)?.writable)&&(u=a(()=>{var h=Ut(v?o[l]:de),m=qe(h);return m}),s.set(l,u)),u!==void 0){var d=f(u);return d===de?void 0:d}return Reflect.get(o,l,c)},getOwnPropertyDescriptor(o,l){var c=Reflect.getOwnPropertyDescriptor(o,l);if(c&&"value"in c){var u=s.get(l);u&&(c.value=f(u))}else if(c===void 0){var v=s.get(l),d=v?.v;if(v!==void 0&&d!==de)return{enumerable:!0,configurable:!0,value:d,writable:!0}}return c},has(o,l){if(l===ot)return!0;var c=s.get(l),u=c!==void 0&&c.v!==de||Reflect.has(o,l);if(c!==void 0||U!==null&&(!u||qt(o,l)?.writable)){c===void 0&&(c=a(()=>{var d=u?Ut(o[l]):de,h=qe(d);return h}),s.set(l,c));var v=f(c);if(v===de)return!1}return u},set(o,l,c,u){var v=s.get(l),d=l in o;if(n&&l==="length")for(var h=c;h<v.v;h+=1){var m=s.get(h+"");m!==void 0?G(m,de):h in o&&(m=a(()=>qe(de)),s.set(h+"",m))}if(v===void 0)(!d||qt(o,l)?.writable)&&(v=a(()=>qe(void 0)),G(v,Ut(c)),s.set(l,v));else{d=v.v!==de;var y=a(()=>Ut(c));G(v,y)}var _=Reflect.getOwnPropertyDescriptor(o,l);if(_?.set&&_.set.call(u,c),!d){if(n&&typeof l=="string"){var w=s.get("length"),R=Number(l);Number.isInteger(R)&&R>=w.v&&G(w,R+1)}ds(r)}return!0},ownKeys(o){f(r);var l=Reflect.ownKeys(o).filter(v=>{var d=s.get(v);return d===void 0||d.v!==de});for(var[c,u]of s)u.v!==de&&!(c in o)&&l.push(c);return l},setPrototypeOf(){Hi()}})}function jn(e){try{if(e!==null&&typeof e=="object"&&ot in e)return e[ot]}catch{}return e}function Ca(e,t){return Object.is(jn(e),jn(t))}var Wn,Mr,Cr,Tr;function Ta(){if(Wn===void 0){Wn=window,Mr=/Firefox/.test(navigator.userAgent);var e=Element.prototype,t=Node.prototype,s=Text.prototype;Cr=qt(t,"firstChild").get,Tr=qt(t,"nextSibling").get,Xn(e)&&(e.__click=void 0,e.__className=void 0,e.__attributes=null,e.__style=void 0,e.__e=void 0),Xn(s)&&(s.__t=void 0)}}function St(e=""){return document.createTextNode(e)}function bt(e){return Cr.call(e)}function ys(e){return Tr.call(e)}function p(e,t){return bt(e)}function We(e,t=!1){{var s=bt(e);return s instanceof Comment&&s.data===""?ys(s):s}}function g(e,t=1,s=!1){let n=e;for(;t--;)n=ys(n);return n}function ka(e){e.textContent=""}function kr(){return!1}let Hn=!1;function $a(){Hn||(Hn=!0,document.addEventListener("reset",e=>{Promise.resolve().then(()=>{if(!e.defaultPrevented)for(const t of e.target.elements)t.__on_r?.()})},{capture:!0}))}function qs(e){var t=Y,s=U;xe(null),Ke(null);try{return e()}finally{xe(t),Ke(s)}}function $r(e,t,s,n=s){e.addEventListener(t,()=>qs(s));const r=e.__on_r;r?e.__on_r=()=>{r(),n(!0)}:e.__on_r=()=>n(!0),$a()}function Ir(e){U===null&&(Y===null&&Ui(),Xi()),Nt&&Yi()}function Ia(e,t){var s=t.last;s===null?t.last=t.first=e:(s.next=e,e.prev=s,t.last=e)}function Je(e,t,s){var n=U;n!==null&&(n.f&$e)!==0&&(e|=$e);var r={ctx:Z,deps:null,nodes:null,f:e|Ee|Ye,first:null,fn:t,last:null,next:null,parent:n,b:n&&n.b,prev:null,teardown:null,wv:0,ac:null};if(s)try{Ht(r),r.f|=En}catch(o){throw Se(r),o}else t!==null&&Pt(r);var i=r;if(s&&i.deps===null&&i.teardown===null&&i.nodes===null&&i.first===i.last&&(i.f&Jt)===0&&(i=i.first,(e&ct)!==0&&(e&At)!==0&&i!==null&&(i.f|=At)),i!==null&&(i.parent=n,n!==null&&Ia(i,n),Y!==null&&(Y.f&ce)!==0&&(e&Rt)===0)){var a=Y;(a.effects??=[]).push(i)}return r}function ps(){return Y!==null&&!Ve}function js(e){const t=Je(Ys,null,!1);return le(t,oe),t.teardown=e,t}function cn(e){Ir();var t=U.f,s=!Y&&(t&ut)!==0&&(t&En)===0;if(s){var n=Z;(n.e??=[]).push(e)}else return Ar(e)}function Ar(e){return Je(Sn|ur,e,!1)}function Aa(e){return Ir(),Je(Ys|ur,e,!0)}function Da(e){He.ensure();const t=Je(Rt|Jt,e,!0);return(s={})=>new Promise(n=>{s.outro?kt(t,()=>{Se(t),n(void 0)}):(Se(t),n(void 0))})}function Dr(e){return Je(Sn,e,!1)}function st(e,t){var s=Z,n={effect:null,ran:!1,deps:e};s.l.$.push(n),n.effect=xs(()=>{e(),!n.ran&&(n.ran=!0,N(t))})}function Ws(){var e=Z;xs(()=>{for(var t of e.l.$){t.deps();var s=t.effect;(s.f&oe)!==0&&le(s,Xe),es(s)&&Ht(s),t.ran=!1}})}function Pa(e){return Je(Mn|Jt,e,!0)}function xs(e,t=0){return Je(Ys|t,e,!0)}function B(e,t=[],s=[],n=[]){wa(n,t,s,r=>{Je(Ys,()=>e(...r.map(f)),!0)})}function Hs(e,t=0){var s=Je(ct|t,e,!0);return s}function Re(e){return Je(ut|Jt,e,!0)}function Pr(e){var t=e.teardown;if(t!==null){const s=Nt,n=Y;Vn(!0),xe(null);try{t.call(null)}finally{Vn(s),xe(n)}}}function Or(e,t=!1){var s=e.first;for(e.first=e.last=null;s!==null;){const r=s.ac;r!==null&&qs(()=>{r.abort(Xt)});var n=s.next;(s.f&Rt)!==0?s.parent=null:Se(s,t),s=n}}function Oa(e){for(var t=e.first;t!==null;){var s=t.next;(t.f&ut)===0&&Se(t),t=s}}function Se(e,t=!0){var s=!1;(t||(e.f&cr)!==0)&&e.nodes!==null&&e.nodes.end!==null&&(Lr(e.nodes.start,e.nodes.end),s=!0),Or(e,t&&!s),Ns(e,0),le(e,at);var n=e.nodes&&e.nodes.t;if(n!==null)for(const i of n)i.stop();Pr(e);var r=e.parent;r!==null&&r.first!==null&&Rr(e),e.next=e.prev=e.teardown=e.ctx=e.deps=e.fn=e.nodes=e.ac=null}function Lr(e,t){for(;e!==null;){var s=e===t?null:ys(e);e.remove(),e=s}}function Rr(e){var t=e.parent,s=e.prev,n=e.next;s!==null&&(s.next=n),n!==null&&(n.prev=s),t!==null&&(t.first===e&&(t.first=n),t.last===e&&(t.last=s))}function kt(e,t,s=!0){var n=[];Nr(e,n,!0);var r=()=>{s&&Se(e),t&&t()},i=n.length;if(i>0){var a=()=>--i||r();for(var o of n)o.out(a)}else r()}function Nr(e,t,s){if((e.f&$e)===0){e.f^=$e;var n=e.nodes&&e.nodes.t;if(n!==null)for(const o of n)(o.is_global||s)&&t.push(o);for(var r=e.first;r!==null;){var i=r.next,a=(r.f&At)!==0||(r.f&ut)!==0&&(e.f&ct)!==0;Nr(r,t,a?s:!1),r=i}}}function kn(e){Fr(e,!0)}function Fr(e,t){if((e.f&$e)!==0){e.f^=$e,(e.f&oe)===0&&(le(e,Ee),Pt(e));for(var s=e.first;s!==null;){var n=s.next,r=(s.f&At)!==0||(s.f&ut)!==0;Fr(s,r?t:!1),s=n}var i=e.nodes&&e.nodes.t;if(i!==null)for(const a of i)(a.is_global||t)&&a.in()}}function zr(e,t){if(e.nodes)for(var s=e.nodes.start,n=e.nodes.end;s!==null;){var r=s===n?null:ys(s);t.append(s),s=r}}let Yt=null;function La(e){var t=Yt;try{if(Yt=new Set,N(e),t!==null)for(var s of Yt)t.add(s);return Yt}finally{Yt=t}}function Ra(e){for(var t of La(e))Lt(t,t.v)}let $t=!1;function Rs(e){$t=e}let Nt=!1;function Vn(e){Nt=e}let Y=null,Ve=!1;function xe(e){Y=e}let U=null;function Ke(e){U=e}let lt=null;function Br(e){Y!==null&&(lt===null?lt=[e]:lt.push(e))}let ge=null,ke=0,Oe=null;function Na(e){Oe=e}let Gr=1,gs=0,It=gs;function Kn(e){It=e}function Yr(){return++Gr}function es(e){var t=e.f;if((t&Ee)!==0)return!0;if(t&ce&&(e.f&=~Dt),(t&Xe)!==0){var s=e.deps;if(s!==null)for(var n=s.length,r=0;r<n;r++){var i=s[r];if(es(i)&&xr(i),i.wv>e.wv)return!0}(t&Ye)!==0&&Fe===null&&le(e,oe)}return!1}function Xr(e,t,s=!0){var n=e.reactions;if(n!==null&&!lt?.includes(e))for(var r=0;r<n.length;r++){var i=n[r];(i.f&ce)!==0?Xr(i,t,!1):t===i&&(s?le(i,Ee):(i.f&oe)!==0&&le(i,Xe),Pt(i))}}function Ur(e){var t=ge,s=ke,n=Oe,r=Y,i=lt,a=Z,o=Ve,l=It,c=e.f;ge=null,ke=0,Oe=null,Y=(c&(ut|Rt))===0?e:null,lt=null,jt(e.ctx),Ve=!1,It=++gs,e.ac!==null&&(qs(()=>{e.ac.abort(Xt)}),e.ac=null);try{e.f|=an;var u=e.fn,v=u(),d=e.deps;if(ge!==null){var h;if(Ns(e,ke),d!==null&&ke>0)for(d.length=ke+ge.length,h=0;h<ge.length;h++)d[ke+h]=ge[h];else e.deps=d=ge;if(ps()&&(e.f&Ye)!==0)for(h=ke;h<d.length;h++)(d[h].reactions??=[]).push(e)}else d!==null&&ke<d.length&&(Ns(e,ke),d.length=ke);if(bs()&&Oe!==null&&!Ve&&d!==null&&(e.f&(ce|Xe|Ee))===0)for(h=0;h<Oe.length;h++)Xr(Oe[h],e);return r!==null&&r!==e&&(gs++,Oe!==null&&(n===null?n=Oe:n.push(...Oe))),(e.f&yt)!==0&&(e.f^=yt),v}catch(m){return _r(m)}finally{e.f^=an,ge=t,ke=s,Oe=n,Y=r,lt=i,jt(a),Ve=o,It=l}}function Fa(e,t){let s=t.reactions;if(s!==null){var n=Oi.call(s,e);if(n!==-1){var r=s.length-1;r===0?s=t.reactions=null:(s[n]=s[r],s.pop())}}s===null&&(t.f&ce)!==0&&(ge===null||!ge.includes(t))&&(le(t,Xe),(t.f&Ye)!==0&&(t.f^=Ye,t.f&=~Dt),yr(t),Ns(t,0))}function Ns(e,t){var s=e.deps;if(s!==null)for(var n=t;n<s.length;n++)Fa(e,s[n])}function Ht(e){var t=e.f;if((t&at)===0){le(e,oe);var s=U,n=$t;U=e,$t=!0;try{(t&(ct|Fi))!==0?Oa(e):Or(e),Pr(e);var r=Ur(e);e.teardown=typeof r=="function"?r:null,e.wv=Gr;var i;rn&&fa&&(e.f&Ee)!==0&&e.deps}finally{$t=n,U=s}}}async function za(){await Promise.resolve(),ha()}function f(e){var t=e.f,s=(t&ce)!==0;if(Yt?.add(e),Y!==null&&!Ve){var n=U!==null&&(U.f&at)!==0;if(!n&&!lt?.includes(e)){var r=Y.deps;if((Y.f&an)!==0)e.rv<gs&&(e.rv=gs,ge===null&&r!==null&&r[ke]===e?ke++:ge===null?ge=[e]:ge.includes(e)||ge.push(e));else{(Y.deps??=[]).push(e);var i=e.reactions;i===null?e.reactions=[Y]:i.includes(Y)||i.push(Y)}}}if(Nt){if(xt.has(e))return xt.get(e);if(s){var a=e,o=a.v;return((a.f&oe)===0&&a.reactions!==null||jr(a))&&(o=Tn(a)),xt.set(a,o),o}}else s&&(!Fe?.has(e)||X?.is_fork&&!ps())&&(a=e,es(a)&&xr(a),$t&&ps()&&(a.f&Ye)===0&&qr(a));if(Fe?.has(e))return Fe.get(e);if((e.f&yt)!==0)throw e.v;return e.v}function qr(e){if(e.deps!==null){e.f^=Ye;for(const t of e.deps)(t.reactions??=[]).push(e),(t.f&ce)!==0&&(t.f&Ye)===0&&qr(t)}}function jr(e){if(e.v===de)return!0;if(e.deps===null)return!1;for(const t of e.deps)if(xt.has(t)||(t.f&ce)!==0&&jr(t))return!0;return!1}function N(e){var t=Ve;try{return Ve=!0,e()}finally{Ve=t}}const Ba=-7169;function le(e,t){e.f=e.f&Ba|t}function Ga(e){if(!(typeof e!="object"||!e||e instanceof EventTarget)){if(ot in e)un(e);else if(!Array.isArray(e))for(let t in e){const s=e[t];typeof s=="object"&&s&&ot in s&&un(s)}}}function un(e,t=new Set){if(typeof e=="object"&&e!==null&&!(e instanceof EventTarget)&&!t.has(e)){t.add(e),e instanceof Date&&e.getTime();for(let n in e)try{un(e[n],t)}catch{}const s=xn(e);if(s!==Object.prototype&&s!==Array.prototype&&s!==Map.prototype&&s!==Set.prototype&&s!==Date.prototype){const n=or(s);for(let r in n){const i=n[r].get;if(i)try{i.call(e)}catch{}}}}}const Ya=["touchstart","touchmove"];function Xa(e){return Ya.includes(e)}const Wr=new Set,fn=new Set;function Ua(e,t,s,n={}){function r(i){if(n.capture||ls.call(t,i),!i.cancelBubble)return qs(()=>s?.call(this,i))}return e.startsWith("pointer")||e.startsWith("touch")||e==="wheel"?Qt(()=>{t.addEventListener(e,r,n)}):t.addEventListener(e,r,n),r}function Hr(e,t,s,n,r){var i={capture:n,passive:r},a=Ua(e,t,s,i);(t===document.body||t===window||t===document||t instanceof HTMLMediaElement)&&js(()=>{t.removeEventListener(e,a,i)})}function ts(e){for(var t=0;t<e.length;t++)Wr.add(e[t]);for(var s of fn)s(e)}let Jn=null;function ls(e){var t=this,s=t.ownerDocument,n=e.type,r=e.composedPath?.()||[],i=r[0]||e.target;Jn=e;var a=0,o=Jn===e&&e.__root;if(o){var l=r.indexOf(o);if(l!==-1&&(t===document||t===window)){e.__root=t;return}var c=r.indexOf(t);if(c===-1)return;l<=c&&(a=l)}if(i=r[a]||e.target,i!==t){ar(e,"currentTarget",{configurable:!0,get(){return i||s}});var u=Y,v=U;xe(null),Ke(null);try{for(var d,h=[];i!==null;){var m=i.assignedSlot||i.parentNode||i.host||null;try{var y=i["__"+n];y!=null&&(!i.disabled||e.target===i)&&y.call(i,e)}catch(_){d?h.push(_):d=_}if(e.cancelBubble||m===t||m===null)break;i=m}if(d){for(let _ of h)queueMicrotask(()=>{throw _});throw d}}finally{e.__root=t,delete e.currentTarget,xe(u),Ke(v)}}}function Vr(e){var t=document.createElement("template");return t.innerHTML=e.replaceAll("<!>","<!---->"),t.content}function Fs(e,t){var s=U;s.nodes===null&&(s.nodes={start:e,end:t,a:null,t:null})}function T(e,t){var s=(t&aa)!==0,n=(t&oa)!==0,r,i=!e.startsWith("<!>");return()=>{r===void 0&&(r=Vr(i?e:"<!>"+e),s||(r=bt(r)));var a=n||Mr?document.importNode(r,!0):r.cloneNode(!0);if(s){var o=bt(a),l=a.lastChild;Fs(o,l)}else Fs(a,a);return a}}function dn(){var e=document.createDocumentFragment(),t=document.createComment(""),s=St();return e.append(t,s),Fs(t,s),e}function S(e,t){e!==null&&e.before(t)}function F(e,t){var s=t==null?"":typeof t=="object"?t+"":t;s!==(e.__t??=e.nodeValue)&&(e.__t=s,e.nodeValue=s+"")}function qa(e,t){return ja(e,t)}const Bt=new Map;function ja(e,{target:t,anchor:s,props:n={},events:r,context:i,intro:a=!0}){Ta();var o=new Set,l=v=>{for(var d=0;d<v.length;d++){var h=v[d];if(!o.has(h)){o.add(h);var m=Xa(h);t.addEventListener(h,ls,{passive:m});var y=Bt.get(h);y===void 0?(document.addEventListener(h,ls,{passive:m}),Bt.set(h,1)):Bt.set(h,y+1)}}};l(Gs(Wr)),fn.add(l);var c=void 0,u=Da(()=>{var v=s??t.appendChild(St());return ma(v,{pending:()=>{}},d=>{if(i){ft({});var h=Z;h.c=i}r&&(n.$$events=r),c=e(d,n)||{},i&&dt()}),()=>{for(var d of o){t.removeEventListener(d,ls);var h=Bt.get(d);--h===0?(document.removeEventListener(d,ls),Bt.delete(d)):Bt.set(d,h)}fn.delete(l),v!==s&&v.parentNode?.removeChild(v)}});return Wa.set(c,u),c}let Wa=new WeakMap;class Kr{anchor;#e=new Map;#t=new Map;#n=new Map;#s=new Set;#l=!0;constructor(t,s=!0){this.anchor=t,this.#l=s}#i=()=>{var t=X;if(this.#e.has(t)){var s=this.#e.get(t),n=this.#t.get(s);if(n)kn(n),this.#s.delete(s);else{var r=this.#n.get(s);r&&(this.#t.set(s,r.effect),this.#n.delete(s),r.fragment.lastChild.remove(),this.anchor.before(r.fragment),n=r.effect)}for(const[i,a]of this.#e){if(this.#e.delete(i),i===t)break;const o=this.#n.get(a);o&&(Se(o.effect),this.#n.delete(a))}for(const[i,a]of this.#t){if(i===s||this.#s.has(i))continue;const o=()=>{if(Array.from(this.#e.values()).includes(i)){var c=document.createDocumentFragment();zr(a,c),c.append(St()),this.#n.set(i,{effect:a,fragment:c})}else Se(a);this.#s.delete(i),this.#t.delete(i)};this.#l||!n?(this.#s.add(i),kt(a,o,!1)):o()}}};#r=t=>{this.#e.delete(t);const s=Array.from(this.#e.values());for(const[n,r]of this.#n)s.includes(n)||(Se(r.effect),this.#n.delete(n))};ensure(t,s){var n=X,r=kr();if(s&&!this.#t.has(t)&&!this.#n.has(t))if(r){var i=document.createDocumentFragment(),a=St();i.append(a),this.#n.set(t,{effect:Re(()=>s(a)),fragment:i})}else this.#t.set(t,Re(()=>s(this.anchor)));if(this.#e.set(n,t),r){for(const[o,l]of this.#t)o===t?n.skipped_effects.delete(l):n.skipped_effects.add(l);for(const[o,l]of this.#n)o===t?n.skipped_effects.delete(l.effect):n.skipped_effects.add(l.effect);n.oncommit(this.#i),n.ondiscard(this.#r)}else this.#i()}}function re(e,t,s=!1){var n=new Kr(e),r=s?At:0;function i(a,o){n.ensure(a,o)}Hs(()=>{var a=!1;t((o,l=!0)=>{a=!0,i(l,o)}),a||i(!1,null)},r)}function nt(e,t){return t}function Ha(e,t,s){for(var n=[],r=t.length,i,a=t.length,o=0;o<r;o++){let v=t[o];kt(v,()=>{if(i){if(i.pending.delete(v),i.done.add(v),i.pending.size===0){var d=e.outrogroups;vn(Gs(i.done)),d.delete(i),d.size===0&&(e.outrogroups=null)}}else a-=1},!1)}if(a===0){var l=n.length===0&&s!==null;if(l){var c=s,u=c.parentNode;ka(u),u.append(c),e.items.clear()}vn(t,!l)}else i={pending:new Set(t),done:new Set},(e.outrogroups??=new Set).add(i)}function vn(e,t=!0){for(var s=0;s<e.length;s++)Se(e[s],t)}var Zn;function Be(e,t,s,n,r,i=null){var a=e,o=new Map,l=(t&dr)!==0;if(l){var c=e;a=c.appendChild(St())}var u=null,v=Cn(()=>{var w=s();return yn(w)?w:w==null?[]:Gs(w)}),d,h=!0;function m(){_.fallback=u,Va(_,d,a,t,n),u!==null&&(d.length===0?(u.f&rt)===0?kn(u):(u.f^=rt,cs(u,null,a)):kt(u,()=>{u=null}))}var y=Hs(()=>{d=f(v);for(var w=d.length,R=new Set,k=X,M=kr(),C=0;C<w;C+=1){var P=d[C],b=n(P,C),x=h?null:o.get(b);x?(x.v&&Lt(x.v,P),x.i&&Lt(x.i,C),M&&k.skipped_effects.delete(x.e)):(x=Ka(o,h?a:Zn??=St(),P,b,C,r,t,s),h||(x.e.f|=rt),o.set(b,x)),R.add(b)}if(w===0&&i&&!u&&(h?u=Re(()=>i(a)):(u=Re(()=>i(Zn??=St())),u.f|=rt)),!h)if(M){for(const[O,$]of o)R.has(O)||k.skipped_effects.add($.e);k.oncommit(m),k.ondiscard(()=>{})}else m();f(v)}),_={effect:y,items:o,outrogroups:null,fallback:u};h=!1}function Va(e,t,s,n,r){var i=(n&Qi)!==0,a=t.length,o=e.items,l=e.effect.first,c,u=null,v,d=[],h=[],m,y,_,w;if(i)for(w=0;w<a;w+=1)m=t[w],y=r(m,w),_=o.get(y).e,(_.f&rt)===0&&(_.nodes?.a?.measure(),(v??=new Set).add(_));for(w=0;w<a;w+=1){if(m=t[w],y=r(m,w),_=o.get(y).e,e.outrogroups!==null)for(const $ of e.outrogroups)$.pending.delete(_),$.done.delete(_);if((_.f&rt)!==0)if(_.f^=rt,_===l)cs(_,null,s);else{var R=u?u.next:l;_===e.effect.last&&(e.effect.last=_.prev),_.prev&&(_.prev.next=_.next),_.next&&(_.next.prev=_.prev),mt(e,u,_),mt(e,_,R),cs(_,R,s),u=_,d=[],h=[],l=u.next;continue}if((_.f&$e)!==0&&(kn(_),i&&(_.nodes?.a?.unfix(),(v??=new Set).delete(_))),_!==l){if(c!==void 0&&c.has(_)){if(d.length<h.length){var k=h[0],M;u=k.prev;var C=d[0],P=d[d.length-1];for(M=0;M<d.length;M+=1)cs(d[M],k,s);for(M=0;M<h.length;M+=1)c.delete(h[M]);mt(e,C.prev,P.next),mt(e,u,C),mt(e,P,k),l=k,u=P,w-=1,d=[],h=[]}else c.delete(_),cs(_,l,s),mt(e,_.prev,_.next),mt(e,_,u===null?e.effect.first:u.next),mt(e,u,_),u=_;continue}for(d=[],h=[];l!==null&&l!==_;)(c??=new Set).add(l),h.push(l),l=l.next;if(l===null)continue}(_.f&rt)===0&&d.push(_),u=_,l=_.next}if(e.outrogroups!==null){for(const $ of e.outrogroups)$.pending.size===0&&(vn(Gs($.done)),e.outrogroups?.delete($));e.outrogroups.size===0&&(e.outrogroups=null)}if(l!==null||c!==void 0){var b=[];if(c!==void 0)for(_ of c)(_.f&$e)===0&&b.push(_);for(;l!==null;)(l.f&$e)===0&&l!==e.fallback&&b.push(l),l=l.next;var x=b.length;if(x>0){var O=(n&dr)!==0&&a===0?s:null;if(i){for(w=0;w<x;w+=1)b[w].nodes?.a?.measure();for(w=0;w<x;w+=1)b[w].nodes?.a?.fix()}Ha(e,b,O)}}i&&Qt(()=>{if(v!==void 0)for(_ of v)_.nodes?.a?.apply()})}function Ka(e,t,s,n,r,i,a,o){var l=(a&Ji)!==0?(a&ea)===0?ne(s,!1,!1):Ot(s):null,c=(a&Zi)!==0?Ot(r):null;return{v:l,i:c,e:Re(()=>(i(t,l??s,c??r,o),()=>{e.delete(n)}))}}function cs(e,t,s){if(e.nodes)for(var n=e.nodes.start,r=e.nodes.end,i=t&&(t.f&rt)===0?t.nodes.start:s;n!==null;){var a=ys(n);if(i.before(n),n===r)return;n=a}}function mt(e,t,s){t===null?e.effect.first=s:t.next=s,s===null?e.effect.last=t:s.prev=t}function Ja(e,t,s=!1,n=!1,r=!1){var i=e,a="";B(()=>{var o=U;if(a!==(a=t()??"")&&(o.nodes!==null&&(Lr(o.nodes.start,o.nodes.end),o.nodes=null),a!=="")){var l=a+"";s?l=`<svg>${l}</svg>`:n&&(l=`<math>${l}</math>`);var c=Vr(l);if((s||n)&&(c=bt(c)),Fs(bt(c),c.lastChild),s||n)for(;bt(c);)i.before(bt(c));else i.before(c)}})}function Za(e,t,...s){var n=new Kr(e);Hs(()=>{const r=t()??null;n.ensure(r,r&&(i=>r(i,...s)))},At)}function Jr(e){var t,s,n="";if(typeof e=="string"||typeof e=="number")n+=e;else if(typeof e=="object")if(Array.isArray(e)){var r=e.length;for(t=0;t<r;t++)e[t]&&(s=Jr(e[t]))&&(n&&(n+=" "),n+=s)}else for(s in e)e[s]&&(n&&(n+=" "),n+=s);return n}function Qa(){for(var e,t,s=0,n="",r=arguments.length;s<r;s++)(e=arguments[s])&&(t=Jr(e))&&(n&&(n+=" "),n+=t);return n}function eo(e){return typeof e=="object"?Qa(e):e??""}const Qn=[...` 	
\r\fÂ \v\uFEFF`];function to(e,t,s){var n=e==null?"":""+e;if(t&&(n=n?n+" "+t:t),s){for(var r in s)if(s[r])n=n?n+" "+r:r;else if(n.length)for(var i=r.length,a=0;(a=n.indexOf(r,a))>=0;){var o=a+i;(a===0||Qn.includes(n[a-1]))&&(o===n.length||Qn.includes(n[o]))?n=(a===0?"":n.substring(0,a))+n.substring(o+1):a=o}}return n===""?null:n}function so(e,t){return e==null?null:String(e)}function se(e,t,s,n,r,i){var a=e.__className;if(a!==s||a===void 0){var o=to(s,n,i);o==null?e.removeAttribute("class"):e.className=o,e.__className=s}else if(i&&r!==i)for(var l in i){var c=!!i[l];(r==null||c!==!!r[l])&&e.classList.toggle(l,c)}return i}function $n(e,t,s,n){var r=e.__style;if(r!==t){var i=so(t);i==null?e.removeAttribute("style"):e.style.cssText=i,e.__style=t}return n}function Zr(e,t,s=!1){if(e.multiple){if(t==null)return;if(!yn(t))return ca();for(var n of e.options)n.selected=t.includes(vs(n));return}for(n of e.options){var r=vs(n);if(Ca(r,t)){n.selected=!0;return}}(!s||t!==void 0)&&(e.selectedIndex=-1)}function no(e){var t=new MutationObserver(()=>{Zr(e,e.__value)});t.observe(e,{childList:!0,subtree:!0,attributes:!0,attributeFilter:["value"]}),js(()=>{t.disconnect()})}function ro(e,t,s=t){var n=new WeakSet,r=!0;$r(e,"change",i=>{var a=i?"[selected]":":checked",o;if(e.multiple)o=[].map.call(e.querySelectorAll(a),vs);else{var l=e.querySelector(a)??e.querySelector("option:not([disabled])");o=l&&vs(l)}s(o),X!==null&&n.add(X)}),Dr(()=>{var i=t();if(e===document.activeElement){var a=us??X;if(n.has(a))return}if(Zr(e,i,r),r&&i===void 0){var o=e.querySelector(":checked");o!==null&&(i=vs(o),s(i))}e.__value=i,r=!1}),no(e)}function vs(e){return"__value"in e?e.__value:e.value}const io=Symbol("is custom element"),ao=Symbol("is html");function hn(e,t){var s=Qr(e);s.value===(s.value=t??void 0)||e.value===t&&(t!==0||e.nodeName!=="PROGRESS")||(e.value=t??"")}function ze(e,t,s,n){var r=Qr(e);r[t]!==(r[t]=s)&&(t==="loading"&&(e[Bi]=s),s==null?e.removeAttribute(t):typeof s!="string"&&oo(e).includes(t)?e[t]=s:e.setAttribute(t,s))}function Qr(e){return e.__attributes??={[io]:e.nodeName.includes("-"),[ao]:e.namespaceURI===la}}var er=new Map;function oo(e){var t=e.getAttribute("is")||e.nodeName,s=er.get(t);if(s)return s;er.set(t,s=[]);for(var n,r=e,i=Element.prototype;i!==r;){n=or(r);for(var a in n)n[a].set&&s.push(a);r=xn(r)}return s}function ks(e,t,s=t){var n=new WeakSet;$r(e,"input",async r=>{var i=r?e.defaultValue:e.value;if(i=en(e)?tn(i):i,s(i),X!==null&&n.add(X),await za(),i!==(i=t())){var a=e.selectionStart,o=e.selectionEnd,l=e.value.length;if(e.value=i??"",o!==null){var c=e.value.length;a===o&&o===l&&c>l?(e.selectionStart=c,e.selectionEnd=c):(e.selectionStart=a,e.selectionEnd=Math.min(o,c))}}}),N(t)==null&&e.value&&(s(en(e)?tn(e.value):e.value),X!==null&&n.add(X)),xs(()=>{var r=t();if(e===document.activeElement){var i=us??X;if(n.has(i))return}en(e)&&r===tn(e.value)||e.type==="date"&&!r&&!e.value||r!==e.value&&(e.value=r??"")})}function en(e){var t=e.type;return t==="number"||t==="range"}function tn(e){return e===""?null:+e}function tr(e,t){return e===t||e?.[ot]===t}function Vt(e={},t,s,n){return Dr(()=>{var r,i;return xs(()=>{r=i,i=[],N(()=>{e!==s(...i)&&(t(e,...i),r&&tr(s(...r),e)&&t(null,...r))})}),()=>{Qt(()=>{i&&tr(s(...i),e)&&t(null,...i)})}}),e}function Ss(e=!1){const t=Z,s=t.l.u;if(!s)return;let n=()=>Ga(t.s);if(e){let r=0,i={};const a=ws(()=>{let o=!1;const l=t.s;for(const c in l)l[c]!==i[c]&&(i[c]=l[c],o=!0);return o&&r++,r});n=()=>f(a)}s.b.length&&Aa(()=>{sr(t,n),Os(s.b)}),cn(()=>{const r=N(()=>s.m.map(Ni));return()=>{for(const i of r)typeof i=="function"&&i()}}),s.a.length&&cn(()=>{sr(t,n),Os(s.a)})}function sr(e,t){if(e.l.s)for(const s of e.l.s)f(s);t()}function In(e,t,s){if(e==null)return t(void 0),s&&s(void 0),it;const n=N(()=>e.subscribe(t,s));return n.unsubscribe?()=>n.unsubscribe():n}const Gt=[];function lo(e,t){return{subscribe:Ue(e,t).subscribe}}function Ue(e,t=it){let s=null;const n=new Set;function r(o){if(hr(e,o)&&(e=o,s)){const l=!Gt.length;for(const c of n)c[1](),Gt.push(c,e);if(l){for(let c=0;c<Gt.length;c+=2)Gt[c][0](Gt[c+1]);Gt.length=0}}}function i(o){r(o(e))}function a(o,l=it){const c=[o,l];return n.add(c),n.size===1&&(s=t(r,i)||it),o(e),()=>{n.delete(c),n.size===0&&s&&(s(),s=null)}}return{set:r,update:i,subscribe:a}}function Ft(e,t,s){const n=!Array.isArray(e),r=n?[e]:e;if(!r.every(Boolean))throw new Error("derived() expects stores as input, got a falsy value");const i=t.length<2;return lo(s,(a,o)=>{let l=!1;const c=[];let u=0,v=it;const d=()=>{if(u)return;v();const m=t(n?c[0]:c,a,o);i?a(m):v=typeof m=="function"?m:it},h=r.map((m,y)=>In(m,_=>{c[y]=_,u&=~(1<<y),l&&d()},()=>{u|=1<<y}));return l=!0,d(),function(){Os(h),v(),l=!1}})}function Ze(e){let t;return In(e,s=>t=s)(),t}let $s=!1,pn=Symbol();function K(e,t,s){const n=s[t]??={store:null,source:ne(void 0),unsubscribe:it};if(n.store!==e&&!(pn in s))if(n.unsubscribe(),n.store=e??null,e==null)n.source.v=void 0,n.unsubscribe=it;else{var r=!0;n.unsubscribe=In(e,i=>{r?n.source.v=i:G(n.source,i)}),r=!1}return e&&pn in s?Ze(e):f(n.source)}function zt(){const e={};function t(){js(()=>{for(var s in e)e[s].unsubscribe();ar(e,pn,{enumerable:!1,value:!0})})}return[e,t]}function co(e){var t=$s;try{return $s=!1,[e(),$s]}finally{$s=t}}function je(e,t,s,n){var r=!Zt||(s&sa)!==0,i=(s&ra)!==0,a=(s&ia)!==0,o=n,l=!0,c=()=>(l&&(l=!1,o=a?N(n):n),o),u;if(i){var v=ot in e||zi in e;u=qt(e,t)?.set??(v&&t in e?k=>e[t]=k:void 0)}var d,h=!1;i?[d,h]=co(()=>e[t]):d=e[t],d===void 0&&n!==void 0&&(d=c(),u&&(r&&ji(),u(d)));var m;if(r?m=()=>{var k=e[t];return k===void 0?c():(l=!0,k)}:m=()=>{var k=e[t];return k!==void 0&&(o=void 0),k===void 0?o:k},r&&(s&na)===0)return m;if(u){var y=e.$$legacy;return(function(k,M){return arguments.length>0?((!r||!M||y||h)&&u(M?m():k),k):m()})}var _=!1,w=((s&ta)!==0?ws:Cn)(()=>(_=!1,m()));i&&f(w);var R=U;return(function(k,M){if(arguments.length>0){const C=M?f(w):r&&i?Ut(k):k;return G(w,C),_=!0,o!==void 0&&(o=C),k}return Nt&&_||(R.f&at)!==0?w.v:f(w)})}function Vs(e){Z===null&&fr(),Zt&&Z.l!==null?uo(Z).m.push(e):cn(()=>{const t=N(e);if(typeof t=="function")return t})}function ei(e){Z===null&&fr(),Vs(()=>()=>N(e))}function uo(e){var t=e.l;return t.u??={a:[],b:[],m:[]}}const fo="5";typeof window<"u"&&((window.__svelte??={}).v??=new Set).add(fo);da();class vo{propagator=null;config;currentSeed;isInitialized=!1;wasmModule=null;currentBackend="cpu";gpuAvailable=!1;constructor(t,s){this.config=t,this.currentSeed=s}async initialize(t="cpu"){try{const n="/autoverse/preview/pr-55/pkg/flow_lenia.js";this.wasmModule=await import(n),await this.wasmModule.default(),this.gpuAvailable=await this.checkWebGPU();const r=t==="gpu"&&this.gpuAvailable?"gpu":"cpu";await this.createPropagator(r),this.isInitialized=!0}catch(s){throw new Error(`Failed to initialize WASM: ${s}`)}}async checkWebGPU(){if(typeof navigator>"u"||!("gpu"in navigator))return!1;try{return await navigator.gpu.requestAdapter()!==null}catch{return!1}}async createPropagator(t){if(!this.wasmModule)throw new Error("WASM module not loaded");const s=JSON.stringify(this.config),n=JSON.stringify(this.currentSeed);t==="gpu"&&this.gpuAvailable?(this.propagator=await new this.wasmModule.WasmGpuPropagator(s,n),this.currentBackend="gpu"):(this.propagator=new this.wasmModule.WasmPropagator(s,n),this.currentBackend="cpu")}async switchBackend(t){if(!this.isInitialized)throw new Error("Simulation not initialized");return t==="gpu"&&!this.gpuAvailable?!1:(t===this.currentBackend||await this.createPropagator(t),!0)}isGpuAvailable(){return this.gpuAvailable}getBackend(){return this.currentBackend}async step(){this.ensureInitialized(),this.currentBackend==="gpu"?await this.propagator.step():this.propagator.step()}async run(t){this.ensureInitialized(),this.currentBackend==="gpu"?await this.propagator.run(BigInt(t)):this.propagator.run(BigInt(t))}getState(){return this.ensureInitialized(),this.propagator.getState()}reset(t){this.ensureInitialized(),t&&(this.currentSeed=t),this.propagator.reset(JSON.stringify(this.currentSeed))}totalMass(){return this.ensureInitialized(),this.propagator.totalMass()}getTime(){return this.ensureInitialized(),this.propagator.getTime()}getStep(){return this.ensureInitialized(),this.propagator.getStep()}getWidth(){return this.config.width}getHeight(){return this.config.height}getConfig(){return{...this.config}}extractRegion(t,s,n,r){this.ensureInitialized();const i=this.getState(),a=[];for(let o=0;o<i.channels.length;o++){const l=[];for(let c=0;c<r;c++)for(let u=0;u<n;u++){const v=(t+u)%i.width,h=(s+c)%i.height*i.width+v;l.push(i.channels[o][h])}a.push(l)}return{width:n,height:r,channels:a,sourceX:t,sourceY:s}}placeRegion(t,s,n){this.ensureInitialized();const r=this.getState(),i=new Map;for(let l=0;l<r.channels.length;l++)for(let c=0;c<r.height;c++)for(let u=0;u<r.width;u++){const v=c*r.width+u,d=r.channels[l][v];d>.001&&i.set(`${u},${c},${l}`,d)}for(let l=0;l<t.channels.length;l++)for(let c=0;c<t.height;c++)for(let u=0;u<t.width;u++){const v=(s+u)%this.config.width,d=(n+c)%this.config.height,h=c*t.width+u,m=t.channels[l][h];m>.001&&i.set(`${v},${d},${l}`,m)}const a=[];for(const[l,c]of i){const[u,v,d]=l.split(",").map(Number);a.push([u,v,d,c])}const o={pattern:{type:"Custom",values:a}};this.reset(o)}drawAt(t,s,n,r,i=0){this.ensureInitialized();const a=this.getState(),o=[];for(let c=0;c<a.channels.length;c++)for(let u=0;u<a.height;u++)for(let v=0;v<a.width;v++){const d=u*a.width+v;let h=a.channels[c][d];if(c===i){const m=v-t,y=u-s,_=Math.sqrt(m*m+y*y);if(_<=n){const w=1-_/n;h=Math.min(1,h+r*w*w)}}h>.001&&o.push([v,u,c,h])}const l={pattern:{type:"Custom",values:o}};this.reset(l)}eraseAt(t,s,n,r=0){this.ensureInitialized();const i=this.getState(),a=[];for(let l=0;l<i.channels.length;l++)for(let c=0;c<i.height;c++)for(let u=0;u<i.width;u++){const v=c*i.width+u;let d=i.channels[l][v];if(l===r){const h=u-t,m=c-s,y=Math.sqrt(h*h+m*m);if(y<=n){const _=1-y/n;d=Math.max(0,d*(1-_*_))}}d>.001&&a.push([u,c,l,d])}const o={pattern:{type:"Custom",values:a}};this.reset(o)}ensureInitialized(){if(!this.isInitialized||!this.propagator)throw new Error("Simulation not initialized. Call initialize() first.")}}const gn={width:128,height:128,channels:1,dt:.1,kernel_radius:13,kernels:[{radius:1,rings:[{amplitude:1,distance:.5,width:.15}],weight:1,mu:.15,sigma:.015,source_channel:0,target_channel:0}],flow:{beta_a:1,n:2,distribution_size:1}},ho={pattern:{type:"GaussianBlob",center:[.5,.5],radius:.1,amplitude:1,channel:0}},po={initialized:!1,playing:!1,step:0,time:0,totalMass:0,fps:0,frameTime:0,backend:"cpu",gpuAvailable:!1,config:gn,state:null},ae=Ue(po),ti=Ue([]);function W(e,t="info"){ti.update(s=>[...s.slice(-100),{message:e,level:t,timestamp:Date.now()}])}let ee=null,Is=null,hs=0,As=0,_n=0,si=1;function zs(){return ee}function ni(e){si=Math.max(1,Math.min(10,e))}async function go(){ee=new vo(gn,ho),await ee.initialize();const e=ee.getState();ae.update(t=>({...t,initialized:!0,step:ee.getStep(),time:ee.getTime(),totalMass:ee.totalMass(),backend:ee.getBackend(),gpuAvailable:ee.isGpuAvailable(),config:gn,state:e}))}function ri(){!ee||Ze(ae).playing||(ae.update(t=>({...t,playing:!0})),hs=performance.now(),_n=hs,As=0,oi(hs),W("Simulation started","info"))}function An(){ae.update(e=>({...e,playing:!1})),Is!==null&&(cancelAnimationFrame(Is),Is=null),W("Simulation paused","info")}async function ii(){ee&&(await ee.step(),Dn())}function _s(e){ee&&(ee.reset(e),Dn(),W("Simulation reset","info"))}async function ai(e){if(!ee)return!1;const t=await ee.switchBackend(e);return t?(ae.update(s=>({...s,backend:e})),W(`Switched to ${e.toUpperCase()} backend`,"success")):W(`Failed to switch to ${e} backend`,"error"),t}async function oi(e){if(!Ze(ae).playing||!ee)return;const s=e-hs;hs=e,await ee.run(si),Dn(),As++,e-_n>=1e3&&(ae.update(n=>({...n,fps:As,frameTime:s})),As=0,_n=e),Is=requestAnimationFrame(n=>oi(n))}function Dn(){if(!ee)return;const e=ee.getState();ae.update(t=>({...t,step:ee.getStep(),time:ee.getTime(),totalMass:ee.totalMass(),state:e}))}const _o=Ft(ae,e=>e.time.toFixed(2)),li=Ft(ae,e=>e.totalMass.toLocaleString(void 0,{maximumFractionDigits:0})),ci=Ft(ae,e=>e.step.toString().padStart(8,"0")),mo={mode:"view",brushSize:5,brushIntensity:.8,colorScheme:"theme",visualizationMode:"mass",showGrid:!1,showScanlines:!0,showSelection:!0,zoom:1,panX:0,panY:0},vt=Ue(mo);function ui(e){vt.update(t=>({...t,mode:e}))}function fi(e){vt.update(t=>({...t,brushSize:Math.max(1,Math.min(50,e))}))}function di(e){vt.update(t=>({...t,brushIntensity:Math.max(0,Math.min(1,e))}))}function bo(e){vt.update(t=>({...t,colorScheme:e}))}function wo(){vt.update(e=>({...e,showScanlines:!e.showScanlines}))}const ms=[{id:"void",name:"VOID",colors:{primary:"#a855f7",primaryDim:"#6b21a8",primaryGlow:"rgba(168, 85, 247, 0.4)",secondary:"#3b82f6",secondaryDim:"#1e40af",secondaryGlow:"rgba(59, 130, 246, 0.4)",tertiary:"#ec4899",tertiaryDim:"#9d174d",tertiaryGlow:"rgba(236, 72, 153, 0.4)",success:"#a855f7",warning:"#f59e0b",danger:"#ef4444"}},{id:"neon-tokyo",name:"NEON TOKYO",colors:{primary:"#ff2d95",primaryDim:"#9d1a5a",primaryGlow:"rgba(255, 45, 149, 0.4)",secondary:"#00f0ff",secondaryDim:"#0891b2",secondaryGlow:"rgba(0, 240, 255, 0.4)",tertiary:"#ffee00",tertiaryDim:"#a38a00",tertiaryGlow:"rgba(255, 238, 0, 0.4)",success:"#00f0ff",warning:"#ffee00",danger:"#ff2d95"}},{id:"synthwave",name:"SYNTHWAVE",colors:{primary:"#f472b6",primaryDim:"#a21caf",primaryGlow:"rgba(244, 114, 182, 0.4)",secondary:"#818cf8",secondaryDim:"#4338ca",secondaryGlow:"rgba(129, 140, 248, 0.4)",tertiary:"#22d3ee",tertiaryDim:"#0e7490",tertiaryGlow:"rgba(34, 211, 238, 0.4)",success:"#22d3ee",warning:"#fbbf24",danger:"#f43f5e"}},{id:"bloodmoon",name:"BLOODMOON",colors:{primary:"#dc2626",primaryDim:"#7f1d1d",primaryGlow:"rgba(220, 38, 38, 0.4)",secondary:"#f97316",secondaryDim:"#9a3412",secondaryGlow:"rgba(249, 115, 22, 0.4)",tertiary:"#fbbf24",tertiaryDim:"#92400e",tertiaryGlow:"rgba(251, 191, 36, 0.4)",success:"#f97316",warning:"#fbbf24",danger:"#dc2626"}},{id:"toxic",name:"TOXIC",colors:{primary:"#84cc16",primaryDim:"#3f6212",primaryGlow:"rgba(132, 204, 22, 0.5)",secondary:"#facc15",secondaryDim:"#854d0e",secondaryGlow:"rgba(250, 204, 21, 0.4)",tertiary:"#22c55e",tertiaryDim:"#166534",tertiaryGlow:"rgba(34, 197, 94, 0.4)",success:"#22c55e",warning:"#facc15",danger:"#ef4444"}},{id:"ice",name:"ICE",colors:{primary:"#38bdf8",primaryDim:"#0369a1",primaryGlow:"rgba(56, 189, 248, 0.4)",secondary:"#e0f2fe",secondaryDim:"#7dd3fc",secondaryGlow:"rgba(224, 242, 254, 0.3)",tertiary:"#a5b4fc",tertiaryDim:"#4f46e5",tertiaryGlow:"rgba(165, 180, 252, 0.4)",success:"#38bdf8",warning:"#fcd34d",danger:"#f87171"}},{id:"hacker",name:"HACKER",colors:{primary:"#22c55e",primaryDim:"#166534",primaryGlow:"rgba(34, 197, 94, 0.5)",secondary:"#4ade80",secondaryDim:"#15803d",secondaryGlow:"rgba(74, 222, 128, 0.4)",tertiary:"#86efac",tertiaryDim:"#22c55e",tertiaryGlow:"rgba(134, 239, 172, 0.3)",success:"#22c55e",warning:"#fbbf24",danger:"#ef4444"}},{id:"phosphor",name:"PHOSPHOR",colors:{primary:"#fef08a",primaryDim:"#a16207",primaryGlow:"rgba(254, 240, 138, 0.5)",secondary:"#fde047",secondaryDim:"#854d0e",secondaryGlow:"rgba(253, 224, 71, 0.4)",tertiary:"#fbbf24",tertiaryDim:"#92400e",tertiaryGlow:"rgba(251, 191, 36, 0.4)",success:"#a3e635",warning:"#fbbf24",danger:"#f87171"}}],Ks=Ue(ms[0]);function mn(e){const t=document.documentElement,{colors:s}=e;t.style.setProperty("--color-primary",s.primary),t.style.setProperty("--color-primary-dim",s.primaryDim),t.style.setProperty("--color-primary-glow",s.primaryGlow),t.style.setProperty("--color-secondary",s.secondary),t.style.setProperty("--color-secondary-dim",s.secondaryDim),t.style.setProperty("--color-secondary-glow",s.secondaryGlow),t.style.setProperty("--color-tertiary",s.tertiary),t.style.setProperty("--color-tertiary-dim",s.tertiaryDim),t.style.setProperty("--color-tertiary-glow",s.tertiaryGlow),t.style.setProperty("--color-success",s.success),t.style.setProperty("--color-warning",s.warning),t.style.setProperty("--color-danger",s.danger),Ks.set(e),localStorage.setItem("autoverse-theme",e.id)}function yo(e){const t=ms.find(s=>s.id===e);t&&mn(t)}function xo(){const e=localStorage.getItem("autoverse-theme");if(e){const t=ms.find(s=>s.id===e);if(t){mn(t);return}}mn(ms[0])}const bn=Ue(null),vi=Ue(0);function So(){vi.update(e=>e+1)}function Eo(e,t){const s=Ze(bn);s&&s.startDragFromLibrary(e,t)}const wn=Ue(null),nr=900,Pe=["controls","display","presets","patterns"];function Mo(){const{subscribe:e,set:t,update:s}=Ue({isMobile:typeof window<"u"&&window.innerWidth<=nr,activeTab:"controls",swipeOffset:0,isSwiping:!1});return{subscribe:e,set:t,update:s,checkViewport:()=>{if(typeof window>"u")return;const n=window.innerWidth<=nr;s(r=>({...r,isMobile:n}))},setTab:n=>{s(r=>({...r,activeTab:n,swipeOffset:0}))},nextTab:()=>{s(n=>{const r=Pe.indexOf(n.activeTab),i=Math.min(r+1,Pe.length-1);return{...n,activeTab:Pe[i],swipeOffset:0}})},prevTab:()=>{s(n=>{const r=Pe.indexOf(n.activeTab),i=Math.max(r-1,0);return{...n,activeTab:Pe[i],swipeOffset:0}})},startSwipe:()=>{s(n=>({...n,isSwiping:!0}))},updateSwipe:n=>{s(r=>({...r,swipeOffset:n}))},endSwipe:n=>{const r=Ze({subscribe:e}),i=n*.2,a=r.swipeOffset;if(Math.abs(a)>i)if(a>0){const o=Pe.indexOf(r.activeTab);if(o>0){t({...r,activeTab:Pe[o-1],swipeOffset:0,isSwiping:!1});return}}else{const o=Pe.indexOf(r.activeTab);if(o<Pe.length-1){t({...r,activeTab:Pe[o+1],swipeOffset:0,isSwiping:!1});return}}s(o=>({...o,swipeOffset:0,isSwiping:!1}))}}}const Ne=Mo(),Co=Ft(Ne,e=>Pe.indexOf(e.activeTab)),sn=Pe;var To=T("<button></button>"),ko=T('<header class="header svelte-4b3o1e"><div class="header-left svelte-4b3o1e"><pre class="ascii-logo svelte-4b3o1e"></pre></div> <div class="header-right svelte-4b3o1e"><div class="theme-picker svelte-4b3o1e"><span class="picker-label svelte-4b3o1e">THEME</span> <div class="theme-swatches svelte-4b3o1e"></div></div> <div><span class="backend-label svelte-4b3o1e">COMPUTE</span> <span class="backend-value svelte-4b3o1e"> </span></div></div></header>');function $o(e,t){ft(t,!1);const s=()=>K(Ks,"$currentScheme",r),n=()=>K(ae,"$simulationStore",r),[r,i]=zt();Ss();var a=ko(),o=p(a),l=p(o);l.textContent=`
 âââ â â âââ âââ â â âââ âââ âââ âââ
 âââ âââ  â  â â âââ âââ âââ âââ âââ`;var c=g(o,2),u=p(c),v=g(p(u),2);Be(v,5,()=>ms,nt,(_,w)=>{var R=To();let k;R.__click=()=>yo(f(w).id),B(()=>{k=se(R,1,"swatch svelte-4b3o1e",null,k,{active:s().id===f(w).id}),$n(R,`--swatch-color: ${f(w).colors.primary??""}`),ze(R,"title",f(w).name)}),S(_,R)});var d=g(u,2);let h;var m=g(p(d),2),y=p(m);B(_=>{h=se(d,1,"backend-indicator svelte-4b3o1e",null,h,{gpu:n().backend==="gpu"}),F(y,_)},[()=>n().backend.toUpperCase()]),S(e,a),dt(),i()}ts(["click"]);var Io=T('<footer class="footer svelte-ww03jg"></footer>');function Ao(e){var t=Io();S(e,t)}var Do=T("<div> </div>"),Po=T('<div><div class="corner top-left svelte-1gtc57s"></div> <div class="corner top-right svelte-1gtc57s"></div> <div class="corner bottom-left svelte-1gtc57s"></div> <div class="corner bottom-right svelte-1gtc57s"></div> <!> <div><!></div></div>');function wt(e,t){let s=je(t,"borderColor",3,"primary"),n=je(t,"noPadding",3,!1),r=je(t,"class",3,"");const i={primary:"border-primary",secondary:"border-secondary",tertiary:"border-tertiary"};var a=Po(),o=g(p(a),8);{var l=d=>{var h=Do(),m=p(h);B(()=>{se(h,1,`title ${i[s()]??""}`,"svelte-1gtc57s"),F(m,t.title)}),S(d,h)};re(o,d=>{t.title&&d(l)})}var c=g(o,2);let u;var v=p(c);Za(v,()=>t.children??it),B(()=>{se(a,1,`tui-box ${i[s()]??""} ${r()??""}`,"svelte-1gtc57s"),u=se(c,1,"content svelte-1gtc57s",null,u,{"no-padding":n()})}),S(e,a)}var Oo=T('<span class="label svelte-1l5vt72"> </span>'),Lo=T("<span> </span>"),Ro=T('<div class="slider-header svelte-1l5vt72"><!> <!></div>'),No=T('<div class="slider-container svelte-1l5vt72"><!> <input type="range"/></div>');function nn(e,t){ft(t,!0);let s=je(t,"value",15),n=je(t,"min",3,0),r=je(t,"max",3,100),i=je(t,"step",3,1),a=je(t,"showValue",3,!0),o=je(t,"valueFormat",3,m=>String(m)),l=je(t,"color",3,"tertiary");function c(m){const y=m.target;s(parseFloat(y.value)),t.onchange?.(s())}var u=No(),v=p(u);{var d=m=>{var y=Ro(),_=p(y);{var w=M=>{var C=Oo(),P=p(C);B(()=>F(P,t.label)),S(M,C)};re(_,M=>{t.label&&M(w)})}var R=g(_,2);{var k=M=>{var C=Lo(),P=p(C);B(b=>{se(C,1,`value ${l()??""}`,"svelte-1l5vt72"),F(P,b)},[()=>o()(s())]),S(M,C)};re(R,M=>{a()&&M(k)})}S(m,y)};re(v,m=>{(t.label||a())&&m(d)})}var h=g(v,2);h.__input=c,B(()=>{se(h,1,eo(l()),"svelte-1l5vt72"),ze(h,"min",n()),ze(h,"max",r()),ze(h,"step",i()),hn(h,s())}),S(e,u),dt()}ts(["input"]);var Fo=T('<span class="icon svelte-oaxjxu">&#9724;</span> <span class="label svelte-oaxjxu">PAUSE</span>',1),zo=T('<span class="icon svelte-oaxjxu">&#9654;</span> <span class="label svelte-oaxjxu">PLAY</span>',1),Bo=T('<div class="control-grid svelte-oaxjxu"><button><!></button> <button class="control-btn svelte-oaxjxu"><span class="icon svelte-oaxjxu">&#9655;</span> <span class="label svelte-oaxjxu">STEP</span></button> <button class="control-btn svelte-oaxjxu"><span class="icon svelte-oaxjxu">&#8634;</span> <span class="label svelte-oaxjxu">RESET</span></button></div> <div class="speed-control svelte-oaxjxu"><!></div>',1),Go=T('<button><span class="icon svelte-oaxjxu"><!></span> <span class="label svelte-oaxjxu"> </span></button>'),Yo=T('<div class="brush-settings svelte-oaxjxu"><!> <!></div>'),Xo=T('<div class="tool-grid svelte-oaxjxu"></div> <!>',1),Uo=T('<div><span class="log-prefix svelte-oaxjxu">&gt;</span> <span class="log-message svelte-oaxjxu"> </span></div>'),qo=T('<div class="log-container svelte-oaxjxu"></div>'),jo=T('<aside class="left-sidebar svelte-oaxjxu"><!> <!> <!></aside>');function Wo(e,t){ft(t,!0);const s=()=>K(ae,"$simulationStore",i),n=()=>K(vt,"$settings",i),r=()=>K(ti,"$systemLog",i),[i,a]=zt();let o=qe(1);function l(y){G(o,y,!0),ni(y)}function c(y){ui(y)}const u=[{id:"view",label:"VIEW",icon:"&#9673;"},{id:"select",label:"SEL",icon:"&#9633;"},{id:"draw",label:"DRAW",icon:"&#9998;"},{id:"erase",label:"ERASE",icon:"&#9747;"}];var v=jo(),d=p(v);wt(d,{title:"SYS.CONTROL",borderColor:"primary",children:(y,_)=>{var w=Bo(),R=We(w),k=p(R);let M;k.__click=()=>s().playing?An():ri();var C=p(k);{var P=D=>{var z=Fo();S(D,z)},b=D=>{var z=zo();S(D,z)};re(C,D=>{s().playing?D(P):D(b,!1)})}var x=g(k,2);x.__click=()=>ii();var O=g(x,2);O.__click=()=>_s();var $=g(R,2),q=p($);nn(q,{label:"SIM SPEED",min:1,max:10,step:1,color:"primary",valueFormat:D=>`${D}X`,onchange:l,get value(){return f(o)},set value(D){G(o,D,!0)}}),B(()=>M=se(k,1,"control-btn svelte-oaxjxu",null,M,{active:!s().playing})),S(y,w)},$$slots:{default:!0}});var h=g(d,2);wt(h,{title:"TOOL.KIT",borderColor:"tertiary",children:(y,_)=>{var w=Xo(),R=We(w);Be(R,21,()=>u,nt,(C,P)=>{var b=Go();let x;b.__click=()=>c(f(P).id);var O=p(b),$=p(O);Ja($,()=>f(P).icon);var q=g(O,2),D=p(q);B(()=>{x=se(b,1,"tool-btn svelte-oaxjxu",null,x,{active:n().mode===f(P).id}),F(D,f(P).label)}),S(C,b)});var k=g(R,2);{var M=C=>{var P=Yo(),b=p(P);nn(b,{label:"BRUSH SIZE",get value(){return n().brushSize},min:1,max:30,step:1,color:"tertiary",valueFormat:$=>`${$}PX`,get onchange(){return fi}});var x=g(b,2);{var O=$=>{nn($,{label:"INTENSITY",get value(){return n().brushIntensity},min:0,max:1,step:.05,color:"tertiary",valueFormat:q=>`${Math.round(q*100)}%`,get onchange(){return di}})};re(x,$=>{n().mode==="draw"&&$(O)})}S(C,P)};re(k,C=>{(n().mode==="draw"||n().mode==="erase")&&C(M)})}S(y,w)},$$slots:{default:!0}});var m=g(h,2);wt(m,{title:"DEBUG.LOG",borderColor:"secondary",class:"debug-log-box",children:(y,_)=>{var w=qo();Be(w,5,r,nt,(R,k)=>{var M=Uo(),C=g(p(M),2),P=p(C);B(()=>{se(M,1,`log-entry ${f(k).level??""}`,"svelte-oaxjxu"),F(P,f(k).message)}),S(R,M)}),S(y,w)},$$slots:{default:!0}}),S(e,v),dt(),a()}ts(["click"]);const Ho={initialized:!1,running:!1,progress:null,result:null,bestState:null,error:null},_e=Ue(Ho);Ft(_e,e=>e.running);Ft(_e,e=>e.progress);Ft(_e,e=>e.bestState);let Bs=null,Ge=null,Ds=null;function Ps(e){return typeof e=="string"?JSON.parse(e):e}async function Vo(){try{Bs=await import("/autoverse/preview/pr-55/pkg/flow_lenia.js"),await Bs.default(),_e.update(s=>({...s,initialized:!0})),W("Evolution engine initialized","success")}catch(e){throw W(`Failed to initialize evolution: ${e}`,"error"),e}}function Ko(){return{base_config:Ze(ae).config,seed_pattern_type:"Blob",constraints:{radius:{min:.05,max:.25},amplitude:{min:.5,max:2},x:{min:.3,max:.7},y:{min:.3,max:.7}},fitness:{metrics:[{metric:"Persistence",weight:1},{metric:"Compactness",weight:.5},{metric:"Locomotion",weight:.3}],aggregation:"WeightedSum"},evaluation:{steps:200,sample_interval:10,warmup_steps:20},population:{size:20,elitism:2},algorithm:{type:"GeneticAlgorithm",config:{mutation_rate:.15,crossover_rate:.7,selection_method:"Tournament",tournament_size:3}},archive:{enabled:!0,max_size:50,diversity_threshold:.1},max_generations:50,target_fitness:.95,stagnation_limit:15}}async function Jo(e){if(!Bs)throw new Error("Evolution module not initialized");An(),pi();try{Ge&&Ge.free(),Ge=new Bs.WasmEvolutionEngine(JSON.stringify(e)),_e.update(t=>({...t,running:!0,progress:null,result:null,error:null})),W(`Evolution started: pop=${e.population.size}, gens=${e.max_generations}`,"info"),hi()}catch(t){throw _e.update(s=>({...s,error:String(t)})),W(`Evolution error: ${t}`,"error"),t}}function hi(){if(!(!Ze(_e).running||!Ge))try{const t=Ps(Ge.step()),s=Ps(Ge.getBestCandidateState());if(_e.update(n=>({...n,progress:t,bestState:s})),Ge.isComplete()){const n=Ps(Ge.getResult());_e.update(r=>({...r,running:!1,result:n})),W(`Evolution complete: fitness=${n.best_fitness.toFixed(3)}, reason=${n.stop_reason}`,"success");return}Ds=requestAnimationFrame(()=>hi())}catch(t){_e.update(s=>({...s,running:!1,error:String(t)})),W(`Evolution error: ${t}`,"error")}}function pi(){Ds!==null&&(cancelAnimationFrame(Ds),Ds=null);const e=Ze(_e);if(Ge&&e.running){Ge.cancel();try{const t=Ps(Ge.getResult());_e.update(s=>({...s,result:t}))}catch{}W("Evolution cancelled","warn")}_e.update(t=>({...t,running:!1}))}function Zo(){const e=Ze(_e);if(!e.bestState){W("No evolved pattern to load","warn");return}const{width:t,height:s,data:n}=e.bestState,r=[];for(let i=0;i<s;i++)for(let a=0;a<t;a++){const o=i*t+a,l=n[o];l>.001&&r.push([a,i,0,l])}_s({pattern:{type:"Custom",values:r}}),W("Loaded evolved pattern into simulation","success")}var Qo=T('<div class="progress-display svelte-auxm5"><div class="progress-row svelte-auxm5"><span class="label svelte-auxm5">GEN</span> <span class="value svelte-auxm5"> </span></div> <div class="progress-row svelte-auxm5"><span class="label svelte-auxm5">FIT</span> <span class="value highlight svelte-auxm5"> </span></div> <div class="progress-bar svelte-auxm5"><div class="progress-fill svelte-auxm5"></div></div></div>'),el=T('<div class="result-display svelte-auxm5"><div class="result-row svelte-auxm5"><span class="label svelte-auxm5">RESULT</span> <span class="value success svelte-auxm5"> </span></div> <div class="result-reason svelte-auxm5"> </div></div>'),tl=T('<div class="idle-status svelte-auxm5">READY</div>'),sl=T('<button class="evo-btn danger svelte-auxm5">STOP</button>'),nl=T('<button class="evo-btn secondary svelte-auxm5">LOAD</button>'),rl=T('<button class="evo-btn primary svelte-auxm5">EVOLVE</button> <!>',1),il=T('<div class="evolution-panel svelte-auxm5"><div class="preview-container svelte-auxm5"><canvas width="64" height="64" class="preview-canvas svelte-auxm5"></canvas> <span class="preview-label svelte-auxm5">BEST</span></div> <!> <div class="controls svelte-auxm5"><!></div> <details class="settings svelte-auxm5"><summary class="svelte-auxm5">SETTINGS</summary> <div class="settings-grid svelte-auxm5"><label class="svelte-auxm5"><span class="svelte-auxm5">POP</span> <input type="number" min="4" max="50" step="2" class="svelte-auxm5"/></label> <label class="svelte-auxm5"><span class="svelte-auxm5">GENS</span> <input type="number" min="10" max="200" step="10" class="svelte-auxm5"/></label> <label class="svelte-auxm5"><span class="svelte-auxm5">MUT%</span> <input type="number" min="1" max="50" step="1" class="svelte-auxm5"/></label> <label class="svelte-auxm5"><span class="svelte-auxm5">STEPS</span> <input type="number" min="50" max="500" step="50" class="svelte-auxm5"/></label></div> <label class="goal-select svelte-auxm5"><span class="svelte-auxm5">GOAL</span> <select class="svelte-auxm5"><option>Survival</option><option>Glider</option><option>Oscillator</option><option>Complex</option></select></label></details></div>');function al(e,t){ft(t,!1);const s=()=>K(_e,"$evolutionStore",n),[n,r]=zt();let i=ne(),a=ne(null),o=ne(20),l=ne(50),c=.95,u=ne(15),v=ne(200),d=ne("survival");function h(M){if(!f(a)||!f(i))return;const{width:C,height:P,data:b}=M,x=f(i).width,O=f(i).height,$=f(a).createImageData(C,P);for(let z=0;z<b.length;z++){const H=Math.floor(Math.min(1,Math.max(0,b[z]))*255);$.data[z*4]=H,$.data[z*4+1]=H,$.data[z*4+2]=H,$.data[z*4+3]=255}const q=new OffscreenCanvas(C,P),D=q.getContext("2d");D&&(D.putImageData($,0,0),et(a,f(a).imageSmoothingEnabled=!1),f(a).clearRect(0,0,x,O),f(a).drawImage(q,0,0,x,O))}function m(M){switch(M){case"glider":return[{metric:"Persistence",weight:1},{metric:"Locomotion",weight:1.5},{metric:"Compactness",weight:.5}];case"oscillator":return[{metric:"Persistence",weight:1},{metric:"Stability",weight:.8},{metric:"Compactness",weight:.5}];case"complex":return[{metric:"Persistence",weight:1},{metric:"Complexity",weight:1.2},{metric:"MassConcentration",weight:.3}];default:return[{metric:"Persistence",weight:1},{metric:"Compactness",weight:.5},{metric:"Stability",weight:.3}]}}function y(){return{...Ko(),population:{size:f(o),elitism:Math.max(1,Math.floor(f(o)/10))},max_generations:f(l),target_fitness:c,stagnation_limit:Math.max(5,Math.floor(f(l)/3)),algorithm:{type:"GeneticAlgorithm",config:{mutation_rate:f(u)/100,crossover_rate:.7,selection_method:"Tournament",tournament_size:3}},evaluation:{steps:f(v),sample_interval:Math.max(1,Math.floor(f(v)/20)),warmup_steps:Math.floor(f(v)/10)},fitness:{metrics:m(f(d)),aggregation:"WeightedSum"}}}async function _(){const M=y();try{await Jo(M)}catch(C){W(`Failed to start evolution: ${C}`,"error")}}function w(){pi()}function R(){Zo()}function k(M){switch(M){case"TargetReached":return"TARGET HIT";case"MaxGenerations":return"MAX GENS";case"Stagnation":return"STAGNANT";case"Cancelled":return"CANCELLED";default:return M}}Vs(async()=>{if(G(a,f(i)?.getContext("2d")??null),!s().initialized)try{await Vo()}catch{}}),st(()=>(f(a),s()),()=>{f(a)&&s().bestState&&h(s().bestState)}),Ws(),Ss(),wt(e,{title:"EVOLVE",borderColor:"tertiary",children:(M,C)=>{var P=il(),b=p(P),x=p(b);Vt(x,V=>G(i,V),()=>f(i));var O=g(b,2);{var $=V=>{var ie=Qo(),Ae=p(ie),pt=g(p(Ae),2),gt=p(pt),fe=g(Ae,2),ye=g(p(fe),2),Et=p(ye),rs=g(fe,2),is=p(rs);B(as=>{F(gt,`${s(),N(()=>s().progress.generation)??""}/${f(l)??""}`),F(Et,as),$n(is,`width: ${s(),f(l),N(()=>s().progress.generation/f(l)*100)??""}%`)},[()=>(s(),N(()=>s().progress.best_fitness.toFixed(3)))]),S(V,ie)},q=V=>{var ie=dn(),Ae=We(ie);{var pt=fe=>{var ye=el(),Et=p(ye),rs=g(p(Et),2),is=p(rs),as=g(Et,2),Es=p(as);B((Ms,Zs)=>{F(is,Ms),F(Es,Zs)},[()=>(s(),N(()=>s().result.best_fitness.toFixed(3))),()=>(s(),N(()=>k(s().result.stop_reason)))]),S(fe,ye)},gt=fe=>{var ye=tl();S(fe,ye)};re(Ae,fe=>{s(),N(()=>s().result)?fe(pt):fe(gt,!1)},!0)}S(V,ie)};re(O,V=>{s(),N(()=>s().running&&s().progress)?V($):V(q,!1)})}var D=g(O,2),z=p(D);{var H=V=>{var ie=sl();ie.__click=w,S(V,ie)},A=V=>{var ie=rl(),Ae=We(ie);Ae.__click=_;var pt=g(Ae,2);{var gt=fe=>{var ye=nl();ye.__click=R,S(fe,ye)};re(pt,fe=>{s(),N(()=>s().bestState)&&fe(gt)})}B(()=>Ae.disabled=(s(),N(()=>!s().initialized))),S(V,ie)};re(z,V=>{s(),N(()=>s().running)?V(H):V(A,!1)})}var J=g(D,2),ue=g(p(J),2),me=p(ue),be=g(p(me),2),Me=g(me,2),Ce=g(p(Me),2),Q=g(Me,2),ve=g(p(Q),2),Te=g(Q,2),he=g(p(Te),2),te=g(ue,2),we=g(p(te),2);B(()=>{f(d),Ra(()=>{})});var Ie=p(we);Ie.value=Ie.__value="survival";var ht=g(Ie);ht.value=ht.__value="glider";var ss=g(ht);ss.value=ss.__value="oscillator";var ns=g(ss);ns.value=ns.__value="complex",ks(be,()=>f(o),V=>G(o,V)),ks(Ce,()=>f(l),V=>G(l,V)),ks(ve,()=>f(u),V=>G(u,V)),ks(he,()=>f(v),V=>G(v,V)),ro(we,()=>f(d),V=>G(d,V)),S(M,P)},$$slots:{default:!0}}),dt(),r()}ts(["click"]);const rr="flow-lenia-presets";class ol{presets=new Map;listeners=new Set;constructor(){this.loadFromStorage()}generateId(){return`preset-${Date.now()}-${Math.random().toString(36).slice(2,9)}`}createThumbnail(t,s=64){const n=document.createElement("canvas");n.width=s,n.height=s;const r=n.getContext("2d"),i=r.createImageData(t.width,t.height),a=t.channels[0];for(let m=0;m<a.length;m++){const y=Math.max(0,Math.min(1,a[m])),_=Math.floor(y*255);i.data[m*4+0]=_,i.data[m*4+1]=_,i.data[m*4+2]=_,i.data[m*4+3]=255}const o=document.createElement("canvas");o.width=t.width,o.height=t.height,o.getContext("2d").putImageData(i,0,0),r.imageSmoothingEnabled=!0,r.fillStyle="#1a1a1a",r.fillRect(0,0,s,s);const c=Math.min(s/t.width,s/t.height),u=t.width*c,v=t.height*c,d=(s-u)/2,h=(s-v)/2;return r.drawImage(o,d,h,u,v),n.toDataURL("image/png")}savePreset(t,s,n){const r={id:this.generateId(),name:t,description:n,thumbnail:this.createThumbnail(s),region:s,createdAt:Date.now()};return this.presets.set(r.id,r),this.persistToStorage(),this.notifyListeners(),r}getPreset(t){return this.presets.get(t)}getAllPresets(){return Array.from(this.presets.values()).sort((t,s)=>s.createdAt-t.createdAt)}deletePreset(t){const s=this.presets.delete(t);return s&&(this.persistToStorage(),this.notifyListeners()),s}renamePreset(t,s){const n=this.presets.get(t);return n?(n.name=s,this.persistToStorage(),this.notifyListeners(),!0):!1}updateDescription(t,s){const n=this.presets.get(t);return n?(n.description=s,this.persistToStorage(),this.notifyListeners(),!0):!1}exportPresets(t){const s=t?t.map(n=>this.presets.get(n)).filter(Boolean):this.getAllPresets();return JSON.stringify(s,null,2)}importPresets(t){try{const s=JSON.parse(t);let n=0;for(const r of s){const i={...r,id:this.generateId(),createdAt:Date.now()};this.presets.set(i.id,i),n++}return this.persistToStorage(),this.notifyListeners(),n}catch{throw new Error("Invalid preset JSON format")}}subscribe(t){return this.listeners.add(t),()=>this.listeners.delete(t)}notifyListeners(){const t=this.getAllPresets();for(const s of this.listeners)s(t)}persistToStorage(){try{const t=JSON.stringify(Array.from(this.presets.entries()));localStorage.setItem(rr,t)}catch(t){console.warn("Failed to persist presets to storage:",t)}}loadFromStorage(){try{const t=localStorage.getItem(rr);if(t){const s=JSON.parse(t);this.presets=new Map(s)}}catch(t){console.warn("Failed to load presets from storage:",t),this.presets=new Map}}clearAll(){this.presets.clear(),this.persistToStorage(),this.notifyListeners()}}const gi=[{name:"Glider",description:"A simple glider that moves across the grid",seed:{pattern:{type:"GaussianBlob",center:[.5,.5],radius:.1,amplitude:1,channel:0}}},{name:"Ring",description:"A ring pattern that expands",seed:{pattern:{type:"Ring",center:[.5,.5],inner_radius:.05,outer_radius:.1,amplitude:1,channel:0}}},{name:"Dual Blobs",description:"Two interacting blobs",seed:{pattern:{type:"MultiBlob",blobs:[{center:[.35,.5],radius:.08,amplitude:1,channel:0},{center:[.65,.5],radius:.08,amplitude:1,channel:0}]}}},{name:"Random Noise",description:"Random initial conditions",seed:{pattern:{type:"Noise",seed:42,amplitude:.5,channel:0}}}],Kt=new ol,Js=Ue(Kt.getAllPresets());Kt.subscribe(e=>{Js.set(e)});function _i(e){const t=Kt.getAllPresets().find(s=>s.id===e);Kt.deletePreset(e),t&&W(`Deleted preset: ${t.name}`,"info")}function ll(){const e=Kt.exportPresets();return W(`Exported ${Ze(Js).length} presets`,"success"),e}function mi(e){try{const t=Kt.importPresets(e);return W(`Imported ${t} presets`,"success"),So(),t}catch(t){throw W(`Import failed: ${t}`,"error"),t}}function bi(){const e=ll(),t=new Blob([e],{type:"application/json"}),s=URL.createObjectURL(t),n=document.createElement("a");n.href=s,n.download="flow-lenia-presets.json",n.click(),URL.revokeObjectURL(s)}var cl=T('<div class="metric-display svelte-1baw31t"><div class="metric-main svelte-1baw31t"><span class="metric-value svelte-1baw31t"> </span> <span class="metric-unit svelte-1baw31t">STEPS</span></div> <div class="metric-row svelte-1baw31t"><div class="metric-item svelte-1baw31t"><span class="metric-label svelte-1baw31t">TIME</span> <span class="metric-num svelte-1baw31t"> </span></div> <div class="metric-item svelte-1baw31t"><span class="metric-label svelte-1baw31t">MASS</span> <span class="metric-num highlight svelte-1baw31t"> </span></div></div> <div class="metric-row svelte-1baw31t"><div class="metric-item svelte-1baw31t"><span class="metric-label svelte-1baw31t">FPS</span> <span class="metric-num accent svelte-1baw31t"> </span></div> <div class="metric-item svelte-1baw31t"><span class="metric-label svelte-1baw31t">BACKEND</span> <button> </button></div></div></div>'),ul=T('<div class="config-grid svelte-1baw31t"><div class="config-item svelte-1baw31t"><span class="cfg-label svelte-1baw31t">mu</span> <span class="cfg-value svelte-1baw31t"> </span></div> <div class="config-item svelte-1baw31t"><span class="cfg-label svelte-1baw31t">sigma</span> <span class="cfg-value svelte-1baw31t"> </span></div> <div class="config-item svelte-1baw31t"><span class="cfg-label svelte-1baw31t">R</span> <span class="cfg-value svelte-1baw31t"> </span></div> <div class="config-item svelte-1baw31t"><span class="cfg-label svelte-1baw31t">dt</span> <span class="cfg-value svelte-1baw31t"> </span></div></div>'),fl=T('<button class="builtin-btn svelte-1baw31t"> </button>'),dl=T('<div class="builtin-grid svelte-1baw31t"></div>'),vl=T('<img class="svelte-1baw31t"/>'),hl=T('<div class="preset-item svelte-1baw31t" draggable="true" role="button" tabindex="0"><div class="preset-thumbnail svelte-1baw31t"><!></div> <div class="preset-info svelte-1baw31t"><span class="preset-name svelte-1baw31t"> </span> <span class="preset-size svelte-1baw31t"> </span></div> <button class="delete-btn svelte-1baw31t">&#10005;</button></div>'),pl=T('<div class="empty-state svelte-1baw31t">No saved patterns</div>'),gl=T('<div class="patterns-header svelte-1baw31t"><button class="small-btn svelte-1baw31t">IMPORT</button> <button class="small-btn svelte-1baw31t">EXPORT</button></div> <div class="preset-list svelte-1baw31t"></div>',1),_l=T('<aside class="right-sidebar svelte-1baw31t"><!> <!> <!> <!> <!></aside>');function ml(e,t){ft(t,!1);const s=()=>K(ae,"$simulationStore",o),n=()=>K(ci,"$formattedStep",o),r=()=>K(_o,"$formattedTime",o),i=()=>K(li,"$formattedMass",o),a=()=>K(Js,"$presets",o),[o,l]=zt(),c=ne();function u(){const b=s().backend==="cpu"?"gpu":"cpu";ai(b)}function v(b){const x=zs();if(!x)return;const O=Math.floor((x.getWidth()-b.region.width)/2),$=Math.floor((x.getHeight()-b.region.height)/2);x.placeRegion(b.region,O,$)}function d(b){_s(b.seed),W(`Loaded pattern: ${b.name}`,"info")}function h(b,x){b.stopPropagation(),_i(x)}function m(){bi()}function y(){const b=document.createElement("input");b.type="file",b.accept=".json",b.onchange=async x=>{const O=x.target.files?.[0];if(!O)return;const $=await O.text();try{mi($)}catch{}},b.click()}function _(b,x){b.dataTransfer.effectAllowed="copy",b.dataTransfer.setData("text/plain",x.id),Eo(x,b)}st(()=>s(),()=>{G(c,s().config.kernels[0])}),Ws(),Ss();var w=_l(),R=p(w);al(R,{});var k=g(R,2);wt(k,{title:"METRICS",borderColor:"secondary",children:(b,x)=>{var O=cl(),$=p(O),q=p($),D=p(q),z=g($,2),H=p(z),A=g(p(H),2),J=p(A),ue=g(H,2),me=g(p(ue),2),be=p(me),Me=g(z,2),Ce=p(Me),Q=g(p(Ce),2),ve=p(Q),Te=g(Ce,2),he=g(p(Te),2);let te;he.__click=u;var we=p(he);B(Ie=>{F(D,n()),F(J,`${r()??""}s`),F(be,i()),F(ve,(s(),N(()=>s().fps))),te=se(he,1,"backend-btn svelte-1baw31t",null,te,{gpu:s().backend==="gpu"}),he.disabled=(s(),N(()=>!s().gpuAvailable)),F(we,Ie)},[()=>(s(),N(()=>s().backend.toUpperCase()))]),S(b,O)},$$slots:{default:!0}});var M=g(k,2);wt(M,{title:"KERNEL",borderColor:"primary",children:(b,x)=>{var O=ul(),$=p(O),q=g(p($),2),D=p(q),z=g($,2),H=g(p(z),2),A=p(H),J=g(z,2),ue=g(p(J),2),me=p(ue),be=g(J,2),Me=g(p(be),2),Ce=p(Me);B(()=>{F(D,(f(c),N(()=>f(c)?.mu??"â"))),F(A,(f(c),N(()=>f(c)?.sigma??"â"))),F(me,(s(),N(()=>s().config.kernel_radius))),F(Ce,(s(),N(()=>s().config.dt)))}),S(b,O)},$$slots:{default:!0}});var C=g(M,2);wt(C,{title:"SEEDS",borderColor:"tertiary",children:(b,x)=>{var O=dl();Be(O,5,()=>gi,nt,($,q)=>{var D=fl();D.__click=()=>d(f(q));var z=p(D);B(()=>{ze(D,"title",(f(q),N(()=>f(q).description))),F(z,(f(q),N(()=>f(q).name)))}),S($,D)}),S(b,O)},$$slots:{default:!0}});var P=g(C,2);wt(P,{title:"SAVED",borderColor:"primary",class:"saved-box",children:(b,x)=>{var O=gl(),$=We(O),q=p($);q.__click=y;var D=g(q,2);D.__click=m;var z=g($,2);Be(z,5,a,H=>H.id,(H,A)=>{var J=hl();J.__click=()=>v(f(A)),J.__keydown=te=>te.key==="Enter"&&v(f(A));var ue=p(J),me=p(ue);{var be=te=>{var we=vl();B(()=>{ze(we,"src",(f(A),N(()=>f(A).thumbnail))),ze(we,"alt",(f(A),N(()=>f(A).name)))}),S(te,we)};re(me,te=>{f(A),N(()=>f(A).thumbnail)&&te(be)})}var Me=g(ue,2),Ce=p(Me),Q=p(Ce),ve=g(Ce,2),Te=p(ve),he=g(Me,2);he.__click=te=>h(te,f(A).id),B(()=>{F(Q,(f(A),N(()=>f(A).name))),F(Te,`${f(A),N(()=>f(A).region.width)??""}x${f(A),N(()=>f(A).region.height)??""}`)}),Hr("dragstart",J,te=>_(te,f(A))),S(H,J)},H=>{var A=pl();S(H,A)}),S(b,O)},$$slots:{default:!0}}),S(e,w),dt(),l()}ts(["click","keydown"]);class bl{canvas;ctx;offscreenCanvas;offscreenCtx;settings;grayscaleMap;thermalMap;viridisMap;themeMap;constructor(t,s){this.canvas=t;const n=t.getContext("2d");if(!n)throw new Error("Failed to get 2D context");this.ctx=n,this.offscreenCanvas=document.createElement("canvas");const r=this.offscreenCanvas.getContext("2d");if(!r)throw new Error("Failed to get offscreen 2D context");this.offscreenCtx=r,this.settings=s,this.grayscaleMap=this.buildGrayscaleMap(),this.thermalMap=this.buildThermalMap(),this.viridisMap=this.buildViridisMap(),this.themeMap=this.viridisMap}setThemeColors(t){this.themeMap=this.buildThemeMap(t)}updateSettings(t){this.settings={...this.settings,...t}}render(t,s,n){const{width:r,height:i,channels:a}=t;(this.offscreenCanvas.width!==r||this.offscreenCanvas.height!==i)&&(this.offscreenCanvas.width=r,this.offscreenCanvas.height=i);const o=this.getColorMap(),l=this.offscreenCtx.createImageData(r,i),c=a[0];for(let u=0;u<c.length;u++){const v=Math.max(0,Math.min(1,c[u])),d=Math.floor(v*255)*4;l.data[u*4+0]=o[d+0],l.data[u*4+1]=o[d+1],l.data[u*4+2]=o[d+2],l.data[u*4+3]=255}this.offscreenCtx.putImageData(l,0,0),this.ctx.imageSmoothingEnabled=!1,this.ctx.fillStyle="#000",this.ctx.fillRect(0,0,this.canvas.width,this.canvas.height),this.ctx.drawImage(this.offscreenCanvas,0,0,r,i,0,0,this.canvas.width,this.canvas.height),this.settings.showGrid&&this.drawGrid(r,i),n&&this.drawGhostPreview(n,r,i),s&&this.settings.showSelection&&this.drawSelection(s,r,i)}drawGrid(t,s){const n=this.canvas.width/t,r=this.canvas.height/s;if(this.ctx.strokeStyle="rgba(255, 255, 255, 0.1)",this.ctx.lineWidth=1,n>=4&&r>=4){this.ctx.beginPath();for(let i=0;i<=t;i++){const a=i*n;this.ctx.moveTo(a,0),this.ctx.lineTo(a,this.canvas.height)}for(let i=0;i<=s;i++){const a=i*r;this.ctx.moveTo(0,a),this.ctx.lineTo(this.canvas.width,a)}this.ctx.stroke()}}drawSelection(t,s,n){const r=this.canvas.width/s,i=this.canvas.height/n,a=Math.min(t.startX,t.endX)*r,o=Math.min(t.startY,t.endY)*i,l=Math.abs(t.endX-t.startX)*r,c=Math.abs(t.endY-t.startY)*i;this.ctx.fillStyle="rgba(79, 195, 247, 0.2)",this.ctx.fillRect(a,o,l,c),this.ctx.strokeStyle="#4fc3f7",this.ctx.lineWidth=2,this.ctx.setLineDash([5,5]),this.ctx.strokeRect(a,o,l,c),this.ctx.setLineDash([]);const u=Math.abs(t.endX-t.startX),v=Math.abs(t.endY-t.startY);u>0&&v>0&&(this.ctx.fillStyle="#4fc3f7",this.ctx.font="12px monospace",this.ctx.fillText(`${u} x ${v}`,a+4,o-4))}drawGhostPreview(t,s,n){const r=this.canvas.width/s,i=this.canvas.height/n,{region:a,x:o,y:l}=t,c=document.createElement("canvas");c.width=a.width,c.height=a.height;const u=c.getContext("2d"),v=u.createImageData(a.width,a.height),d=this.getColorMap();for(let h=0;h<a.channels[0].length;h++){const m=Math.max(0,Math.min(1,a.channels[0][h])),y=Math.floor(m*255)*4;v.data[h*4+0]=d[y+0],v.data[h*4+1]=d[y+1],v.data[h*4+2]=d[y+2],v.data[h*4+3]=m>.01?180:0}u.putImageData(v,0,0),this.ctx.globalAlpha=.7,this.ctx.drawImage(c,0,0,a.width,a.height,o*r,l*i,a.width*r,a.height*i),this.ctx.globalAlpha=1,this.ctx.strokeStyle="#4fc3f7",this.ctx.lineWidth=2,this.ctx.setLineDash([3,3]),this.ctx.strokeRect(o*r,l*i,a.width*r,a.height*i),this.ctx.setLineDash([])}canvasToSim(t,s,n,r){const i=this.canvas.getBoundingClientRect(),a=n/this.canvas.width,o=r/this.canvas.height;return{x:Math.floor((t-i.left)*a),y:Math.floor((s-i.top)*o)}}getColorMap(){switch(this.settings.colorScheme){case"thermal":return this.thermalMap;case"viridis":return this.viridisMap;case"theme":return this.themeMap;default:return this.grayscaleMap}}buildGrayscaleMap(){const t=new Uint8ClampedArray(1024);for(let s=0;s<256;s++)t[s*4+0]=s,t[s*4+1]=s,t[s*4+2]=s,t[s*4+3]=255;return t}buildThermalMap(){const t=new Uint8ClampedArray(1024);for(let s=0;s<256;s++){const n=s/255;let r,i,a;if(n<.2){const o=n/.2;r=0,i=0,a=Math.floor(o*128)}else if(n<.4){const o=(n-.2)/.2;r=0,i=Math.floor(o*255),a=128+Math.floor(o*127)}else if(n<.6){const o=(n-.4)/.2;r=Math.floor(o*255),i=255,a=255-Math.floor(o*255)}else if(n<.8){const o=(n-.6)/.2;r=255,i=255-Math.floor(o*255),a=0}else{const o=(n-.8)/.2;r=255,i=Math.floor(o*255),a=Math.floor(o*255)}t[s*4+0]=r,t[s*4+1]=i,t[s*4+2]=a,t[s*4+3]=255}return t}buildViridisMap(){const t=[[68,1,84],[72,35,116],[64,67,135],[52,94,141],[41,120,142],[32,144,140],[34,167,132],[68,190,112],[121,209,81],[189,222,38],[253,231,36]],s=new Uint8ClampedArray(256*4);for(let n=0;n<256;n++){const i=n/255*(t.length-1),a=Math.floor(i),o=Math.min(a+1,t.length-1),l=i-a;s[n*4+0]=Math.floor(t[a][0]+l*(t[o][0]-t[a][0])),s[n*4+1]=Math.floor(t[a][1]+l*(t[o][1]-t[a][1])),s[n*4+2]=Math.floor(t[a][2]+l*(t[o][2]-t[a][2])),s[n*4+3]=255}return s}getCanvas(){return this.canvas}buildThemeMap(t){const s=l=>{const c=l.replace("#","");return[parseInt(c.slice(0,2),16),parseInt(c.slice(2,4),16),parseInt(c.slice(4,6),16)]},n=s(t.primary),r=s(t.secondary),i=s(t.tertiary),a=[{t:0,color:[5,5,5]},{t:.15,color:[n[0]*.3,n[1]*.3,n[2]*.3]},{t:.35,color:n},{t:.6,color:r},{t:.85,color:i},{t:1,color:[255,255,255]}],o=new Uint8ClampedArray(256*4);for(let l=0;l<256;l++){const c=l/255;let u=a[0],v=a[1];for(let h=1;h<a.length;h++)if(c<=a[h].t){u=a[h-1],v=a[h];break}const d=(c-u.t)/(v.t-u.t);o[l*4+0]=Math.floor(u.color[0]+d*(v.color[0]-u.color[0])),o[l*4+1]=Math.floor(u.color[1]+d*(v.color[1]-u.color[1])),o[l*4+2]=Math.floor(u.color[2]+d*(v.color[2]-u.color[2])),o[l*4+3]=255}return o}}class wl{canvas;simulation;callbacks;mode="view";selection=null;isSelecting=!1;isDrawing=!1;isDragging=!1;draggedCreature=null;ghostPreview=null;brushSize=3;brushIntensity=.5;constructor(t,s,n,r={}){this.canvas=t,this.simulation=s,this.callbacks=r,this.setupEventListeners(),this.setupDragDrop()}setMode(t){switch(this.mode=t,this.selection=null,this.isSelecting=!1,this.isDrawing=!1,t){case"select":this.canvas.style.cursor="crosshair";break;case"draw":this.canvas.style.cursor="cell";break;case"erase":this.canvas.style.cursor="not-allowed";break;default:this.canvas.style.cursor="default"}this.callbacks.onModeChange?.(t)}getMode(){return this.mode}getSelection(){return this.selection}clearSelection(){this.selection=null,this.callbacks.onSelectionChange?.(null)}setBrushSize(t){this.brushSize=Math.max(1,Math.min(20,t))}setBrushIntensity(t){this.brushIntensity=Math.max(0,Math.min(1,t))}getGhostPreview(){return this.ghostPreview}startDragFromLibrary(t,s){this.isDragging=!0,this.draggedCreature={preset:t,offsetX:t.region.width/2,offsetY:t.region.height/2};const n=this.getSimCoords(s);this.ghostPreview={region:t.region,x:n.x-this.draggedCreature.offsetX,y:n.y-this.draggedCreature.offsetY}}setupEventListeners(){this.canvas.addEventListener("mousedown",this.handleMouseDown.bind(this)),this.canvas.addEventListener("mousemove",this.handleMouseMove.bind(this)),this.canvas.addEventListener("mouseup",this.handleMouseUp.bind(this)),this.canvas.addEventListener("mouseleave",this.handleMouseLeave.bind(this)),this.canvas.addEventListener("touchstart",this.handleTouchStart.bind(this),{passive:!1}),this.canvas.addEventListener("touchmove",this.handleTouchMove.bind(this),{passive:!1}),this.canvas.addEventListener("touchend",this.handleTouchEnd.bind(this),{passive:!1}),this.canvas.addEventListener("touchcancel",this.handleTouchEnd.bind(this),{passive:!1}),document.addEventListener("keydown",this.handleKeyDown.bind(this))}setupDragDrop(){this.canvas.addEventListener("dragover",t=>{if(t.preventDefault(),t.dataTransfer.dropEffect="copy",this.draggedCreature){const s=this.getSimCoords(t);this.ghostPreview={region:this.draggedCreature.preset.region,x:s.x-this.draggedCreature.offsetX,y:s.y-this.draggedCreature.offsetY}}}),this.canvas.addEventListener("drop",t=>{if(t.preventDefault(),this.draggedCreature){const s=this.getSimCoords(t),n=Math.floor(s.x-this.draggedCreature.offsetX),r=Math.floor(s.y-this.draggedCreature.offsetY);this.callbacks.onDrop?.(this.draggedCreature.preset,n,r),this.draggedCreature=null,this.ghostPreview=null,this.isDragging=!1}}),this.canvas.addEventListener("dragleave",()=>{this.ghostPreview=null})}handleMouseDown(t){const s=this.getSimCoords(t);switch(this.mode){case"select":this.isSelecting=!0,this.selection={startX:s.x,startY:s.y,endX:s.x,endY:s.y},this.callbacks.onSelectionChange?.(this.selection);break;case"draw":this.isDrawing=!0,this.callbacks.onDraw?.(s.x,s.y);break;case"erase":this.isDrawing=!0,this.callbacks.onErase?.(s.x,s.y);break}}handleMouseMove(t){const s=this.getSimCoords(t);this.isSelecting&&this.selection&&(this.selection.endX=s.x,this.selection.endY=s.y,this.callbacks.onSelectionChange?.(this.selection)),this.isDrawing&&(this.mode==="draw"?this.callbacks.onDraw?.(s.x,s.y):this.mode==="erase"&&this.callbacks.onErase?.(s.x,s.y)),this.isDragging&&this.draggedCreature&&(this.ghostPreview={region:this.draggedCreature.preset.region,x:s.x-this.draggedCreature.offsetX,y:s.y-this.draggedCreature.offsetY})}handleMouseUp(t){if(this.isSelecting&&this.selection){const s={startX:Math.min(this.selection.startX,this.selection.endX),startY:Math.min(this.selection.startY,this.selection.endY),endX:Math.max(this.selection.startX,this.selection.endX),endY:Math.max(this.selection.startY,this.selection.endY)};s.endX>s.startX&&s.endY>s.startY?(this.selection=s,this.callbacks.onSelectionComplete?.(s)):this.selection=null,this.callbacks.onSelectionChange?.(this.selection)}this.isSelecting=!1,this.isDrawing=!1}handleMouseLeave(t){this.isSelecting&&(this.isSelecting=!1,this.selection=null,this.callbacks.onSelectionChange?.(null)),this.isDrawing=!1,this.ghostPreview=null}handleTouchStart(t){if(t.touches.length!==1)return;this.mode!=="view"&&t.preventDefault();const s=t.touches[0],n=this.getTouchSimCoords(s);switch(this.mode){case"select":this.isSelecting=!0,this.selection={startX:n.x,startY:n.y,endX:n.x,endY:n.y},this.callbacks.onSelectionChange?.(this.selection);break;case"draw":this.isDrawing=!0,this.callbacks.onDraw?.(n.x,n.y);break;case"erase":this.isDrawing=!0,this.callbacks.onErase?.(n.x,n.y);break}}handleTouchMove(t){if(t.touches.length!==1)return;this.mode!=="view"&&(this.isDrawing||this.isSelecting)&&t.preventDefault();const s=t.touches[0],n=this.getTouchSimCoords(s);this.isSelecting&&this.selection&&(this.selection.endX=n.x,this.selection.endY=n.y,this.callbacks.onSelectionChange?.(this.selection)),this.isDrawing&&(this.mode==="draw"?this.callbacks.onDraw?.(n.x,n.y):this.mode==="erase"&&this.callbacks.onErase?.(n.x,n.y))}handleTouchEnd(t){if(this.mode!=="view"&&(this.isDrawing||this.isSelecting)&&t.preventDefault(),this.isSelecting&&this.selection){const s={startX:Math.min(this.selection.startX,this.selection.endX),startY:Math.min(this.selection.startY,this.selection.endY),endX:Math.max(this.selection.startX,this.selection.endX),endY:Math.max(this.selection.startY,this.selection.endY)};s.endX>s.startX&&s.endY>s.startY?(this.selection=s,this.callbacks.onSelectionComplete?.(s)):this.selection=null,this.callbacks.onSelectionChange?.(this.selection)}this.isSelecting=!1,this.isDrawing=!1}getTouchSimCoords(t){const s=this.canvas.getBoundingClientRect(),n=t.clientX-s.left,r=t.clientY-s.top,i=this.simulation.getWidth(),a=this.simulation.getHeight();return{x:Math.floor(n/s.width*i),y:Math.floor(r/s.height*a)}}handleKeyDown(t){const s=t.target;s.tagName==="INPUT"||s.tagName==="TEXTAREA"||(t.key==="v"||t.key==="Escape"?this.setMode("view"):t.key==="s"?this.setMode("select"):t.key==="d"?this.setMode("draw"):t.key==="e"&&this.setMode("erase"),t.key==="["?(this.setBrushSize(this.brushSize-1),this.callbacks.onBrushSizeChange?.(this.brushSize)):t.key==="]"&&(this.setBrushSize(this.brushSize+1),this.callbacks.onBrushSizeChange?.(this.brushSize)))}getSimCoords(t){const s=this.canvas.getBoundingClientRect(),n=t.clientX-s.left,r=t.clientY-s.top,i=this.simulation.getWidth(),a=this.simulation.getHeight();return{x:Math.floor(n/s.width*i),y:Math.floor(r/s.height*a)}}getBrushSize(){return this.brushSize}getBrushIntensity(){return this.brushIntensity}}var yl=T('<div class="simulation-view svelte-145nxqv"><div class="canvas-frame svelte-145nxqv"><div class="canvas-header svelte-145nxqv"><span class="dim-label svelte-145nxqv"> </span></div> <div class="canvas-container svelte-145nxqv"><canvas class="svelte-145nxqv"></canvas> <div class="corner-marker top-left svelte-145nxqv"></div> <div class="corner-marker top-right svelte-145nxqv"></div> <div class="corner-marker bottom-left svelte-145nxqv"></div> <div class="corner-marker bottom-right svelte-145nxqv"></div> <div class="canvas-scanlines svelte-145nxqv"></div></div></div></div>');function ir(e,t){ft(t,!1);const s=()=>K(vt,"$settings",a),n=()=>K(ae,"$simulationStore",a),r=()=>K(Ks,"$currentScheme",a),i=()=>K(vi,"$renderTrigger",a),[a,o]=zt();let l=ne(),c=ne(),u=ne(null),v=ne(null);const d=512;Vs(()=>{const C=zs();!C||!f(c)||(wn.set(f(c)),G(u,new bl(f(c),{colorScheme:s().colorScheme,showGrid:s().showGrid,showSelection:s().showSelection,brushSize:s().brushSize,brushIntensity:s().brushIntensity,backend:n().backend})),G(v,new wl(f(c),C,f(u),{onSelectionChange:()=>h(),onSelectionComplete:()=>{},onDrop:(P,b,x)=>{C.placeRegion(P.region,b,x),h()},onDraw:(P,b)=>{C.drawAt(P,b,s().brushSize,s().brushIntensity),h()},onErase:(P,b)=>{C.eraseAt(P,b,s().brushSize),h()},onModeChange:()=>{},onBrushSizeChange:()=>{}})),bn.set(f(v)),h())}),ei(()=>{bn.set(null),wn.set(null),G(u,null),G(v,null)});function h(){if(!f(u))return;const C=zs();if(!C)return;const P=C.getState(),b=f(v)?.getSelection(),x=f(v)?.getGhostPreview();f(u).render(P,b,x)}st(()=>(n(),f(u)),()=>{n().state&&f(u)&&h()}),st(()=>(f(v),s()),()=>{f(v)&&s().mode&&f(v).setMode(s().mode)}),st(()=>(f(v),s()),()=>{f(v)&&(f(v).setBrushSize(s().brushSize),f(v).setBrushIntensity(s().brushIntensity))}),st(()=>(f(u),s()),()=>{f(u)&&s().colorScheme&&(f(u).updateSettings({colorScheme:s().colorScheme}),h())}),st(()=>(f(u),r()),()=>{f(u)&&r()&&(f(u).setThemeColors({primary:r().colors.primary,secondary:r().colors.secondary,tertiary:r().colors.tertiary}),h())}),st(()=>(i(),f(u)),()=>{i()&&f(u)&&h()}),Ws(),Ss();var m=yl(),y=p(m),_=p(y),w=p(_),R=p(w),k=g(_,2),M=p(k);ze(M,"width",d),ze(M,"height",d),Vt(M,C=>G(c,C),()=>f(c)),Vt(k,C=>G(l,C),()=>f(l)),B(()=>F(R,`${n(),N(()=>n().config.width)??""}x${n(),N(()=>n().config.height)??""}`)),S(e,m),dt(),o()}var xl=T("<button> </button>"),Sl=T('<span class="icon svelte-xicwp9">â¸</span>'),El=T('<span class="icon svelte-xicwp9">â¶</span>'),Ml=T('<button><span class="icon svelte-xicwp9"> </span> <span class="label svelte-xicwp9"> </span></button>'),Cl=T('<div class="brush-row svelte-xicwp9"><label class="svelte-xicwp9">INTENSITY</label> <input type="range" min="0" max="100" class="svelte-xicwp9"/> <span class="svelte-xicwp9"> </span></div>'),Tl=T('<div class="brush-settings svelte-xicwp9"><div class="brush-row svelte-xicwp9"><label class="svelte-xicwp9">SIZE</label> <input type="range" min="1" max="30" class="svelte-xicwp9"/> <span class="svelte-xicwp9"> </span></div> <!></div>'),kl=T("<button> </button>"),$l=T('<img class="svelte-xicwp9"/>'),Il=T('<div class="preset-placeholder svelte-xicwp9"></div>'),Al=T('<div class="preset-item svelte-xicwp9" role="button" tabindex="0"><!> <span class="preset-name svelte-xicwp9"> </span> <span class="preset-size svelte-xicwp9"> </span></div>'),Dl=T('<div class="empty-state svelte-xicwp9">No saved patterns</div>'),Pl=T('<button class="builtin-btn svelte-xicwp9"><span class="builtin-name svelte-xicwp9"> </span> <span class="builtin-desc svelte-xicwp9"> </span></button>'),Ol=T("<button></button>"),Ll=T('<div class="bottom-sheet svelte-xicwp9"><div class="mobile-stats svelte-xicwp9"><div class="stats-group svelte-xicwp9"><span>STEP: <strong class="svelte-xicwp9"> </strong></span> <span>MASS: <strong class="svelte-xicwp9"> </strong></span> <span>FPS: <strong class="svelte-xicwp9"> </strong></span></div> <div class="backend-toggle svelte-xicwp9"><span>CPU</span> <button aria-label="Toggle between CPU and GPU backend"><span class="toggle-knob svelte-xicwp9"></span></button> <span>GPU</span></div></div> <div class="tabs svelte-xicwp9"></div> <div class="panels-container svelte-xicwp9"><div><div class="panel svelte-xicwp9"><div class="playback-controls svelte-xicwp9"><button><!></button> <button class="ctrl-btn svelte-xicwp9"><span class="icon svelte-xicwp9">â­</span></button> <button class="ctrl-btn svelte-xicwp9"><span class="icon svelte-xicwp9">âº</span></button> <div class="speed-control svelte-xicwp9"><button class="speed-btn svelte-xicwp9">â</button> <strong> </strong> <button class="speed-btn svelte-xicwp9">+</button></div></div> <div class="tools-grid svelte-xicwp9"></div> <!></div> <div class="panel svelte-xicwp9"><div class="display-section svelte-xicwp9"><label class="section-label svelte-xicwp9">COLOR SCHEME</label> <div class="scheme-grid svelte-xicwp9"></div></div> <div class="display-section svelte-xicwp9"><label class="section-label svelte-xicwp9">EFFECTS</label> <div class="toggle-row svelte-xicwp9"><span>CRT Scanlines</span> <button aria-label="Toggle CRT scanlines effect"><span class="toggle-knob svelte-xicwp9"></span></button></div></div></div> <div class="panel svelte-xicwp9"><div class="preset-actions svelte-xicwp9"><button class="action-btn svelte-xicwp9">IMPORT</button> <button class="action-btn svelte-xicwp9">EXPORT</button></div> <div class="preset-grid svelte-xicwp9"></div></div> <div class="panel svelte-xicwp9"><div class="builtin-grid svelte-xicwp9"></div></div></div></div> <div class="swipe-indicator svelte-xicwp9"></div></div>');function Rl(e,t){ft(t,!0);const s=()=>K(Ne,"$mobileStore",c),n=()=>K(Co,"$currentTabIndex",c),r=()=>K(ci,"$formattedStep",c),i=()=>K(li,"$formattedMass",c),a=()=>K(ae,"$simulationStore",c),o=()=>K(vt,"$settings",c),l=()=>K(Js,"$presets",c),[c,u]=zt();let v,d=0,h=0,m=qe(1);function y(E){const I=E.touches[0];d=I.clientX,h=I.clientX,Ne.startSwipe()}function _(E){if(!s().isSwiping)return;h=E.touches[0].clientX;const L=h-d,j=n();j===0&&L>0||j===sn.length-1&&L<0?Ne.updateSwipe(L*.3):Ne.updateSwipe(L)}function w(){!s().isSwiping||!v||Ne.endSwipe(v.clientWidth)}function R(E){Ne.setTab(E)}function k(E){G(m,Math.max(1,Math.min(10,f(m)+E)),!0),ni(f(m))}const M=[{id:"view",label:"VIEW",icon:"â"},{id:"select",label:"SEL",icon:"â¡"},{id:"draw",label:"DRAW",icon:"â"},{id:"erase",label:"ERASE",icon:"â"}],C=[{id:"theme",label:"THEME"},{id:"grayscale",label:"GRAY"},{id:"thermal",label:"THERMAL"},{id:"viridis",label:"VIRIDIS"}];function P(E){const I=zs();if(!I)return;const L=Math.floor((I.getWidth()-E.region.width)/2),j=Math.floor((I.getHeight()-E.region.height)/2);I.placeRegion(E.region,L,j)}function b(E){_s(E.seed),W(`Loaded: ${E.name}`,"info")}let x=null;function O(E){x=setTimeout(()=>{confirm(`Delete "${E.name}"?`)&&_i(E.id)},500)}function $(){x&&(clearTimeout(x),x=null)}function q(){const E=document.createElement("input");E.type="file",E.accept=".json",E.onchange=async I=>{const L=I.target.files?.[0];if(!L)return;const j=await L.text();try{mi(j)}catch{}},E.click()}let D=Sa(()=>{const E=-n()*100,I=v?s().swipeOffset/v.clientWidth*100:0;return`translateX(${E+I}%)`});var z=Ll(),H=p(z),A=p(H),J=p(A),ue=g(p(J)),me=p(ue),be=g(J,2),Me=g(p(be)),Ce=p(Me),Q=g(be,2),ve=g(p(Q)),Te=p(ve),he=g(A,2),te=p(he);let we;var Ie=g(te,2);let ht;Ie.__click=()=>ai(a().backend==="cpu"?"gpu":"cpu");var ss=g(Ie,2);let ns;var V=g(H,2);Be(V,21,()=>sn,nt,(E,I)=>{var L=xl();let j;L.__click=()=>R(f(I));var pe=p(L);B(Qe=>{j=se(L,1,"tab svelte-xicwp9",null,j,{active:s().activeTab===f(I)}),F(pe,Qe)},[()=>f(I).toUpperCase()]),S(E,L)});var ie=g(V,2);ie.__touchstart=y,ie.__touchmove=_,ie.__touchend=w;var Ae=p(ie);let pt;var gt=p(Ae),fe=p(gt),ye=p(fe);let Et;ye.__click=()=>a().playing?An():ri();var rs=p(ye);{var is=E=>{var I=Sl();S(E,I)},as=E=>{var I=El();S(E,I)};re(rs,E=>{a().playing?E(is):E(as,!1)})}var Es=g(ye,2);Es.__click=()=>ii();var Ms=g(Es,2);Ms.__click=()=>_s();var Zs=g(Ms,2),Pn=p(Zs);Pn.__click=()=>k(-1);var On=g(Pn,2),wi=p(On),yi=g(On,2);yi.__click=()=>k(1);var Ln=g(fe,2);Be(Ln,21,()=>M,nt,(E,I)=>{var L=Ml();let j;L.__click=()=>ui(f(I).id);var pe=p(L),Qe=p(pe),_t=g(pe,2),os=p(_t);B(()=>{j=se(L,1,"tool-btn svelte-xicwp9",null,j,{active:o().mode===f(I).id}),F(Qe,f(I).icon),F(os,f(I).label)}),S(E,L)});var xi=g(Ln,2);{var Si=E=>{var I=Tl(),L=p(I),j=g(p(L),2);j.__input=Mt=>fi(parseInt(Mt.currentTarget.value));var pe=g(j,2),Qe=p(pe),_t=g(L,2);{var os=Mt=>{var Cs=Cl(),De=g(p(Cs),2);De.__input=Qs=>di(parseInt(Qs.currentTarget.value)/100);var Ct=g(De,2),Di=p(Ct);B((Qs,Pi)=>{hn(De,Qs),F(Di,`${Pi??""}%`)},[()=>Math.round(o().brushIntensity*100),()=>Math.round(o().brushIntensity*100)]),S(Mt,Cs)};re(_t,Mt=>{o().mode==="draw"&&Mt(os)})}B(()=>{hn(j,o().brushSize),F(Qe,o().brushSize)}),S(E,I)};re(xi,E=>{(o().mode==="draw"||o().mode==="erase")&&E(Si)})}var Rn=g(gt,2),Nn=p(Rn),Ei=g(p(Nn),2);Be(Ei,21,()=>C,nt,(E,I)=>{var L=kl();let j;L.__click=()=>bo(f(I).id);var pe=p(L);B(()=>{j=se(L,1,"scheme-btn svelte-xicwp9",null,j,{active:o().colorScheme===f(I).id}),F(pe,f(I).label)}),S(E,L)});var Mi=g(Nn,2),Ci=g(p(Mi),2),Fn=g(p(Ci),2);let zn;Fn.__click=function(...E){wo?.apply(this,E)};var Bn=g(Rn,2),Gn=p(Bn),Yn=p(Gn);Yn.__click=q;var Ti=g(Yn,2);Ti.__click=function(...E){bi?.apply(this,E)};var ki=g(Gn,2);Be(ki,5,l,E=>E.id,(E,I)=>{var L=Al();L.__click=()=>P(f(I)),L.__keydown=De=>De.key==="Enter"&&P(f(I)),L.__touchstart=()=>O(f(I)),L.__touchend=$,L.__touchmove=$;var j=p(L);{var pe=De=>{var Ct=$l();B(()=>{ze(Ct,"src",f(I).thumbnail),ze(Ct,"alt",f(I).name)}),S(De,Ct)},Qe=De=>{var Ct=Il();S(De,Ct)};re(j,De=>{f(I).thumbnail?De(pe):De(Qe,!1)})}var _t=g(j,2),os=p(_t),Mt=g(_t,2),Cs=p(Mt);B(()=>{F(os,f(I).name),F(Cs,`${f(I).region.width??""}Ã${f(I).region.height??""}`)}),S(E,L)},E=>{var I=Dl();S(E,I)});var $i=g(Bn,2),Ii=p($i);Be(Ii,21,()=>gi,nt,(E,I)=>{var L=Pl();L.__click=()=>b(f(I));var j=p(L),pe=p(j),Qe=g(j,2),_t=p(Qe);B(()=>{F(pe,f(I).name),F(_t,f(I).description)}),S(E,L)}),Vt(ie,E=>v=E,()=>v);var Ai=g(ie,2);Be(Ai,21,()=>sn,nt,(E,I,L)=>{var j=Ol();let pe;j.__click=()=>Ne.setTab(f(I)),B(()=>{pe=se(j,1,"dot svelte-xicwp9",null,pe,{active:n()===L}),ze(j,"aria-label",`Go to ${f(I)??""} panel`)}),S(E,j)}),B(()=>{F(me,r()),F(Ce,i()),F(Te,a().fps),we=se(te,1,"backend-label svelte-xicwp9",null,we,{active:a().backend==="cpu"}),ht=se(Ie,1,"toggle-btn svelte-xicwp9",null,ht,{gpu:a().backend==="gpu"}),Ie.disabled=!a().gpuAvailable,ns=se(ss,1,"backend-label svelte-xicwp9",null,ns,{active:a().backend==="gpu",unavailable:!a().gpuAvailable}),pt=se(Ae,1,"panels-wrapper svelte-xicwp9",null,pt,{swiping:s().isSwiping}),$n(Ae,`transform: ${f(D)??""}`),Et=se(ye,1,"play-btn svelte-xicwp9",null,Et,{active:a().playing}),F(wi,`${f(m)??""}X`),zn=se(Fn,1,"toggle-btn small svelte-xicwp9",null,zn,{on:o().showScanlines})}),Hr("touchcancel",ie,w),S(e,z),dt(),u()}ts(["click","touchstart","touchmove","touchend","input","keydown"]);var Nl=T('<div class="loading-screen svelte-1n46o8q"><div class="loading-content svelte-1n46o8q"><div class="glitch-text svelte-1n46o8q" data-text="FLOW_LENIA">FLOW_LENIA</div> <div class="loading-status svelte-1n46o8q"><span class="animate-pulse">INITIALIZING SUBSTRATE</span> <span class="animate-blink">_</span></div></div></div>'),Fl=T('<div class="error-screen svelte-1n46o8q"><div class="error-content svelte-1n46o8q"><div class="error-title svelte-1n46o8q">SYSTEM FAILURE</div> <div class="error-message svelte-1n46o8q"> </div> <div class="error-hint svelte-1n46o8q">Ensure WASM is built: <code class="svelte-1n46o8q">wasm-pack build --target web --release</code></div></div></div>'),zl=T('<div class="mobile-header svelte-1n46o8q"><span class="mobile-title svelte-1n46o8q">FLOW_LENIA</span></div> <div class="mobile-canvas-container svelte-1n46o8q"><!></div> <!>',1),Bl=T('<!> <div class="main-content svelte-1n46o8q"><!> <!> <!></div> <!>',1),Gl=T('<div class="scanlines"></div>'),Yl=T('<div><canvas class="glow-layer svelte-1n46o8q"></canvas> <!></div> <!> <div class="vignette"></div>',1);function Xl(e,t){ft(t,!1);const s=()=>K(wn,"$simulationCanvas",o),n=()=>K(Ks,"$currentScheme",o),r=()=>K(ae,"$simulationStore",o),i=()=>K(Ne,"$mobileStore",o),a=()=>K(vt,"$settings",o),[o,l]=zt();let c=ne(!1),u=ne(null),v=ne(),d=ne(null),h,m=ne(!1),y=ne(),_=null,w=null;function R(){const b=s();if(!b||!f(d)||!f(v)){h=requestAnimationFrame(R);return}if(_||(_=document.createElement("canvas"),w=_.getContext("2d",{willReadFrequently:!0})),f(y)){const A=f(y).getBoundingClientRect(),J=f(v).width!==A.width||f(v).height!==A.height,ue=_.width===0||_.height===0;(J||ue)&&(et(v,f(v).width=A.width),et(v,f(v).height=A.height),_.width=A.width,_.height=A.height)}if(!w||_.width===0)return;const x=f(v).width,O=f(v).height,$=n().colors;w.drawImage(b,0,0,x,O);const q=w.getImageData(0,0,x,O),D=q.data,z=5,H=255-z;for(let A=0;A<D.length;A+=4){const J=(D[A]+D[A+1]+D[A+2])/3,me=Math.max(0,J-z)/H,be=Math.pow(me,.35);D[A]=255,D[A+1]=255,D[A+2]=255,D[A+3]=be*255}w.putImageData(q,0,0),f(d).clearRect(0,0,x,O),et(d,f(d).fillStyle=$.primary),f(d).fillRect(180,0,80,O),et(d,f(d).fillStyle=$.secondary),f(d).fillRect(x-220,0,80,O),et(d,f(d).fillStyle=$.tertiary),f(d).fillRect(0,30,x,40),et(d,f(d).fillStyle=$.tertiary),f(d).fillRect(0,O-60,x,40),et(d,f(d).globalCompositeOperation="destination-in"),f(d).drawImage(_,0,0),et(d,f(d).globalCompositeOperation="source-over"),h=requestAnimationFrame(R)}Vs(async()=>{xo(),Ne.checkViewport(),window.addEventListener("resize",Ne.checkViewport),W("SYS.BOOT","info"),W("Loading WASM module...","info");try{await go(),G(c,!0),W("WASM initialized","success"),W(`Backend: ${r().backend.toUpperCase()}`,"info"),W(`Theme: ${n().name}`,"info"),r().gpuAvailable?W("WebGPU available","success"):W("WebGPU not available","warn"),W("SYSTEM READY","success")}catch(b){G(u,String(b)),W(`INIT FAILED: ${b}`,"error")}}),ei(()=>{h&&cancelAnimationFrame(h),window.removeEventListener("resize",Ne.checkViewport)}),st(()=>(f(v),f(m)),()=>{f(v)&&!f(m)&&(G(d,f(v).getContext("2d")),G(m,!0),R())}),Ws(),Ss();var k=dn(),M=We(k);{var C=b=>{var x=Nl();S(b,x)},P=b=>{var x=dn(),O=We(x);{var $=D=>{var z=Fl(),H=p(z),A=g(p(H),2),J=p(A);B(()=>F(J,f(u))),S(D,z)},q=D=>{var z=Yl(),H=We(z);let A;var J=p(H);Vt(J,Q=>G(v,Q),()=>f(v));var ue=g(J,2);{var me=Q=>{var ve=zl(),Te=g(We(ve),2),he=p(Te);ir(he,{});var te=g(Te,2);Rl(te,{}),S(Q,ve)},be=Q=>{var ve=Bl(),Te=We(ve);$o(Te,{});var he=g(Te,2),te=p(he);Wo(te,{});var we=g(te,2);ir(we,{});var Ie=g(we,2);ml(Ie,{});var ht=g(he,2);Ao(ht),S(Q,ve)};re(ue,Q=>{i(),N(()=>i().isMobile)?Q(me):Q(be,!1)})}Vt(H,Q=>G(y,Q),()=>f(y));var Me=g(H,2);{var Ce=Q=>{var ve=Gl();S(Q,ve)};re(Me,Q=>{a(),N(()=>a().showScanlines)&&Q(Ce)})}B(()=>A=se(H,1,"app-container svelte-1n46o8q",null,A,{"mobile-layout":i().isMobile})),S(D,z)};re(O,D=>{f(u)?D($):D(q,!1)},!0)}S(b,x)};re(M,b=>{!f(c)&&!f(u)?b(C):b(P,!1)})}S(e,k),dt(),l()}qa(Xl,{target:document.getElementById("app")});
